function sideNavFunc(){return{scope:{menuwidth:"@",closeonclick:"@"},link:function(e,t,n){t.sideNav({menuWidth:angular.isDefined(e.menuwidth)?e.menuwidth:void 0,edge:n.sidenav?n.sidenav:"left",closeOnClick:angular.isDefined(e.closeonclick)?"true"==e.closeonclick:void 0})}}}function tabsFunc(){return{link:function(e,t,n){t.tabs()}}}function dropdownFunc(e,t){return{scope:{inDuration:"@",outDuration:"@",constrainWidth:"@",hover:"@",alignment:"@",gutter:"@",belowOrigin:"@"},link:function(n,o,i){var a;t(function(){e(o.contents())(n),a=o.attr("data-activates"),o.dropdown({inDuration:angular.isDefined(n.inDuration)?n.inDuration:void 0,outDuration:angular.isDefined(n.outDuration)?n.outDuration:void 0,constrain_width:angular.isDefined(n.constrainWidth)?n.constrainWidth:void 0,hover:angular.isDefined(n.hover)?n.hover:void 0,alignment:angular.isDefined(n.alignment)?n.alignment:void 0,gutter:angular.isDefined(n.gutter)?n.gutter:void 0,belowOrigin:angular.isDefined(n.belowOrigin)?n.belowOrigin:void 0})}),n.$on("closeDropdown",function(e,t){t.ddname===a&&o.trigger("close")})}}}function inputDateFunc(e,t){var n=$("<style>#inputCreated_root {outline: none;}</style>");$("html > head").append(n);var o=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,i=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e};return function(a,l,r){var s=o;if(1!==arguments.length||"[object String]"!=Object.prototype.toString.call(a)||/\d/.test(a)||(l=a,a=void 0),a=a?new Date(a):new Date,isNaN(a))throw SyntaxError("invalid date");l=String(s.masks[l]||l||s.masks["default"]),"UTC:"==l.slice(0,4)&&(l=l.slice(4),r=!0);var c=r?"getUTC":"get",d=a[c+"Date"](),u=a[c+"Day"](),p=a[c+"Month"](),f=a[c+"FullYear"](),g=a[c+"Hours"](),m=a[c+"Minutes"](),h=a[c+"Seconds"](),v=a[c+"Milliseconds"](),y=r?0:a.getTimezoneOffset(),b={d:d,dd:i(d),ddd:s.i18n.dayNames[u],dddd:s.i18n.dayNames[u+7],m:p+1,mm:i(p+1),mmm:s.i18n.monthNames[p],mmmm:s.i18n.monthNames[p+12],yy:String(f).slice(2),yyyy:f,h:g%12||12,hh:i(g%12||12),H:g,HH:i(g),M:m,MM:i(m),s:h,ss:i(h),l:i(v,3),L:i(v>99?Math.round(v/10):v),t:12>g?"a":"p",tt:12>g?"am":"pm",T:12>g?"A":"P",TT:12>g?"AM":"PM",Z:r?"UTC":(String(a).match(t)||[""]).pop().replace(n,""),o:(y>0?"-":"+")+i(100*Math.floor(Math.abs(y)/60)+Math.abs(y)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return l.replace(e,function(e){return e in b?b[e]:e.slice(1,e.length-1)})}}();o.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},o.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(e,t){return o(this,e,t)};var i=function(e){return"[object Date]"===Object.prototype.toString.call(e)?!isNaN(e.getTime()):!1};return{require:"ngModel",scope:{container:"@",format:"@",formatSubmit:"@",monthsFull:"@",monthsShort:"@",weekdaysFull:"@",weekdaysLetter:"@",firstDay:"=",disable:"=",today:"=",clear:"=",close:"=",selectYears:"=",onStart:"&",onRender:"&",onOpen:"&",onClose:"&",onSet:"&",onStop:"&",ngReadonly:"=?",max:"@",min:"@"},link:function(n,o,a,l){l.$formatters.unshift(function(e){if(e){var t=new Date(e);return angular.isDefined(n.format)?t.format(n.format):t.format("d mmmm, yyyy")}return null});var r=angular.isDefined(n.monthsFull)?n.$eval(n.monthsFull):void 0,s=angular.isDefined(n.monthsShort)?n.$eval(n.monthsShort):void 0,c=angular.isDefined(n.weekdaysFull)?n.$eval(n.weekdaysFull):void 0,d=angular.isDefined(n.weekdaysLetter)?n.$eval(n.weekdaysLetter):void 0;e(o.contents())(n),n.ngReadonly||t(function(){var e=o.pickadate({container:angular.isDefined(n.container)?n.container:"body",format:angular.isDefined(n.format)?n.format:void 0,formatSubmit:angular.isDefined(n.formatSubmit)?n.formatSubmit:void 0,monthsFull:angular.isDefined(r)?r:void 0,monthsShort:angular.isDefined(s)?s:void 0,weekdaysFull:angular.isDefined(c)?c:void 0,weekdaysLetter:angular.isDefined(d)?d:void 0,firstDay:angular.isDefined(n.firstDay)?n.firstDay:0,disable:angular.isDefined(n.disable)?n.disable:void 0,today:angular.isDefined(n.today)?n.today:void 0,clear:angular.isDefined(n.clear)?n.clear:void 0,close:angular.isDefined(n.close)?n.close:void 0,selectYears:angular.isDefined(n.selectYears)?n.selectYears:void 0,onStart:angular.isDefined(n.onStart)?function(){n.onStart()}:void 0,onRender:angular.isDefined(n.onRender)?function(){n.onRender()}:void 0,onOpen:angular.isDefined(n.onOpen)?function(){n.onOpen()}:void 0,onClose:angular.isDefined(n.onClose)?function(){n.onClose()}:void 0,onSet:angular.isDefined(n.onSet)?function(){n.onSet()}:void 0,onStop:angular.isDefined(n.onStop)?function(){n.onStop()}:void 0}),t=e.pickadate("picker");n.$watch("max",function(e){if(t){var n=new Date(e);t.set({max:i(n)?n:!1})}}),n.$watch("min",function(e){if(t){var n=new Date(e);t.set({min:i(n)?n:!1})}})})}}}function modal(e,t){return{restrict:"E",scope:{},link:function(e,t,n){e.templateUrl=n.templateUrl,e.title=n.title,modalCounter+=1,e.modalCounter=modalCounter,setTimeout(function(){angular.element("#modalButton"+modalCounter).leanModal()})},template:'<div><a id="modalButton{{modalCounter}}" class="waves-effect waves-light btn modal-trigger" href="#modal{{modalCounter}}" modal>{{title}}</a><div id="modal{{modalCounter}}" class="modal modal-sm" ng-include="templateUrl"></div>'}}function slideToggleFunc(){return{restrict:"A",scope:{},controller:function(e){},link:function(e,t,n){t.bind("click",function(){var e=angular.element(n.slideToggle),t=parseInt(n.slideToggleDuration,10)||200;e.stop().slideToggle(t)})}}}function collapsibleFunc(){return{restrict:"A",link:function(e,t,n){t.collapsible()}}}function smartHeightFun(e){return{restrict:"A",link:function(e,t,n){function o(e){var t=0;return e?NaN==Number(e)?e.indecOf(",")>-1?$(e).each(function(){t+=this.outerHeight}):t=$(e).get(0).outerHeight:t=Number(e):t=0,t}function i(e,t){var n;switch(t){case"relativeTo":n=e?e:window;break;case"plusThis":n=e?e:!1;break;case"minusThis":n=e?e:!1}return n}var a={relativeTo:i(n.relativeTo,"relativeTo"),plusThis:i(n.plusThis,"plusThis"),minusThis:i(n.minusThis,"minusThis")},l=function(){var e=0,t=0,n=0;return e=a.relativeTo==window?window.innerHeight:$(a.relativeTo).get(0).outerHeight,a.plusThis?(n=o(a.plusThis),e+=n):(t=o(a.minusThis),e-=t),e}();t.css("height",l)}}}!function(){angular.module("SMART2").directive("body",function(){return{restrict:"E",link:function(e,t,n){function o(e){return void 0==e.originalEvent.wheelDelta?e.originalEvent.deltaY:-e.originalEvent.wheelDelta}IEscroll=function(e){if(0==$(e.target).closest(".dropdown-content").length&&0==$(e.target).closest("smart-scroll").length&&0==$(e.target).closest(".scroll-inner-wrapp").length){var t=o(e);if("hidden"==$("body").css("overflow"))return;var n=function(){return 0>t?-90>t?60:40:t>90?60:40}();e.preventDefault();var i=0>t?t-n:t+n,a=window.pageYOffset;$(this).scrollTop(a+i)}},("Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/rv:11/)||"undefined"!=typeof $.browser&&1==$.browser.msie)&&$("html,body").bind("mousewheel",IEscroll)}}})}(),function(){"use strict";angular.module("SMART2").directive("ckEditor",["APPCONSTANTS",function(e){return{require:"?ngModel",link:function(t,n,o,i){function a(){s&&i.$setViewValue(r.getData())}var l="en";e.userPreferences.UserBasicDetails.Culture&&(l=e.userPreferences.UserBasicDetails.Culture);var r=CKEDITOR.replace(n[0],{toolbar:"Basic",language:l});if(i){var s=!1;r.on("instanceReady",function(){r.setData(i.$viewValue)}),i.$render=function(e){r.setData(i.$viewValue)},r.on("change",a),r.on("focus",function(e){s=!0}),t.$on("$destroy",function(){r.removeAllListeners(),CKEDITOR.remove(r)})}}}}])}(),function(){"use strict";angular.module("SMART2").directive("colorPicker",["$parse","$timeout",function(e,t){return{restrict:"E",replace:!0,transclude:!0,scope:{onSelect:"&"},link:function(e,t,n){var o=$(t).find(".colorPicker");o.on("change.color",function(t,n){n&&e.$apply(function(){e.onSelect({$event:{color:n}})})}),o.colorpicker({showOn:"button",history:!1}),$(t).bind("click",function(e){e.stopImmediatePropagation(),$(this).find(".colorPicker").colorpicker("showPalette")}),n.$observe("color",function(e){o.colorpicker("val",e)})},templateUrl:"shared/directives/colorPicker/colorPickerTemplate.html"}}])}(),angular.module("SMART2").directive("sidenav",[sideNavFunc]).directive("tabs",[tabsFunc]).directive("dropdown",["$compile","$timeout",dropdownFunc]).directive("inputDate",["$compile","$timeout",inputDateFunc]).directive("modal",["$compile","$timeout",modal]).directive("slideToggle",[slideToggleFunc]).directive("collapsible",[collapsibleFunc]);var modalCounter=0;!function(){"use strict";angular.module("SMART2").factory("notification",[function(){var e={};return e.show=!1,e.onCallback=void 0,e.on=function(t){e.onCallback=t},e.notify=function(e,t){this.show=!0,this.config=e,this.broadcastItem(),this.resultCallBack=function(e){"function"==typeof t&&setTimeout(function(){t(e)})}},e.broadcastItem=function(){angular.isFunction(e.onCallback)&&e.onCallback()},e}]),angular.module("SMART2").directive("smartNotification",["$rootScope","notification","$translate","$sce","$timeout","$focusOnField","browserSniffing",function(e,t,n,o,i,a,l){return{restrict:"EA",replace:!0,scope:{showN:"@"},link:function(l,r,s){function c(){l.notifyClass="",l.buttons=[],angular.element("body").css("overflow",""),angular.element(".notification-massage .modal-content").css("display","none"),angular.element(".notification-massage .modal-footer").css("display","none")}var d=0;l.isChrome=-1!=navigator.userAgent.indexOf("Chrome")?"remindMeOption":"";var u=function(){$(window).off("keyup",p),angular.element(".picker").attr("tabindex",0),angular.element(document).scrollTop(d)},p=function(e){0==angular.element(e.target).closest(".modal").length&&9==e.keyCode&&angular.element(r.find(":focusable")[0]).focus()};l.$on("$stateChangeSuccess",function(){l.showN&&"unsupportedBrowserVersion"!=l.config.type&&"unsupportedBrowser"!=l.config.type&&(l.showN=!1,c())}),l.dismissible=!0,t.on(function(){switch(l.dismissible=angular.isDefined(t.config.dismissible)?t.config.dismissible:!0,l.config=t.config,l.buttons=l.config.buttons,l.config.type){case"success":l.notifyClass="notify-success",l.title=n.instant("notificationSuccessMsg"),l.icon="#icon_CircleCheck";break;case"error":l.notifyClass="notify-error",l.title=n.instant("notificationErrorMsg"),l.icon="#icon_Exclamation";break;case"warning":l.notifyClass="notify-warning",l.icon="#icon_Warning",l.title=n.instant("notificationWarningMsg");break;case"confirm":l.notifyClass="notify-confirm",l.icon="#icon_Help",l.title=n.instant("notificationConfirmationMsg");break;case"inform":l.notifyClass="notify-information",l.icon="#icon_Info",l.title=n.instant("notificationInformationMsg");break;case"sessionTimeOut":l.notifyClass="notify-session-timeout",l.icon="#icon_AlertTimer",l.title=n.instant("notificationSessionTimeOut"),l.dismissible=!1;break;case"sessionExpire":l.notifyClass="notify-session-expire",l.icon="#icon_AlertTimer",l.title=n.instant("notificationSessionExpiredMsg"),l.dismissible=!1;break;case"unsupportedBrowserVersion":l.notifyClass="notify-unsupported-browser-version",l.titleTextColor="browser-version-header-text",l.title=n.instant("notificationUnsupportedBrowserVersionMsg");break;case"unsupportedBrowser":l.notifyClass="notify-unsupported-browser",l.titleTextColor="browser-unsupported-header-text",l.title=n.instant("notificationUnsupportedBrowserMsg")}if(l.onChange=function(e){l.showN=!1,l.$digest()},l.message=o.trustAsHtml(l.config.message),l.checkboxText=l.config.checkMessage,l.customTemplate=!1,"undefined"!=typeof l.config.isMultipleCheck&&l.config.isMultipleCheck){l.customTemplate=!0,"undefined"==typeof l.config.modalType&&(l.config.modalType="small");for(var e in l.config.multipleCheckList){switch(l.config.multipleCheckList[e].model={},l.config.multipleCheckList[e].model.modelName=l.config.multipleCheckList[e].checkContext,l.config.multipleCheckList[e].type){case"check":l.config.multipleCheckList[e].model.isCheck=!1;break;case"radio":l.config.multipleCheckList[e].model.isCheck={title:""};case"select":"undefined"!=typeof l.config.multipleCheckList[e].preSelected?l.config.multipleCheckList[e].model.isCheck=l.config.multipleCheckList[e].preSelected:l.config.multipleCheckList[e].model.isCheck={title:""}}"undefined"!=typeof l.config.multipleCheckList[e].header&&"string"==typeof l.config.multipleCheckList[e].header&&(l.config.multipleCheckList[e].header=o.trustAsHtml(l.config.multipleCheckList[e].header)),"string"==typeof l.config.multipleCheckList[e].label&&(l.config.multipleCheckList[e].label=o.trustAsHtml(l.config.multipleCheckList[e].label))}for(var e in l.config.buttons)"undefined"!=typeof l.config.buttons[e].disableBtn&&(l.config.buttons[e].disableBtn=!0)}l.isCheckSelect=!1,"undefined"!=typeof l.config.isCheckSelect&&(l.isCheckSelect=l.config.isCheckSelect),l.showN=t.show,angular.element("body").css("overflow","hidden"),i(function(){var e=r.find(":focusable")[0];a(e),$(window).on("keyup",p),angular.element(".picker").removeAttr("tabindex"),l.notifyClass=l.notifyClass+" notificationanimate--active"},250),d=angular.element(document).scrollTop()}),l.showN=!1,l.bindforTab=!1,l.overlayCLicked=function(){l.dismissible},l.$on("LastRepeaterElement",function(){l.bindforTab=!0}),l.onChangeNotification=function(){var e=0;for(var t in l.config.multipleCheckList)l.config.multipleCheckList[t].model.isCheck&&e++;for(var t in l.config.buttons)"undefined"!=typeof l.config.buttons[t].disableBtn&&(e>0?l.config.buttons[t].disableBtn=!1:l.config.buttons[t].disableBtn=!0)},l.clickCallbackFunction=function(n){i(function(){l.showN=!1,l.bindforTab=!1;var o={result:n};if(l.customTemplate)for(var i in l.config.multipleCheckList)o[l.config.multipleCheckList[i].model.modelName]=l.config.multipleCheckList[i].model.isCheck;else o.isChecked=l.isCheckSelect;c(),t.resultCallBack(o),e.$broadcast("closedPopup")})},l.$on("$destroy",function(){u()})},templateUrl:"shared/directives/notification/notificationTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("onCaptureClick",["$parse",function(e){return{restrict:"A",compile:function(t,n){var o=e(n.onCaptureClick);return function(e,t){t[0].addEventListener("click",function(t){e.$apply(function(){o(e,{$event:t})})},!0)}}}}])}(angular),function(){"use strict";angular.module("SMART2").directive("onLoad",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{onLoadCallback:"&"},link:function(t,n,o){t.onLoadCallback?t.onLoadCallback=t.$eval(t.onLoadCallback):null,angular.isFunction(t.onLoadCallback)&&e(function(){t.onLoadCallback()},0)}}}])}(),function(){"use strict";angular.module("SMART2").directive("profilePic",["notification","$translate",function(e,t){return{restrict:"E",replace:!0,scope:{},link:function(n,o,i){n.isProfilePicEditable=!1,n.isUserProfile=!1,"true"==i.circular&&(n.isUserProfile=!0),"true"==i.editable&&(n.isProfilePicEditable=!0),n.dummyimg=!1,"true"==i.dummyimg&&(n.dummyimg=!0),1==n.isUserProfile?n.dummyimg||(n.imgsrc="shared/resources/images/dummyImage.jpg"):n.dummyimg||(n.imgsrc="shared/resources/images/kelloggs_logo.png");var a=function(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){angular.element(".user-profile").addClass("is-profile-pic"),n.dummyimg=!1,n.imgsrc=e.target.result,n.$apply()},t.readAsDataURL(e.files[0])}};o.find("#callFileFOrProfile").on("change",function(){a(this)}),n.profilePicEdit=function(){o.find("#callFileFOrProfile").get(0).click()},n.clearProfilePicEdit=function(){var i={type:"confirm",message:"<p class='left-align'>"+t.instant("confirmationMsg")+"</p>",buttons:[{title:t.instant("notificationButtonYes"),result:"yes"},{title:t.instant("cancelBtn"),result:"no"}]};e.notify(i,function(e){"yes"==e.result&&(angular.element(".overL").prev().toggleClass("changeImage"),angular.element(".user-profile img").hasClass("changeImage")?(n.imgsrc=!1,o.find("#callFileFOrProfile").val(""),n.dummyimg=!0,1==n.isUserProfile&&(n.imgsrc="shared/resources/images/user_default_BIG.PNG",angular.element(".user-profile").removeClass("is-profile-pic"))):(n.imgsrc=dummySrc,n.isDeleted=!1,angular.element(".user-profile").addClass("is-profile-pic")))})}},templateUrl:"shared/components/directives/profilePic/profilePic.html"}}])}(),angular.module("SMART2").directive("progressMeter",["$timeout",function(e){return{restrict:"EA",replace:!0,scope:{percent:"=?"},link:function(t,n,o){function i(){t.value=parseInt(t.percent),t.value&&(t.c=50*Math.PI,t.pct=156,t.value<0&&(t.value=0),t.value>100&&(t.value=100),e(function(){t.pct=(100-t.value)/100*t.c,t.strokeStyle={"stroke-dashoffset":t.pct}},500))}var a=t.$watch("percent",function(e,t){i()});t.$on("$destroy",function(){a()})},templateUrl:"shared/directives/progressMeter/progressMeterTemplate.html"}}]),angular.module("SMART2").directive("isResizable",function(){return{restrict:"A",scope:{handle:"@",onresize:"&",onstart:"&",onstop:"&"},link:function(e,t,n){t.resizable({handles:e.handle,resize:function(t,n){e.onresize({event:t,ui:n})},start:function(t,n){e.onstart({event:t,ui:n})},stop:function(t,n){e.onstop({event:t,ui:n})}}),void 0!=n.maxheight&&n.$observe("maxheight",function(){t.resizable("option","maxHeight",n.maxheight)}),void 0!=n.minheight&&n.$observe("minheight",function(){t.resizable("option","minHeight",n.minheight)}),void 0!=n.maxwidth&&n.$observe("maxwidth",function(){t.resizable("option","maxWidth",n.maxwidth)}),void 0!=n.minwidth&&n.$observe("minwidth",function(){t.resizable("option","minWidth",n.minwidth)}),void 0!=n.alsoResizeRevert&&t.resizable("option","alsoResizeReverse",n.alsoResizeRevert),void 0!=n.alsoResize&&t.resizable("option","alsoResize",n.alsoResizeRevert)}}}),angular.module("SMART2").directive("smartWindowResizer",["$window",function(e){return{restrict:"AE",replace:!1,scope:{pageHeight:"@"},link:function(t,n,o){t.pageHeight=e.innerHeight-114+"px",n.css("height",t.pageHeight),angular.element(e).bind("resize",function(o){t.fixedSubHeader?t.pageHeight=e.innerHeight-50+"px":t.pageHeight=e.innerHeight-114+"px",t.$apply(),console.log(t.pageHeight),n.css("height",t.pageHeight)})}}}]),angular.module("SMART2").directive("scrollContent",["$window","$filter","$rootScope","scrollPosition",function(e,t,n,o){return{restrict:"A",scope:!0,link:function(i,a,l){n.$on("$locationChangeSuccess",function(){if(1==o.getEnableScroll()){var n=t("filter")(o.get(),{currentUrl:e.location.hash},!0)[0];n&&o.performScroll(o.get()[o.get().indexOf(n)].scroll,500)}}),angular.element(e).bind("scroll",function(t){var n=this.scrollY||this.pageYOffset;n>0&&o.set(n,e.location.hash)})}}}]),function(){"use strict";angular.module("SMART2").directive("smartSlidingMenu",["RuleEngine","$timeout","$compile","$translate","$rootScope",function(e,t,n,o,i){return{restrict:"E",replace:!0,transclude:!0,scope:{right:"@",top:"@",show:"=",detachDefaultClass:"@",includeTemplate:"@",model:"@",modifyParentStyle:"@",tabData:"="},link:function(e,t,n,o){e.getModel=function(){return JSON.parse(e.model)},e.logoutSession=function(){requestClicked.navCircle("request","#",null)},e.detachDefaultClass?"true"===e.detachDefaultClass.toLowerCase()||t.addClass("secondary-navigation white"):t.addClass("secondary-navigation white"),e.slidingMenuId="sliding-menu-"+(new Date).getTime(),e.rightPos=e.right?e.right:0,e.leftPos=window.innerWidth-e.rightPos,e.$watch("show",function(n,o){(void 0!=n||null!=n)&&(n?(e.modifyParentStyle&&"false"!==e.modifyParentStyle.toLowerCase()&&t.parent().css({width:"calc(100% - "+t.outerWidth(!0)+"px)"}),t.css({transform:"translateX(-"+(t.outerWidth(!0)-e.rightPos)+"px)"}),$("body").addClass("is-overflowHidden")):(e.modifyParentStyle&&"false"!==e.modifyParentStyle.toLowerCase()&&t.parent().css({width:"calc(100% - "+e.rightPos+"px)"}),t.css({transform:"translateX(0px)"}),$("body").removeClass("is-overflowHidden")))})},templateUrl:"shared/directives/slidingMenu/slidingMenuTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartAccordion",["$timeout","$parse","$rootScope",function(e,t,n){return{restrict:"EA",transclude:!0,replace:!0,scope:!0,link:function(e,n,o){function i(){r(e,{e:{isOpen:l.target.data("isOpen")}})}function a(e){var t=$(this),n=t.data("isOpen");e&&!n?(t.data("isOpen",!0),l.content.slideDown()):!e&&n&&(t.data("isOpen",!1),l.content.slideUp())}var l={target:n.find(".accordion-header"),content:n.find(".accordion-content")},r=t(o.onChange);l.target.data("isOpen",!1),l.content.hide(0).slideUp(0),o.$observe("show",function(e,t){a.call(l.target,"true"==e?!0:!1)}),l.target.click(function(){a.call(this,!$(this).data("isOpen")),i(),e.$digest()})},template:"<div class='smart-accordion-container' ng-transclude></div>"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartAccumulator",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{ngModel:"=?",options:"=",isSearch:"=",leftLoader:"=",rightLoader:"=",modelCount:"=?",optionCount:"=?",columnMappingError:"=",selectionCallback:"&",searchCallback:"&",maxLimit:"=",scrollEndRightCallback:"&",scrollEndLeftCallback:"&"},link:function(e,t,n){function o(t){for(var o="",i="",a=e.$eval(n.addKeys),l=0;l<a.length;l++)o=a[l],i=i+" "+t[o];return i}e.label=n.label,e.optionCount=angular.isDefined(e.optionCount)?e.optionCount:!0,e.modelCount=angular.isDefined(e.modelCount)?e.modelCount:!0,e.iconInfo=e.$eval(n.iconInfo),e.accumulatorHeight=n.height+"px",e.accumulatorLeftScrollHeight=n.height-48+"px",e.loaderFlag={plain:!0,center:!0,message:"",top:"50",left:"131"},e.focusAccumulatorSearch=!1,e.isAccumulatorSearchActive=!1,e.showAccumulatorSearch=!1,e.accumulatorSearchModel="",e.showAccumulatorSearch=function(){e.isAccumulatorSearchActive=!0,e.focusAccumulatorSearch=!0,setTimeout(function(){$("#searchLeftTextbox").find("input").focus()},500),e.hideAccumulatorSearchClose=!0},e.hideAcccumulatorSearch=function(){e.leftCheckedCount=0,""!=e.accumulatorSearchModel?e.accumulatorSearchModel="":(e.isAccumulatorSearchActive=!1,e.focusAccumulatorSearch=!1,e.hideAccumulatorSearchClose=!1,$("#accumulatorLeftShowSearch").focus()),$.isFunction(e.searchCallback)&&e.searchCallback({$data:{text:e.accumulatorSearchModel,type:"close"}})},e.smartScrollLeftEnd=function(){$.isFunction(e.scrollEndLeftCallback)&&e.scrollEndLeftCallback()},e.smartScrollRightEnd=function(){$.isFunction(e.scrollEndRightCallback)&&e.scrollEndRightCallback()},e.focusRightAccumulatorSearch=!1,e.isRightAccumulatorSearchActive=!1,e.showRightAccumulatorSearch=!1,e.showRightAccumulatorSearch=function(){e.isRightAccumulatorSearchActive=!0,e.focusRightAccumulatorSearch=!0,setTimeout(function(){$("#searchRightTextbox").find("input").focus()},500),e.hideRightAccumulatorSearchClose=!0},e.hideRightAcccumulatorSearch=function(){e.isRightAccumulatorSearchActive=!1,e.focusRightAccumulatorSearch=!1,e.hideRightAccumulatorSearchClose=!1,$("#accumulatorRightShowSearch").focus()},e.searchTextKeyUpFn=function(t){$.isFunction(e.searchCallback)&&e.searchCallback({$data:{text:t.target.value,type:"textfield",e:t}}),e.leftCheckedCount=0},e.leftCheckedCount=0,e.rightCheckedCount=0,e.leftBoxListCheck=function(t){t.isChecked?e.leftCheckedCount++:e.leftCheckedCount--;for(var n=0;n<e.options.length;n++)e.leftCheckedCount+e.ngModel.length>=e.maxLimit&&!e.options[n].isChecked||e.maxLimit==e.leftCheckedCount&&!e.options[n].isChecked?e.options[n].isDisabled=!0:(e.ngModel.length>=e.maxLimit&&e.options[n].$$hashKey==t.$$hashKey&&(e.options[n].isChecked=!1),e.options[n].isDisabled=!1)},e.rightBoxListCheck=function(){e.rightCheckedCount=0;for(var t=0;t<e.ngModel.length;t++)e.ngModel[t].isDisabled||e.ngModel[t].isChecked&&e.rightCheckedCount++},e.$watch("options",function(t){e.options=t;for(var n=0;n<e.options.length;n++)if(e.options[n].isGroup)for(var i=0;i<e.options[n].group.length;i++)e.options[n].group[i].optionKey=o(e.options[n].group[i]);else e.options[n].optionKey=o(e.options[n])},!0),e.moveRight=function(t){var n=[];if(e.leftCheckedCount>0){for(var o=0;o<e.options.length;o++)if(e.options[o].isChecked){if(e.options[o].isGroup)for(var i=0;i<e.options[o].group.length;i++)e.ngModel.push(e.options[o].group[i]),e.options[o].group[i].isChecked=!0;else e.options[o].isChecked=!0,n.push(e.options[o]),e.ngModel.push(e.options[o]);var a=e.options.indexOf(e.options[o]);e.options.splice(a,1),o--}$.isFunction(e.selectionCallback)&&e.selectionCallback({e:n,direction:"LTR"})}e.rightBoxListCheck(),e.leftCheckedCount=0};var i=[];e.moveLeft=function(t){if(e.rightCheckedCount>0){for(var n=0;n<e.ngModel.length;n++)if(!e.ngModel[n].isDisabled&&e.ngModel[n].isChecked){e.ngModel[n].isChecked=!1,e.options.push(e.ngModel[n]);for(var o=0;o<e.options.length;o++)e.options[o].isDisabled=!1,e.rightCheckedCount--;i.push(e.ngModel[n]);var a=e.ngModel.indexOf(e.ngModel[n]);e.ngModel.splice(a,1),n--}$.isFunction(e.selectionCallback)&&e.selectionCallback({e:i,direction:"RTL"})}e.rightCheckedCount=0},e.$watch("ngModel",function(t){e.accumulatorSearchModel="",e.accumulatorRightSearchModel="",e.ngModel=t,e.ngModel.length<=0&&(e.rightCheckedCount=0)}),e.$watch("rightLoader",function(t){e.rightLoader=t}),e.$watch("leftLoader",function(t){e.leftLoader=t})},templateUrl:"shared/directives/smartAccumulator/smartAccumulatorTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartCarousel",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{apiObj:"=",carouselArr:"=",arrowClick:"&",getItem:"&"},link:function(e,t,n){var o="margin-left",i="width",a="left",l=94;e.scrollBarClass="scrollBarClass "+e.carouselArr.classes,e.arrowClass="icon iconMedium reqNavArrow "+e.carouselArr.arrow,"horizontal"===e.carouselArr.type&&"leftBar"===e.carouselArr.id&&(a="right"),"vertical"==e.carouselArr.type&&(o="margin-top",i="height",a="top",l=94),e.internalAPIObj=e.apiObj||{},e.internalAPIObj.arrowClick=function(t){e.arrowClick(e,{e:t})},e.getClickedItem=function(t){e.getItem({e:t})},e.animate=!1,e.internalAPIObj.resetUI=function(n,o){var a=angular.element(t.children()[1]),r=e.carouselArr.items.length*l;e.animate=!0,"height"==i?a.css("height",n):a.css("width","100%"),r>=n?("topBar"===e.carouselArr.id&&a.removeClass("topBarOverflow").addClass("topBarOverflowHidden"),e.carouselArr.showArrow=!0):("topBar"===e.carouselArr.id&&a.removeClass("topBarOverflowHidden").addClass("topBarOverflow"),e.carouselArr.showArrow=!1)}},templateUrl:"shared/directives/smartCarousel/smartCarousel.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("countdown",["$interval",function(e){return{restrict:"E",replace:!0,transclude:!0,scope:{date:"@",timeoutCallback:"&"},link:function(t,n,o){function i(n){var i=Math.floor(n/86400);n-=86400*i;var a=Math.floor(n/3600)%24;n-=3600*a;var r=Math.floor(n/60)%60;n-=60*r;var s=n%60;return i||a||r||s?i+"d "+a+"h "+r+"m "+s+"s":(angular.isDefined(l)&&e.cancel(l),void(o.timeoutCallback&&angular.isFunction(t.timeoutCallback)&&t.timeoutCallback()))}var a=new Date(o.date),l=e(function(){var e=Math.floor((a.getTime()-(new Date).getTime())/1e3);$(n).text(i(e))},1e3)}}}])}(),function(){"use strict";angular.module("SMART2").directive("smartDocSlider",["$parse","$focusOnField",function(e,t){return{restrict:"E",replace:!0,scope:!0,link:function(n,o,i){var a=e(i.onHide);n.commonSelectedOptionInside={title:""},i.$observe("slideObj",function(e){if(i.slideObj){var t=JSON.parse(i.slideObj);n.src=t.src,n.list=t.list,n.index=t.index,n.commonSelectedOptionInside.title=n.list[n.index],n.updateTheIndexInController=function(e){n.index=n.list.indexOf(e),n.nextIndex=angular.copy(n.index)+1,n.prevIndex=angular.copy(n.index)-1;var t=n.list.length;0==n.index?n.prevIndex=t-1:n.index==t-1&&(n.nextIndex=0)},n.nextIndex=angular.copy(n.index),n.prevIndex=angular.copy(n.index);var o=n.list.length;0==n.index?(n.nextIndex++,n.prevIndex=o-1):n.index==o-1?(n.nextIndex=0,n.prevIndex--):n.index<o-1&&(n.nextIndex++,n.prevIndex--)}}),n.tabbingFocus=!1,n.$watch(i.ngShow,function(e){e?(angular.element("body").css("overflow","hidden"),angular.element(document.activeElement).addClass("sliderDocTrigger"),setTimeout(function(){l()},500)):(angular.element("body").css("overflow",""),angular.element(".sliderDocTrigger").focus().removeClass("sliderDocTrigger"),n.tabbingFocus=!1)}),n.next=function(){n.tabbingFocus=!1;var e=n.list.length,t=angular.element(".slide-view-modal");t.css("left","-50%"),n.index<e-1?n.index++:n.index==e-1&&(n.index=0),0==n.index?(n.nextIndex=angular.copy(n.index)+1,n.prevIndex=e-1):n.index==e-1?(n.nextIndex=0,n.prevIndex=angular.copy(n.index)-1):n.index<e-1&&(n.nextIndex=angular.copy(n.index)+1,n.prevIndex=angular.copy(n.index)-1),setTimeout(function(){t.css("transition","none"),t.css("display","none"),t.css("left","150%"),t.css("display","block")},350),setTimeout(function(){t.css("transition","0.5s ease-in-out"),t.css("left","50%"),l()},370),n.commonSelectedOptionInside.title=n.list[n.index]},n.prev=function(){n.tabbingFocus=!1;var e=n.list.length,t=angular.element(".slide-view-modal");t.css("left","150%"),n.index>0?n.index--:0==n.index&&(n.index=e-1),0==n.index?(n.prevIndex=angular.copy(n.index)+1,n.prevIndex=e-1):n.index==e-1?(n.prevIndex=0,n.prevIndex=angular.copy(n.index)-1):n.index<e-1&&(n.nextIndex=angular.copy(n.index)+1,n.prevIndex=angular.copy(n.index)-1),setTimeout(function(){t.css("transition","none"),t.css("display","none"),t.css("left","-50%"),t.css("display","block")},350),setTimeout(function(){t.css("transition","0.7s ease-in-out"),t.css("left","50%"),l()},370),n.commonSelectedOptionInside.title=n.list[n.index]},n.close=function(){angular.isFunction(a)&&a(n,{e:""}),n.tabbingFocus=!1};var l=function(){n.tabbingFocus=!0;var e=angular.element(".docSlider-content").find("a, input, button, textarea").first();t(e)};n.funcOnKeyDown=function(e){27==e.keyCode?n.close():37==e.keyCode?n.prev():39==e.keyCode&&n.next()}},templateUrl:"shared/directives/smartDocSlider/smartDocSlider.html"}}])}(),function(){"use strict";angular.module("SMART2").factory("httpLoaderInterceptor",["$rootScope","$timeout",function(e,t){function n(e){return i++,e}function o(e){return i?(i--,e):void 0}e.$on("$stateChangeStart",function(t,n,o,i,a){e.pageLoaderFlagController=!0}),e.$on("$stateChangeSuccess",function(t,n,o,i,a){e.pageLoaderFlagController=!1});var i=0;return{request:n,requestError:o,response:o,responseError:o}}]),angular.module("SMART2").config(["$httpProvider",function(e){e.interceptors.push("httpLoaderInterceptor")}]),angular.module("SMART2").directive("smartGlobalLoader",["$timeout","$translate",function(e,t){return{restrict:"AE",replace:!0,scope:{isFixed:"=?",config:"=?",onCancel:"&"},link:function(n,o,i){var a=t.instant("loadingMsg");n.conf=angular.extend({message:a,center:!1,plain:!1,bgwhite:!1,top:void 0,left:void 0},n.config),n.messageArray=n.conf.message.split("\n"),e(function(){var e=angular.element(o[0].querySelector(".relative-loader-container")).width(),t=angular.element(o[0].querySelector(".relative-loader-container")).height();n.leftTopCount={left:void 0==n.conf.left||null==n.conf.left||""==n.conf.left?"calc(50% - "+e/2+"px)":n.conf.left+"px",top:void 0==n.conf.top||null==n.conf.top||""==n.conf.top?"calc(50% - "+t/2+"px)":n.conf.top+"px"}}),angular.isDefined(i.onCancel)&&(n.cancelBtn={title:t.instant("cancelBtn")
},n.conf.isCancel=!0),n.cancelCallback=function(e){n.onCancel({$event:e})}},templateUrl:"shared/directives/smartGlobalLoader/smartGlobalLoader.html"}}])}(),angular.module("SMART2").directive("smartHeight",["$timeout",smartHeightFun]),function(e){"use strict";var t=0;e.module("smartHierarchyComponent",[]).directive("smartHierarchyComponent",["$timeout","RESTApi","$q","$rootScope","APPCONSTANTS","$translate",function(n,o,i,a,l,r){return{restrict:"E",replace:!0,scope:{config:"=",callback:"&"},link:function(a,s,c){function d(e){switch(e){case"PAS":re="PASCodes",se="PASList",ce="PASDetails",de="PAS_SearchList",a.codeProperty="ID",a.titleProperty="Name",a.levelProperty="Level",a.parentProperty="ParentID",ue="SelectedPasCodeList";break;case"REG":re="RegionId",ce="RegionDetails",se="RegionList",de="Region_SearchList",a.codeProperty="ID",a.titleProperty="Name",a.levelProperty="Level",a.parentProperty="ParentID",ue="SelectedRegionList";break;case"ORG":re="EntityDetailCode",ce="EntityDetails",se="Org_DetailsList",de="Org_SearchList",a.codeProperty="EntityDetailCode",a.titleProperty="EntityDisplayName",a.levelProperty="Level",a.parentProperty="ParentEntityDetailCode",ue="SelectedORGList"}}function u(e){xe={},a.categories=[],we=[],a.isLoading=!0,a.isError=!1,a.selectedData=[],a.getUserSelectionArray=[],a.totalSelection=0,Ie=[],Oe=[],e&&m(!0,!0)}function p(){pe(),a.isError=!1,a.noRecordsFound=!1,a.selectionAndCountOptions=!1,a.isPartiallySelected=!1,a.treeConfig.isReadOnly=function(){var e,t;return e=0==a.selectedData.length||null===a.config.selectedNodes?!1:a.config.isReadOnly,a.treeConfig.selectAllToggle||(t=a.treeConfig.requestParameter.requestObject&&a.treeConfig.requestParameter.requestObject.selectedNodes&&a.treeConfig.requestParameter.requestObject.selectedNodes.length,e=t?!0:!1),e}(),De=!0,u(!0),o.getData(ne,function(e){var t=e.data,n=t.data;De=!1,"success"==e.action&&t&&404!=t.status?(a.noRecordsFound=!n[se]||n[se].length<=0,a.noRecordsFound?a.isLoading=!1:(ve?b(n):v(_.sortBy(n[se],"Level")),n[ue]&&n[ue].length>0&&(a.treeConfig.isReadOnly="undefined"!=typeof a.config.isShowSelected?a.config.isShowSelected:!0),g(),f(n[ue]),oe.resolve(),a.treeType==Fe||(a.totalSelection=a.selectedData.length))):(a.isLoading&&(a.isLoading=!1),a.categories.length||(a.isError=!0))},ve?{LevelAt:"1",PageNumber:1,PageSize:be}:{},!1,a.treeType)}function f(e){e&&e.length>0&&(a.selectedData=W(e),a.treeConfig.isReadOnly="undefined"!=typeof a.config.isShowSelected?a.config.isShowSelected:!0)}function g(){void 0!=xe[Se+"1"]&&(a.categories=a.treeConfig.isReadOnly?xe[Se+"1"]:xe[Se+"1"].slice(0,be),a.treeConfig.isReadOnly||a.categories.length%be!=0||we.push(a.categories[a.categories.length-1]),a.isLoading=!1,a.categories.length>0&&(a.selectionAndCountOptions=!0)),a.config.levelWiseData=xe}function m(e,t){oe=null,ie=null,me.length=0,e&&(oe=i.defer(),me.push(oe.promise)),t&&(ie=i.defer(),me.push(ie.promise)),i.all(me).then(h)}function h(){x(),m(!1,!0)}function v(e){if(e.length>0){var t=1,n=e[t-1][ce];for(y(n);n;){var o=xe[Se+t];if(xe[Se+t]=o?_.map(_.groupBy(_.union(o,n),function(e){return e[a.codeProperty]}),function(e){return e[0]}):n,e[t]&&y(n,t,e),Ce=t,t+=1,"undefined"!=typeof a.treeConfig.to)if(t>a.treeConfig.to){for(var i=n.length,l=0;i>l;l++)n[l].ChildCount=0;n=null}else n=e[t-1]?e[t-1][ce]:null;else n=e[t-1]?e[t-1][ce]:null}}}function y(e,t,n){var o=t?_.groupBy(n[t][ce],a.parentProperty):null;_.each(e,function(t){var n=o?o[t[a.codeProperty]]:e;n&&_.each(n,function(e,n){e[Te]=t[Te]?t[Te]+" > "+e[a.titleProperty]:e[a.levelProperty]>1?t[a.titleProperty]+" > "+e[a.titleProperty]:"",e[$e]=t[$e]?t[$e]+">"+e[a.codeProperty]:e[a.levelProperty]>1?t[a.codeProperty]+">"+e[a.codeProperty]:"",e.isExpanded=!1;var o=e.selection,i=e.IsSelected;if(e.selection=e&&o&&("1"==o||"0"==o)?o:0==i||null==i||i?w(i):"0",e.index=n,"1"==o){var n=Ie.indexOf(e[a.codeProperty]);n>-1||(Ie.push(e[a.codeProperty]),Oe.push(e[a.titleProperty]),a.totalSelection++)}})})}function b(e,t){_.each(e[se],function(e){_.each(e[ce],function(e){e.selection=t&&t.selection&&("1"==t.selection||"0"==t.selection)?t.selection:0==e.IsSelected||null==e.IsSelected||e.IsSelected?w(e.IsSelected):"0",e[$e]=t&&t[$e]?t[$e]+">"+e[a.codeProperty]:e[a.levelProperty]>1?t[a.codeProperty]+">"+e[a.codeProperty]:"",e[Te]=t&&t[Te]?t[Te]+" > "+e[a.titleProperty]:e[a.levelProperty]>1?t[a.titleProperty]+" > "+e[a.titleProperty]:"",Me[e[a.codeProperty]]&&(e.selection=N(e),a.expandNode(e),delete Me[e[a.codeProperty]])}),xe[Se+e.Level]=_.isArray(xe[Se+e.Level])?xe[Se+e.Level].concat(e[ce]):e[ce]})}function C(e,t){_.each(e[se],function(e){_.each(e[ce],function(e){if(a.treeType==Fe){var n=t.selection,o=e.IsSelected;e.selection=t&&n&&("1"==n||"0"==n)?t.selection:0==o||null==o||o?w(o):"0"}else e.selection="0";a.treeType==Fe&&ve&&(Ie.push(e[a.codeProperty]),Oe.push(e[a.titleProperty]),a.totalSelection++),e[$e]=t&&t[$e]?t[$e]+">"+e[a.codeProperty]:e[a.levelProperty]>1?t[a.codeProperty]+">"+e[a.codeProperty]:"",e[Te]=t&&t[Te]?t[Te]+" > "+e[a.titleProperty]:e[a.levelProperty]>1?t[a.titleProperty]+" > "+e[a.titleProperty]:"",Me[e[a.codeProperty]]&&(e.selection=N(e),a.expandNode(e),delete Me[e[a.codeProperty]])}),xe[Se+e.Level]=_.isArray(xe[Se+e.Level])?xe[Se+e.Level].concat(e[ce]):e[ce]})}function w(e){return e?"1":0==e?"2":null==e?"0":void 0}function S(){_.each(a.selectedData,function(e){a.selectNode(e,"0")})}function x(){S(),_.each(le,function(e){for(var t=1;Ce>=t;){var n=_.groupBy(xe[Se+t],a.codeProperty)[e];if(n){a.selectNode(n[0],"1");break}t+=1}})}function T(e,t,n,i,l){a.isLoading=!0,a.isError&&(a.isError=!1),e&&(e.childLoading=!0);var r={LevelAt:t,PageNumber:e?null:i,PageSize:e?null:n};r[re]=e?e[a.codeProperty]:null,o.getData(ne,function(t){"success"==t.action?a.isLoading=!1:(a.isError=!0,a.noRecordsFound=!0);var o=t.data.data[se]&&t.data.data[se].length>0?t.data.data[se][0].Level:null;Ce=o&&o>Ce?o:Ce,l(e,t,!0,n,i)},r,!1,a.treeType)}function D(e,t,n){var o=e?e[a.levelProperty]+1:1,i=e?_.groupBy(xe[Se+o],a.parentProperty)[e[a.codeProperty]]:xe[Se+o];if(a.treeConfig.isReadOnly)return i=i?i:[],{data:i,searchLevel:o};var l=(n-1)*t,r=t&&i?i.slice(l,l+t):i?i:[];return{data:r,searchLevel:o}}function k(e,t,n,o){void 0!=e&&void 0!=e.ChildCount&&e.ChildCount>0&&(t=e.ChildCount);var i=D(e,t,n),a=i.data,l=i.searchLevel;a.length>0?o(e,a,!1,t,n):T(e,l,t,n,o)}function M(e){var t=e[a.levelProperty]-1,n=e[a.parentProperty],o=_.find(xe[Se+t],function(e){return e[a.codeProperty]==n});o&&o.children&&o.children.length%be!=0||k(o,be,o?o.children.length/be+1:a.categories.length/be+1,Le)}function F(e,t,o){o||Pe!=e&&(Pe=e,Ee=Ce,Re.length=0,Ae.length=0,a.searchResults.length=0);var i=E(e,t);o||0!=i.length||0!==a.searchResults.length?a.noRecordsFound=!1:a.noRecordsFound=!0;var l=n(function(){a.searchResults=a.searchResults.concat(i),a.searchResults.length>0?a.noRecordsFound=!1:a.noRecordsFound=!0,n.cancel(l),l=null})}function I(e){var t=_.partition(Re,function(t,n){return n>e-1});return Re=t[0],t[1]}function O(e){var t=_.partition(Ae,function(t,n){return n>e-1});return Ae=t[0],t[1]}function E(e,t){for(var n=[];n.length<t&&Ee>0;){var o=I(t);if(o.length==t){n=o;break}var i=_.filter(xe[Se+Ee],function(e){return-1!=e[a.titleProperty].toLowerCase().indexOf(Pe.toLowerCase())}),l=_.filter(xe[Se+Ee],function(e){return new RegExp("("+_.compact(Pe.split(" ")).join("|")+")","gi").test(e[a.titleProperty])&&-1==e[a.titleProperty].toLowerCase().indexOf(Pe.toLowerCase())});Ae=Ae.concat(l);var r=o.concat(i),s=_.partition(r,function(e,n){return n>t-1});Re=Re.concat(s[0]),n=n.concat(s[1]),Ee-=1}if(0==Ee)for(;n.length<t;){var c=O(t);if(!(c.length>0))break;n=n.concat(c)}return n}function P(e){k(e,null,null,function(e,t){var n=_.filter(t,function(e){return e.isExpanded});_.each(n,function(e){e.isExpanded=!1,e.children=[],P(e)})})}function R(e){var t=_.filter(we,function(t,n){return-1!=t[$e].indexOf(e[a.codeProperty])});we=_.difference(we,t),P(e)}function A(e,t){switch(t){case"0":a.selectedData=_.filter(a.selectedData,function(t){return t[a.codeProperty]!=e[a.codeProperty]}),a.totalSelection=a.totalSelection-1;var n=Ie.indexOf(e[a.codeProperty]);n>-1&&(Ie.splice(n,1),Oe.splice(n,1));break;case"1":a.selectedData.push(e),a.totalSelection=a.totalSelection+1,Ie.push(e[a.codeProperty]),Oe.push(e[a.titleProperty])}}function L(e,t){switch(t){case"0":a.getUserSelectionArray=_.filter(a.getUserSelectionArray,function(t){return t[a.codeProperty]!=e[a.codeProperty]});break;case"1":a.getUserSelectionArray.push(e)}}function V(e,t,n){for(var o=e[a.levelProperty]-1,i=e[a.parentProperty].toString();o>0;){var l=_.find(xe[Se+o],function(e){return e[a.codeProperty]==i});if(l||1!=o||(Me[e[$e].split(">")[0]]=!0,l={},l[a.codeProperty]=e[$e].split(">")[0],l[a.levelProperty]=1,l[a.parentProperty]=l[a.codeProperty]),l&&!l.disabled)i=l[a.parentProperty].toString(),l.isExpanded||a.expandNode(l),l.selection=N(l,l.selection);else{i=l[a.parentProperty].toString(),l.isExpanded||a.expandNode(l);N(l,l.selection);l.selection="2"}o-=1,i=l[a.parentProperty].toString()}}function N(e,t){var n=e[a.levelProperty]+1,o=e[a.codeProperty],i=_.groupBy(xe[Se+n],a.parentProperty),l=i[o].length,r=_.filter(i[o],function(e){return"1"==e.selection}),s=_.filter(i[o],function(e){return"2"==e.selection});if(a.isSingleSelect)return"0";if(a.treeType==Fe){if(l==r.length){a.selectedData=_.filter(a.selectedData,function(e){return e[a.parentProperty]!=o}),a.selectedData.push(e),a.totalSelection=a.totalSelection+1;var c=Ie.indexOf(e[a.codeProperty]);return c>-1||(Ie.push(e[a.codeProperty]),Oe.push(e[a.titleProperty])),"1"}if(r.length+s.length>0){a.selectedData=_.union(a.selectedData,r),a.selectedData=_.uniq(a.selectedData,function(e,t,n){return e[a.codeProperty]}),a.selectedData=_.filter(a.selectedData,function(t){return t[a.codeProperty]!=e[a.codeProperty]}),"0"!=t&&"2"!=t&&(a.totalSelection=a.totalSelection-1);var c=Ie.indexOf(e[a.codeProperty]);return c>-1&&(Ie.splice(c,1),Oe.splice(c,1)),"2"}a.selectedData=_.union(a.selectedData,r),a.selectedData=_.filter(a.selectedData,function(t){return t[a.codeProperty]!=e[a.codeProperty]});var c=Ie.indexOf(e[a.codeProperty]);return c>-1&&(Ie.splice(c,1),Oe.splice(c,1),a.totalSelection=a.totalSelection-1),"0"}return l==r.length?(a.selectedData=_.union(a.selectedData,r),"2"):r.length+s.length>0?(a.selectedData=_.union(a.selectedData,r),a.selectedData=_.uniq(a.selectedData,function(e,t,n){return e[a.codeProperty]}),a.selectedData=_.filter(a.selectedData,function(t){return t[a.codeProperty]!=e[a.codeProperty]}),"2"):(a.selectedData=_.union(a.selectedData,r),a.selectedData=_.filter(a.selectedData,function(t){return t[a.codeProperty]!=e[a.codeProperty]}),"0")}function H(e,t){for(var n=e[a.levelProperty]+1,o=e[a.codeProperty].toString();Ce>=n;){var i=_.filter(xe[Se+n],function(e){var t=e[$e].split(">");return-1!=t.indexOf(o)});_.each(i,function(e){if(a.treeType==Fe){var n=e[a.codeProperty];if("1"==t){a.totalSelection="1"==e.selection?a.totalSelection:a.totalSelection+1,a.selectedData=_.filter(a.selectedData,function(e){return e[a.codeProperty]!=n});var o=Ie.indexOf(n);o>-1||(Ie.push(n),Oe.push(n))}else{a.totalSelection=a.totalSelection-1;var o=Ie.indexOf(n);o>-1&&(Ie.splice(o,1),Oe.splice(o,1))}"1"==t&&a.isSingleSelect||(e.selection=t),a.getUserSelectionArray=_.filter(a.getUserSelectionArray,function(t){return t[a.codeProperty]!=e[a.codeProperty]})}else e.selection="0",a.selectedData=_.filter(a.selectedData,function(t){return t[a.codeProperty]!=e[a.codeProperty]})}),n+=1}K(e)}function K(e){var t=[];_.each(a.selectedData,function(n){-1!=n[$e].indexOf(e[a.codeProperty].toString())&&t.push(n)}),_.each(t,function(e){a.selectedData=_.filter(a.selectedData,function(t){return t[a.codeProperty]!=e[a.codeProperty]})})}function U(e,t,n,i){n!=ze&&(ze=n,Ge=0,a.searchResults.length=0),a.isLoading=!0,a.isError&&(a.isError=!1),a.searchResults.length>0&&(He=a.searchResults[a.searchResults.length-1],He.lazyLoading=!0),Ke&&!i&&o.abort(Ke),Ke={PageNumber:Ge+=1,PageSize:e,SearchText:a.searchFieldVal},o.getData(ne,function(e){Ke=null,"success"==e.action?a.isLoading=!1:(a.isError=!0,a.noRecordsFound=!0),t(e)},Ke,!1,a.treeType)}function B(e){He&&(He.lazyLoading=!1),a.searchResults=a.searchResults.concat(W(e.data.data[de]))}function W(e){var t=e,n=[];_.groupBy(a.selectedData,a.codeProperty);return _.each(t,function(e){var t=e[ce],o=_.sortBy(t,"Level"),i=o[o.length-1],l="",r="";_.each(o,function(e){l=l.length>0?l+" > "+e[a.titleProperty]:e[a.titleProperty],r=r.length>0?r+">"+e[a.codeProperty].toString():e[a.codeProperty].toString(),e[Te]=l,e[$e]=r,e.selection=G(e)}),n.push(i)}),n}function j(e){_.each(a.searchResults,function(t){e[a.codeProperty]!=t[a.codeProperty]&&-1!=t[$e].indexOf(e[$e].length>0?e[$e]:e[a.codeProperty].toString())?t.selection=e.selection:t.selection=G(t)})}function G(e){var t=e[a.levelProperty],n=_.groupBy(xe[Se+t],a.codeProperty),o=n[e[a.codeProperty]]?n[e[a.codeProperty]][0].selection:z(e)?"1":0==e.IsSelected||null==e.IsSelected||e.IsSelected?w(e.IsSelected):"0";return o}function z(e){for(var t=!1,n=a.selectedData.length,o=0;n>o;o++){var i=a.selectedData[o];if(-1!=e[$e].indexOf(i[$e].length>0?i[$e]:i[a.codeProperty].toString())){t=!0;break}}return t}function q(e){var t=e[$e].split(">");e.Level;if(xe[Se+e[a.levelProperty]]&&_.find(xe[Se+e[a.levelProperty]],function(t){return e[a.codeProperty]==t[a.codeProperty]}))Y(e);else{var n={};n[re]=[parseInt(t[t.length-1])],o.getData(ne,function(t){if("success"==t.action){for(var n=t.data.data.PAS_SearchList[0][ce],o=_.groupBy(n,"Level"),i=1,a=[];i;){var l={};if(l[ce]=o[i],l.Level=i,a.push(l),i+=1,!o[i])break}v(a),Y(e)}else console.log("error")},n,!0,a.treeType)}}function Y(e){a.selectNode(_.find(xe[Se+e.Level],function(t){return t[a.codeProperty]==e[a.codeProperty]}),"1"==e.selection?"0":"1",!0),j(e)}function J(e){"inline"==a.config.useAs&&(!a.config._export&&(a.config._export={}),void 0!==e&&(a.config._export[e]="function"==typeof a[e]?function(){a[e]()}:function(){return a[e]}))}a.hierarchyCounter=t++,a.treeConfig=a.config,a.searchFieldVal="",a.cancelTitle=""==a.searchFieldVal?r.instant("closeSearch"):r.instant("clearSearch"),a.checkCondForTemplate=function(e){var t=!1;return a.searchFieldVal.length<=2&&!a.treeConfig.isReadOnly?t=!0:a.searchFieldVal.length<=2&&a.treeConfig.isReadOnly&&"0"!=e.selection&&!a.treeConfig.selectAllToggle?t=!0:a.searchFieldVal.length<=2&&a.treeConfig.isReadOnly&&a.treeConfig.selectAllToggle&&(t=!0),t},a.templateCheck2=function(e){var t=!1;return a.treeConfig.isReadOnly&&"0"!=e.selection?t=!0:a.treeConfig.isReadOnly||(t=!0),t},a.secondaryLinkCallback=function(){a.treeConfig.secondaryLink.callback()},a.treeConfig.isSelectedOnly=!1,a.noRecordsFound=!1,a.treeConfig.hasOwnProperty("modalButtonShow")||(a.treeConfig.modalButtonShow=!1),a.treeConfig.hasOwnProperty("isMandatory")||(a.treeConfig.isMandatory=!0),a.treeConfig.hasOwnProperty("listIcon")||(a.treeConfig.listIcon=null),a.treeConfig.hasOwnProperty("selectAllToggle")||(a.treeConfig.selectAllToggle=!1);var Q=a.$eval(a.callback);a.config.refreshConfig=function(e){a.treeConfig=e,Z(a.treeConfig)};var Z=function(e){a.treeConfig.isRadio&&(a.uniqueRadioGroupName=Ne()),a.treeConfig.clearCache&&(u(),a.isLoading=!1,a.treeConfig.clearCache=!1),me=[],ne=a.treeConfig.navigationContext,ve=1==a.treeConfig.isLazyLoad||0==a.treeConfig.isLazyLoad?a.treeConfig.isLazyLoad:!1,ye=50,be=50,Ce=1,we=[],Se="level",Te="parentString",$e="parentCodeString",De=!1,ke=[],Me=[],he=!1,a.getUserSelectionArray=[],a.selectionAndCountOptions=!1,a.treeType=a.treeConfig.treeType,a.isReadOnly=a.treeConfig.isReadOnly,a.isDisabled=a.treeConfig.isDisabled,a.isSingleSelect=a.treeConfig.isRadio?a.treeConfig.isRadio:!1,a.showSelectAll=a.treeConfig.showSelectAll,a.showClearSelection=a.treeConfig.showClearSelection,a.showSelectionCount=a.treeConfig.showSelectionCount,a.enableLastLevelSelection=a.treeConfig.enableLastLevelSelection},X=a.$watch("config.getSelections",function(e,t){e&&(je(),a.config.getSelections=!1)}),ee=a.$watch("config.requestParameter.contactCode",function(e,t){e!=t&&(o.setContactCode(e),p())}),te=a.$watch("config.requestParameter",function(e,t){e&&(a.treeConfig.requestParameter=e,o.setDocumentId(e.documentCode),o.setContactCode(e.contactCode),o.setUserContext(e.userExecutionContext),o.setEnvironment(l.userPreferences.URLs.AppURL),o.setRequestObject(e.requestObject),d(e.navigationContext),ne=e.navigationContext,e.hasOwnProperty("url")&&o.setUrl(e.url),p())});a.selectOptions=[{code:1,name:"Select All"},{code:0,name:"Single Select"}],a.selectType={code:0,name:"Single Select"};var ne,oe,ie,ae,le,re,se,ce,de,ue,pe=function(){a.onSelectTypeChange=function(e){a.selectType=e,1==e.code&&a.clearAllSelection()},1===a.treeConfig.selectType?(a.clearAllSelection(),a.selectType={code:1,name:"Select All"}):a.selectType={code:0,name:"Single Select"}},fe=a.$watch("config.data",function(e,t){e&&(pe(),a.config.selectedNodes&&a.selectedData.length>0?a.config.isReadOnly="undefined"!=typeof a.config.isShowSelected?a.config.isShowSelected:!a.treeConfig.isRadio:a.config.selectedNodes&&a.config.selectedNodes||(a.config.isReadOnly=!1),d(a.treeConfig.navigationContext),ne=a.treeConfig.navigationContext,u(!0),v(_.sortBy(e[se],"Level")),oe.resolve(),g()),a.config.data=null}),ge=a.$watch("config.selectedNodes",function(e,t){e&&(le=e.split(","),le&&0==le.length&&(a.treeConfig.isReadOnly=!1),ie&&ie.resolve()),a.config.selectedNodes=null}),me=[],he=!1,ve=1==a.treeConfig.isLazyLoad||0==a.treeConfig.isLazyLoad?a.treeConfig.isLazyLoad:!1,ye=50,be=50,Ce=1,we=[],Se="level",xe={},Te="parentString",$e="parentCodeString",De=!1,ke=[],Me=[],Fe="Generic";a.codeProperty="ID",a.titleProperty="Name",a.levelProperty="Level",a.parentProperty="ParentID",a.getUserSelectionArray=[],a.treeType="Generic",a.totalSelection=0,a.isReadOnly=!1,a.isDisabled=!1,a.showSelectAll=!1,a.showClearSelection=!1,a.showSelectionCount=!1,a.enableLastLevelSelection=!1,a.isReadOnly=a.treeConfig.isReadOnly,a.isDisabled=a.treeConfig.isDisabled,a.isSingleSelect=a.treeConfig.isRadio,a.showSelectAll=a.treeConfig.showSelectAll,a.showClearSelection=a.treeConfig.showClearSelection,a.showSelectionCount=a.treeConfig.showSelectionCount,a.enableLastLevelSelection=a.treeConfig.enableLastLevelSelection,a.selectionAndCountOptions=!1,a.closeButton={title:r.instant("closeBtn")},a.cancelButton={title:r.instant("cancelBtn")},a.doneButton={title:r.instant("doneBtn")},a.resetButton={title:r.instant("resetButton")},a.editButton={title:r.instant("editButton")},a.isPartiallySelected=!1;var Ie=[],Oe=[];a.selectedData=[],a.getSelectAllBool=function(){if(a.categories&&a.categories.length>0){var e=_.filter(a.categories,function(e){return"1"==e.selection||1==e.disabled});he=a.categories.length>0&&e.length==a.categories.length?!0:!1}else he=!1;return he},a.doneClickHandler=function(){a.treeConfig.getSelections=!0;var e=n(function(){a.treeConfig.isReadOnly=!1,n.cancel(e),e=null},10)};var Ee,Pe="",Re=[],Ae=[];a.searchResults=[],a.searchText="",a.searchFieldVal="",a.expandNode=function(e,t){e.isExpanded=!e.isExpanded,e.isExpanded?k(e,be,1,Le):(e.children=[],R(e))};var Le=function(e,t,o,i,l){if(o)e&&(e.childLoading=!1,e.lazyLoading=!1),"success"==t.action?(C(t.data.data,e),e&&t.data.data[se][0]?(e.children?e.children=e.children.concat(D(e,i,l).data):e.children=D(e,i,l).data,e.children.length%be==0&&we.push(e.children[e.children.length-1])):(a.categories[a.categories.length-1].lazyLoading=!1,a.categories=a.categories.concat(t.data.data[se][0][ce]),a.categories.length%be==0&&we.push(a.categories[a.categories.length-1]))):console.log("service failure");else var r=n(function(){e?(e&&e.children&&e.children.length>0&&(e.children[e.children.length-1].lazyLoading=!1),e.children=e.children?a.treeConfig.getAllLazyLoadedData?t:e.children.concat(t):t,a.treeConfig.isReadOnly||e.children.length%be!=0||we.push(e.children[e.children.length-1])):(a.categories[a.categories.length-1].lazyLoading=!1,a.categories=a.categories.concat(t),a.treeConfig.isReadOnly||a.categories.length%be!=0||we.push(a.categories[a.categories.length-1])),n.cancel(r),r=null})};a.searchAndSelectNode=function(e){var t=n(function(){a.noRecordsFound=!1,a.searchFieldVal.length<=2?(ze="",Re.length=0,Ae.length=0):a.searchFieldVal.length>=3&&(ve?U(ye,B,a.searchFieldVal):F(a.searchFieldVal,ye,!1)),n.cancel(t),t=null,a.cancelTitle=""==e.target.value?r.instant("closeSearch"):r.instant("clearSearch")},500)},a.selectAll=function(){if(a.isPartiallySelected=!1,he){for(var e in xe)_.each(xe[e],function(t,n){t.selection="0",a.selectedData=e==Se+"1"?[]:[]});a.getUserSelectionArray=[],a.totalSelection=0,Ie=[],Oe=[]}else for(var e in xe)_.each(xe[e],function(t,n){1!=t.disabled&&(t.selection="1"),a.selectedData=e==Se+"1"?xe[Se+"1"]:a.selectedData;var o=Ie.indexOf(t[a.codeProperty]);o>-1||(Ie.push(t[a.codeProperty]),Oe.push(t[a.titleProperty]),a.totalSelection++)})},a.clearAllSelection=function(){for(var e in xe)_.each(xe[e],function(e,t){e.selection="0"});a.selectedData=[],a.getUserSelectionArray=[],a.totalSelection=0,Ie=[],Oe=[],a.isPartiallySelected=!1},a.selectNode=function(e,t,n,o,i){if(ve&&a.searchFieldVal.length>0&&!n)return q(e),void("inline"==a.config.useAs&&je());if(a.isSingleSelect){if(a.selectedData.length>0&&a.selectedData[0][a.codeProperty]==e[a.codeProperty])return void("inline"==a.config.useAs&&je());a.selectedData.length>0&&a.selectedData[0][a.codeProperty]!=e[a.codeProperty]&&a.clearAllSelection(),e.selection=t,a.selectedData=[e],a.totalSelection=a.selectedData.length}else e.selection=t,A(e,t),H(e,t);V(e,t,o),L(e,t),a.treeType==Fe||(a.totalSelection=a.selectedData.length),"inline"==a.config.useAs&&je(),0==a.totalSelection?a.isPartiallySelected=!1:a.isPartiallySelected=!a.getSelectAllBool()};var Ve,Ne=function(){var e=(new Date).getTime(),t="xxx2xxxpxxxoxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t};a.scroll=function(){Ve&&(n.cancel(Ve),Ve=null),Ve=n(function(){if(!ae){var t=e.element("#treeComponentContainer");t.position(),$(window).width();ae=$(window).height()}var n=we.length;if(n>0&&0==a.searchFieldVal.length){var o=we[n-1],i=e.element("#"+o[a.codeProperty]);i.length>0&&i[0].getBoundingClientRect().top<=ae&&(o.lazyLoading=!0,we.length=n>0?n-1:0,M(o))}},20)};var _e;a.scrollEnd=function(){_e&&(n.cancel(_e),_e=null),_e=n(function(){a.searchFieldVal.length>2&&(ve?U(ye,B,a.searchFieldVal,!0):F(a.searchFieldVal,ye,!0))},20)};var He,Ke,Ue=function(e){return _.each(e,function(e){e.children&&delete e.children}),e},Be=[],We=[],je=function(){_.each(a.selectedData,function(e){e.disabled&&(a.selectedData=_.without(a.selectedData,e))}),Be=[],We=[];var e=n(function(){a.treeConfig.selectType=a.selectType.code;var t={selectType:a.selectType.code,selections:Ue(a.selectedData)};_.each(t.selections,function(e){Be.push(e[a.codeProperty]),We.push(e[a.titleProperty])}),t.selectionIds=Be,t.selectionNames=We,a.treeType==Fe&&(t.selectionAllIds=Ie,t.selectionAllNames=Oe);var o=[];_.each(a.selectedData,function(e){if(e[a.levelProperty]>1){var t=e[$e].split(">"),n=[];_.each(t,function(e,t){var o=_.clone(_.find(xe[Se+(t+1)],function(t){return t[a.codeProperty]==e}));o&&o.children&&delete o.children,n.push(o)}),o.push(n)}else o.push([e])}),a.treeConfig.getHierarchyOnSelection&&a.treeType==Fe&&(t.selectionHierarchy=Ue(o)),a.treeConfig.getUserSelection&&a.treeType==Fe&&(t.userSelection=Ue(a.getUserSelectionArray)),a.treeConfig.getAllLazyLoadedData&&(t.allLazyLoadedData=xe),a.isActive&&(a.searchFieldVal="",a.hideSearch()),Q(t),n.cancel(e),e=null})},Ge=0,ze="";if(a.focusSearch=!1,a.isActive=!1,a.showMe=!1,a.showSearch=function(){a.isActive=!0,a.showMe=!0,a.hideClose=!0,n(function(){a.focusSearch=!0},100)},a.hideSearch=function(){""!=a.searchFieldVal?(a.searchFieldVal="",a.noRecordsFound=!1):(a.searchFieldVal="",a.isActive=!1,a.focusSearch=!1,a.hideClose=!1,a.noRecordsFound=!1,$("#SearchBtn").focus()),a.cancelTitle=""==a.searchFieldVal?r.instant("closeSearch"):r.instant("clearSearch")},a.editCallback=function(){a.treeConfig.isReadOnly=!1,a.categories=[],we=[],a.isLoading=!0,a.isError=!1,Ie=[],Oe=[],m(!0,!0),g()},"inline"==a.config.useAs&&a.config["export"])for(var qe=a.config["export"].length,Ye=0;qe>Ye;Ye++)J(a.config["export"][Ye]);a.$on("$destroy",function(){X(),te(),ee(),fe(),ge()})},templateUrl:"shared/directives/smartHierarchy/smartHierarchyTemplate.html"}}]).directive("myTemplate",function(){return{restrict:"EA",templateUrl:function(e,t){return t.type}}}).directive("ngIndeterminate",["$compile",function(e){return{restrict:"A",link:function(e,t,n){e.$watch(n.ngIndeterminate,function(e){t.prop("indeterminate",e)})}}}]).directive("ngHighlight",["$compile","hilitor",function(e,t){return{restrict:"A",link:function(e,t,n){e.$watch(n.ngHighlight,function(t){new Hilitor("treeComponentContainer-"+e.hierarchyCounter).apply(t)})}}}]).service("RESTApi",["$http","$q","APPCONSTANTS",function(e,t,n){function o(e,o,i,u){var f,g,m,h,v="&c="+n.userPreferences.EncryptedBPC;if(!a)return null;switch(e){case"PAS":f="nonGeneric"==u?"GetContactPASMappingDetilsForProject?oloc=218"+v:"GetContactPASMappingDetails?oloc=218"+v,g="GetPASDetails?oloc=218"+v,m="PASInputParam_Levels",h="GetPASLevelDetailsByPASCodes?oloc=218"+v;break;case"REG":f="nonGeneric"==u?"GetContactRegionMappingDetailsForProject?oloc=218"+v:"GetContactRegionMappingDetails?oloc=218"+v,g="GetRegionDetails?oloc=218"+bpcCodes,m="RegionInputParam_Levels",h="GetREGIONLevelDetailsByRegionIds";break;case"ORG":f="nonGeneric"==u?"GetContactORGMappingDetailsForProject?oloc=218"+v:"GetContactOrgMappingDetails?oloc=218"+v,g="GetORGDetails?oloc=218"+v,m="ORG_InputParams",h="GetOrgEntityLevelDetailsByEntityDetailCodes"}var y=t.defer(),b={url:a,headers:{"Content-Type":"application/json",UserExecutionContext:null},data:{},method:"POST",timeout:y.promise};if(b.data[m]={ContactCode:null,DocumentCode:null},void 0!=e&&"pas"==e.toLowerCase()&&("8"==l||"7"==l||"38"==l)){var C=_.where(n.userPreferences.CommonSettings.lstSettings,{FieldName:"RestrictUserMappedCategorySelection"});void 0!=C&&C.length>0&&"false"==C[0].FieldValue.toLowerCase()&&(c=null)}return 1==i?(b.url=b.url+h,b.data=o):(c?(b.data[m].ContactCode=c,b.url=b.url+f):(b.data[m].ContactCode=null,b.url=b.url+g),b.data[m].DocumentCode=s?s:null),d&&(b.url=d),b.headers.UserExecutionContext=r,b.promise=y,null==p&&null==c?b.data[m]=_.extend(b.data[m],o):b.data[m]=_.extend(_.extend(b.data[m],o),p),b}function i(t){e(t).then(function(e){var n,o=_.find(u,function(e,o){return n=o,_.isEqual(JSON.parse(e.key),t.data)}).callback;u.splice(n,1),o({action:"success",data:e})},function(e){var n,o=_.find(u,function(e,o){return n=o,_.isEqual(JSON.parse(e.key),t.data)}).callback;u.splice(n,1),o({action:"failure",data:e})})}var a,l="";void 0!=n&&(void 0!=n.userPreferences.OrderData&&(l=n.userPreferences.OrderData.type.id),void 0!=n.userPreferences.RequisitionData&&(l=n.userPreferences.RequisitionData.type.id),void 0!=n.userPreferences.ProcurementProfileData&&(l=n.userPreferences.ProcurementProfileData.type.id));var r,s,c,d,u=[],p=null;this.setEnvironment=function(e){a=e+"PortalRestService/"},this.setDocumentId=function(e){s=e},this.setContactCode=function(e){c=e},this.setUserContext=function(e){r=e},this.setRequestObject=function(e){p=e},this.setUrl=function(e){d=e},this.abort=function(e){var t,n=_.find(u,function(n,o){return t=o,_.isEqual(e,n.data)}).promise;n&&(n.resolve(),console.log("canceled - "+e))},this.getData=function(e,t,n,a,l){var r=new o(e,n,a,l);_.isEmpty(r)||(u.push({key:JSON.stringify(r.data),callback:t,promise:r.promise,data:n}),i(r))}}])}(angular),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=function(n){if(n=n||e,!n.document)throw new Error("Hilitor requires a window with a document");return t(n.document)}:"function"==typeof define&&define.amd?define([],function(){return t(document)}):e.Hilitor=t(document)}(this,function(e,t){function n(t,n,o){var i=e.getElementById(t)||e.body,a=n||"EM",l=new RegExp("^(?:SCRIPT|FORM|INPUT|TEXTAREA|IFRAME|VIDEO|AUDIO)$"),r=["#ff6"],s=[],c=0,d="",u=!0,p=!0;o=o||{},"function"!=typeof o.onStart&&(o.onStart=function(){}),"function"!=typeof o.onFinish&&(o.onFinish=function(){return!0}),"function"!=typeof o.onDoOne&&(o.onDoOne=function(e){}),this.setMatchType=function(e){switch(e){case"left":u=!1,p=!0;break;case"right":u=!0,p=!1;break;default:case"open":u=p=!0;break;case"complete":u=p=!1}},this.setRegex=function(e){e=e.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w'\-]+/g,"|");var t="("+e+")";u||(t="\\b"+t),p||(t+="\\b"),d=new RegExp(t,"i")},this.getRegex=function(){var e=d.toString();return e=e.replace(/^\/(\\b)?|(\\b)?\/i$/g,""),e=e.replace(/\|/g," ")},this.hiliteWords=function(t){var n;if(t&&d&&!l.test(t.nodeName)&&(t.nodeName!==a||"hilitor"!==t.className)){if(t.hasChildNodes())for(n=0;n<t.childNodes.length;n++)this.hiliteWords(t.childNodes[n]);if(3===t.nodeType&&(nv=t.nodeValue)&&(regs=d.exec(nv))&&!1!==o.onDoOne.call(this,t)){s[regs[0].toLowerCase()]||(s[regs[0].toLowerCase()]=r[c++%r.length]);var i=e.createElement(a);i.appendChild(e.createTextNode(regs[0])),i.className="hilitor",i.style.backgroundColor=s[regs[0].toLowerCase()],i.style.fontStyle="inherit",i.style.color="#000";var u=t.splitText(regs.index);u.nodeValue=u.nodeValue.substring(regs[0].length),t.parentNode.insertBefore(i,u)}}},this.remove=function(){var t,n;do for(t=e.querySelectorAll(a+".hilitor"),n=0;n<t.length&&(el=t[n]);){var o=el.parentNode;o?(o.replaceChild(el.firstChild,el),o.normalize()):n++}while(t.length>0)},this.apply=function(e){if(this.remove(),!e)return!1;this.setRegex(e);var t=o.onStart.call(this);return t===!1?t:(i.normalize(),this.hiliteWords(i),o.onFinish.call(this))}}return n}),function(e){"use strict";e.module("SMART2").directive("smartLastRepeaterElement",function(){return function(e,t,n){"true"===n.callbackOnItem&&e.$emit("AllRepeaterElement",t,n),e.$last&&e.$emit("LastRepeaterElement",t,n)}})}(angular),function(e){"use strict";e.module("SMART2").directive("smartMaps",["$compile","$sce","$templateRequest","$timeout","$translate",function(t,n,o,i,a){return{restrict:"E",template:'<div><div ng-if="!mapLoaded" class="row"><div class="mapinfocontainer center-align"> <i class="icon grey-text"><svg><use xlink:href="#icon_Info"></use></svg></i> <span class="center-align displayBlock">'+a.instant("couldNotLoadMap")+'</span> <span class="center-align displayBlock">'+a.instant("checkAccessPermission")+'<a href="javascript:void(0)" ng-click="viewSwitcher()">'+a.instant("tableView")+"</a>.</span></div></div></div>",scope:!0,replace:!0,link:function(a,l,r){function s(){var e=$(".gm-style-iw"),t=e.prev(),n=e.parent("div").parent("div").parent("div");n.css({visibility:"hidden"}),e.next().css("display","none"),e.children(":nth-child(1)").css({overflow:"visible"}),t.children(":nth-child(2)").css({display:"none"}),t.children(":nth-child(4)").css({display:"none"}),e.parent().css({width:"360px"}),e.css({"z-index":"-1"}),n.css({visibility:"visible"})}function c(e,t,n){var o=e.countryInfo?e.countryInfo.CountryCode.toString():e.state?e.state.toString():"",i=e.zipcode?e.zipcode.toString():"";T.geocode({componentRestrictions:{country:o,postalCode:i}},function(n,o){if(o==google.maps.GeocoderStatus.OK){g=t>=7?t%7:t;var i=new google.maps.Marker({position:new google.maps.LatLng(n[0].geometry.location.lat(),n[0].geometry.location.lng()),map:y,title:e.state,id:t,icon:a.locations.baseImgUrl+"cmarker"+g+".png"});i.setMap(y),S.push(i),v.addMarkers(S),google.maps.event.addListener(i,"click",function(){var e=this;a.locations.id=e.id,C.open(y,e),s()}),w.extend(new google.maps.LatLng(n[0].geometry.location.lat(),n[0].geometry.location.lng())),y.fitBounds(w)}h=S.length?!1:!0,h!=a.locations.dataGeoData&&a.$apply(function(){a.locations.dataGeoData=h}),h&&a.locations.viewSwitcherFlag.flag&&a.$apply(function(){a.locations.viewSwitcherFlag.flag=!1})})}function d(n,o){a.locationClusterMarker=o.cluster_;
var i='<ul id="dropdown1" class="dropdown-content clusterDomContainer"><li ng-click="clusterListFn(marker)" ng-repeat="marker in locationClusterMarker.markers_"><a href="javascript:void(0)" class="grey-text text-darken-4">{{locations.locData[marker.id].locname}}</a></li></ul>';return i=t(i)(a),e.element(o.div_).hasClass("clusterDomContainer-dropdown-button")||(e.element(o.div_).addClass("clusterDomContainer-dropdown-button").attr({"data-activates":"dropdown1","data-stoppropagation":!0}).append(i),setTimeout(function(){var t=e.element(".clusterDomContainer-dropdown-button");t.dropdown({constrain_width:!1}),t.trigger("click")},10)),!1}var u=a.$eval(r.locations);if(a.locations=a[u[0]][u[1]],a.mapLoaded=!0,"object"!=typeof window.google||"object"!=typeof window.google.maps)return a.mapLoaded=!1,a.viewSwitcher=function(){a.locations.viewSwitcherFlag.flag=!1},!1;var p=new google.maps.LatLng(21,78),f={center:p,maxZoom:14,minZoom:2,streetViewControl:!1,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#6fa4e4","font-weight":"normal"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative.country",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#e6ebf1","font-weight":"normal"},{visibility:"off"}]},{featureType:"administrative.country",elementType:"labels",stylers:[{color:"#6fa4e4","font-weight":"normal"},{visibility:"simplified"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",stylers:[{color:"#6fa4e4","font-weight":"normal"},{visibility:"simplified"}]},{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]},{featureType:"administrative.province",stylers:[{color:"e6ebf1","font-weight":"normal"},{visibility:"simplified"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels",stylers:[{color:"#6fa4e4","font-weight":"normal"},{visibility:"simplified"}]},{featureType:"landscape.man_made",stylers:[{color:"#e6ebf1",visibility:"off"}]},{featureType:"landscape.natural",stylers:[{color:"#e6ebf1"},{visibility:"on"}]},{featureType:"landscape.natural.landcover",stylers:[{color:"#e6ebf1",visibility:"off"}]},{featureType:"landscape.natural.terrain",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"transit.station",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",stylers:[{visibility:"off"}]},{featureType:"transit.station.bus",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{color:"#ffffff"}]}]};l.height(480);var g,m,h,v,y=new google.maps.Map(document.getElementById(r.id),f),b={gridSize:50,maxZoom:14,imagePath:a.locations.baseImgUrl+"m"},C=new google.maps.InfoWindow({maxWidth:360}),w=new google.maps.LatLngBounds,S=[],x=a.locations.locData.length;for(v=new MarkerClusterer(y,S,b),v.styles_.forEach(function(e,t){e.textColor="white"}),v.onClickZoom=function(e){return d(v,e)},a.locationClusterMarker={},m=0;x>m;m++){var T=new google.maps.Geocoder;!function(e,t){c(e,t,x)}(a.locations.locData[m],m)}var D=a.$watch("locations.mapReinit",function(e){if(e.reinit)for(x=a.locations.locData.length,C.close(),v&&(v.clearMarkers(),S=[]),m=0;x>m;m++){new google.maps.Geocoder;!function(e,t){c(e,t,x)}(a.locations.locData[m],m)}e.refresh&&setTimeout(function(){google.maps.event.trigger(y,"resize"),y.fitBounds(w);var e=y.getZoom();y.setZoom(e>14?14:e)},100)});a.$on("$destroy",function(){D(),a.dataOption=null,C=null,w=null,S=null,f=null,y=null,T=null}),a.clusterListFn=function(e){var t=e;i(function(){a.locations.id=t.id,C.setPosition(t.position),C.open(y),s()},10)},google.maps.event.addListener(y,"click",function(t){if(C){var n=e.element(".mapdropdownbtn");n.hasClass("active")&&n.trigger("click"),C.close()}});var k,M=n.getTrustedResourceUrl(a.locations.infoTemplateURL);o(M).then(function(e){k=e,C.setContent(t(k)(a)[0])}),google.maps.event.addDomListener(y,"zoom_changed",function(){if(C){var t=e.element(".mapdropdownbtn");t.hasClass("active")&&t.trigger("click"),C.close()}e.element("#dropdown1").remove()})}}}])}(angular),function(e){"use strict";e.module("SMART2").directive("smartMetadataChips",["debouncer",function(t){return{restrict:"E",replace:!0,scope:{smartmetadata:"=metadata",metadatatitle:"@",maxlength:"@",callBack:"&"},link:function(n,o,i){n.fieldClass="undefined"==typeof i.fieldClass?"s4":i.fieldClass,n.itemTotal="undefined"==typeof i.itemTotal?3:parseInt(i.itemTotal,10)<=0?0:parseInt(i.itemTotal,10),n.fieldkey="undefined"==typeof i.fieldkey?"name":i.fieldkey,n.showMoreChips=0,i.$observe("optionId",function(){n.optionId=i.optionId}),n.$on("LastRepeaterElement",function(n,o,i){t.add(function(){var t;t="undefined"!=typeof t?t:e.element("#"+n.targetScope.$parent.optionId+"-chips-0"),t&&(t.css({transition:"all .5s ease-in-out",background:"#e4e4e4",color:"#000"}),t.find(".chips-icon").css({transition:"all .5s ease-in-out",color:"#9e9e9e"}),setTimeout(function(){t.css("transition","none").find(".chips-icon").css("transition","none")},500))},100)}),n.metadataAdd=function(t,o){var i,a=(e.element("#"+n.optionId).width()-200,n.fieldkey);return e.isString(t.displayfield.title)&&(t.displayfield.title=t.displayfield.title.trim()),t.displayfield.title?(i=e.element("#"+n.optionId+"-chips-0"),i&&(i.css({transition:"none",background:"#159dfc",color:"#fff"}),i.find(".chips-icon").css({transition:"none",color:"#fff"})),t.options.unshift({}),t.options[0][a]=t.displayfield.title,t.displayfield.title="",void(t.displayfield.isfocus=!0)):(t.displayfield.isfocus=!0,0)},n.metadataCheck=function(t,o){var i,a,l=o.which||o.keyCode,r=[13,188,186],s=r.length;if(t.displayfield.title)for(a=0;s>a;a++)l===r[a]&&(i=188===r[a]?",":186===r[a]?";":"",i&&(t.displayfield.title=t.displayfield.title.replace(i,"")),e.element(o.currentTarget).blur(),n.metadataAdd(t,o))};var a=function(e){function t(t){t?e.success():e.reject()}n.callBack({data:{data:e.data.chipData.options[e.data.index],type:"delete",callback:t}})};n.metadataDelete=function(e,t){i.callBack?a({data:{chipData:e,index:t},success:function(){e.options.splice(t,1),n.$apply()},reject:function(){}}):e.options.splice(t,1)},n.smartmetachipTitleClick=function(t,o){e.isFunction(n.callBack)&&n.callBack({data:{data:t.options[o],type:"add"}})},n.metadataShowMore=function(o){e.element("#"+o).css("transition","1s ease-in-out"),t.add(function(){n.showMoreChips=1},10)},n.metadataLessMore=function(t){e.element("#"+t).css("transition","none"),n.showMoreChips=0}},templateUrl:"shared/directives/smartMetadataChips/smartMetadataChipsTemplate.html"}}])}(angular),function(){"use strict";angular.module("SMART2").value("uiSliderConfig",{}).directive("smartRangeSlider",["uiSliderConfig","$timeout",function(e,t){return e=e||{},{require:"ngModel",compile:function(){var n=function(n,o,i,a){function l(e,t){return t?parseFloat(e):parseInt(e,10)}function r(){o.hasClass("ui-slider")&&o.slider("destroy")}var s=angular.copy(n.$eval(i.uiSlider)),c=angular.extend(s||{},e),d={min:null,max:null},u=["min","max","step","lowerBound","upperBound"],p=angular.isUndefined(i.useDecimals)?!1:!0,f=angular.isDefined(c.updateOn)?c.updateOn:"slide",g=function(){angular.isArray(a.$viewValue)&&c.range!==!0&&(console.warn("Change your range option of ui-slider. When assigning ngModel an array of values then the range option should be set to true."),c.range=!0),angular.forEach(u,function(e){angular.isDefined(i[e])&&(c[e]=l(i[e],p))}),o.slider(c),g=angular.noop};angular.forEach(u,function(e){i.$observe(e,function(t){t&&(g(),c[e]=l(t,p),o.slider("option",e,l(t,p)),a.$render())})}),i.$observe("disabled",function(e){g(),o.slider("option","disabled",!!e)}),n.$watch(i.uiSlider,function(e){g(),void 0!==e&&o.slider("option",e)},!0),t(g,0,!0),o.bind(f,function(e,t){var i;if(t.values){var l=t.values.slice();c.lowerBound&&l[0]<c.lowerBound&&(l[0]=Math.max(l[0],c.lowerBound)),c.upperBound&&l[1]>c.upperBound&&(l[1]=Math.min(l[1],c.upperBound)),(l[0]!==t.values[0]||l[1]!==t.values[1])&&(i=!0,t.values=l)}else{var r=t.value;c.lowerBound&&r<c.lowerBound&&(r=Math.max(r,c.lowerBound)),c.upperBound&&r>c.upperBound&&(r=Math.min(r,c.upperBound)),r!==t.value&&(i=!0,t.value=r)}return a.$setViewValue(t.values||t.value),$(t.handle).find(".ui-slider-tip").text(t.value),n.$apply(),i?(setTimeout(function(){o.slider("value",t.values||t.value)},0),!1):void 0}),a.$render=function(){g();var e=c.range===!0?"values":"value";if(c.range===!0||!isNaN(a.$viewValue)||a.$viewValue instanceof Array?c.range&&!angular.isDefined(a.$viewValue)&&(a.$viewValue=[0,0]):a.$viewValue=0,c.range===!0){if(a.$viewValue&&angular.isString(a.$viewValue)&&1===(a.$viewValue.match(/,/g)||[]).length){var t=a.$viewValue.split(",");a.$viewValue=[Number(t[0]),Number(t[1])]}angular.isDefined(c.min)&&c.min>a.$viewValue[0]&&(a.$viewValue[0]=c.min),angular.isDefined(c.max)&&c.max<a.$viewValue[1]&&(a.$viewValue[1]=c.max),a.$viewValue[0]>a.$viewValue[1]&&(d.min>=a.$viewValue[1]&&(a.$viewValue[1]=d.min),d.max<=a.$viewValue[0]&&(a.$viewValue[0]=d.max)),d.min=a.$viewValue[0],d.max=a.$viewValue[1]}o.slider(e,a.$viewValue)},n.$watch(i.ngModel,function(){c.range===!0?(a.$render(),$(o).find(".ui-slider-tip").each(function(e,t){$(t).text(a.$viewValue[e])})):$(o).find(".ui-slider-tip").text(a.$viewValue)},!0),n.$on("$destroy",r),o.one("$destroy",r)},o=function(e,n,o,i){var a=angular.extend({},e.$eval(o.uiSlider)),l=["min","max","step","tick","tip"];if(angular.forEach(l,function(e){angular.isDefined(o[e])&&(a[e]=o[e])}),angular.isDefined(a.tick)&&angular.isDefined(a.step))for(var r=parseInt((parseInt(a.max)-parseInt(a.min))/parseInt(a.step)),s=r;s>=0;s--){var c=s/r*100+"%";$("<div/>").addClass("ui-slider-tick").appendTo(n).css({left:c})}angular.isDefined(a.tip)&&t(function(){var e=n.find(".ui-slider-handle");e&&e.length>1&&i.$viewValue&&angular.isArray(i.$viewValue)?($(e[0]).append('<div class="ui-slider-tip">'+i.$viewValue[0]+"</div>"),$(e[1]).append('<div class="ui-slider-tip">'+i.$viewValue[1]+"</div>")):n.find(".ui-slider-handle").append('<div class="ui-slider-tip">'+i.$viewValue+"</div>")},10)};return{pre:n,post:o}}}}])}(),function(e,t){"use strict";function n(e,n){return{link:function(o,i,a){function l(e){return e.replace(/\(\)/,"(e)")}function r(e){function n(t,n){s.onResize&&e.onResize.call(e.element,t),t.height!=n.height&&s.onHeightChange?e.onHeightChange.call(e.element,t):t.width!=n.width&&s.onWidthChange&&e.onWidthChange.call(e.element,t),n.height=t.height,n.width=t.width}var e=t.extend({element:null,onResize:null,onHeightChange:null,onWidthChange:null},e),o="width:100%;height:100%;position:absolute;left:0;top:0;z-index:-1;",i="position:absolute;left:0;top:0;overflow:hidden;height:100%;width:100%;",a="position:relative;top:0;",l='<div class="resize-sensor" style="'+o+'"><div class="sensor" style="'+i+'" data-el="shrink"><div class="sensor-element-shrink" style="'+a+'"></div></div><div class="sensor" style="'+i+'" data-el="expand"><div class="sensor-element-expand" style="'+a+'"></div></div></div>',r=t(e.element),c={height:0,width:0},d={height:0,width:0};if(r.length>0){var u=t(l);r.css("position","relative").append(u),u.find(".sensor").each(function(){var e=t(this);"expand"==e.data("el")?e.find(".sensor-element-expand").css({width:2*r.outerWidth(),height:2*r.outerHeight()}):"shrink"==e.data("el")&&e.find(".sensor-element-shrink").css({width:"200%",height:"200%"}),e.scrollLeft(2*r.outerWidth()),e.scrollTop(2*r.outerHeight())}).each(function(){var e=t(this);e.scroll(function(e){var o=t(this);r.outerWidth()==c.width&&r.outerHeight()==c.height||0==c.height||0==c.width?(c.height=r.outerHeight(),c.width=r.outerWidth(),d.height=c.height,d.width=c.width):(c.height=r.outerHeight(),c.width=r.outerWidth(),"shrink"==o.data("el")?u.find(".sensor-element-expand").css({width:2*c.width,height:2*c.height}).parent().scrollLeft(2*c.width).scrollTop(2*c.height):"expand"==o.data("el")&&u.find(".sensor-element-shrink").parent().scrollLeft(2*c.width).scrollTop(2*c.height).next().find(".sensor-element-expand").css({width:2*c.width,height:2*c.height}).parent().scrollLeft(2*c.width).scrollTop(2*c.height),n(c,d))})})}}var s={onResize:a.onResize?n(l(a.onResize)):null,onHeightChange:a.onHeightChange?n(l(a.onHeightChange)):null,onWidthChange:a.onWidthChange?n(l(a.onWidthChange)):null};e(function(){r({element:i.get(0),onResize:function(e){s.onResize(o,{e:e})},onHeightChange:function(e){s.onHeightChange(o,{e:e})},onWidthChange:function(e){s.onWidthChange(o,{e:e})}})})}}}e.module("SMART2").directive("smartResize",["$timeout","$parse",n]),t.fn.resizeSensor=function(e){var n="width:100%;height:100%;position:absolute;left:0;top:0;z-index:-1;",o="position:absolute;left:0;top:0;overflow:hidden;height:100%;width:100%;",i="position:relative;top:0;",a='<div class="resize-sensor" style="'+n+'"><div class="sensor" style="'+o+'" data-el="shrink"><div class="sensor-element-shrink" style="'+i+'"></div></div><div class="sensor" style="'+o+'" data-el="expand"><div class="sensor-element-expand" style="'+i+'"></div></div></div>',l={onResize:null,onHeightChange:null,onWidthChange:null};return this.each(function(){function n(e,t,n){o.onResize&&o.onResize.call(e,t),t.height!=n.height&&o.onHeightChange?o.onHeightChange.call(e,t):t.width!=n.width&&o.onWidthChange&&o.onWidthChange.call(e,t),n.height=t.height,n.width=t.width}var o=t.extend(l,e),i=t(this),r={height:0,width:0},s={height:0,width:0};if(i.length>0){var c=t(a);"static"===i.css("position")&&i.css("position","relative"),i.append(c),c.find(".sensor").each(function(){var e=t(this);"expand"==e.data("el")?e.find(".sensor-element-expand").css({width:2*i.outerWidth(),height:2*i.outerHeight()}):"shrink"==e.data("el")&&e.find(".sensor-element-shrink").css({width:"200%",height:"200%"}),e.scrollLeft(2*i.outerWidth()),e.scrollTop(2*i.outerHeight())}).each(function(){var e=t(this);e.scroll(function(o){var a=t(this);i.outerWidth()==r.width&&i.outerHeight()==r.height||0==r.height||0==r.width?(r.height=i.outerHeight(),r.width=i.outerWidth(),s.height=r.height,s.width=r.width):(r.height=i.outerHeight(),r.width=i.outerWidth(),"shrink"==a.data("el")?c.find(".sensor-element-expand").css({width:2*r.width,height:2*r.height}).parent().scrollLeft(2*r.width).scrollTop(2*r.height):"expand"==a.data("el")&&c.find(".sensor-element-shrink").parent().scrollLeft(2*r.width).scrollTop(2*r.height).next().find(".sensor-element-expand").css({width:2*r.width,height:2*r.height}).parent().scrollLeft(2*r.width).scrollTop(2*r.height),n(e,r,s))})})}})}}(angular,jQuery),function(e){"use strict";function t(e,t,o){return{restrict:"E",replace:!0,transclude:{oldData:"?span",newData:"?div"},scope:{align:"@",oldData:"=?",newData:"=?",label:"@",type:"@",imgDimention:"@",treeCallback:"&"},link:function(i,a,l){var r={image:"image",normal:"normal",defaultDimention:150,tree:"tree"};if(i.type=i.type||r.normal,i.align=i.align?i.align:"left",i.treemode=l.treemode,i.closeButton={title:o.instant("closeBtn")},i.multiRows=function(e){var t=!1;if(e){var n=e.constructor.toString().match(/function ([A-Za-z]+)/)[1];"Array"==n&&(t=!0)}return t}(i.oldData||i.newData),i.oldData||i.newData?i.oldData&&i.newData?(i.isChanged=!0,"tree"!==i.type&&(i.oldDataHtml=t.trustAsHtml(i.oldData),i.newDataHtml=t.trustAsHtml(i.newData))):i.oldData&&!i.newData?(i.isChanged=!1,"tree"!==i.type&&(i.oldDataHtml=t.trustAsHtml(i.oldData))):!i.oldData&&i.newData&&(i.isChanged=!0,"tree"!==i.type&&(i.newDataHtml=t.trustAsHtml(i.newData))):(i.transclude=!0,e(function(){a.find("[old-data]").addClass("revision-old-val").wrap("<span>").parent().addClass("revision-old-data"),a.find("[new-data]").wrap("<span>").parent().addClass("revision-new-data")})),i.type==r.image)if(i.imgDimention)i.diagonal={};else{var s=n(r.defaultDimention,r.defaultDimention);i.diagonal={width:s,left:-(s/2-r.defaultDimention/2)}}else i.type==r.tree&&(i.popup={url:"shared/directives/smartRevision/treeviewChanges.html",show:!1,callback:function(e){i.popup.show=!1,l.treeCallback&&i.treeCallback({data:{oldData:i.oldData,newData:i.newData,type:"close",label:i.label}})}});i.treeChange=function(){l.treeCallback&&i.treeCallback({data:{oldData:i.oldData,newData:i.newData,type:"open",label:i.label}}),i.popup.show=!0}},templateUrl:"shared/directives/smartRevision/smartRevisionTemplate.html"}}function n(e,t){return Math.sqrt(e*e+t*t)}e.module("SMART2").directive("smartRevision",["$timeout","$sce","$translate",t])}(angular),function(){"use strict";function e(e,t,n,o){return{restrict:"E",transclude:!0,scope:{show:"=",hide:"&",loader:"=",model:"=ngModel",config:"=",isApplyFilters:"=",isSavedView:"=",isSavedViewModified:"=",openPopupSavedView:"=",api:"=",setTitle:"@",callbackFunc:"&"},controller:["$scope","$http","$timeout","smartSavedViewPopupCollection",function(n,i,a,l){function r(e){if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}function s(e){var t="";return t=_.find(n.config,{name:e}),"undefined"==typeof t?!1:!0}function c(e){return e.length>n.api.viewNameLength?!0:!1}function d(t){e.notify(t,function(e){})}function u(e){if("SAVED FILTERS"==n.setTitle){console.log(e);var t={rowKey:e.rowKey,moduleName:e.module,removeDefaultFilter:e.isDefault?!1:!0},o={method:"POST",url:n.api.MarkasDefault,data:t,headers:{"Content-Type":"application/json"}};i(o).then(function(e){if(null!=e.data){var t=_.find(n.config,{name:n.selectedFilter.name||n.api.currentViewApplied.name});t&&(t.isDefault?n.isMarkAsDefault.check=!0:n.isMarkAsDefault.check=!1);for(var o=0;o<n.config.length;o++)n.config[o].isDefault=!1;t.isDefault=!0}})["catch"](function(e){console.log(e.statusText)})}else{var t={ViewId:e.ViewId,ViewName:e.name,ContactCode:e.ContactCode,ColumnList:e.ColumnList,Filters:e.Filters,SortColumn:"NeedByDate",SortOrder:"Ascending",GroupColumn:e.GroupColumn,IsDefaultView:e.isDefault,IsSystemDefault:e.IsSystemDefault,DocumentTypeCode:e.DocumentTypeCode},o={method:"POST",url:n.api.UpdateSavedViewURL,data:t,headers:{"Content-Type":"application/json"}};i(o).then(function(t){if(null!=t.data&&(console.log(n.api.updateMessage),e.isDefault))for(var o=0;o<n.config.length;o++)n.config[o].ViewId!=e.ViewId&&n.config[o].isDefault&&(n.config[o].isDefault=!1)})["catch"](function(e){console.log(e.statusText)})}}l.set(n),n.popupInc=l.get().length,n.disableDoneButton=!0,n.doneButton={title:o.instant("doneBtn")},n.cancelButton={title:o.instant("cancelBtn")},n.uncheckMarkAsDefault;var p=function(){var e=_.find(n.config,{isDefault:!0});e?n.disableDoneButton=!1:n.disableDoneButton=!0};p(),n.defaultCheckUncheck=!0;var f=function(){n.isMarkAsDefault.check=!1;for(var e=0;e<n.config.length;e++)n.config[e].isDefault&&n.config[e].isDefaultTxt&&(n.isMarkAsDefault.check=!0)};n.setDefaultFiler=function(e){n.defaultCheckUncheck=!0,e?n.uncheckMarkAsDefault=!1:n.uncheckMarkAsDefault=!0;for(var t=0;t<n.config.length;t++)n.config[t].isDefault&&n.config[t].isDefaultTxt&&(n.defaultCheckUncheck=e)},n.showSavedViewPopup=!0,n.showSaveView=!0,n.radioChangeCallback=function(e,t){var o=_.find(n.config,{index:n.model.name});o||(o=_.find(n.config,{index:n.model.index})),n.selectedFilter=o;for(var i=0;i<n.config.length;i++)n.config[i].isDefault=!1;for(var i=0;i<n.config.length;i++)t?n.config[i].index===t.index&&(n.config[i].isDefault=!0):n.config[i].index===(o&&o.index)&&(n.config[i].isDefault=!0);p(),f()},n.currentDefault,n.showSavedView=function(){n.currentDefault=_.find(n.config,{isDefaultTxt:!0});var e=n.defaultCheckUncheck;if(n.isSavedView=!0,n.isSavedFilter=!0,n.uncheckMarkAsDefault&&void 0!=n.uncheckMarkAsDefault)for(var o=0;o<n.config.length;o++)n.config[o].isDefaultTxt=!1;n.uncheckMarkAsDefault=!1;for(var o=0;o<n.config.length;o++)1==n.isMarkAsDefault.check&&(n.config[o].isDefaultTxt=!1,1==n.config[o].isDefault&&(n.config[o].isDefaultTxt=!0));n.selectedFilter.name||(n.selectedFilter.name=n.api.currentViewApplied.name),n.api&&(n.api.currentViewApplied=_.find(n.config,{index:n.selectedFilter.index}),null==n.api.currentViewApplied&&t.setFilterDef('{"defaultFilterType":3,"filters":[]}'),void 0!=n.api.currentViewApplied&&t.setFilterDef(n.api.currentViewApplied.Filters),n.api.selectedSavedview={name:n.selectedFilter.name},n.api.selectedFilterView={name:n.selectedFilter.name},void 0!=n.currentDefault&&n.currentDefault.index!=n.api.currentViewApplied.index&&(n.currentDefault.isDefault=e,u(n.currentDefault)),1==n.isMarkAsDefault.check?(n.api.currentViewApplied.isDefault=!0,u(n.api.currentViewApplied),n.isMarkAsDefault.check=!1):(n.api.currentViewApplied.isDefault=!1,u(n.api.currentViewApplied)),"SAVED FILTERS"!=n.setTitle&&n.api.applyViewOnGrid()),n.callbackFunc({e:{model:n.selectedFilter,currOperation:"applyFilter"}})},n.Reset=function(){var e=_.find(n.config,{IsSystemDefault:!0});e.isDefault=!0,n.api.currentViewApplied=e;var t={method:"POST",url:n.api.UpdateSavedViewURL,headers:{"Content-Type":"application/json"}};_.each(n.config,function(e){e.IsSystemDefault||(e.isDefault&&(t.data=e,i(t).then(function(e){})["catch"](function(e){console.log(e.statusText)})),e.isDefault=!1)}),"SAVED FILTERS"!=n.setTitle&&n.api.applyViewOnGrid()},n.isMarkAsDefault={check:!1},n.SystemAsDefault={check:!1},n.showSavedViewPopup=!1,n.showSaveView=!1,n.focusSearch=!1,n.isActive=!1,n.showMe=!1,n.showSearch=function(){n.isActive=!0,n.focusSearch=!0,n.showMe=!0,n.hideClose=!0},n.hideSearch=function(){n.isActive=!1,n.focusSearch=!1,n.hideClose=!1};var g={type:"inform",buttons:[{title:o.instant("notificationButtonOk"),result:"true"}]};n.deleteItem=function(a,l,r){if(l.IsSystemDefault&&"SAVED FILTERS"!=n.setTitle)g.message=o.instant("deleteSystemDefaultMsg"),e.notify(g,function(e){});else if(1==l.isDefault&&"SAVED FILTERS"!=n.setTitle)g.message="You can not delete a saved view when it is marked as default.",e.notify(g,function(e){});else{var s={type:"warning",message:o.instant("deleteMessage"),buttons:[{title:o.instant("notificationButtonYes"),result:"true"},{title:o.instant("notificationButtonNo"),result:"false"}]},c=t.getDefaultSavedView(n.config,!1)||t.getDefaultSavedView(n.config,!0);e.notify(s,function(e){if("true"==e.result){for(var t,o=0;o<n.config.length;o++)n.config[o].index===l.index&&(t=n.config.splice(o,1));p(),f(),n.callbackFunc({e:{index:l.index,currentItem:l,currOperation:r}});var a={method:"DELETE",url:n.api.deleteSavedViewURL,data:{data:{savedViewId:t[0].ViewId}},headers:{"Content-Type":"application/json"}};i(a).then(function(e){null!=e.data&&c&&(n.api.currentViewApplied=c,n.selectedFilter.name=c.name,n.api.applyViewOnGrid(),console.log("Saved View Deleted"))})["catch"](function(e){console.log(e.statusText)})}})}},n.showEditor=!1,n.editCurrentViewName=function(t,i){var l=n;if(angular.forEach(l.config,function(e,t){1==l.config[t].showCurrentItemEditor&&(l.config[t].showCurrentItemEditor=!1)}),i.IsSystemDefault)g.message=o.instant("renameSystemDefaultMsg"),e.notify(g,function(e){});else{for(var r=0;r<l.config.length;r++)l.config[r].index===i.index&&(l.config[r].showCurrentItemEditor=!0);l.getEditedviewName.name=i.name}a(function(){l.getEditedviewName.isFocus=!0},900)},n.getEditedviewName={name:"",isFocus:!1},n.updateViewName=function(e,t,o){if(n.closeEditPanel(e,t),n.callbackFunc({e:{index:t.index,currentItem:t,currOperation:o,editedName:n.getEditedviewName.name}}),0==n.getEditedviewName.name.length)return r(),!1;var a=n.config.filter(function(t){return t.name===n.getEditedviewName.name&&t.ViewId!==n.config[e].ViewId});if(0!=a.length)d(n.api.duplicateErrorMessage);else if(c(n.getEditedviewName.name))d(n.api.maxCharacterLength);else{n.config[t.index].name=n.getEditedviewName.name,n.config[t.index].showCurrentItemEditor=!1;var l={ViewName:n.config[t.index].name||n.config[t.index].ViewName,IsDefaultView:n.config[t.index].isDefault,IsSystemDefault:n.config[t.index].IsSystemDefault,SortColumn:n.config[t.index].SortColumn,SortOrder:n.config[t.index].SortOrder,ViewId:n.config[t.index].ViewId,GroupColumn:n.config[t.index].GroupColumn,Filters:n.config[t.index].Filters,DocumentTypeCode:n.config[t.index].DocumentTypeCode,ContactCode:n.config[t.index].ContactCode,ColumnList:n.config[t.index].ColumnList},s={method:"POST",url:n.api.UpdateSavedViewURL,data:l,headers:{"Content-Type":"application/json"}};i(s).then(function(e){null!=e.data&&console.log(n.api.updateMessage)})["catch"](function(e){console.log(e.statusText)})}},n.closeEditPanel=function(e,t){for(var o=0;o<n.config.length;o++)n.config[o].index===t.index&&(n.config[o].showCurrentItemEditor=!1);t.validate=!1},n.viewObject={},n.viewObject.SaveViewName="",n.saveCurrentView=function(e){if(""!=e)if(s(e))d(n.api.duplicateErrorMessage);else if(c(e))d(n.api.maxCharacterLength);else{n.isApplyFilters=!1,n.model={name:e,isDefault:!1,showCurrentItemEditor:!1};var o={method:"POST",url:n.api.insertSavedViewURL,data:{ViewId:0,ViewName:e,ContactCode:n.api.contactCode,ColumnList:t.getColDef()||"",Filters:t.getFilterDef()||"",SortColumn:"NeedByDate",SortOrder:"Ascending",GroupColumn:t.getGroupDef()||"",IsDefaultView:!1,IsSystemDefault:!1,DocumentTypeCode:n.api.documentTypeCode},headers:{"Content-Type":"application/json"}};i(o).then(function(o){null!=o.data&&(n.isSavedView=!0,n.config.push({ViewId:o.data,ViewName:e,ContactCode:n.api.contactCode,ColumnList:t.getColDef()||"",Filters:t.getFilterDef()||"",SortColumn:"NeedByDate",SortOrder:"Ascending",GroupColumn:t.getGroupDef()||"",IsDefaultView:!1,IsSystemDefault:!1,DocumentTypeCode:n.api.documentTypeCode,showCurrentItemEditor:!1,name:e,isDefault:!1}),n.api.currentViewApplied=_.find(n.config,{name:n.selectedFilter.name}),console.log("Saved View Created"))})["catch"](function(e){console.log(e.statusText)}),n.isSavedFilter=!0,n.viewObject.SaveViewName=""}else r()},n.$watch("show",function(e,t){angular.forEach(n.config,function(e,t){1==n.config[t].showCurrentItemEditor&&(n.config[t].showCurrentItemEditor=!1)}),1==n.openPopupSavedView&&1==e?(n.showPopUp=!0,n.showSavedViewPopup=!0,n.showSaveView=!1,n.hideSearch()):1!=n.openPopupSavedView&&1==e?(n.showSavedViewPopup=!1,n.showSaveView=!0):(n.showSavedViewPopup=!1,n.showSaveView=!1,n.show=!1,n.showPopUp=!1),a(function(){angular.element(".searchWithHiddenTextField input").blur(),angular.element(".savedFiltersPopUpLists").find(angular.element('input[checked="checked"]')).prop("checked",!0)},1e3),n.radioChangeCallback()}),n.loaderFlag={plain:!0,message:o.instant("loadingMsg"),center:!0},n.$watch("setTitle",function(e){"SAVED FILTERS"==e&&(n.title=o.instant("savedFilters")),"SAVED VIEWS"==e&&(n.title=o.instant("savedViews"))}),n.search_data=n.config;var m=[];n.search_savedpopup=function(e){if(n.config=[],null!=e.data[0].value&&""!=e.data[0].value){m=[];for(var t=0;t<n.search_data.length;t++){var o=(n.search_data[t].name+"").toLowerCase(),i=0===o.indexOf(e.data[0].value.toLowerCase());i&&-1==m.indexOf(n.search_data[t].name)&&m.push({name:n.search_data[t].name,isDefault:n.search_data[t].isDefault,showCurrentItemEditor:n.search_data[t].showCurrentItemEditor})}n.config=m}else m=[],n.config=n.search_data},n.onHide=function(){n.viewObject.SaveViewName="",n.hide()}}],templateUrl:"shared/directives/smartSavedViewPopup/smartSavedViewPopupTemplate.html"}}angular.module("SMART2").directive("smartSavedViewPopup",["notification","cacheHelperService","smartSavedViewPopupCollection","$translate",e]).service("smartSavedViewPopupCollection",function(){this.collection=[],this.set=function(e){this.collection.push(e)},this.get=function(e){return this.collection}})}(),function(){"use strict";angular.module("SMART2").directive("smartSearch",["httpService","$timeout","APPCONSTANTS","$translate",function(e,t,n,o){return{restrict:"E",replace:!0,transclude:!0,scope:{type:"@"},link:function(i,a,l){function r(e){for(var t=e.Output,n=-1,o=0;o<t.length;o++)if(8==t[o].FilterKey){n=o;break}if(n>-1){var a=t.splice(n,1);t.splice(1,0,a[0])}i.modules=angular.copy(t),i.selectedModule=i.modules[0],i.advancedSearchDocTypes=e.AdvancedSearchDocTypes}var s={RFX:{value:"0",string:"RFX",SubAppCodes:103},RFP:{value:"1",string:"RFP",SubAppCodes:103},RFQ:{value:"2",string:"RFQ",SubAppCodes:103},RFI:{value:"3",string:"RFI",SubAppCodes:103},Auction:{value:"4",string:"Auction",SubAppCodes:103},Contract:{value:"5",string:"Contract",SubAppCodes:104},Catalog:{value:"6",string:"Catalog",SubAppCodes:108},Requisition:{value:"7",string:"Requisition",SubAppCodes:107},PO:{value:"8",string:"PO",SubAppCodes:107},Order:{value:"8",string:"Order",SubAppCodes:107},Invoice:{value:"9",string:"Invoice",SubAppCodes:107},Receipts:{value:"10",string:"Receipt",SubAppCodes:107},Forms:{value:"11",string:"Forms",SubAppCodes:105},Scorecards:{value:"12",string:"Scorecards",SubAppCodes:105},Workbench:{value:"13",string:"Workbench",SubAppCodes:110},InvoiceReconciliation:{value:"14",string:"InvoiceReconciliation",SubAppCodes:107},Items:{value:"20",string:"Items"},Templates:{value:"15",string:"Templates",SubAppCodes:111},Partners:{value:"19",string:"Partners",SubAppCodes:105},ContractRequest:{value:"16",string:"ContractRequest"},RFxRequest:{value:"17",string:"RFxRequest"},AuctionRequest:{value:"18",string:"AuctionRequest"},PaymentRequest:{value:"27",string:"PaymentRequest"},Project:{value:"21",string:"Project",SubAppCodes:113},CreditMemo:{value:"22",string:"CreditMemo",SubAppCodes:107},ReturnNote:{value:"20",string:"ReturnNote",SubAppCodes:107},ActionPlan:{value:"23",string:"ActionPlan",SubAppCodes:105},Blanket:{value:"30",string:"Blanket",SubAppCodes:104},CategoryWorkbench:{value:"28",string:"CategoryWorkbench",SubAppCodes:116},ProjectDashboard:{value:"101",string:"ProjectDashboard",SubAppCodes:113}},c=function(){for(var e=i.selectedModule.FilterKey.split(","),t="",n=0;n<e.length;n++)switch(e[n]){case s.RFI.value:t+=s.RFI.string+",";break;case s.RFP.value:t+=s.RFP.string+",";break;case s.RFQ.value:t+=s.RFQ.string+",";break;case s.Auction.value:t+=s.Auction.string+",";break;case s.Workbench.value:t+=s.Workbench.string+",";break;case s.Contract.value:t+=s.Contract.string+",";break;case s.Scorecards.value:t+=s.Scorecards.string+",";break;case s.Forms.value:t+=s.Forms.string+",";break;case s.Requisition.value:t+=s.Requisition.string+",";break;case s.Order.value:t+=s.Order.string+",";break;case s.Invoice.value:t+=s.Invoice.string+",";break;case s.InvoiceReconciliation.value:t+=s.InvoiceReconciliation.string+",";break;case s.Receipts.value:t+=s.Receipts.string+",";break;case s.AuctionRequest.value:t+=s.AuctionRequest.string+",";break;case s.RFxRequest.value:t+=s.RFxRequest.string+",";break;case s.ContractRequest.value:t+=s.ContractRequest.string+",";break;case s.PaymentRequest.value:t+=s.PaymentRequest.string+",";break;case s.Partners.value:t+=s.Partners.string+",";break;case s.Templates.value:t+=s.Templates.string+",";break;case s.Catalog.value:t+=s.Catalog.string+",";break;case s.Project.value:t+=s.Project.string+",";break;case s.CreditMemo.value:t+=s.CreditMemo.string+",";break;case s.ReturnNote.value:t+=s.ReturnNote.string+",";break;case s.ActionPlan.value:t+=s.ActionPlan.string+",";break;case s.Blanket.value:t+=s.Blanket.string+",";break;case s.CategoryWorkbench.value:t+=s.CategoryWorkbench.string+",";break;case s.ProjectDashboard.value:t+=s.ProjectDashboard.string+","}(-1!==t.indexOf(s.RFI.string)||-1!==t.indexOf(s.RFP.string)||-1!==t.indexOf(s.RFQ.string))&&(t=t.replace(s.RFI.string+",",""),t=t.replace(s.RFP.string+",",""),t=t.replace(s.RFQ.string+",",""),t+=s.RFX.string);var o=t.slice(-1);return","==o&&(t=t.slice(0,-1)),t};i.getSearchNavigateURL=function(e,t){var n=g(e);return t&&(n+="&fieldkey="+t),
n};var d=function(e){var t="",n=$.makeArray("16,17,18,27".split(","),e.split(",")[0]);if("1,2,3"==e)t=s.RFX.string.toLowerCase();else if("16"==n||"17"==n||"18"==n||"27"==n)t="request";else for(var o in s)if(s[o].value==e){t=s[o].string.toLowerCase();break}return t},u=function(e){var t="";for(var n in s)if(s[n].string.toLowerCase()==e){t=s[n].value;break}return t},p=function(e){var t=f(),n=u(e);return t.length>0?-1!=t.indexOf(n)?!0:!1:void 0},f=function(){var e=null!=i.advancedSearchDocTypes?i.advancedSearchDocTypes.split(","):[];return e},g=function(e){var t=i.searchText.trim(),o="";switch(o=p(e)?h.portalURL+"Portal/Dashboard/Documents?scope="+e+"&q="+t+"&oloc="+h.documentTypeCodes:h.portalURL+"Portal/search/searchresults?q="+t+"&scope="+e+"&oloc="+h.documentTypeCodes,e.toLowerCase()){case s.Catalog.string.toLowerCase():o=h.portalURL+"/Catalog/Manage/Navigation?bpc="+h.encryptedBPC+"&navTo=1&q="+t+"&scope="+e+"&"+h.catalogQueryString+"&oloc="+s.Catalog.SubAppCodes;break;case s.Order.string.toLowerCase():o+="&"+h.orderQueryString;break;case s.Invoice.string.toLowerCase():o+="&"+h.invoiceQueryString;break;case s.Receipts.string.toLowerCase():o+="&"+h.receiptQueryString;break;case s.Requisition.string.toLowerCase():o+="&"+h.requisitionQueryString;break;case s.InvoiceReconciliation.string.toLowerCase():o+="&"+h.invoiceReconcillationQueryString;break;case s.CreditMemo.string.toLowerCase():o+="&"+h.creditMemoQuerystring;break;case s.Blanket.string.toLowerCase():o+="&"+h.blanketQueryString;break;case s.CategoryWorkbench.string.toLowerCase():o+="&"+h.categoryWorkbenchQueryString;break;case s.Partners.string.toLowerCase():o=h.portalURL+"Portal/search/searchresults?q="+t+"&scope="+e+"&"+h.partnersQueryString+"&oloc="+h.documentTypeCodes;break;case s.Forms.string.toLowerCase():o+="&"+h.formQueryString;break;case s.Scorecards.string.toLowerCase():o+="&"+h.assessmentQueryString;break;case s.Workbench.string.toLowerCase():o+="&"+h.workBenchQueryString;break;case s.RFX.string.toLowerCase():case s.RFP.string.toLowerCase():case s.RFQ.string.toLowerCase():case s.RFI.string.toLowerCase():o+="&"+h.rfxQueryString;break;case s.Auction.string.toLowerCase():o+="&"+h.auctionQueryString;break;case s.ActionPlan.string.toLowerCase():o+="&"+h.actionPlanQueryString;break;case s.Contract.string.toLowerCase():o+="&"+h.contractQueryString;break;case s.Templates.string.toLowerCase():o+="&"+h.catalogQueryString;break;case"request":e=s.RFxRequest.string.toLowerCase()+","+s.AuctionRequest.string.toLowerCase()+","+s.ContractRequest.string.toLowerCase()+","+s.PaymentRequest.string.toLowerCase(),o=h.portalURL+"Portal/search/searchresults?q="+t+"&scope="+e+"&oloc="+h.documentTypeCodes;break;case"returnnote":o+="&"+h.returnNoteQuerystring;break;case s.Project.string.toLowerCase():o=h.portalURL+"PPST/Project/ProjectHome?oloc=113&q="+t+"&"+h.projectQueryString;break;default:(-1!==e.toLowerCase().indexOf(s.AuctionRequest.string.toLowerCase())||-1!==e.toLowerCase().indexOf(s.RFxRequest.string.toLowerCase())||-1!==e.toLowerCase().indexOf(s.ContractRequest.string.toLowerCase())||-1!==e.toLowerCase().indexOf(s.PaymentRequest.string.toLowerCase()))&&(o+="&"+h.auctionQueryString)}return n.userPreferences.UserBasicDetails.IsSupplier&&(o=o+"&dd="+h.encryptedBPC),o};i.searchText="";var m,h,v;n&&n.userPreferences&&n.userPreferences.constantURLAndQueryStringValue?h=n.userPreferences.constantURLAndQueryStringValue:(m={method:"GET",url:"/"+n.userPreferences.AreaName+"/GetConstantURLAndQueryStringValues?oloc=216"},e.directhttp(m).then(function(e){h=e},function(e){h={}})),m={method:"GET",url:"/"+n.userPreferences.AreaName+"/GetAllowedModulesList?oloc=216&BuyerPartnerCode="+n.userPreferences.UserBasicDetails.BuyerPartnerCode},n.userPreferences.allowedModulesList?r(n.userPreferences.allowedModulesList):e.directhttp(m).then(function(e){r(e)},function(e){}),i.onModuleClick=function(e){i.selectedModule=e,i.showFilterList=!1,i.recentSearches=null,i.searchResult=null};var y=function(){return i.recentSearches?(i.recentSearches=i.recentSearches.splice(0,5),void(i.showRecentSearches=!0)):(i.recentSearches=null,i.isRecentSearchesLoading=!0,m={method:"GET",url:"/Controls/HeaderBar/GetRecentSearches?oloc=101&moduleType="+(i.selectedModule.IsAllMenu?0:i.selectedModule.FilterKey.split(",")[0])+"&fieldKey="+(void 0!=i.selectedModule.FieldKey?i.selectedModule.FieldKey:0)},void e.directhttp(m).then(function(e){i.showRecentSearches=!0,i.isRecentSearchesLoading=!1;try{i.recentSearches=JSON.parse(e.RecentSearches).splice(0,5)}catch(t){i.recentSearches=[]}},function(e){i.isRecentSearchesLoading=!1}))};i.onSearchTextChange=function(t){if(13===t.keyCode&&i.searchText.trim().length>2){if(!i.selectedModule.IsAllMenu)return void(window.location.href=i.getSearchNavigateURL(d(i.selectedModule.FilterKey),i.selectedModule.FieldKey));if(i.showRecentSearches=!1,i.showFilterList=!1,i.showSearchResult=!0,i.isSearchResultLoading=!0,v===i.searchText.trim()&&i.searchResult)return void(i.isSearchResultLoading=!1);if(!i.recentSearches)return void b();for(var n=[{Sequence:0,SearchText:i.searchText.trim()}],o=0;o<i.recentSearches.length;o++)i.recentSearches[o].SearchText!=i.searchText.trim()&&n.push({Sequence:n.length,SearchText:i.recentSearches[o].SearchText});i.recentSearches=angular.copy(n),m={method:"POST",url:"/Controls/HeaderBar/SaveRecentSearches?oloc=101",data:{recentSearches:JSON.stringify(n),moduleType:i.selectedModule.IsAllMenu?0:i.selectedModule.FilterKey.split(",")[0],fieldKey:void 0!=i.selectedModule.FieldKey?i.selectedModule.FieldKey:0}},e.directhttp(m).then(function(e){b()},function(e){b()})}else 0==i.searchText.trim().length&&(i.showSearchResult=!1,y())};var b=function(){v=angular.copy(i.searchText.trim()),i.searchResult=null,m={method:"POST",url:"/Controls/BaseSearch/GetSearchResultForWeb?oloc=101",data:{searchKeyword:i.searchText.trim(),Filters:["searchScope:All","pageNumber:1","isGlobalSearch:true","module:all","moduleScope:"+c(),"noOfRecords:0"]}},i.selectedModule.FieldKey&&m.data.Filters.push("fieldkey:"+i.selectedModule.FieldKey),e.directhttp(m).then(function(e){i.isSearchResultLoading=!1,e.DataSearchResult.GroupTotal.TotalCount>0?i.searchResult=e.DataSearchResult.GroupTotal:i.searchResult=[]},function(e){i.isSearchResultLoading=!1})};i.onSearchTextFocus=function(e){0==i.searchText.trim().length&&(i.showSearchResult=!1,y())},i.onRecentSearchItemClick=function(e){i.searchText=e,i.onSearchTextChange({keyCode:13})},i.getTranslatedLabel=function(e){return o.instant(e)};var C=function(){t(function(){i.showRecentSearches=!1,i.showFilterList=!1,i.showSearchResult=!1;try{e.abort(m)}catch(t){}})};$(document).on("click",C),i.$on("$destroy",function(){$(document).off("click",C)})},templateUrl:"shared/directives/smartSearch/smartSearchTemplate.html"}}])}(),function(angular){"use strict";function smartSelectallFun($parse,$timeout){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ngModel){function initCheckbox(){$timeout(function(){initCheckboxItem()})}function initCheckboxItem(){var e=$(config.selector).find("input[type=checkbox]");e&&e.length>0&&e.unbind("change").change(function(e){var t=$(this),n=t.prop("checked");config.selected=n?config.selected+=1:config.selected-=1,config.selected<config.length?(0==config.selected?element.removeClass("filled-partial"):element.addClass("filled-partial"),ngModel.$setViewValue(!1),ngModel.$render()):config.selected==config.length&&(element.removeClass("filled-partial"),ngModel.$setViewValue(!0),ngModel.$render()),getCheckboxInfo&&scope.$apply(function(){getCheckboxInfo(scope,getInfo())})})}function resetConfig(){var e=0;config.scopeData=getScope(scope,config.scopeDeep),config.scopeData.forEach(function(t){t[config.checkerFlag]&&e++}),config.selected=e,config.length=config.scopeData.length,config.selected<config.length?(0==config.selected?element.removeClass("filled-partial"):element.addClass("filled-partial"),ngModel.$setViewValue(!1),ngModel.$render()):config.selected==config.length&&(element.removeClass("filled-partial"),ngModel.$setViewValue(!0),ngModel.$render()),getCheckboxInfo&&scope.$applyAsync(function(){getCheckboxInfo(scope,getInfo())})}function getScope(e,t){var n,o=t.split(".");if(o.length>1){n=e;for(var i=0;i<o.length;i++)n=n[o[i]]}else n=e[t];return n}function refresh(){initCheckbox(),resetConfig()}function getInfo(){return{selected:config.selected,length:config.length}}var getCheckboxInfo=attrs.getCheckboxInfo?$parse(attrs.getCheckboxInfo.replace(/\(\)/,"(selected, length)")):!1,config=function(){var e=attrs.data.split("|"),t=e[0]?e[0].replace(/\s+/gi,""):null,n=e[1]?e[1].replace(/\s+/gi,""):null,o=attrs.checkerFlag?attrs.checkerFlag:"checked",i=attrs.disableFlag?attrs.disableFlag:"disable",a=0==i.indexOf("{")?"eval":"flag",l=getScope(scope,t);return{checkerFlag:o,disableFlag:i,disableStyle:a,scopeDeep:t,scopeData:l,selector:n,selected:0,length:l.length}}(),mainCheckbox=element.find("input[type=checkbox]");scope.__selectallExoprt&&(!scope.__selectallExoprt&&(scope.__selectallExoprt={}),scope.__selectallExoprt.selectall=function(e){mainCheckbox.prop("checked",e).change()}),mainCheckbox.change(function(e){var el=$(this),_scope=scope,isChecked=el.prop("checked");config.scopeData.forEach(function(a){var isDisabled=function(){var r;return"flag"==config.disableStyle?r=a[config.disableFlag]:"eval"==config.disableStyle&&(r=eval(config.disableFlag.replace(/(\{|\})/gi,"").replace(/this/gi,"a"))),r}();isDisabled||(a[config.checkerFlag]=isChecked)}),element.removeClass("filled-partial"),config.selected=isChecked?config.scopeData.length:0,getCheckboxInfo&&scope.$apply(function(){getCheckboxInfo(scope,getInfo())})}),scope.$watchCollection(config.scopeData,function(){refresh()}),scope.$watch(config.scopeDeep+".length",function(){refresh()}),initCheckbox()}}}angular.module("SMART2").directive("smartSelectall",["$parse","$timeout",smartSelectallFun])}(angular),angular.module("SMART2").directive("smartSort",function(){return{restrict:"E",transclude:!0,template:'<a href="javascript:void(0)" class="waves-circle waves-effect waves-grey" ng-click="ascDescToggler()">\n<i ng-if="currentCell != sortBy" class="icon iconSmall grey-text" smart-tooltip position="bottom" delay="50" message="{{ \'Sort By \' | translate }}">\n<svg>\n<use xlink:href="{{ \'#icon_Sort\' }}"></use>\n</svg></i><i class="icon iconSmall grey-text" ng-if="currentCell == sortBy" ng-class=" { \'s-dd-icon-wth-color\':  currentCell == sortBy }"  smart-tooltip position="bottom" delay="50" message="{{ iconWithTooltip.tooltip | translate }}">\n<svg>\n<use xlink:href="{{ iconWithTooltip.sortbyIcon }}"></use>\n</svg></i></a>',scope:{sortBy:"=",sortReverse:"=",currentCell:"@"},link:function(e,t,n){e.iconWithTooltip={sortbyIcon:"",tooltip:""},e.ascDescToggler=function(){e.sortBy=e.currentCell,e.sortReverse=!e.sortReverse,e.sortBy==e.currentCell&&0==e.sortReverse?(e.iconWithTooltip.sortbyIcon="#icon_SortDescending",e.iconWithTooltip.tooltip="Descending"):e.sortBy==e.currentCell&&1==e.sortReverse&&(e.iconWithTooltip.sortbyIcon="#icon_SortAscending",e.iconWithTooltip.tooltip="Ascending")}}}});var isRegionalSettingEnabled="undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable;!function(){"use strict";function getObjectValue(e,t){try{for(var n=t.split(".");n.length;)e=e[n.shift()]}catch(o){}return e}function getObjectValueForAutoSuggest(e,t){var n=t.split(".");return n.length>1?(n.splice(n.length-1,1),getObjectValue(e,n.join("."))):e[n[0]]}function setObjectValue(e,t,n){try{var o=t.split(".");if(1==o.length)e[o[0]]=n;else{var e=e[o[0]];o.shift();var t=o.join(".");setObjectValue(e,t,n)}}catch(i){}}function updateCell(e,t,n){return angular.isObject(n)?!angular.isObject(e[t.split(".")[0]])&&angular.isObject(n)?void setObjectValue(e,t,n[t.split(".")[0]]):void angular.extend(e[t.split(".")[0]],n):void setObjectValue(e,t,n)}function getFormattedData(data,displayFormat){if(!data||0==data.length)return[];for(var i=0;i<data.length;i++){var str=displayFormat;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data[i].hasOwnProperty(childSplit[k]))&&(str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),eval("data[i]."+childSplit[k])))}catch(e){}data[i].value=str.trim()}return data}function getDisplayData(data,displayFormat){if(void 0==data||null==data||""==data)return"";var str=displayFormat,evalResult,evaluatedKeysCounter=0,nullKeysCounter=0;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data.hasOwnProperty(childSplit[k]))&&(evalResult=eval("data."+childSplit[k]),evaluatedKeysCounter++,(void 0==evalResult||null==evalResult||0==(evalResult+"").trim().length)&&(evalResult="",nullKeysCounter++),str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),evalResult));evaluatedKeysCounter==nullKeysCounter&&(str="")}catch(e){}return void 0===str||null===str||"undefined"===str||"null"===str?"":str}function convertNumberToFixed(e,t,n){var o,i;return o=(e+"").split("."),o.length>1?(i=o[o.length-1],n>0&&i.length>=n?e.toString().match(new RegExp("^-?\\d+(?:.\\d{0,"+(n||-1)+"})?"))[0]:t>0&&i.length<=t?Number(Math.round(e+"e"+t)+"e-"+t):e):Number(Math.round(e+"e"+t)+"e-"+t)}function sortSmartTableData(e,t,n,o){return e.sort(function(e,i){var a=getObjectValue(e,t.field),l=getObjectValue(i,t.field),r=parseFloat(a),s=parseFloat(l);if(isNaN(r)&&isNaN(s)){try{t.enableTranslation&&(a=o.instant(a),l=o.instant(l)),a=a.toLowerCase(),l=l.toLowerCase()}catch(c){}return a>l?n?-1:1:l>a?n?1:-1:0}return isNaN(r)?n?-1:1:isNaN(s)?n?1:-1:r>s?n?-1:1:s>r?n?1:-1:0})}var app=angular.module("SMART2");window.onmousedown=function(e){return $(e.target).closest(".smart-table-cell-template").length>0&&(window.isSmartTableCellClicked=!0),window.lastActiveCellScope&&($(e.target).closest(".daterangepicker").length>0||$(e.target).closest(".autocomplete-suggestion").length>0||$(e.target).closest(".autocomplete-suggestions").length>0||$(e.target).closest(".modal").length>0||$(e.target).closest(".lean-overlay").length>0)?void 0:0==$(e.target).closest(".smart-table-row-cell").length||$(e.target).closest(".smart-table-icon-holder").length>0?void(window.lastActiveCellScope&&(window.lastActiveCellScope.stopEdit(),window.lastActiveCellScope=void 0)):void 0},window.focusHandler=function(e){e.focus(function(){setTimeout(function(e){var t=e.value.length;return function(){void 0!==e.setSelectionRange?e.setSelectionRange(t,t):$(e).val(e.value)}}(this),0)})},setTimeout(function(){window.onkeydown=function(e){return $(e.target).is("body")&&window.lastActiveCellScope&&window.lastActiveCellScope.column.attributes&&"date"==window.lastActiveCellScope.column.attributes.type?(window.lastActiveCellScope.onElementKeyDown(e),!1):void 0}},500),app.filter("smartTableFilter",["$filter","$translate","smartTableUtils",function(e,t,n){var o=function(e,t,n){for(var o=!1,i=t+1;i<e.length&&0!=e[i].$$treeLevel;i++)for(var a=0;a<n.length;a++)if((getObjectValue(e[i],n[a].filterKey)+"").toLowerCase().indexOf((n[a].filterText+"").toLowerCase())>-1){o=!0;break}return o},i=function(t,n){var o=e("filter")(t,function(e,t){return e.$$treeLevel>0&&e.$$nodeIndex==n});return o=e("orderBy")(o,"$$treeLevel",!1)};return function(a,l,r,s,c,d,u,p,f){var g;if(0==l.length)if(a)if(s){var m=-1,h=-1;g=e("filter")(a,function(e,t){if(0==e.$$treeLevel)m++,h=t,e.$$enableTreeView=!1;else try{a[h].$$enableTreeView=!0}catch(n){}return e.$$nodeIndex=m,e.$$index=(p?d:0)+t,e.$$parentIndex=h,e.$$isExpanded=a[h].$$isExpanded||!c,e.$$isSelectable=angular.isUndefined(e.$$isSelectable)?!0:e.$$isSelectable,0==e.$$treeLevel||e.$$isExpanded})}else g=e("filter")(a,function(e,t){return e.$$index=(p?d:0)+t,e.$$isSelectable=angular.isUndefined(e.$$isSelectable)?!0:e.$$isSelectable,!0});else g=[];else{var v,y=0,m=-1,h=-1;g=s?e("filter")(a,function(e,n){if(0==e.$$treeLevel)m++,h=n,e.$$enableTreeView=!1;else try{a[h].$$enableTreeView=!0}catch(i){}e.$$nodeIndex=m,e.$$index=n,e.$$parentIndex=h,e.$$isExpanded=a[h].$$isExpanded||!c,e.$$isSelectable=angular.isUndefined(e.$$isSelectable)?!0:e.$$isSelectable,y=0;for(var r=0;r<l.length;r++)v=l[r].colDef.enableTranslation&&t.instant(getObjectValue(e,l[r].filterKey)+"")||getObjectValue(e,l[r].filterKey)+"",(v.toLowerCase().indexOf((l[r].filterText+"").toLowerCase())>-1||angular.isFunction(l[r].condition)&&l[r].condition(l[r].filterText,e,l[r].colDef))&&y++;return 0==e.$$treeLevel&&y==l.length||0!=e.$$treeLevel&&e.$$isExpanded&&y==l.length||0==e.$$treeLevel&&o(a,n,l)}):e("filter")(a,function(e,n){e.$$index=n,e.$$isSelectable=angular.isUndefined(e.$$isSelectable)?!0:e.$$isSelectable,y=0;for(var o=0;o<l.length;o++)v=l[o].colDef.enableTranslation&&t.instant(getObjectValue(e,l[o].filterKey)+"")||getObjectValue(e,l[o].filterKey)+"",(v.toLowerCase().indexOf((l[o].filterText+"").toLowerCase())>-1||angular.isFunction(l[o].condition)&&l[o].condition(l[o].filterText,e,l[o].colDef))&&y++;return y==l.length})}if(r)if(s){var b=e("filter")(g,function(e){return 0==e.$$treeLevel});r.order>-1&&(b=angular.isFunction(r.condition)?r.condition(b,r.column,0==r.order?!1:!0):sortSmartTableData(b,r.column,0==r.order?!1:!0,t));var C=[];angular.forEach(b,function(e){C=C.concat([e]).concat(i(g,e.$$nodeIndex))}),g=C}else r.order>-1&&(g=angular.isFunction(r.condition)?r.condition(g,r.column,0==r.order?!1:!0):sortSmartTableData(g,r.column,0==r.order?!1:!0,t));return p||(n.broadcast("dataChange",{totalRecords:g.length,smartTableId:f}),g=g.slice(d,u),n.broadcast("pageIndexChanged",{currentPageDataLength:g.length,smartTableId:f})),g}}]),app.directive("smartTable",["$filter","$timeout","$templateCache","smartTableUtils",function(e,t,n,o){return{restrict:"EA",replace:!0,transclude:!0,scope:{smartTable:"=?"},link:function(e,t,n){var i,a,l=!1,r=[],s=0,c=0,d=1;e.filters=[],e.enableRowSelection=!1,e.enableTreeView=!1,e.showTreeView=!1,e.arrRowsPerPageOptions=[10,20,30,40,50],e.rowsPerPage="10",e.useExternalPagination=!1,e.smartTableId="smart-table-"+(new Date).getTime(),e.listeners={};var u=parseInt(e.rowsPerPage),p=function(t){a={core:{getActiveColumns:function(){return e.smartTableConfig.columnDefs},getColDefs:function(){return e.smartTableConfig.columnDefs},notifyColumnChange:function(){b("columnChange")},notifyRowDataChange:function(t){o.broadcast("rowDataChange",{rowIndex:t,smartTableId:e.smartTableId})},notifyDataChange:function(t){t?b("refresh"):o.broadcast("dataChange",{smartTableId:e.smartTableId,updateCell:!0})},refresh:function(){e.enableRowSelection=e.smartTableConfig.enableRowSelection?!0:!1,e.enableTreeView=e.smartTableConfig.enableTreeView?!0:!1,e.showTreeView=e.smartTableConfig.showTreeView?!0:!1,e.useExternalPagination=e.smartTableConfig.useExternalPagination?!0:!1,b("refresh"),angular.isFunction(t.onRefresh)&&t.onRefresh(a)},update:function(){b("dataChange")},stopEdit:function(){window.lastActiveCellScope&&(window.lastActiveCellScope.stopEdit(),window.lastActiveCellScope=void 0)},pagination:{on:{nextButtonClick:function(t,n){e.listeners.nextButtonClick=n},previousButtonClick:function(t,n){e.listeners.previousButtonClick=n},sort:function(t,n){e.listeners.sort=n},filter:function(t,n){e.listeners.filter=n}},setDataLength:function(t){e.displayedRecords=t},setData:function(t){e.smartTableConfig.data=t,e.currentPageDataLength=t.length},setOffset:function(t){e.offset=t},setLimit:function(t){e.limit=t},getOffset:function(){return e.offset},getRowsPerPage:function(){return e.rowsPerPage}},on:{columnRefresh:function(t,n){e.listeners.columnRefresh=n}}},cell:{on:{click:function(t,n){e.listeners.cellClick=n},change:function(t,n){e.listeners.cellChange=n},optionsChange:function(t,n){e.listeners.optionsChange=n},optionSelect:function(t,n){e.listeners.optionSelect=n}}},cellNav:{scrollToFocus:function(t,n){for(var o,i=!0,a=0;a<e.colDefs.length;a++)if(e.colDefs[a].field==n){o=a;break}e.enableTreeView&&e.showTreeView&&!e.smartTableConfig.data[e.smartTableConfig.data[t].$$parentIndex].$$isExpanded&&(e.pendingFocus={rowIndex:t,columnIndex:o},e.smartTableConfig.data[e.smartTableConfig.data[t].$$parentIndex].$$isExpanded=!0,i=!1),t>(e.limit>e.displayedRecords?e.displayedRecords:e.limit)-1?(e.pendingFocus={rowIndex:t,columnIndex:o},e.updatePagination(!0,!1)):t<e.offset?(e.pendingFocus={rowIndex:t,columnIndex:o},e.updatePagination(!1,!1)):i&&(e.pendingFocus=void 0,$("#"+e.smartTableId+"-smart-table-cell-"+((e.pinnedColumns.length+e.unpinnedColumns.length)*(t-e.offset)+o)).focus()),document.getSelection().removeAllRanges()}},edit:{on:{beginCellEdit:function(t,n){e.listeners.beginCellEdit=n},endCellEdit:function(t,n){e.listeners.endCellEdit=n},afterCellEdit:function(t,n){e.listeners.afterCellEdit=n}}},saveState:{save:function(){for(var t=[],n=v(e.smartTableConfig.columnDefs),o=0;o<n.length;o++)t.push({displayKey:n[o].displayKey,displayName:n[o].displayName,field:n[o].field,width:n[o].width,visible:n[o].visible});return{columns:JSON.stringify(t),filters:e.filters,sort:e.sortState,enableRowSelection:e.enableRowSelection,enableTreeView:e.enableTreeView,showTreeView:e.showTreeView,pagination:{pageIndex:s,limit:u,paginationCurrentPage:1,paginationPageSize:10},timestamp:new Date,documentURL:window.location.href,isSmartTable:!0}},restore:function(n,o){o.isSmartTable?(e.enableRowSelection=o.enableRowSelection?!0:!1,e.enableTreeView=o.enableTreeView?!0:!1,e.showTreeView=o.showTreeView?!0:!1,o.filters&&!e.useExternalPagination&&(e.filters=o.filters),angular.isDefined(o.columns)&&(e.smartTableConfig.columnDefs=h(o.columns)),e.useExternalPagination||(o.pagination&&(s=o.pagination.limit>10?0:o.pagination.pageIndex,u=10,e.offset=s*u,e.limit=s*u+u,e.rowsPerPage="10"),o.sort&&(e.sortState=o.sort,d=o.sort.order)),y(),angular.isFunction(t.onRefresh)&&t.onRefresh(a)):(e.enableRowSelection=e.smartTableConfig.enableRowSelection?!0:!1,e.enableTreeView=e.smartTableConfig.enableTreeView?!0:!1,e.showTreeView=e.smartTableConfig.showTreeView?!0:!1,b("refresh"))}},selection:{clearSelectedRows:function(){for(var t=0;t<e.smartTableConfig.data.length;t++)e.smartTableConfig.data[t].$$isSelected=!1;r=[],e.isAllRowSelected=!1},getSelectedRows:function(){for(var t,n=[],o=[],i=0;i<r.length;i++)t=angular.copy(e.smartTableConfig.data[r[i]]),t?(t.$$isSelected=!1,n.push({entity:t,index:r[i]})):o.push(i);for(var i=o.length-1;i>=0;i--)r.splice(o[i],1);return n},on:{rowSelectionChanged:function(t,n){e.listeners.rowSelectionChanged=n}}},options:e.smartTableConfig},angular.isFunction(t.onRegister)&&t.onRegister(a)},f=e.$watch("smartTable",function(t){t&&(e.smartTableConfig=t,e.enableRowSelection=e.smartTableConfig.enableRowSelection?!0:!1,e.enableTreeView=e.smartTableConfig.enableTreeView?!0:!1,e.showTreeView=e.smartTableConfig.showTreeView?!0:!1,e.useExternalPagination=e.smartTableConfig.useExternalPagination?!0:!1,e.smartTableConfig.columnDefs=t.columnDefs?t.columnDefs:[],e.smartTableConfig.data=t.data?t.data:[],b("refresh"),l||(p(e.smartTable),l=!0))}),g=function(e,t){for(var n=0;n<e.length;n++)if(e[n].field==t)return e[n]},m=function(t){for(var n=0;n<e.filters.length;n++)if(e.filters[n].filterKey==t)return e.filters[n].filterText},h=function(t){t="string"==typeof t?JSON.parse(t):t;for(var n=0;n<e.smartTableConfig.columnDefs.length;n++)if(angular.isUndefined(g(t,e.smartTableConfig.columnDefs[n].field)))return e.smartTableConfig.columnDefs;for(var o,i=[],n=0;n<t.length;n++){if(o=g(e.smartTableConfig.columnDefs,t[n].field),angular.isUndefined(o))return e.smartTableConfig.columnDefs;i.push(angular.extend(o,{width:t[n].width,visible:angular.isUndefined(t[n].visible)?o.visible:t[n].visible,filterText:m(t[n].field)}))}return i},v=function(e){for(var t=[],n=[],o=0;o<e.length;o++)e[o].pinnedLeft?t.push(e[o]):n.push(e[o]);return t.concat(n)},y=function(){for(var n=[],o=[],i=0,a=angular.copy(e.smartTableConfig.columnDefs),l=[],r=(e.enableRowSelection?40:0)+(e.enableTreeView&&e.showTreeView?40:0),s=0;s<a.length;s++)0!=a[s].visible&&(a[s].pinnedLeft?n.push(a[s]):(a[s].pinnedLeft=!1,o.push(a[s])));a=n.concat(o),n=[],o=[];for(var s=0;s<a.length;s++)0!=a[s].visible&&(a[s].left=r,r+=a[s].width,a[s].pinnedLeft?(i+=a[s].visible?a[s].width?a[s].width:"100":0,n.push(a[s])):o.push(a[s]));l=n.concat(o),e.colDefs=angular.copy(l),$(t.find(".smart-table-unpinned-container")).css("margin-left",i+(e.enableRowSelection?40:0)+(e.enableTreeView&&e.showTreeView?40:0)),e.pinnedColumns=n,e.unpinnedColumns=o,e.updateSmartTableColumnResizer=!0,e.updateSmartTableColumnSorter=!0},b=function(t){switch(t){case"refresh":s=0,e.rowsPerPage="10",u=parseInt(e.rowsPerPage),c=0,d=1;for(var n=0;n<e.smartTableConfig.columnDefs.length;n++)e.smartTableConfig.columnDefs[n].filterText="";e.filters=[],e.sortState=void 0,e.isRowSelectionEnabled=!0,e.isAllRowSelected=!1,y(),e.updatePagination(!1,!0);break;case"columnChange":case"dataChange":y()}};e.updatePagination=function(t,n){return e.useExternalPagination?void(t?angular.isFunction(e.listeners.nextButtonClick)&&e.listeners.nextButtonClick():angular.isFunction(e.listeners.previousButtonClick)&&e.listeners.previousButtonClick()):void(n?(e.offset=0,e.limit=parseInt(e.rowsPerPage),s=0):(t&&i>s?s++:!t&&s>0&&s--,e.offset=s*u,e.limit=s*u+u))},e.onRowsPerPageOptionChange=function(t){u=parseInt(t),e.updatePagination(!1,!0)},e.filterData=function(t){for(var n=0;n<e.filters.length;n++)if(e.filters[n].filterKey==t.field)return""==t.filterText.trim()?e.filters.splice(n,1):e.filters[n].filterText=t.filterText,void e.updatePagination(!1,!0);e.filters.push({filterKey:t.field,filterText:t.filterText,colDef:t,condition:t.hasOwnProperty("filter")&&t.filter.condition}),e.updatePagination(!1,!0)},e.sortData=function(t){o.debounce.add(function(){(e.sortState&&e.sortState.column.field!=t.field||-1>d)&&(d=1),y(),e.updatePagination(!1,!0),e.sortState={column:t,order:d,condition:t.sortCondition},d--},250)},e.selectRow=function(t,n,o){if(o){e.isAllRowSelected=!e.isAllRowSelected,e.isAllRowSelected&&(r=[]);for(var i=0;i<e.smartTableConfig.data.length;i++)e.smartTableConfig.data[i].$$isSelected=e.smartTableConfig.data[i].$$isSelectable&&e.isAllRowSelected,e.isAllRowSelected&&e.smartTableConfig.data[i].$$isSelected&&r.push(i);e.isAllRowSelected||(r=[])}else t.$$isSelected=t.$$isSelectable&&!t.$$isSelected,t.$$isSelected?r.push(n):r.indexOf(n)>-1&&r.splice(r.indexOf(n),1),e.isAllRowSelected=r.length==e.smartTableConfig.data.length;angular.isFunction(e.listeners.rowSelectionChanged)&&e.listeners.rowSelectionChanged({row:{entity:t,index:n,isSelected:e.isAllRowSelected||t&&t.$$isSelected}})},e.expandRow=function(t,n,o){if(o){for(var i=0;i<e.smartTableConfig.data.length;i++)0==e.smartTableConfig.data[i].$$treeLevel&&(e.smartTableConfig.data[i].$$isExpanded=!e.isAllRowExpanded);e.isAllRowExpanded=!e.isAllRowExpanded,e.updatePagination(!1,!0)}else{if(t.$$treeLevel>0)return;t.$$isExpanded=!t.$$isExpanded,e.isAllRowExpanded=!1}},e.onColumnSort=function(t){var n,o,i=angular.copy(e.colDefs),a=i[t.startIndex],l=i[t.endIndex];a.pinnedLeft==l.pinnedLeft&&a.field!=l.field&&e.$apply(function(){for(var t=0;t<e.smartTableConfig.columnDefs.length&&(e.smartTableConfig.columnDefs[t].field!=a.field||(n=t,!angular.isDefined(o)))&&(e.smartTableConfig.columnDefs[t].field!=l.field||(o=t,!angular.isDefined(n)));t++);var i=angular.copy(e.smartTableConfig.columnDefs),r=i.splice(n,1);i.splice(o,0,r[0]),e.smartTableConfig.columnDefs=angular.copy(i),i=null,b("columnChange"),angular.isFunction(e.listeners.columnRefresh)&&e.listeners.columnRefresh(e.colDefs)})},e.onColumnResize=function(t){for(var n,o=angular.copy(e.colDefs),i=0;i<o.length;i++)if(t.columnIndex==i){n=o[i];break}for(var i=0;i<e.smartTableConfig.columnDefs.length;i++)if(e.smartTableConfig.columnDefs[i].field==n.field){e.smartTableConfig.columnDefs[i].width=t.width;break}b("columnChange"),angular.isFunction(e.listeners.columnRefresh)&&e.listeners.columnRefresh(e.colDefs)};var C;e.onSmartTableRenderingStart=function(){C=e.$$watchers,e.$$watchers=[]},e.onSmartTableRenderingDone=function(){C&&(e.$$watchers=C),C=void 0};var w=(o.on("dataChange",function(t){angular.isDefined(t.totalRecords)&&t.smartTableId==e.smartTableId&&(i=Math.ceil(t.totalRecords/u)-1,e.displayedRecords=t.totalRecords)}),o.on("pageIndexChanged",function(t){t.smartTableId==e.smartTableId&&(e.currentPageDataLength=t.currentPageDataLength)})),S=e.$watch("currentPageDataLength",function(t){0==t&&s>0&&e.updatePagination(!1,!1)});e.$on("$destroy",function(){f(),w(),S()})},templateUrl:"shared/directives/smartTable/smartTableTemplate.html"}}]),app.service("smartTableUtils",["$timeout",function(e){var t=this,n=[],o=0;this.removeEventListener=function(e){for(var t=0;t<n.length;t++)if(n[t].eventName==e.eventName&&n[t].eventId==e.eventId){n[t].callback=null,n.splice(t,1);break}},this.on=function(e,i){o++,n.push({eventName:e,callback:i,eventId:"smart-broadcast-event-"+o});var a={eventName:e,eventId:"smart-broadcast-event-"+o};return function(){t.removeEventListener(a)}},this.broadcast=function(e,t){for(var o=0;o<n.length;o++)e==n[o].eventName&&angular.isFunction(n[o].callback)&&n[o].callback(t)};var i,a;this.debounce={add:function(t,n,o){i&&(angular.isDefined(o)&&0==o?clearTimeout(i):e.cancel(i)),i=angular.isDefined(o)&&0==o?setTimeout(function(){angular.isFunction(t)&&t()},n?n:1e3):e(function(){angular.isFunction(t)&&t()},n?n:1e3),a=!angular.isDefined(o)&&0==o},cancel:function(){a?e.cancel(i):clearTimeout(i),i=null}}}]),app.directive("smartTableCellStyle",["$compile","$timeout",function(){return{restrict:"A",link:function(e,t,n){var o=e.$watch("column",function(e){i()}),i=function(){t.removeClass("smart-table-pinned-column smart-table-unpinned-column"),e.column.pinnedLeft?(t.addClass("smart-table-pinned-column"),t.css("left",e.column.left),t.css("width",e.column.width)):t.addClass("smart-table-unpinned-column")};e.$on("$destroy",function(){o()})}}}]),app.directive("smartTableHeaderCellTextContainer",["$compile","$timeout",function(){return{restrict:"C",link:function(e,t,n){var o=e.$watch("column",function(e){i()}),i=function(){t.css("width",e.column.width-(e.column.pinnedLeft?12:0))};e.$on("$destroy",function(){o()})}}}]),app.directive("smartTableColumnResizer",[function(){return{restrict:"A",link:function(e,t,n){var o,i,a,l,r,s,c,d=0,u=function(e){o?(e.clientX>d&&(angular.isUndefined(r)||angular.isDefined(r)&&e.clientX-d<r)&&a.css({left:e.clientX}),document.getSelection().removeAllRanges()):e.offsetX>$(this).outerWidth(!0)-2-5&&e.offsetX<$(this).outerWidth(!0)-2?$(this).css("cursor","col-resize"):$(this).css("cursor","default")},p=function(t){o&&(a.off("mousemove",u),a.off("mouseup",p),a.remove(),i=!1,o=!1,c=angular.isDefined(r)&&t.clientX-d>r?r:t.clientX-d,Math.abs(c-s)>5&&e.$apply(function(){e.onColumnResize({columnIndex:l,width:20>c?20:c})}))},f=function(t){t.offsetX>=$(this).outerWidth(!0)-2-5&&t.offsetX<$(this).outerWidth(!0)-2?($(this).css("cursor","col-resize"),d=$(this).offset().left,a=$(document.createElement("div")),l=parseInt($(this).attr("column-index")),r=e.colDefs[l].maxWidth,s=e.colDefs[l].width,a.css({position:"absolute",left:$(this).offset().left+$(this).outerWidth(!0),top:$(this).offset().top,width:"1px",height:$(this).closest("table").outerHeight(!0),"z-index":1e3,border:"dotted"}),a.on("mousemove",u),a.on("mouseup",p),$(document.body).append(a),o=!0):$(this).css("cursor","default")},g=function(){setTimeout(function(){t.find("th").not(".smart-table-icon-holder").off("mousedown",f),t.find("th").not(".smart-table-icon-holder").off("mouseup",p),t.find("th").not(".smart-table-icon-holder").off("mousemove",u),t.find("th").not(".smart-table-icon-holder").on("mousedown",f),t.find("th").not(".smart-table-icon-holder").on("mouseup",p),t.find("th").not(".smart-table-icon-holder").on("mousemove",u)},250)};e.$watch("updateSmartTableColumnResizer",function(t){t&&(g(),e.updateSmartTableColumnResizer=!1)})}}}]),app.directive("smartTableColumnSorter",[function(){
return{restrict:"A",link:function(e,t,n){var o,i,a,l,r,s,c=function(e){o&&($(r).css({left:e.clientX-a}),document.getSelection().removeAllRanges())},d=function(n){if($(r).off("mousemove",c),$(r).off("mouseup",d),$(r).off("mouseleave",d),$(r).remove(),o&&"mouseup"==n.type){var a,u;t.find("th").not(".smart-table-icon-holder").each(function(e,t){angular.isUndefined(a)&&i>$(t).offset().left&&i<$(t).offset().left+$(t).outerWidth(!0)?a=e:angular.isUndefined(u)&&n.clientX>$(t).offset().left&&n.clientX<$(t).offset().left+$(t).outerWidth(!0)&&(u=e)}),angular.isDefined(a)&&angular.isDefined(u)&&e.onColumnSort({startIndex:a,endIndex:u,isPinnedColumn:l})}o=!1,s&&(clearTimeout(s),s=void 0)},u=function(e){if(!($(e.target).closest(".smart-table-search-container").length>0||e.offsetX>=$(this).outerWidth(!0)-20)){var t=this;s=setTimeout(function(){i=e.clientX,a=e.offsetX,o=!0,l=$(e.target).closest(".smart-table-pinned-column").length>0,r=$(t).clone(),$(r).on("mousemove",c),$(r).on("mouseup",d),$(r).on("mouseleave",d),$(r).css({position:"absolute",left:$(t).offset().left,top:$(t).offset().top,width:$(t).outerWidth(!0),height:$(t).outerHeight(!0),"z-index":1e3,border:"dotted"}),$(document.body).append(r),s=void 0},500)}},p=function(){setTimeout(function(){t.find("th").not(".smart-table-icon-holder").off("mousedown",u),t.find("th").not(".smart-table-icon-holder").off("mouseup",d),t.find("th").not(".smart-table-icon-holder").off("mousemove",c),t.find("th").not(".smart-table-icon-holder").on("mousedown",u),t.find("th").not(".smart-table-icon-holder").on("mousemove",c),t.find("th").not(".smart-table-icon-holder").on("mouseup",d)},250)};e.$watch("updateSmartTableColumnSorter",function(t){t&&(p(),e.updateSmartTableColumnSorter=!1)})}}}]),app.directive("smartTableCell",["$rootScope","$compile","$timeout","smartTableUtils","$filter","$translate","APPCONSTANTS","httpService",function(e,t,n,o,i,a,l,r){return{restrict:"EA",replace:!0,link:function(t,n,s){function c(){n.trigger("blur"),o.debounce.add(function(){window.isPopupOpenedByUIGridCompatibleElement=!0,angular.isFunction(I.listeners.cellClick)&&I.listeners.cellClick({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex})},100)}function d(){o.debounce.add(function(){window.isPopupOpenedByUIGridCompatibleElement=!0,angular.isFunction(I.listeners.cellClick)&&I.listeners.cellClick({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex})},100),event.stopPropagation(),event.preventDefault()}function u(){o.debounce.add(function(){window.isPopupOpenedByUIGridCompatibleElement=!0,angular.isFunction(I.listeners.cellClick)&&I.listeners.cellClick({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex})},100),event.stopPropagation(),event.preventDefault()}var p,f,g,m,h,v,y,b,C,w,S,x=!1,T=$(n.closest(".smart-table-row-cell")),D=!1,k=!1,M=!1,F=!1,I=(t.$parent.$parent.$parent,t.$parent.$parent),O=t.$watchGroup(["value","column"],function(e){p=(t.pinnedColumns.length+t.unpinnedColumns.length)*t.$parent.$index+t.$index,n.attr("id",I.smartTableId+"-smart-table-cell-"+p),n.attr("tabindex",p),g=void 0,E(!1,!0),angular.isDefined(I.pendingFocus)&&I.pendingFocus.rowIndex-I.offset==t.rowIndex&&I.pendingFocus.columnIndex==t.columnIndex&&(n.trigger("focus"),t.pendingFocus=void 0)}),E=function(e,o){if(t.row={entity:t.value},angular.isDefined(t.column)&&"editable"==t.column.uiType&&"date"==t.column.attributes.type&&isRegionalSettingEnabled&&(t.column.attributes.format=moment.localeData().longDateFormat("L").toLowerCase().replace(/m/g,"M")),t.enableCellEdit=angular.copy(t.column.enableCellEdit),T.removeClass("smart-table-row-cell-invalid smart-table-row-cell-disabled smart-table-row-cell-canceled"),$(n.closest(".smart-table-row-cell-text")).css({border:"",width:t.column.width+(t.column.pinnedLeft?-2:10)}),e||(I.hasSmartTableRenderingStarted||(t.onSmartTableRenderingStart(),I.hasSmartTableRenderingStarted=!0),t.pinned="true"==s.pinned,t.rowIndex=t.$parent.$index,t.columnIndex=t.$index,t.column.autoIncrement&&!I.useExternalPagination&&(angular.isDefined(t.row.entity.$$nodeIndex)?updateCell(t.row.entity,t.column.field,t.row.entity.$$nodeIndex+1):updateCell(t.row.entity,t.column.field,t.row.entity.$$index+1))),angular.isDefined(t.column.attributes)&&"autocomplete"==t.column.attributes.type&&angular.isDefined(t.column.attributes.displayformat)&&angular.isDefined(t.column.field)?(v=getObjectValueForAutoSuggest(t.row.entity,t.column.field),angular.isObject(v)?t.COL_FIELD=getDisplayData(v,t.column.attributes.displayformat):t.COL_FIELD=getObjectValue(t.row.entity,t.column.field)):t.COL_FIELD=getObjectValue(t.row.entity,t.column.field),angular.isFunction(t.column.cellClass)){var i=t.column.cellClass({},{entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex,value:getObjectValue(t.row.entity,t.column.field)});if(angular.isObject(i)){if(0==T.find(".smart-table-row-cell-info-icon").length){var a="";switch(i.type){case"smart-table-row-cell-info":a+='<svg><use xlink:href="#icon_Info"></use></svg>';break;default:a+='<svg><use xlink:href="#icon_Info"></use></svg>'}T.find(".smart-table-cell-text").append('<i class="icon small blue-text smart-table-row-cell-info-icon" style="float: right; line-height: 23px !important;" title="'+i.message+'">'+a+"</i>")}T.addClass(i["class"])}else T.addClass(i);g=i}angular.isFunction(t.column.cellEditableCondition)&&(t.enableCellEdit=t.column.cellEditableCondition({row:t.row,index:t.rowIndex,col:{colDef:t.column,index:t.columnIndex},grid:{rows:I.smartTableConfig.data}})),V(!0,o),e||t.$parent.$last&&t.$last&&(t.onSmartTableRenderingDone(),I.hasSmartTableRenderingStarted=!1)},P=function(e){b!="/Date("+(1e3*e.unix()+432e5)+"+0000)/"&&(b="/Date("+(1e3*e.unix()+432e5)+"+0000)/",n.find("input").val(i("smartDateFormat")(b,t.column.attributes.format)),t.column.isRegUpdateCol&&angular.isFunction(I.listeners.cellChange)&&I.listeners.cellChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex},{value:b}))},R=function(){var o,i;w=e.$on("popupOpened",function(){o=getObjectValue(t.row.entity,t.column.field)}),S=e.$on("popupClosed",function(){angular.isDefined(t.column.debounce)&&t.column.debounce>0?setTimeout(function(){i=getObjectValue(t.row.entity,t.column.field),A(o,i)},t.column.debounce):(i=getObjectValue(t.row.entity,t.column.field),A(o,i)),n.trigger("focus")})},A=function(e,n){angular.equals(e,n)||(t.COL_FIELD=n,V(!0,!0),angular.isFunction(I.listeners.cellChange)&&I.listeners.cellChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex}))},L=function(){angular.isFunction(w)&&w(),angular.isFunction(S)&&S()},V=function(e,o){if(angular.isFunction(t.column.cellTemplate))return m=t.column.cellTemplate({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex}),"popup"==t.column.uiType&&angular.isNumber(m)&&(m=angular.isDefined(t.column.attributes.minmaxprecisionfilter)?i("minPrecisionHandler")(m,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1],!1):i("minPrecisionHandler")(m)),n.find(".smart-table-cell-template").html(("popup"==t.column.uiType?"<a"+(t.column.enableCellEdit&&t.enableCellEdit?"":' class="disabled" ')+">":"<span>")+m+("popup"==t.column.uiType?"</a>":"</span>")),void n.parent().attr("title",m);if("editable"==t.column.uiType){switch(t.column.attributes.type){case"number":e&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)&&(t.COL_FIELD=i("minPrecisionHandler")(t.COL_FIELD,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1],!1));break;case"date":e&&(t.COL_FIELD=""==t.COL_FIELD||void 0==t.COL_FIELD||null==t.COL_FIELD?"":i("smartDateFormat")(t.COL_FIELD,t.column.attributes.format));break;default:o&&t.column.enableTranslation&&(t.COL_FIELD=a.instant(t.COL_FIELD)),e&&angular.isDefined(t.column.attributes.maxlength)&&angular.isDefined(t.COL_FIELD)&&(t.COL_FIELD=t.COL_FIELD.substr(0,t.column.attributes.maxlength))}if(m=void 0==t.COL_FIELD||null==t.COL_FIELD?"":t.COL_FIELD,n.find(".smart-table-cell-template").html("<span>"+m+"</span>"),"editable"==t.column.uiType&&t.column.adhocpopup&&"adhocpopup"===t.column.adhocpopup){var l=$('<i style="float: right" class="icon small blue-text smart-table-row-cell-info-icon" style="float: right; line-height: 23px !important;" title="'+a.instant("P2P_Common_AddAdhocLocation")+'"><svg><use xlink:href="#icon_Location"></use></svg></i>');l.mousedown(function(){d()}),n.find(".smart-table-cell-template").append(l)}else if("editable"==t.column.uiType&&t.column.supplierCardPopup&&"supplierCardPopup"===t.column.supplierCardPopup){var l=$('<i style="float: right" class="icon small blue-text smart-table-row-cell-info-icon" style="float: right; line-height: 23px !important;" title="'+a.instant("P2P_Req_SupplierName")+'"><svg><use xlink:href="#icon_ContactCard"></use></svg></i>');l.mousedown(function(){u()}),n.find(".smart-table-cell-template").append(l)}if(void 0!=t.row.entity.RequisitionSource&&3==t.row.entity.RequisitionSource&&"editable"==t.column.uiType&&t.column.Changereq&&"Changereq"===t.column.Changereq&&void 0!=t.row.entity.IsAddedFromRequistion)if(1==t.row.entity.IsAddedFromRequistion);else{var l=$('<i  style="float: right" class="icon small red-text smart-table-row-cell-info-icon" style="float: right; line-height: 23px !important;" title=""><svg><use xlink:href="#icon_AddToDefault "></use></svg></i>');n.find(".smart-table-cell-template").append(l)}}else if("popup"==t.column.uiType)m=""===t.COL_FIELD||void 0==t.COL_FIELD||null==t.COL_FIELD?t.column.placeHolder?t.column.placeHolder:a.instant("P2P_Common_Add"):t.COL_FIELD,angular.isNumber(m)&&(m=angular.isDefined(t.column.attributes.minmaxprecisionfilter)?i("minPrecisionHandler")(m,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1],!1):i("minPrecisionHandler")(m)),n.find(".smart-table-cell-template").html("<a"+(t.column.enableCellEdit&&t.enableCellEdit?"":' class="disabled" ')+">"+m+"</a>");else if("dropdown"==t.column.uiType)m=o&&t.column.enableTranslation?a.instant(t.COL_FIELD):t.COL_FIELD,n.find(".smart-table-cell-template").html("<span>"+m+"</span>");else if("taxesPopup"==t.column.uiType){if(m=t.row.entity[t.column.field],angular.isNumber(m)&&(m=angular.isDefined(t.column.attributes.minmaxprecisionfilter)?i("minPrecisionHandler")(m,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1],!1):i("minPrecisionHandler")(m)),n.find(".smart-table-cell-template").html("<a"+(t.column.enableCellEdit&&t.enableCellEdit?"":' class="disabled" ')+">"+m+"</a>"),t.row.entity.isTaxExempt){var r=$("<a>"+a.instant("P2P_Common_Exempt")+"</a>");r.mousedown(function(){c()}),n.find(".smart-table-cell-template").html(r)}var l=$('<i style="float: right" class="icon iconSmall tooltipped" smart-tooltip position="bottom" delay="50" message="ADD"><svg><use xlink:href="#icon_CirclePlus"></use></svg></i>');l.mousedown(function(){c()}),n.find(".smart-table-cell-template").append(l),n.parent().attr("title",m)}else e&&t.column.attributes&&"number"==t.column.attributes.type&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)&&(t.COL_FIELD=i("minPrecisionHandler")(t.COL_FIELD,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1],!1)),m=o&&t.column.enableTranslation?a.instant(t.COL_FIELD):void 0==t.COL_FIELD||null==t.COL_FIELD?"":t.COL_FIELD,n.find(".smart-table-cell-template").html("<span>"+m+"</span>");n.parent().attr("title",m)},N=function(){var e="<div>";switch(t.column.uiType){case"editable":switch(t.column.attributes.type){case"number":h=parseFloat(getObjectValue(t.row.entity,t.column.field)),!isRegionalSettingEnabled&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)&&(h=convertNumberToFixed(h,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1])),e+='<input type="number" autocomplete="off" value="'+(0==h?"":h)+'">';break;case"date":e+='<input type="text" autocomplete="off" value="'+(void 0==t.COL_FIELD||null==t.COL_FIELD?"":t.COL_FIELD)+'" placeholder="'+(t.column.attributes.format?t.column.attributes.format.toUpperCase():"MM/DD/YYYY")+'">';break;default:e+='<input type="text" autocomplete="off" value="'+(void 0==t.COL_FIELD||null==t.COL_FIELD?"":t.COL_FIELD)+'"'+(angular.isDefined(t.column.attributes.maxlength)?'maxlength="'+t.column.attributes.maxlength:'"')+">"}break;case"dropdown":case"select":e+='<select style="display: block !important;">';for(var n=0;n<t.column.attributes.options.length;n++)e+="<option "+(a.instant(t.column.attributes.options[n][t.column.attributes.dataKey]+"")==a.instant(t.COL_FIELD+"")?"selected":"")+' value="'+a.instant(t.column.attributes.options[n][t.column.attributes.idKey]+"")+'">'+a.instant(t.column.attributes.options[n][t.column.attributes.dataKey]+"")+"</option>";e+="</select>"}return e+"</div>"},H=function(e){switch(window.lastKeyPressed=e.keyCode,e.keyCode){case 32:if("editable"==t.column.uiType&&n.find("input").length>0){if(n.find("input:focus").length>0&&(k=!0),"date"==t.column.attributes.type)return n.find("input").focus(),e.stopPropagation(),!1;if(!k)return k=!0,h=n.find("input").val(),n.find("input").focus().val("").val(h),e.stopPropagation(),!1}else{if(!("dropdown"==t.column.uiType&&n.find("select").length>0))return"popup"==t.column.uiType&&t.column.enableCellEdit&&angular.isFunction(t.column.cellEditableCondition)&&t.column.cellEditableCondition({row:t.row,col:{colDef:t.column},grid:{rows:I.smartTableConfig.data}})&&t.column.isRegClickCol?(o.debounce.add(function(){window.isPopupOpenedByUIGridCompatibleElement=!0,angular.isFunction(I.listeners.cellClick)&&I.listeners.cellClick({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex})},100),e.stopPropagation(),!1):(e.stopPropagation(),!1);n.find("select").focus()}break;case 37:if(!k)return n.find("input:focus").length>0?void(k=!0):(0==t.rowIndex&&0==t.columnIndex||($("#"+I.smartTableId+"-smart-table-cell-"+(parseInt(p)-1)).focus(),t.stopEdit()),e.stopPropagation(),!1);break;case 39:case 9:if(39!=e.keyCode)return e.shiftKey?0==t.rowIndex&&0==t.columnIndex||($("#"+I.smartTableId+"-smart-table-cell-"+(parseInt(p)-1)).focus(),t.stopEdit()):($("#"+I.smartTableId+"-smart-table-cell-"+(parseInt(p)+1)).focus(),t.stopEdit()),e.stopPropagation(),!1;if(!k)return n.find("input:focus").length>0?void(k=!0):(t.$parent.$last&&t.$last?$("#"+I.smartTableId+"-smart-table-cell-0").focus():$("#"+I.smartTableId+"-smart-table-cell-"+(parseInt(p)+1)).focus(),t.stopEdit(),e.stopPropagation(),!1);break;case 38:if(t.rowIndex>0){var a=parseInt(p)-(I.pinnedColumns.length+I.unpinnedColumns.length);$("#"+I.smartTableId+"-smart-table-cell-"+a).focus(),t.stopEdit()}return e.stopPropagation(),!1;case 40:case 13:if(t.rowIndex<I.currentPageDataLength-1){var a=parseInt(p)+(I.pinnedColumns.length+I.unpinnedColumns.length);$("#"+I.smartTableId+"-smart-table-cell-"+a).focus(),t.stopEdit()}return e.stopPropagation(),!1;case 27:if(("editable"==t.column.uiType||"dropdown"==t.column.uiType)&&("autocomplete"!=t.column.attributes.type||"autocomplete"==t.column.attributes.type&&t.column.isFreeText&&!y)){if(k=!1,"number"==t.column.attributes.type){if(h=parseFloat(f),!isRegionalSettingEnabled&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)&&(h=convertNumberToFixed(h,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1])),n.find("input").val(0==h?"":h).blur(),isRegionalSettingEnabled)try{n.find("input").autoNumeric("get")}catch(e){}updateCell(t.row.entity,t.column.field,f)}else if("date"==t.column.attributes.type)n.find("input").val(i("smartDateFormat")(f,t.column.attributes.format)).blur(),updateCell(t.row.entity,t.column.field,f),b=void 0;else if("dropdown"==t.column.uiType){for(var l,r=0;r<t.column.attributes.options.length;r++)if(f==t.column.attributes.options[r][t.column.attributes.dataKey]){l=t.column.attributes.options[r],updateCell(t.row.entity,t.column.field,t.column.attributes.options[r]);break}n.find("select").val(l[t.column.attributes.idKey]).blur()}else n.find("input").val(f).blur(),updateCell(t.row.entity,t.column.field,f);M=!0,F=!0,n.focus(),"number"==t.column.attributes.type&&t.column.isRegUpdateCol?o.debounce.add(function(){angular.isFunction(I.listeners.cellChange)&&I.listeners.cellChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex}),o.broadcast("rowDataChange",{rowIndex:t.rowIndex,smartTableId:I.smartTableId})},250,!1):"date"==t.column.attributes.type?t.column.isRegUpdateCol&&angular.isFunction(I.listeners.cellChange)&&I.listeners.cellChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex},{value:b}):"dropdown"==t.column.uiType&&angular.isFunction(I.listeners.optionSelect)&&I.listeners.optionSelect({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex},{value:l})}break;default:if(e.keyCode>=112&&e.keyCode<=123||[16,20,255,17,91,18,33,34,144,45,19,145,93,173,174,175].indexOf(e.keyCode)>-1)return e.preventDefault(),!1;if(("editable"==t.column.uiType||"taxesPopup"==t.column.uiType)&&n.find("input").length>0){if(!k&&[35,36].indexOf(e.keyCode)>-1)return e.preventDefault(),!1;if(!k&&(k=!0,0==n.find("input:focus").length&&(n.find("input").focus().val(""),"number"==t.column.attributes.type&&!isRegionalSettingEnabled&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)))){var s=n.find("input").val().split(".");if(s.length>1){if(s[s.length-1].length>=t.column.attributes.minmaxprecisionfilter.split(":")[1]&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105))return e.preventDefault(),!1}else if(0==t.column.attributes.minmaxprecisionfilter.split(":")[0]&&190==e.keyCode)return e.preventDefault(),!1}}else"dropdown"==t.column.uiType&&n.find("select").length>0&&n.find("select").focus();if(8==e.keyCode&&0==n.find("input").length)return e.preventDefault(),!1}};t.onElementKeyDown=H,n.on("keydown",H),t.stopEdit=function(e){if(M=!1,F=!1,!(e&&"popup"==t.column.uiType||(t.$last&&37!=window.lastKeyPressed&&!window.isSmartTableCellClicked&&window.shiftKey&&9==window.lastKeyPressed&&$(n.closest(".smart-table-unpinned-container")).scrollLeft(0),("popup"==t.column.uiType||"taxesPopup"==t.column.uiType||t.column.adhocpopup&&"adhocpopup"===t.column.adhocpopup||t.column.supplierCardPopup&&"supplierCardPopup"===t.column.supplierCardPopup)&&t.column.isRegClickCol&&L(),D))){if(x=!1,k=!1,t.column.enableCellEdit&&angular.isFunction(t.column.cellEditableCondition)&&t.column.cellEditableCondition({row:t.row,col:{colDef:t.column},grid:{rows:I.smartTableConfig.data}})){switch(t.column.uiType){case"editable":switch(t.column.attributes.type){case"number":if(isRegionalSettingEnabled)try{t.COL_FIELD=1*n.find("input").autoNumeric("get")}catch(l){console.log(l),console.log("Error in number get. "+t.column.field)}else t.COL_FIELD=parseFloat($(n.find("input")).val());t.COL_FIELD=isNaN(t.COL_FIELD)?0:t.COL_FIELD,updateCell(t.row.entity,t.column.field,angular.copy(t.COL_FIELD)),angular.isDefined(t.column.attributes)&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)&&(t.COL_FIELD=i("minPrecisionHandler")(t.COL_FIELD,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1],!1));break;case"autocomplete":n.find("input").devbridgeAutocomplete()&&n.find("input").devbridgeAutocomplete().dispose(),y?(t.COL_FIELD=angular.isDefined(t.column.attributes.displayformat)?getDisplayData(y,t.column.attributes.displayformat):$(n.find("input")).val(),updateCell(t.row.entity,t.column.field,y),y=void 0):t.column.isFreeText?(t.COL_FIELD=$(n.find("input")).val(),updateCell(t.row.entity,t.column.field,t.COL_FIELD)):t.COL_FIELD=getObjectValue(t.row.entity,t.column.field);break;case"date":n.find("input").daterangepicker()&&n.find("input").daterangepicker().daterangepicker(),""==b?(t.COL_FIELD="",updateCell(t.row.entity,t.column.field,null)):angular.isDefined(b)&&b.indexOf("Date")>-1?(t.COL_FIELD=i("smartDateFormat")(b,t.column.attributes.format),updateCell(t.row.entity,t.column.field,b)):t.COL_FIELD=i("smartDateFormat")(getObjectValue(t.row.entity,t.column.field),t.column.attributes.format),b=void 0;break;default:t.COL_FIELD=$(n.find("input")).val(),updateCell(t.row.entity,t.column.field,t.COL_FIELD)}break;case"dropdown":case"select":for(var r=0;r<t.column.attributes.options.length;r++)if($(n.find("select")).val()==t.column.attributes.options[r][t.column.attributes.idKey]){t.COL_FIELD=t.column.attributes.options[r][t.column.attributes.dataKey],updateCell(t.row.entity,t.column.field,t.column.attributes.options[r]);break}t.COL_FIELD=t.column.enableTranslation?a.instant(t.COL_FIELD):t.COL_FIELD;break;case"taxesPopup":if(isRegionalSettingEnabled)try{n.find("input").length>0&&(t.COL_FIELD=1*n.find("input").autoNumeric("get"))}catch(l){console.log(l),console.log("Error in number get. "+t.column.field)}else t.COL_FIELD=parseFloat($(n.find("input")).val());t.COL_FIELD=isNaN(t.COL_FIELD)?0:t.COL_FIELD,updateCell(t.row.entity,t.column.field,angular.copy(t.COL_FIELD)),angular.isDefined(t.column.attributes)&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)&&(t.COL_FIELD=i("minPrecisionHandler")(t.COL_FIELD,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1],!1))}V()}$(n.closest(".smart-table-row-cell-text")).css("border",""),C&&C.empty(),t.column.enableCellEdit&&f!=t.COL_FIELD&&(f!=t.COL_FIELD&&(angular.isFunction(I.listeners.afterCellEdit)&&I.listeners.afterCellEdit({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex}),o.broadcast("rowDataChange",{rowIndex:t.rowIndex,smartTableId:I.smartTableId})),angular.isFunction(I.listeners.endCellEdit)&&I.listeners.endCellEdit({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex})),!t.column.enableCellEdit||"popup"!=t.column.uiType&&"taxesPopup"!=t.column.uiType||o.broadcast("rowDataChange",{rowIndex:t.rowIndex,smartTableId:I.smartTableId}),D=!0}};var K=function(e){if(M)return void(n.find("input").length>0&&!F&&n.find("input").focus());if(f=t.column.enableTranslation?a.instant(t.COL_FIELD):"editable"!=t.column.uiType||"date"!=t.column.attributes.type&&"number"!=t.column.attributes.type?t.COL_FIELD:getObjectValue(t.row.entity,t.column.field),t.$last&&(window.lastKeyPressed=37),window.lastActiveCellScope&&(window.lastActiveCellScope.stopEdit(),window.lastActiveCellScope=void 0),window.lastActiveCellScope=t,D=!1,I.pinnedColumns.length==t.$index&&setTimeout(function(){$(n.closest(".smart-table-unpinned-container")).scrollLeft(0)},250),("popup"==t.column.uiType||"taxesPopup"==t.column.uiType||t.column.adhocpopup&&"adhocpopup"===t.column.adhocpopup||t.column.supplierCardPopup&&"supplierCardPopup"===t.column.supplierCardPopup)&&t.column.enableCellEdit&&angular.isFunction(t.column.cellEditableCondition)&&t.column.cellEditableCondition({row:t.row,col:{colDef:t.column},grid:{rows:I.smartTableConfig.data}})&&t.column.isRegClickCol&&R(),window.isSmartTableCellClicked=!1,$(n.closest(".smart-table-row-cell-text")).css("border","1px solid "+(T.hasClass("smart-table-row-cell-invalid")?"red":"#159dfc")),!x&&t.column.enableCellEdit&&(!angular.isFunction(t.column.cellEditableCondition)||t.column.cellEditableCondition({row:t.row,col:{colDef:t.column},grid:{rows:I.smartTableConfig.data}}))){if(angular.isFunction(I.listeners.beginCellEdit)&&I.listeners.beginCellEdit({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex}),"popup"!=t.column.uiType)if($(n.find(".smart-table-cell-template")).html(N()),"editable"==t.column.uiType&&t.column.adhocpopup&&"adhocpopup"===t.column.adhocpopup){var i=$('<i style="float: right" class="icon small blue-text smart-table-row-cell-info-icon" style="float: right; line-height: 23px !important;" title="'+a.instant("P2P_Common_AddAdhocLocation")+'"><svg><use xlink:href="#icon_Location"></use></svg></i>');i.mousedown(function(){d()});var s=$(n.find(".smart-table-cell-template")).html(N()).css("width",$(n.find(".smart-table-cell-template")).parent().width()-40+"px");$(n.find(".smart-table-cell-template")).append(s).append(i)}else if("editable"==t.column.uiType&&t.column.supplierCardPopup&&"supplierCardPopup"===t.column.supplierCardPopup){var i=$('<i style="float: right" class="icon small blue-text smart-table-row-cell-info-icon" style="float: right; line-height: 23px !important;" title="'+a.instant("P2P_Req_SupplierName")+'"><svg><use xlink:href="#icon_ContactCard"></use></svg></i>');i.mousedown(function(){u()}),n.find(".smart-table-cell-template").append(i)}if("taxesPopup"==t.column.uiType){var p=parseFloat(getObjectValue(t.row.entity,t.column.field));!isRegionalSettingEnabled&&angular.isDefined(t.column.attributes.minmaxprecisionfilter)&&(p=convertNumberToFixed(p,t.column.attributes.minmaxprecisionfilter.split(":")[0],t.column.attributes.minmaxprecisionfilter.split(":")[1]));var g=$('<input  type="number" autocomplete="off" value="'+(0==p?"":p)+'">');t.row.entity.isTaxExempt&&(g=$("<a>"+a.instant("P2P_Common_Exempt")+"</a>"),g.mousedown(function(){c()}));var i=$('<i style="float: right" class="icon iconSmall tooltipped"><svg><use xlink:href="#icon_CirclePlus"></use></svg></i>');i.mousedown(function(){c()}),g.css("width",$(n.find(".smart-table-cell-template")).parent().width()-40+"px"),$(n.find(".smart-table-cell-template")).html("").append(g).append(i)}switch(t.column.uiType){case"editable":switch(t.column.attributes.type){case"number":setTimeout(function(){var e;if(isRegionalSettingEnabled)try{n.find("input").attr("type","text");var i=void 0!=t.column.attributes.minmaxprecisionfilter&&""!=t.column.attributes.minmaxprecisionfilter.split(":")[1]?t.column.attributes.minmaxprecisionfilter.split(":")[1]:MaxPrecessionValue;n.find("input").autoNumeric("init",{mDec:i})}catch(a){console.log("Error in number init. "+t.column.field)}else if(angular.isDefined(t.column.attributes.minmaxprecisionfilter)){var l;n.find("input").on("keydown",function(e){if(l=$(this).val().split("."),l.length>1){if(l[l.length-1].length>=t.column.attributes.minmaxprecisionfilter.split(":")[1]&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105))return e.preventDefault(),!1}else if(0==t.column.attributes.minmaxprecisionfilter.split(":")[0]&&190==e.keyCode)return e.preventDefault(),!1})}n.find("input").on("keyup",function(n){if(isRegionalSettingEnabled)try{e=1*$(this).autoNumeric("get")}catch(i){console.log("Error in number format. "+t.column.field)}else{if(e==$(this).val())return;e=$(this).val()}t.column.isRegUpdateCol&&o.debounce.add(function(){updateCell(t.row.entity,t.column.field,parseFloat(e)),angular.isFunction(I.listeners.cellChange)&&I.listeners.cellChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex}),o.broadcast("rowDataChange",{rowIndex:t.rowIndex,smartTableId:I.smartTableId})},250,!1)})});break;case"autocomplete":var m=t.column.attributes.filterkeys?t.column.attributes.filterkeys:["title"],h=t.column.attributes.optionformat?t.column.attributes.optionformat:"{title}",v=t.column.attributes.displayformat?t.column.attributes.displayformat+"":"{title}";setTimeout(function(){var e=t.column.attributes.serviceObj,i=f;if(n.find("input").on("keyup",function(a){angular.isDefined(i)&&$(this).val().trim().length>0&&i.trim()==$(this).val().trim()||(i=$(this).val(),[37,38,39,40].indexOf(a.keyCode)>-1||(angular.isFunction(I.listeners.cellChange)&&I.listeners.cellChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex},{value:i}),(!angular.isDefined(i)||0!=i.trim().length||t.column.attributes.populateListOnFocus)&&o.debounce.add(function(){if(void 0!=e){var o={method:"POST"===e.method?"POST":"GET",url:e.url,params:JSON.parse(JSON.stringify(e.param).replace("@term",i)),timeout:12e4,headers:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(l.userPreferences.UserBasicDetails)}};"POST"==o.method&&(o.data=JSON.parse(JSON.stringify(e.param).replace("@term",i)),delete o.params),r.directhttp(o).then(function(o){e.CallbackObj&&(o=e.CallbackObj(o,t.column.field));var a=[];if("string"==typeof o&&(o=JSON.parse(o)),e.isFlatArray?_.each(o,function(e,t){var n={};n.name=e,n.code=e,a.push(n)}):_.each(o,function(t){var n=e.isObjectArray?t:{};_.each(e.mapper,function(e){var o="";if(angular.isArray(e.toBeMapped)){var i=e.key;_.each(e.toBeMapped,function(e){o+=void 0!=i&&"email"==i&&"EmailAddress"==e?"</br>"+t[e]+" ":t[e]+" "}),o.trim()}else o=t[e.toBeMapped];n[e.key]=o}),_.each(e.staticValues,function(e){n[e.key]=e.value}),a.push(n)}),n.find("input").devbridgeAutocomplete()?n.find("input").devbridgeAutocomplete().setLookup(getFormattedData(a,v)):n.find("input").devbridgeAutocomplete({filterKeys:m,optionFormat:h,displayFormat:v,lookup:getFormattedData(a,v),width:t.column.width,minChars:t.column.attributes.populateListOnFocus?0:1,onSelect:function(e){y=e,M=!0,n.find("input").devbridgeAutocomplete().setLookup([]),angular.isFunction(I.listeners.optionSelect)&&I.listeners.optionSelect({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex},{value:i,option:y}),n.trigger("focus")}}),1==a.length&&t.column.attributes.populateListOnFocus)try{n.find("input").devbridgeAutocomplete().onSelect(0)}catch(l){}else angular.isFunction(I.listeners.optionsChange)&&I.listeners.optionsChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex},{value:i,options:o})},function(){})}},250,!1)))}),t.column.attributes.populateListOnFocus){var a=function(){if(!k){var e=$.Event("keyup",{keyCode:32});n.find("input").trigger(e),k=!0}};n.find("input").on("click",function(e){a()}),n.find("input:focus").length>0&&a()}});break;case"date":setTimeout(function(){n.find("input").on("keyup",function(e){b=$(this).val()}),n.find("input").daterangepicker({singleDatePicker:!0,showDropdowns:!0,locale:{format:t.column.attributes.format?t.column.attributes.format.toUpperCase():"MM/DD/YYYY"},minDate:t.column.attributes.min?t.column.attributes.min:null,maxDate:t.column.attributes.max?t.column.attributes.max:null,autoUpdateInput:!1},function(e,t){P(e)}).on("apply.daterangepicker",function(e,t){P(t.startDate)})})}break;case"dropdown":angular.isFunction(I.listeners.optionSelect)&&setTimeout(function(){n.find("select").on("change",function(){for(var e=0;e<t.column.attributes.options.length;e++)if($(this).val()==t.column.attributes.options[e][t.column.attributes.idKey]+""){I.listeners.optionSelect({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex},{value:t.column.attributes.options[e]});break}})});break;case"taxesPopup":setTimeout(function(){var e;if(isRegionalSettingEnabled)try{n.find("input").attr("type","text"),n.find("input").autoNumeric("init")}catch(i){console.log("Error in number init. "+t.column.field)}else if(angular.isDefined(t.column.attributes.minmaxprecisionfilter)){var a;n.find("input").on("keydown",function(e){if(a=$(this).val().split("."),a.length>1){if(a[a.length-1].length>=t.column.attributes.minmaxprecisionfilter.split(":")[1]&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105))return e.preventDefault(),!1}else if(0==t.column.attributes.minmaxprecisionfilter.split(":")[0]&&190==e.keyCode)return e.preventDefault(),!1})}n.find("input").on("keyup",function(n){if(isRegionalSettingEnabled)try{e=1*$(this).autoNumeric("get")}catch(i){console.log("Error in number format. "+t.column.field)}else{if(e==$(this).val())return;e=$(this).val()}t.column.isRegUpdateCol&&o.debounce.add(function(){updateCell(t.row.entity,t.column.field,parseFloat(e)),angular.isFunction(I.listeners.cellChange)&&I.listeners.cellChange({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex}),o.broadcast("rowDataChange",{rowIndex:t.rowIndex,
smartTableId:I.smartTableId})},250,!1)})})}I.lastActiveCell={rowIndex:t.rowIndex,columnIndex:t.columnIndex},x=!0}};n.on("focus",K),n.on("click",function(e){"popup"==t.column.uiType&&t.column.enableCellEdit&&angular.isFunction(t.column.cellEditableCondition)&&t.column.cellEditableCondition({row:t.row,col:{colDef:t.column},grid:{rows:I.smartTableConfig.data}})&&t.column.isRegClickCol&&o.debounce.add(function(){window.isPopupOpenedByUIGridCompatibleElement=!0,angular.isFunction(I.listeners.cellClick)&&I.listeners.cellClick({entity:t.row.entity,index:t.rowIndex},{colDef:t.column,index:t.columnIndex})},100)});var U=o.on("focusCell",function(e){e.rowIndex==t.rowIndex&&e.columnIndex==t.columnIndex&&e.smartTableId==I.smartTableId&&n.trigger("focus")}),B=o.on("rowDataChange",function(e){e.rowIndex==t.rowIndex&&e.smartTableId==I.smartTableId&&(x||E(!0,!0))}),W=o.on("dataChange",function(e){e.smartTableId==I.smartTableId&&e.updateCell&&E(!0,!0)});t.$on("$destroy",function(){O(),U(),B(),W(),n.off("keydown",H)})},template:'<span class="smart-table-cell-text"><span class="smart-table-cell-template"></span></span>'}}])}(),function(e){"use strict";e.module("SMART2").directive("smartTreePopup",["$timeout",function(t){return{restrict:"E",scope:{header:"@",isRadio:"@",toggle:"@",preselection:"@",onHide:"&",onSelect:"&",disableLevelSelection:"@"},link:function(n,o,i){var a=!0;n.$watch("toggle",function(e){n.showPopupBool=n.$eval(e),n.showPopupBool&&(n.treeConfig.hideSearch=!1,a&&(t(function(){n.treeConfig.initServiceCall()}),a=!1))}),n.$watch("preselection",function(e){n.treeConfig.SelectedNodes=e});var l=n.$eval(n.onHide),r=n.$eval(n.onSelect);n.treeConfig={IsRadio:n.$eval(n.isRadio),type:"Category",SelectedNodes:"",title:n.header,disableLevelSelection:n.disableLevelSelection,hideSearch:!1},n.onDoneCallback=function(t){e.isFunction(r)&&r(t)},n.showPopupBool=!1,n.onPopupHideCallback=function(){n.showPopupBool=!1,n.treeConfig.hideSearch=!0,e.isFunction(l)&&l()}},templateUrl:"shared/directives/smartTree/smartTreePopup.html"}}]),e.module("smartTreeComponent",[]).directive("smartTreeComponent",["$timeout","$translate","RESTApiSt","$q","APPCONSTANTS","Common",function(t,n,o,i,a,l){return{restrict:"E",replace:!0,scope:{config:"=",onDone:"&"},link:function(r,s,c){function d(e,t){F=null,I=null,O.length=0,e&&(F=i.defer(),O.push(F.promise)),t&&(I=i.defer(),O.push(I.promise)),i.all(O).then(u)}function u(){h(),d(!1,!0)}function p(){var e=1,t=E[e];for(f(t);t;)K[H+e]=t,f(t,e),P=e,e+=1,t=E[e]}function f(e,t){var n=t?_.groupBy(E[t+1],r.parentProperty):null;_.each(e,function(t){var o=n?n[t[r.codeProperty]]:e;o&&_.each(o,function(e,n){e[U]=t[U]?t[U]+" > "+e[r.titleProperty]:e[r.levelProperty]>1?t[r.titleProperty]+" > "+e[r.titleProperty]:"",e[B]=t[B]?t[B]+">"+e[r.codeProperty]:e[r.levelProperty]>1?t[r.codeProperty]+">"+e[r.codeProperty]:"",e.isExpanded=!1,e.selection="0",e.index=n})})}function g(e){try{E=_.groupBy(JSON.parse(e.data.GetPASForDeviceMobResult),r.levelProperty),p(),r.categories=K[H+"1"].slice(0,V),N.push(K[H+"1"][K[H+"1"].length-1]),r.isLoading=!1}catch(t){r.msg=n.instant("loadingDataErr")}F.resolve()}function m(){_.each(r.selectedData,function(e){r.selectNode(e,"0")})}function h(){m(),_.each(R,function(e){for(var t=1;P>=t;){var n=_.groupBy(K[H+t],r.codeProperty)[e];if(n){r.selectNode(n[0],"1");break}t+=1}})}function v(e,t,n){var o=e[r.levelProperty]+1,i=_.groupBy(K[H+o],r.parentProperty)[e[r.codeProperty]],a=i;return a}function y(e,t){j!=e&&(j=e,W=P,G.length=0,z.length=0,r.searchResults.length=0);var n=w(e,t);r.searchResults=r.searchResults.concat(n)}function b(e){var t=_.partition(G,function(t,n){return n>e-1});return G=t[0],t[1]}function C(e){var t=_.partition(z,function(t,n){return n>e-1});return z=t[0],t[1]}function w(e,t){for(var n=[];n.length<t&&W>0;){var o=b(t);if(o.length==t){n=o;break}var i=_.filter(K[H+W],function(e){return-1!=e[r.titleProperty].toLowerCase().indexOf(j.toLowerCase())}),a=_.filter(K[H+W],function(e){return new RegExp("("+_.compact(j.split(" ")).join("|")+")","gi").test(e[r.titleProperty])&&-1==e[r.titleProperty].toLowerCase().indexOf(j.toLowerCase())});z=z.concat(a);var l=o.concat(i),s=_.partition(l,function(e,n){return n>t-1});G=G.concat(s[0]),n=n.concat(s[1]),W-=1}if(0==W)for(;n.length<t;){var c=C(t);if(!(c.length>0))break;n=n.concat(c)}return n}function S(e){var t=_.filter(v(e),function(e){return e.isExpanded});_.each(t,function(e){e.isExpanded=!1,e.children=[],S(e)})}function x(e){var t=_.filter(N,function(t,n){return-1!=t[B].indexOf(e[r.codeProperty])});N=_.difference(N,t),S(e)}function T(e,t){switch(t){case"0":r.selectedData=_.without(r.selectedData,e);break;case"1":r.selectedData.push(e)}}function $(e,t){for(var n=e[r.levelProperty]-1,o=e[r.parentProperty].toString();n>0;){var i=_.find(K[H+n],function(e){return e[r.codeProperty]==o});o=i[r.parentProperty].toString(),i.isExpanded||r.expandNode(i),r.isSingleSelect||(i.selection=D(i)),n-=1}}function D(e){var t=e.ChildCount,n=e[r.levelProperty]+1,o=e[r.codeProperty],i=_.groupBy(K[H+n],r.parentProperty),a=_.filter(i[o],function(e){return"1"==e.selection}),l=_.filter(i[o],function(e){return"2"==e.selection});return t==a.length?(r.selectedData=_.difference(r.selectedData,a),r.selectedData.push(e),"1"):a.length+l.length>0?(r.selectedData=_.union(r.selectedData,a),r.selectedData=_.without(r.selectedData,e),"2"):(r.selectedData=_.union(r.selectedData,a),r.selectedData=_.without(r.selectedData,e),"0")}function k(e,t){for(var n=e[r.levelProperty]+1,o=e[r.codeProperty].toString();P>=n;){var i=_.filter(K[H+n],function(e){return-1!=e[B].indexOf(o)});_.each(i,function(e){e.selection=t,"1"==t&&(r.selectedData=_.without(r.selectedData,e))}),n+=1}}r.parentId="Parent_"+l.uniqueIDGenerator(),r.templateId="Template_"+l.uniqueIDGenerator()+".html",r.config.initServiceCall=function(){o.getData(r.treeConfig.type,g,A)},r.treeConfig=r.config;var M=r.$eval(r.onDone);r.$watch("config.SelectedNodes",function(e,t){e&&(R=e.split(","),I&&I.resolve())}),r.$watch("config.hideSearch",function(n,o){n&&r.searchFieldVal.length>0&&t(function(){e.element("#closeButton").trigger("click")})});var F,I,O=[];d(!0,!0);var E,P,R,A,L=50,V=50,N=[],H="level",K={},U="parentString",B="parentCodeString";switch(r.treeConfig.type){case"Category":r.codeProperty="PASCode",r.titleProperty="PASName",r.levelProperty="PASLevel",r.parentProperty="ParentPASCode",A={method:"POST",url:a.userPreferences.URLs.AppURL+"PortalRestService/GetPASForDeviceMob?oloc=218",headers:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(a.userPreferences.UserBasicDetails)},data:{ContactCode:a.userPreferences.UserBasicDetails.ContactCode,entityDetailCode:a.userPreferences.ACEntityId,entityId:a.userPreferences.UserBasicDetails.EntityId}};break;case"Region":r.codeProperty="RegionId",r.titleProperty="RegionName",r.levelProperty="RegionLevel",r.parentProperty="RegionParentId"}r.isLoading=!0,r.selectedData=[],r.isSingleSelect=r.treeConfig.IsRadio,r.msg=n.instant("loadingMsg");var W,j="",G=[],z=[];r.searchResults=[],r.searchText="",r.searchFieldVal="",r.expandNode=function(e,t){e.isExpanded=!e.isExpanded,e.isExpanded?(e.children=v(e,V,0),N.push(e.children[e.children.length-1])):(e.children=[],x(e))};var q;r.searchAndSelectNode=function(e){q&&t.cancel(q),q=t(function(){r.searchFieldVal.length>2?y(r.searchFieldVal,L):(G.length=0,z.length=0)},300)},r.selectNode=function(e,t){e.selection=t,r.isSingleSelect?(r.selectedData&&r.selectedData[0]&&r.selectedData[0][r.codeProperty]!=e[r.codeProperty]&&(r.selectedData[0].selection="0"),r.selectedData="0"==t?[]:[e]):(T(e,t),k(e,t)),$(e,t)};var Y=function(){var e=(new Date).getTime(),t="xxx2xxxpxxxoxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t};r.isSingleSelect&&(r.uniqueRadioGroupName=Y()),r.scrollEnd=function(e){y(r.searchFieldVal,L)},r.doneButton={title:n.instant("doneBtn")},r.doneClickHandler=function(){e.isFunction(M)&&M(r.selectedData)},r.focusSearch=!1,r.isActive=!1,r.showMe=!1,r.showSearch=function(){r.isActive=!0,r.focusSearch=!0,r.showMe=!0,r.hideClose=!0},r.hideSearch=function(){r.isActive=!1,r.focusSearch=!1,r.hideClose=!1}},templateUrl:"shared/directives/smartTree/smartTreeTemplate.html"}}]).directive("ngIndeterminate",function(e){return{restrict:"A",link:function(e,t,n){e.$watch(n.ngIndeterminate,function(e){t.prop("indeterminate",e)})}}}).directive("ngHighlightSt",["$compile","hilitor",function(e,t){return{restrict:"A",link:function(e,n,o){e.$watch(o.ngHighlight,function(e){t.getHilitor().apply(e)})}}}]).service("RESTApiSt",["$http",function(e){function t(t){e(t).then(function(e){n(e)},function(e){n(e)})}var n;this.getData=function(e,o,i){switch(e){case"Category":n=o,t(i)}}}]).service("hilitor",[function(){var e=new Hilitor("treeComponentContainer");this.getHilitor=function(){return e}}])}(angular),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=function(n){if(n=n||e,!n.document)throw new Error("Hilitor requires a window with a document");return t(n.document)}:"function"==typeof define&&define.amd?define([],function(){return t(document)}):e.Hilitor=t(document)}(this,function(e,t){function n(t,n,o){var i=e.getElementById(t)||e.body,a=n||"EM",l=new RegExp("^(?:SCRIPT|FORM|INPUT|TEXTAREA|IFRAME|VIDEO|AUDIO)$"),r=["#ff6"],s=[],c=0,d="",u=!0,p=!0;o=o||{},"function"!=typeof o.onStart&&(o.onStart=function(){}),"function"!=typeof o.onFinish&&(o.onFinish=function(){return!0}),"function"!=typeof o.onDoOne&&(o.onDoOne=function(e){}),this.setMatchType=function(e){switch(e){case"left":u=!1,p=!0;break;case"right":u=!0,p=!1;break;default:case"open":u=p=!0;break;case"complete":u=p=!1}},this.setRegex=function(e){e=e.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w'\-]+/g,"|");var t="("+e+")";u||(t="\\b"+t),p||(t+="\\b"),d=new RegExp(t,"i")},this.getRegex=function(){var e=d.toString();return e=e.replace(/^\/(\\b)?|(\\b)?\/i$/g,""),e=e.replace(/\|/g," ")},this.hiliteWords=function(t){var n;if(t&&d&&!l.test(t.nodeName)&&(t.nodeName!==a||"hilitor"!==t.className)){if(t.hasChildNodes())for(n=0;n<t.childNodes.length;n++)this.hiliteWords(t.childNodes[n]);if(3===t.nodeType&&(nv=t.nodeValue)&&(regs=d.exec(nv))&&!1!==o.onDoOne.call(this,t)){s[regs[0].toLowerCase()]||(s[regs[0].toLowerCase()]=r[c++%r.length]);var i=e.createElement(a);i.appendChild(e.createTextNode(regs[0])),i.className="hilitor",i.style.backgroundColor=s[regs[0].toLowerCase()],i.style.fontStyle="inherit",i.style.color="#000";var u=t.splitText(regs.index);u.nodeValue=u.nodeValue.substring(regs[0].length),t.parentNode.insertBefore(i,u)}}},this.remove=function(){var t,n;do for(t=e.querySelectorAll(a+".hilitor"),n=0;n<t.length&&(el=t[n]);){var o=el.parentNode;o?(o.replaceChild(el.firstChild,el),o.normalize()):n++}while(t.length>0)},this.apply=function(e){if(this.remove(),!e)return!1;this.setRegex(e);var t=o.onStart.call(this);return t===!1?t:(i.normalize(),this.hiliteWords(i),o.onFinish.call(this))}}return n}),angular.module("SMART2").directive("stickOnScroll",function(e,t){return{restrict:"A",scope:{setTop:"@",setZindex:"@",onScroll:"&",setLeft:"@",setRight:"@"},link:function(n,o,i){(""==n.setTop||void 0==n.setTop)&&(n.setTop="0"),(""==n.setLeft||void 0==n.setLeft)&&(n.setLeft="0"),(""==n.setRight||void 0==n.setRight)&&(n.setRight="0"),(""==n.setZindex||void 0==n.setZindex)&&(n.setZindex="1");var a='<div id="fixedtoHeaderheight_'+n.$id+'" style="display:none"></div>';i.$observe("stickOnScroll",function(l){if("true"==l){var r=t(a)(n);o.after(r);var s=o.offset().top;angular.element(e).bind("scroll",function(){var t=o.outerHeight(),a=angular.element(e).scrollTop();if(a>=s)if(void 0!=i.stickLimit){var l=$(i.stickLimit),r={top:l.offset().top,height:l.outerHeight()};a+o.outerHeight()>r.top+r.height?(o.removeClass("is-fixed-on-top").css({top:"",left:"",right:"","z-index":""}),angular.element("#fixedtoHeaderheight_"+n.$id).css({height:0,display:"none"})):(o.addClass("is-fixed-on-top "+i.applyClassOnFixed).css({top:n.setTop,left:n.setLeft,right:n.setRight,"z-index":n.setZindex}),angular.element("#fixedtoHeaderheight_"+n.$id).css({height:t,display:"block"}))}else o.addClass("is-fixed-on-top "+i.applyClassOnFixed).css({top:n.setTop,left:n.setLeft,right:n.setRight,"z-index":n.setZindex}),angular.element("#fixedtoHeaderheight_"+n.$id).css({height:t,display:"block"});else o.removeClass("is-fixed-on-top").css({top:"",left:"",right:"","z-index":""}),angular.element("#fixedtoHeaderheight_"+n.$id).css({height:0,display:"none"});n.onScroll()})}else angular.element("#fixedtoHeaderheight_"+n.$id).css({height:0,display:"none"}),o.next("#fixedtoHeaderheight_"+n.$id).remove(),o.removeClass("is-fixed-on-top").css({top:"",left:"",right:"","z-index":""})})}}}),function(){"use strict";angular.module("SMART2").directive("customTab",[function(){return{restrict:"A",link:function(e,t,n){var o=function(e){var t=$(this),o=angular.isDefined(n.tabType);38==e.keyCode&&!o&&t.prev().length>0||37==e.keyCode&&o&&t.prev().length>0?(t.prev().focus(),e.preventDefault()):40==e.keyCode&&!o&&t.next().length>0||39==e.keyCode&&o&&t.next().length>0?(t.next().focus(),e.preventDefault()):13==e.keyCode&&(t.trigger("click"),e.preventDefault())};t.bind("keydown",o),e.$on("$destroy",function(){t.unbind("keydown",o)})}}}])}(),function(){"use strict";angular.module("SMART2").directive("focusonkeypress",["$focusOnField",function(e){return{restrict:"A",link:function(t,n,o){var i,a=function(t){var a=function(){if(!n.hasClass("focused")){i=document.activeElement,n.addClass("focused");var t=n.find("a, input, textarea, [tabindex]").first();e(t)}},l=function(){n.hasClass("focused")&&(e(i),i="",n.removeClass("focused"))};o.altkey&&"false"!=o.altkey?o.focusin&&t.key==o.focusin&&1==t.altKey?a():o.focusout&&t.key==o.focusout&&1==t.altKey&&l():o.focusin&&t.key==o.focusin?a():o.focusout&&t.key==o.focusout&&l()};$(document).bind("keydown",a),t.$on("$destroy",function(){$(document).unbind("keydown",a)})}}}])}(),function(){"use strict";angular.module("SMART2").directive("a",function(){return{restrict:"E",link:function(e,t,n){var o=n.href,i=t.find("svg");i&&i.attr("focusable","false"),void 0==o&&n.$set("href","")}}}).directive("menuItemList",["menuListItemServ",function(e){return{restrict:"A",link:function(t,n,o){e(n)}}}]).directive("extraNavTitle",[function(){return{restrict:"C",link:function(e,t,n){var o=t.find("a, input, button, textarea, [tabindex]").not(":disabled, :hidden, [tabindex = -1]").first();o.focus()}}}])}(),function(){"use strict";angular.module("SMART2").directive("tabbingGroup",["$focusOnField",function(e){return{restrict:"A",link:function(t,n,o){n.bind("keydown",function(t){if(9==t.which){var o="a, input[type=text],input[type=radio]:checked,input[type=checkbox], button, textarea, [tabindex='0']",i=":disabled, :hidden, [tabindex=-1]",a=n.find(o).not(i).first(),l=n.find(o).not(i).last();t.target==a.get(0)&&t.shiftKey?(t.preventDefault(),e(l)):t.target!=l.get(0)||t.shiftKey||(t.preventDefault(),e(a))}})}}}])}(),function(){angular.module("SMART2").directive("searchableCube",[function(){"use strict";return{restrict:"E",transclude:!0,scope:{cubeletList:"=?",enableProceed:"&",selectedCube:"=?",formatKey:"@"},link:function(e,t,n){function o(){x=t[0],T=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e4),T.position.set(-360,440,700),$=new THREE.Scene,T.lookAt($.position),$.add(new THREE.AmbientLight(5263440));var n=new THREE.SpotLight(16777215,1.25);n.position.set(-650,650,650),n.castShadow=!0,n.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(70,1,100,1e4)),n.shadow.bias=1e-5,n.shadow.mapSize.width=4096,n.shadow.mapSize.height=4096,$.add(n);var o,i,a,r=90,d=20,u=[[-1,1,1],[-1,0,1],[-1,-1,1],[0,1,1],[0,0,1],[0,-1,1],[1,1,1],[1,0,1],[1,-1,1],[1,1,0],[1,0,0],[1,-1,0],[1,1,-1],[1,0,-1],[1,-1,-1],[0,1,-1],[0,0,-1],[0,-1,-1],[-1,1,-1],[-1,0,-1],[-1,-1,-1],[-1,1,0],[-1,0,0],[-1,-1,0],[0,1,0],[0,-1,0],[0,0,0]],p=[[-1,1,1],[-1,-1,1],[1,1,1],[1,-1,1],[1,1,-1],[1,-1,-1],[-1,1,-1],[-1,-1,-1]];i=function(){o=new THREE.BoxGeometry(r,r,r);for(var t,n=0;27>n;n++)t=n<e.options.length?new THREE.Mesh(o,new THREE.MeshLambertMaterial({color:"#6fc2fb"})):new THREE.Mesh(o,new THREE.MeshLambertMaterial({color:16777215,transparent:!0,opacity:.7})),t.position.x=u[n][0]*(r+d),t.position.y=u[n][1]*(r+d),t.position.z=u[n][2]*(r+d),t.scale.x=1,t.scale.y=1,t.scale.z=1,t.dataID=n+1,n<e.options.length?(t.castShadow=!0,t.receiveShadow=!0,t.name=e.options[n][e.formatKey],t.disable=!1):t.disable=!0,R.add(t)},a=function(){o=new THREE.BoxGeometry(r+45,r+45,r+45);for(var t,n=0;8>n;n++)t=n<e.options.length?new THREE.Mesh(o,new THREE.MeshLambertMaterial({color:"#6fc2fb"})):new THREE.Mesh(o,new THREE.MeshLambertMaterial({color:16777215,transparent:!0,opacity:.7})),t.position.x=p[n][0]*(r+d+45)/2,t.position.y=p[n][1]*(r+d+45)/2,t.position.z=p[n][2]*(r+d+45)/2,t.scale.x=1,t.scale.y=1,t.scale.z=1,t.dataID=n+1,n<e.options.length?(t.name=e.options[n][e.formatKey],t.castShadow=!0,t.receiveShadow=!0,t.disable=!1):t.disable=!0,R.add(t)},e.options.length>8?i():a(),$.add(R),D=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),D.setPixelRatio(window.devicePixelRatio),D.setSize(window.innerWidth,window.innerHeight),D.shadowMap.enabled=!0,D.shadowMap.type=THREE.PCFShadowMap,D.shadowMap.soft=!0,x.appendChild(D.domElement),x.addEventListener("mousemove",c),x.addEventListener("mousedown",s,!0),window.addEventListener("resize",l,!1)}function i(t){switch(t.keyCode){case 38:e.handleRotation("top");break;case 40:e.handleRotation("bottom");break;case 37:e.handleRotation("left");break;case 39:e.handleRotation("right")}}function a(e,t,n){var o={x:0,y:0},i={x:0,y:Math.PI/2},a=new TWEEN.Tween(o).to(i,1e3),l={x:0,y:0},r=0,s=0,c=0;a.easing(TWEEN.Easing.Quadratic.InOut),a.onUpdate(function(){e?(r=o.y-l.y,1==e&&(r=-1*r)):(s=o.y-l.y,1==t&&(s=-1*s)),H=!1;var n=(new THREE.Quaternion).setFromEuler(new THREE.Euler(r,s,c,"XYZ"));R.quaternion.multiplyQuaternions(n,R.quaternion),l.y=o.y}),a.start(),a.onComplete(function(){H=!0})}function l(){T.aspect=window.innerWidth/window.innerHeight,T.updateProjectionMatrix(),D.setSize(window.innerWidth,window.innerHeight)}function r(){requestAnimationFrame(r),m(),v(),TWEEN.update()}function s(e){H&&e.target==t.find(".mainScreen")[0]&&(x.addEventListener("mousemove",d,!1),x.addEventListener("mouseup",u,!1),A=!0,j={x:e.clientX,y:e.clientY},V=N=p(0,0))}function c(e){E=!0,event.preventDefault(),P.x=event.clientX/window.innerWidth*2-1,P.y=2*-(event.clientY/window.innerHeight)+1,P.clientX=event.clientX,P.clientY=event.clientY}function d(e){L=!0,G=e.x-j.x,z=e.y-j.y,q(),j.x=e.x,j.y=e.y,I=new Date}function u(e){b(M),(new Date).getTime()-(I?I.getTime():0)>W&&(G=e.x-j.x,z=e.y-j.y),A=!1,x.removeEventListener("mousemove",d,!1),x.removeEventListener("mouseup",u,!1),L=!1;var t=new THREE.Vector3(P.x,P.y,1);t.unproject(T);var n=new THREE.Raycaster(T.position,t.sub(T.position).normalize()),o=n.intersectObjects($.children[2].children);o.length>0&&(void 0==O||o[0].object.name!=O.name)&&(w(k),C(k))}function p(e,t){var n=new THREE.Vector3;n.set(g(e/K,-1,1),g(-t/U,-1,1),0);var o=n.length();return o>1?n.normalize():n.z=Math.sqrt(1-o*o),n}function f(e,t){var n,o=new THREE.Vector3,i=new THREE.Quaternion;return n=Math.acos(e.dot(t)/e.length()/t.length()),n&&(o.crossVectors(e,t).normalize(),n*=B,i.setFromAxisAngle(o,n)),i}function g(e,t,n){return Math.min(Math.max(e,t),n)}function m(){if(TWEEN.update(),!A){var e=.95,t=.05;-t>G||G>t?G*=e:G=0,-t>z||z>t?z*=e:z=0}D.render($,T)}function h(e,t,n,o,i,a,l){var r,s,c,d=$.children[2].children[parseInt(l)-1],u=R.rotation,p=(Math.PI,{x:u.x,y:u.y,z:u.z}),f={x:o,y:i,z:a},g=new TWEEN.Tween(p).to(f,200),m={x:o,y:o,z:a};b(M),y(d,!0),w(d),C(d),M=d,g.onUpdate(function(){e&&(r=p.x-m.x,1==e&&(r=-1*r)),t&&(s=p.y-m.y,1==t&&(s=-1*s)),n&&(c=p.z-m.z,1==t&&(s=-1*s)),H=!1,R.rotation.x=p.x,R.rotation.y=p.y,R.rotation.z=p.z,m.x=p.x,m.y=p.y,m.z=p.z}),g.start(),g.onComplete(function(){H=!0})}function v(){if(H&&!A&&E){var e=new THREE.Vector3(P.x,P.y,1);e.unproject(T);var t=new THREE.Raycaster(T.position,e.sub(T.position).normalize()),n=t.intersectObjects($.children[2].children);if(n.length>0){if(n[0].object!=k){if(!k||void 0!=O&&k.id==O.id||k.disable||k.material.color.setHex(k.currentHex),k=n[0].object,k.disable)return;void 0!==M&&k.name!==M.name&&M.hovered&&b(M),(void 0==M||k.name!==M.name)&&(E=!1,y(k))}}else k=null}}function y(e,n){var o={x:0,y:0},i={x:0,y:20},a=(new TWEEN.Tween(o).to(i,100),t.find(".mainScreen")),l={x:P.clientX+10,y:P.clientY};n&&(l=Y(e,T,t)),a.attr("interesect",JSON.stringify(l)).attr("tooltipActive",!0).attr("message","Cublet <b>"+e.name+"</b>").trigger("interesected"),e.currentHex=e.material.color.getHex(),e.hovered=!0,e.selected?e.material.color.setHex(16754176):e.material.color.setHex(10788091),M=e}function b(e){t.find(".mainScreen").attr("tooltipActive",!1),void 0!==e&&e.hovered&&(void 0==O||M.id!=O.id)&&(M.material.color.setHex(M.currentHex),M.hovered=!1)}function C(t){if(!t.disable){H=!1,M.material.color.setHex(16754176),t.selected=!0,e.selectedCube.select=_.where(e.cubeletList,{id:t.dataID})[0];var n={x:0,y:0},o={x:0,y:20},i=new TWEEN.Tween(n).to(o,100),a={x:0,y:0};i.easing(TWEEN.Easing.Quadratic.InOut),i.onUpdate(function(){t.position.x+=Math.sign(t.position.x)*(n.y-a.y),t.position.y+=Math.sign(t.position.y)*(n.y-a.y),t.position.z+=Math.sign(t.position.z)*(n.y-a.y),O=t,a.y=n.y}),i.start(),i.onComplete(function(){H=!0,e.proceed||(e.proceed=!0,S(),e.$apply())})}}function w(e){void 0==O||e.disable||(O.selected=!1,O.material.color.setHex(7324411),O.position.x-=20*Math.sign(O.position.x),O.position.y-=20*Math.sign(O.position.y),O.position.z-=20*Math.sign(O.position.z))}e.proceed=!1;var S=e.$eval(e.enableProceed);e.options=JSON.parse(JSON.stringify(e.cubeletList)),e.selectedCube=e.selectedCube||{};var x,T,$,D,k,M,F,I,O,E=!1,P=new THREE.Vector2,R=new THREE.Group,A=!1,L=!1,V=new THREE.Vector3(0,0,1),N=new THREE.Vector3(0,0,1),H=!0,K=window.innerWidth/2,U=window.innerHeight/2,B=2,W=50,j={x:0,y:0},G=0,z=0;o(),r(),x.addEventListener("keydown",i),e.handleRotation=function(e){if(H)switch(e){case"top":a(1,0,0);break;case"bottom":a(-1,0,0);break;case"left":a(0,1,0);break;case"right":a(0,-1,0)}},e.routeToReport=function(){location.href="index_reports.html#/analytics/new"},e.searchElementByValue=function(){var n=t.find(".searchElement input").val().toLowerCase(),o=_.findIndex(this.cubeletList,{name:n.charAt(0).toUpperCase()+n.slice(1)});-1!==o&&(e.selectedCube.select=this.cubeletList[o],e.searchElement(e.selectedCube.select.id))};var q=function(){N=p(G,z,-1*G);var e=f(V,N);F=R.quaternion,F.multiplyQuaternions(e,F),F.normalize(),R.setRotationFromQuaternion(F),N=V};e.searchElement=function(t){if(e.options.length>8)switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:h(0,0,0,0,0,0,t);break;case 16:case 17:case 18:case 19:case 20:case 21:h(1,0,1,Math.PI,0,Math.PI,t);break;case 22:case 23:case 24:h(0,1,0,0,Math.PI/2,0,t);break;case 10:case 11:case 12:case 13:case 14:case 15:h(0,-1,0,0,-Math.PI/2,0,t);break;case 25:h(1,0,0,Math.PI/2,0,0,t);break;case 26:h(-1,0,0,-Math.PI/2,0,0,t)}else switch(t){case 1:case 2:case 3:case 4:h(0,0,0,0,0,0,t);break;case 5:case 6:case 7:case 8:h(1,0,1,Math.PI,0,Math.PI,t)}};var Y=function(e,t,n){var o=e.position.clone(),i=new THREE.Matrix4;return i.multiply(t.projectionMatrix,t.matrixWorldInverse),i.multiplyVector3(o),{x:(o.x+1)*n.width()/2+n.offset().left,y:(-o.y+1)*n.height()/2+n.offset().top}};e.selectedCube.select&&e.searchElement(e.selectedCube.select.id)},templateUrl:"shared/directives/uiElements/searchableCube/searchableCubeTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartBack",["$timeout","persistenceService","$rootScope",function(e,t,n){return{restrict:"E",replace:!0,scope:{callback:"&"},link:function(e,n,o){var i=e.$eval(e.callback);t.nPlusOne.historyIsEmpty()||(e.show=!0),e.goBackClick=function(n){e.disable||(angular.isFunction(i)&&i(n),t.redirectToPreviousNode())}},templateUrl:"shared/directives/uiElements/smartBack/smartBackTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").factory("browserSniffing",[function(){var e,t=navigator.userAgent,n=(t.indexOf("MSIE "),t.indexOf("Trident/"),t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[]);return/trident/i.test(n[1])||/MSIE/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],0==e.length?"IE "+(n[2]||""):"IE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!=e)?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n)}]),angular.module("SMART2").directive("smartBrowserSniffing",["$window","$timeout","$translate","browserSniffing","notification","APPCONSTANTS","favoriteOps",function(e,t,n,o,i,a,l){return{restrict:"A",scope:{showSniffing:"@"},templateUrl:"shared/directives/uiElements/smartBrowserSniffing/browerSniffingTemplate.html",link:function(r,s){var c="true"==r.showSniffing?!0:!1;r.image960=a.userPreferences.URLs.ContentURL+"smartcontent/workspace/shared/resources/images/browser-sniff/960-error-trans.png",r.image1920=a.userPreferences.URLs.ContentURL+"smartcontent/workspace/shared/resources/images/browser-sniff/1920-error-trans.png";var d=a.userPreferences.URLs.ContentURL+"smartcontent/workspace/shared/resources/images/browser-sniff/IE.png",u=a.userPreferences.URLs.ContentURL+"smartcontent/workspace/shared/resources/images/browser-sniff/Chrome.png";if(1==c){t(function(){r.execBrowserSniffing()}),angular.element(e).bind("resize",function(){r.execBrowserSniffing()}),r.Screen960=!1,r.Screen1920=!1,r.execBrowserSniffing=function(){r.isShowSniffer=l.getSnifferFlag&&l.getSnifferFlag(),r.isShowSniffer||(r.sniffTemplateUrl="",angular.element("html").css("overflow","hidden"),angular.element(e).innerWidth()<960||angular.element(e).innerWidth()>1920?(angular.element(e).innerWidth()<960&&(r.Screen960=!0,r.sniffTemplateUrl="shared/directives/uiElements/smartBrowserSniffing/Browse960.html",s.addClass("active"),r.$apply()),angular.element(e).innerWidth()>1920&&(r.Screen1920=!0,r.sniffTemplateUrl="shared/directives/uiElements/smartBrowserSniffing/Browse1920.html",s.addClass("active"),r.$apply())):(s.removeClass("active"),angular.element("html").removeAttr("style")),angular.element(".sniffingContainer").animate({scrollTop:1e3},"slow"))},r.onChange=function(e){r.isShowSniffer=e},r.hideSniffingOverlay=function(){r.Screen1920=!1,r.Screen960=!1,s.removeClass("active"),angular.element("html").removeAttr("style"),l.setSnifferFlag(r.isShowSniffer)},"object"!=typeof o&&(o=o.split(" "));var p=o;r.remindOptions=[{title:"30 Days"},{title:"15 Days"}],r.selectedDate={title:"30 Days"};var f={type:"unsupportedBrowserVersion",isMultipleCheck:!0,titleTextColor:"browser-version-header-text",buttons:[{title:n.instant("updateNowBtn"),result:"Update Now"},{title:n.instant("dismissLink"),result:"dismiss"}],multipleCheckList:[{type:"select",checkContext:r.selectedDate,options:r.remindOptions,model:r.selectedDate,preSelected:r.selectedDate,header:n.instant("yourCurrentBrowser")}]},g={type:"unsupportedBrowser",isMultipleCheck:!0,titleTextColor:"browser-unsupported-header-text",buttons:[{title:n.instant("dismissLink"),result:"dismiss"}],multipleCheckList:[{type:"select",checkContext:r.selectedDate,options:r.remindOptions,model:r.selectedDate,preSelected:r.selectedDate,header:"<em>"+p[0]+"</em> "+n.instant("browserIncompatibleMsg")+'<ul class="browser-list"><li><a href="https://www.google.com/chrome/browser/desktop/index.html?brand=CHBD&gclid=EAIaIQobChMIuPufvL320gIVwpe9Ch3VhQUtEAAYASAAEgJ8ifD_BwE" target="_blank"><img src='+u+" /><p>"+n.instant("broswerChrome")+'</p></a></li><li><a href="https://www.microsoft.com/en-in/download/Internet-Explorer-11-for-Windows-7-details.aspx" target="_blank"><img src='+d+" /><p>"+n.instant("browserInterExplorer")+"</p></a></li></ul>"}]},m=(window.navigator.standalone,window.navigator.userAgent.toLowerCase()),h=/iphone|ipod|ipad|android/.test(m);if(h)return!1;("Chrome"==o[0]&&o[1]<45||"IE"==o[0]&&o[1]<11)&&i.notify(f,function(e){}),"Chrome"!=o[0]&&"IE"!=o[0]&&i.notify(g,function(e){})}}}}])}(),function(){"use strict";angular.module("SMART2").directive("smartButton",["$timeout","persistenceService",function(e,t){return{restrict:"E",replace:!0,scope:{callback:"&",onClick:"&",config:"=",backgroundColor:"=",fabConfig:"=",flat:"=",disable:"=",callbackParams:"=",buttonType:"="},link:function(e,n,o){e.isFloating=o.floating?e.$eval(o.floating):!1,e.isLarge=o.large?e.$eval(o.large):!1;var i=e.$eval(e.callback);e.clickCallback=function(n){n.goBack=t.redirectToPreviousNode,!e.buttonType||e.buttonType&&"Cancel"!=e.buttonType?e.disable||(angular.isFunction(i)&&i(n,e.callbackParams),e.onClick({$event:n})):t.redirectToPreviousNode()},o.$observe("ngClass",function(t){e.styleClass=t})},templateUrl:"shared/directives/uiElements/smartButton/smartButtonTemplate.html"}}])}(),function(){"use strict";var checkboxCounter=0;angular.module("SMART2").directive("smartCheckbox",["$timeout","ScrollTo","RuleEngine",function($timeout,ScrollTo,RuleEngine){return{restrict:"E",replace:!0,require:"?ngModel",scope:{ngModelResolve:"&",disable:"@",isMandatory:"@",isVisible:"=?",label:"@",minHeight:"@",fill:"@",rules:"@",validate:"=?",focus:"=?",parentElement:"@",errorMessage:"@",onChange:"&",removable:"@",showTooltip:"@",tooltipPosition:"@",showinfo:"@"},link:function(scope,element,attrs,ngModelCtrl){checkboxCounter++,scope.checkBoxId="checkbox-"+checkboxCounter,scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable),scope.showTooltip=void 0==scope.showTooltip||null==scope.showTooltip?!1:scope.showTooltip,scope.fill=void 0==scope.$eval(scope.fill)?!0:scope.$eval(scope.fill);var checkboxEle=element.find(":checkbox");try{ngModelCtrl.$render=function(){scope.ngModel=ngModelCtrl.$modelValue}}catch(e){}var updateView=function(){try{ngModelCtrl.$setViewValue(scope.ngModel)}catch(e){}},onFocus=scope.$watch("focus",function(e){e&&(ScrollTo.perform(element,angular.element("#"+scope.parentElement)),scope.focus=!1)}),onValidate=scope.$watch("validate",function(e){void 0!=e&&e&&scope.validateRules()});scope.validateRules=function(){if(scope.validate=!1,scope.errorMessage=null,scope.rules)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,i=0;i<rules.length;i++)if("object"==typeof rules[i]){if(eval(rules[i].rule.replace(/this/g,"scope.ngModel"))){scope.validate=!0,scope.errorMessage=rules[i].error;break}if(isFoundInvalid)break;RuleEngine.isValid(rules[i],function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,isFoundInvalid=!0})}},scope.ngChange=function(){if(attrs.ngModelResolve){var e=checkboxEle.prop("checked");checkboxEle.prop("checked",!e),ngModelCtrl.$setViewValue(!e),scope.ngModel=!e,scope.ngModelResolve({$event:{isChecked:!checkboxEle.prop("checked"),resolveFun:function(e){checkboxEle.prop("checked",e),ngModelCtrl.$setViewValue(e),scope.ngModel=e,updateView(),scope.validateRules();var t=$timeout(function(){scope.onChange(),$timeout.cancel(t)})}}})}else{updateView(),scope.validateRules();var t=$timeout(function(){scope.onChange(),$timeout.cancel(t)})}},scope.$on("$destroy",function(){onFocus(),onValidate(),element.remove(),scope=null})},templateUrl:"shared/directives/uiElements/smartCheckBox/smartCheckBoxTemplate.html"}}])}(),angular.module("SMART2").directive("smartCultureDate",["APPCONSTANTS",function(e){"use strict";var t={january:"Jan",february:"Feb",march:"Mar",april:"Apr",may:"May",june:"Jun",july:"Jul",august:"Aug",september:"Sep",october:"Oct",november:"Nov",december:"Dec"};return{restrict:"AE",scope:{ngModel:"=ngModel",enableShortMonth:"@"},replace:!0,link:function(n,o,i){var a=/^[0-9]+$/,l=e.userPreferences.UserBasicDetails.Culture,r=function(){if("number"==i.type&&void 0!=n.ngModel&&""!=n.ngModel){if("string"==typeof n.ngModel){var e=n.ngModel.replace(/,/g,"");
-1!==e.indexOf(".")&&(e=n.ngModel.replace(/\./g,"")),-1!==e.indexOf("")&&(e=n.ngModel.replace(/\s/g,"")),n.ngModel=parseInt(e)}"pt-PT"==l?n.ngModel=n.ngModel.toLocaleString(l).replace(/\s+/g,"."):n.ngModel=n.ngModel.toLocaleString(l)}};if("date"==i.type&&void 0!=n.ngModel&&""!=n.ngModel&&(a.test(n.ngModel)?"true"==i.showTime?n.ngModel=moment.unix(new Date(JSON.parse(n.ngModel)).getTime()/1e3).format(moment.localeData()._longDateFormat.L+" HH:mm"):n.ngModel=moment.unix(new Date(JSON.parse(n.ngModel)).getTime()/1e3).format(moment.localeData()._longDateFormat.L):"true"==i.showTime?n.ngModel=moment.unix(new Date(n.ngModel).getTime()/1e3).format(moment.localeData()._longDateFormat.LL+" HH:mm"):n.ngModel=moment.unix(new Date(n.ngModel).getTime()/1e3).format(moment.localeData()._longDateFormat.LL),1==n.enableShortMonth&&n.ngModel))for(var s=0,c=Object.keys(t);s<c.length;s++)if(n.ngModel.search(new RegExp(c[s],"gi"))>-1){n.ngModel=n.ngModel.replace(new RegExp(c[s],"gi"),t[c[s]]);break}r(),n.$watch("ngModel",function(e){e&&r()})},templateUrl:"shared/directives/uiElements/smartCultureDate/smartCultureDate.html"}}]),function(){"use strict";var e;angular.module("SMART2").directive("smartSortable",[function(){return{restrict:"A",scope:{onSort:"&",onDrag:"&"},link:function(t,n,o){n.sortable({placeholder:o.placeholder?o.placeholder:"drop-hover",helper:o.helper?o.helper:"original",handle:".collapsible-header-drag-icon",items:">*:not(.disable-sort-item)",cancel:".disable-sort-item",connectWith:o.connectWith?o.connectWith:"",appendTo:o.appendTo?o.appendTo:"parent",containment:o.containment?o.containment:"parent",tolerance:o.tolerance?o.tolerance:"intersect",start:function(n,i){"true"==o.isOverflowHidden&&$("body").css("overflow","hidden"),e=i.item.index(),i.placeholder&&i.placeholder.height(i.item.height()).css("width",i.item.outerWidth()),t.$apply(function(){t.onDrag({$event:{dragging:!0}})})},stop:function(e,n){"true"==o.isOverflowHidden&&$("body").css("overflow",""),t.$apply(function(){t.onDrag({$event:{dragging:!1}})})},update:function(n,i){if("true"==o.isOverflowHidden&&$("body").css("overflow",""),t.$apply(function(){t.onSort({$event:{startIndex:e,endIndex:i.item.index()}}),t.onDrag({$event:{dragging:!1}})}),"true"==o.swipItem&&i.sender){var a=1==i.item.next().length?i.item.next():i.item.prev();i.sender.append(a)}},sort:function(e,t){if("true"==o.whileSorting){var n=$(".slick-list"),i=(n.scrollLeft(),n.outerWidth()),a=t.helper.outerWidth(),l=t.helper.offset().left-n.offset().left,r=i-(l+a);0>l?$(".slick-prev").click():0>r&&$(".slick-next").click()}}})}}}]),angular.module("SMART2").directive("isDraggable",[function(){return{restrict:"A",link:function(e,t,n){n.$observe("isDraggable",function(e){void 0!=e&&""!=e&&(("true"==e||1==e)&&t.removeClass("disable-sort-item"),("false"==e||0==e)&&t.addClass("disable-sort-item"))})}}}])}(),function(){"use strict";angular.module("SMART2").directive("smartDropdown",["$window","$timeout","menuListItemServ","$focusOnField",function(e,t,n,o){return{restrict:"E",replace:!0,transclude:!0,scope:{config:"@",show:"@",onHide:"&",stopProg:"@",autoClose:"@"},link:function(i,a,l){var r,s,c=function(e){var t=e.children("li"),o=t.length;if(!t.attr("isItemList")){for(var i=0;o>i;i++){var a=t.eq(i),l=a.children().eq(0);if(1==a.children().length&&!a.hasClass("dropdown-content-footer")&&(null!=l.attr("ng-click")||null!=l.attr("ui-sref")||null!=a.attr("ng-click"))){r=!0;break}}1==r&&(t.last().hasClass("dropdown-content-footer")&&t.splice(o-1,1),n(t),r=!1)}},d=function(e){9==e.keyCode&&(s=e.keyCode,window.lastOpenedDropdownConfig.activates.hide().removeClass("active"),window.lastOpenedDropdownConfig.origin.removeClass("active"),window.lastOpenedDropdownConfig.activates.unbind("keydown",d))},u=setTimeout(function(){var e=a.find(".dropdown-button"),t=a.find(".close-dd");$(e).dropdown(angular.extend("object"==typeof i.$eval(l.config)?i.$eval(l.config):{},{onHide:function(){return 9!=s&&void 0!=l.singleElementDropdown&&(window.lastOpenedDropdownConfig.origin.focus(),s=null),"false"==i.autoClose?!1:void 0}}));var n=angular.element(".dd-close-off");n.length>0&&n.click(function(e){var t=angular.element(e.target);t.hasClass("btn-flat")||t.hasClass("btn")||t.hasClass("btn-large")||e.stopPropagation()}),t.length>0&&t.click(function(){var e=a.find(".dropdown-content");e.length>0&&i.hideDropDown(e)}),clearTimeout(u),u=null});i.$eval(l.fixed)?($(a).find(".dropdown-content").addClass("fixeddd"),$(a).find(".dropdown-button").bind("click",function(t){!function(t){var n=setTimeout(function(){var a=t.next(".dropdown-content"),r=t.offset().top-$(window).scrollTop(),s=t.offset().left-$(window).scrollLeft();a.css({left:s-2+"px",top:r-2+"px"});var u=r-2,p=r-2,f=a.css("height"),g=angular.element(window).height();if(parseInt(f)+r>g){var m=parseInt(f)+r-g,h=r-m-15;a.css("top",h+"px"),u=h,p=h}angular.element(e).on("scroll.smartFixedSmartDrop",function(){p=this.pageYOffset,p!==u&&a.hasClass("active")&&i.hideDropDown(a),u=p}),c(a),void 0!=l.singleElementDropdown&&a.bind("keydown",d);var v=a.find("a, input, textarea, [tabindex]").first();o(v),clearTimeout(n),n=null})}($(this))})):$(a).find(".dropdown-button").bind("click",function(e){var t=$(this).next(".dropdown-content");c(t),void 0!=l.singleElementDropdown&&t.bind("keydown",d),$(this).next(".dropdown-content").addClass("ddautoHeight"),function(e){var t=setTimeout(function(){var n=e.next(".dropdown-content"),i=parseInt(n.css("top"))+5+"px",a=parseInt(n.css("left"))+5+"px";parseInt(i,10)<0&&(n.css("top",0),n.animate({top:i,left:a}));var l=n.find("a, input, textarea, [tabindex]").first();o(l),clearTimeout(t),t=null})}($(this))});var p=l.$observe("show",function(e){if(angular.isDefined(e)&&!i.$eval(e)){var t=a.find(".dropdown-content");i.hideDropDown(t)}});if(i.hideDropDown=function(e){e.length>0&&(e.fadeOut(250),e.removeClass("active"),e.css("max-height",""),angular.element("[data-activates='"+e.attr("id")+"']").removeClass("active"),angular.isFunction(i.onHide)&&i.onHide())},"true"===i.stopProg)var f=t(function(){a.find(".dropdown-button").click(function(e){e.stopPropagation()}).end().find(".dropdown-content").click(function(e){var t=window.lastOpenedDropdownConfig;t.activates.fadeOut(t.options.outDuration),t.activates.removeClass("active"),t.activates.css("max-height",""),t.origin.removeClass("active"),e.stopPropagation()}),t.cancel(f),f=null});i.$on("$destroy",function(){p(),angular.element(e).off("scroll.smartFixedSmartDrop"),$(a).find(".dropdown-button").unbind("click"),$(a).find(".dropdown-button").off("click")})},templateUrl:"shared/directives/uiElements/smartDropdown/smartDropdownTemplate.html"}}]),angular.module("SMART2").directive("actionCloseDropdown",[function(){return{restrict:"C",scope:!0,link:function(e,t,n){t.bind("click",function(){angular.element(document).trigger("click")}),e.$on("$destroy",function(){t.unbind("click",function(){angular.element(document).trigger("click")})})}}}])}(),angular.module("SMART2").directive("smartErrorFieldHighlighter",["$timeout",function(e){return{restrict:"AE",scope:{errorConfig:"="},link:function(t,n,o){t.otherMandetoryFields=!1,t.$watch("errorConfig.check",function(o){1==o&&e(function(){$(n.find("[is-mandatory='true'] input")).each(function(){return $(this).hasClass("invalid")?($(this).focus(),t.otherMandetoryFields=!0,!1):void(t.otherMandetoryFields=!1)}),t.otherMandetoryFields||$(n.find("[is-mandatory='true'].smartMandetoryField")).each(function(){return $(this).find(".smartErrorText").length>0||$(this).find(".select-invalid-wrapper").length>0?($(this).find("a.focusErrorField").focus(),$(this).find("input").focus(),!1):void 0}),t.errorConfig.check=!1})})}}}]),function(){"use strict";var formWidgetCounter=0;angular.module("SMART2").directive("smartFormWidget",["APPCONSTANTS","ScrollTo","formWidgetUtils","$translate","$timeout","$compile","persistenceService","scrollPosition","$window",function(APPCONSTANTS,ScrollTo,formWidgetUtils,$translate,$timeout,$compile,persistenceService,scrollPosition,$window){return{restrict:"E",replace:!0,transclude:!0,scope:{formConfig:"=?",modelData:"=?",isSequential:"@",showWidget:"@",searchHolder:"@",widgetPanelTop:"@",widgetPanelRight:"@",onSectionSort:"&",onSave:"&",revisionMode:"@",secNav:"=?",filterWith:"=?"},link:function(scope,element,attrs){function initSectionsLoadedWatcher(){scope.SectionLoaderInitiated=!0;for(var e=[],t=0;t<scope.formConfig.sections.length;t++)e.push("formConfig.sections["+t+"].isContentLoaded");unbindSectionsLoadedWathcer=scope.$watchGroup(e,function(e,t){if(e)for(var n=!1,o=0;o<e.length&&(0!=e[o]||scope.formConfig.sections[o].isLazyLoadEnabled);o++)if(o==e.length-1&&(1==e[o]||"undefined"==typeof e[o])){scope.initSectionFocus();var i=persistenceService.nPlusOne.getSelectedSection();if(""!=i){for(var a=-1,l=scope.formConfig.sections,r=0;r<l.length;r++)if("undefined"!=typeof l[r].id&&l[r].id==i){a=r,l[r].isActive=!0;break}if(n=!0,a>-1){sectionItemClicked=!0;var s=scope.sectionTrackerItems[a];s.visible&&(scope.sectionTrackerItems[currentSelectedSection].isActive=!1,s.isActive=!0,currentSelectedSection=a),scope.isSectionsLoaded=!1,ScrollTo.perform(element.find("#"+scope.formWidgetId+"-section-"+a),angular.element("#"+scope.formWidgetId),function(e){setTimeout(function(){sectionItemClicked=!1,scope.isSectionsLoaded=!0},250),unbindSectionsLoadedWathcer()})}else scope.isSectionsLoaded=!0}else scope.isSectionsLoaded=!0}})}function getOpenWidgetSection(e){for(var t=!1,n=scope.formConfig.sections.length,o=0;n>o;o++){var i=scope.formConfig.sections[o];if(i.id===e){t=i;break}}return t}function isCheckSecnav(){$(".secondary-navigation").length?(onDocumentScroll(),$(document).on("scroll.secnav",onDocumentScroll)):setTimeout(function(){isCheckSecnav()},500)}function isCheckWidget(){$("#"+scope.formWidgetId).length?scrollPosition.scrollWitgetsection(scope.sectionTrackerItems):setTimeout(function(){isCheckWidget()},1e3)}$window.onload=function(){persistenceService.masterPersistenceService.getMasterDataForRootField()},void 0==scope.secNav&&(scope.secNav=!0),scope.widgetPanelRightPos=scope.widgetPanelRight?parseFloat(scope.widgetPanelRight):70,formWidgetCounter+=1,scope.formWidgetId="form-widget-"+formWidgetCounter,scope.addRemoveSection=$translate.instant("AddRemoveSectionTxt"),scope.visibleSectionTrackerItemsCount=0;var currentSelectedSection=0,thumbnailsWrapHeightTemp=0,secnavIndex=0,thumbnailsWrapHeight=0,sectionItemClicked=!1,staticTopmargin=64;scope.enableFieldPreview=!1;var updateVisibleSectionTrackerItemsCount=function(){for(var e=0,t=scope.sectionTrackerItems.length,n=0;t>n;n++){var o=scope.sectionTrackerItems[n];o.visible&&!o.hidden&&e++}scope.visibleSectionTrackerItemsCount=e},onSubHeaderHeight=attrs.$observe("subHeaderHeight",function(e){isNaN(e)||ScrollTo.setScrollingTopMargin(parseInt(e))});scope.isFormWidgetToBeLoaded=!1;var toutPromise=$timeout(function(){scope.isFormWidgetToBeLoaded=!0,$timeout.cancel(toutPromise),toutPromise=null},500);scope.checkPresistence=!1,scope.getPresistence=function(e){e&&"undefined"!=typeof e.documentType&&(persistenceService.getUserData(e.documentType),persistenceService.sectionPersistence.getSectionsPersistence(e,persistenceService.userData))},scope.modelDataWatcherEnabledOrNot=!1,scope.initModelDataWatcher=function(e){scope.modelDataWatcherEnabledOrNot=!0,scope.unbindModelDataWatcher=scope.$watch("modelData",function(t,n){persistenceService.getModelData(e,t,scope.unbindModelDataWatcher,scope.initChipsWatcher)},!0)};var persistenceTimeout;scope.initChipsWatcher=function(e){scope.$watchGroup(e,function(e,t){persistenceService.nPlusOne.getSelectedSection(),persistenceTimeout&&($timeout.cancel(persistenceTimeout),persistenceTimeout=void 0),persistenceTimeout=$timeout(function(){persistenceService.saveRecentDocument(e,scope.modelData)},1e3)})};var unbindSectionsLoadedWathcer,formWidgetTimeout,fixedElemHeight=0,windowScrollTop=0;scope.sectionTrackerItems=[];var onFormConfig=scope.$watch("formConfig",function(e,t){e&&(formWidgetTimeout&&($timeout.cancel(formWidgetTimeout),formWidgetTimeout=void 0),1!=scope.checkPresistence&&(scope.getPresistence(e),scope.formConfig.sections=e.sections,scope.checkPresistence=!0),0==scope.modelDataWatcherEnabledOrNot&&void 0!=e&&scope.initModelDataWatcher(e),formWidgetTimeout=$timeout(function(){var t=[],n=[],o=[],i=scope.formConfig.sections.length;scope.enableFieldPreview=e.enableFieldPreview;for(var a=0;i>a;a++){var l=scope.formConfig.sections[a];if(l.isMandatory=formWidgetUtils.convertAndGetValue(l.isMandatory,scope,l),angular.isDefined(l.isVisible)?l.isVisible=formWidgetUtils.convertAndGetValue(l.isVisible,scope,l):l.isVisible=l.isMandatory,angular.isDefined(l.isHidden)||(l.isHidden=!1),l.key=scope.formWidgetId+"-section-"+a,0!=scope.$eval(scope.showWidget)){t.push({sectionKey:l.key,sectionId:l.sectionId,isOptionalSection:!l.isMandatory,label:l.label,sectionIndex:a,visible:l.isVisible,hidden:l.isHidden,isActive:a==currentSelectedSection,save:l.save,id:l.id||"",mandatoryFieldStatus:l.mandatoryFieldStatus,isReadOnly:l.isReadOnly});var r=scope.sectionTrackerItems.length;if(r)for(var s=0;r>s;s++)scope.sectionTrackerItems[s].sectionIndex==l.key.split("section-")[1]&&(scope.sectionTrackerItems[s]={sectionKey:l.key,sectionId:l.sectionId,isOptionalSection:!l.isMandatory,label:l.label,sectionIndex:a,visible:l.isVisible,hidden:l.isHidden,isActive:a==currentSelectedSection,save:l.save,mandatoryFieldStatus:l.mandatoryFieldStatus,isReadOnly:l.isReadOnly})}l.isMandatory||0==scope.$eval(scope.showWidget)||l.isHidden||n.push({sectionKey:l.key,sectionId:l.sectionId,isOptionalSection:!l.isMandatory,label:l.label,searchLabel:$translate.instant(l.label),sectionIndex:a,visible:l.isVisible,hidden:scope.formConfig.sections[a].isHidden,isActive:!1,isSection:!0,save:l.save,mandatoryFieldStatus:l.mandatoryFieldStatus,isReadOnly:l.isReadOnly});for(var c=[],d=l.rows.length,u=0;d>u;u++)for(var p=l.rows[u],f=p.properties.length,g=0;f>g;g++){var m=p.properties[g];m.isMandatory=formWidgetUtils.convertAndGetValue(m.isMandatory,scope,m),angular.isDefined(m.isVisible)?m.isVisible=formWidgetUtils.convertAndGetValue(m.isVisible,scope,m):m.isVisible=m.isMandatory,angular.isDefined(m.isHidden)&&(m.isHidden=formWidgetUtils.convertAndGetValue(m.isHidden,scope,m)),m.isMandatory||0==scope.$eval(scope.showWidget)||m.isHidden||c.push({sectionKey:l.key,label:m.label,sectionLabel:l.label,searchLabel:$translate.instant(l.label)+" "+$translate.instant(m.label),sectionIndex:a,rowIndex:u,propertyIndex:g,visible:m.isVisible,isSection:!1})}l.optionalFields=c,o=o.concat(l.optionalFields)}scope.sectionTrackerItems.length!=t.length&&(scope.sectionTrackerItems=t),scope.optionalSections=n,o=scope.optionalSections.concat(o),scope.optionalFieldsAndSections=o,updateVisibleSectionTrackerItemsCount(),scope.showWidget=scope.sectionTrackerItems.length>1||scope.optionalSections.length>0,scope.SectionLoaderInitiated||initSectionsLoadedWatcher()},250))},!0),searchHolder=angular.element("#"+scope.searchHolder);if(searchHolder.length>0&&(searchHolder.html("<div ng-include=\"'shared/directives/uiElements/smartFormWidget/searchTemplate.html'\"></div>"),$compile(searchHolder.contents())(scope)),0!=scope.$eval(scope.showWidget)){var draggableWidth=$(window).width()/2,restrictWidth=0,secnavcontainerExpandWidth=350;element.on("click.secnavchevroicon","#secnavchevroicon",function(){var e=$("#panelexpandor");e.data("ui-draggable")||e.draggable({axis:"x",drag:function(e,t){restrictWidth=secnavcontainerExpandWidth-draggableWidth,t.position.left=Math.min(secnavcontainerExpandWidth-300,t.position.left),t.position.left=Math.max(restrictWidth,t.position.left)},stop:function(t,n){secnavcontainerExpandWidth-=n.position.left,$(".secnavcontainer-expand").width(secnavcontainerExpandWidth),e.css("left",0)}});var t=$(this),n=t.closest(".secnavcontainer");if(n.hasClass("secnavcontainer-animate"))n.removeClass("secnavcontainer-animate secnavcontainer-expand").width(69),t.find("use").attr("xlink:href","#icon_LeftChevron"),$("#sevnav-overlay").remove(),$("body").css("overflow","auto"),secnavHeightCal(element,secnavIndex,thumbnailsWrapHeight);else{$("body").css("overflow","hidden").append('<div id="sevnav-overlay" class="sevnav-overlay"></div>'),n.addClass("secnavcontainer-animate").width(secnavcontainerExpandWidth),setTimeout(function(){n.addClass("secnavcontainer-expand")},450),t.find("use").attr("xlink:href","#icon_RightChevro");var o=n.find(".thumbnails-wrap").children("li");o.each(function(e,t){t.style.height="46px"});var i=$("#thumbnails-wrap");i.animate({scrollTop:$(o[secnavIndex]).offset().top-i.offset().top-20},"slow"),$("#sevnav-overlay").off("click").on("click",function(){$("#secnavchevroicon").trigger("click")})}}),element.on("mouseenter.secnav",".thumbnails-wrap li",function(e){var t=$(this);t.closest(".secnavcontainer").hasClass("secnavcontainer-animate")||($(".nearby").removeClass("nearby"),t.prev("li").addClass("nearby"),t.next("li").addClass("nearby"),secnavHeightCal(element,e,thumbnailsWrapHeight,"mouse"))}),$(".extra-nav-wrap").resizeSensor({onHeightChange:function(e){$("#subheaderwrapper").height(e.height),onDocumentScroll()}}),element.on("mouseleave.secnav",".thumbnails-wrap",function(){$(this).closest(".secnavcontainer").hasClass("secnavcontainer-animate")||(element.find("li").removeClass("nearby"),secnavHeightCal(element,secnavIndex,thumbnailsWrapHeight,"mouse"))}),element.on("mouseenter.secnavform",".accountDetails",function(){$(this).closest(".secnavcontainer").hasClass("secnavcontainer-animate")||(element.find("li").removeClass("nearby"),secnavHeightCal(element,secnavIndex,thumbnailsWrapHeight,"mouse"))});var secnavHeightCal=function(e,t,n,o){var i,a=$("#thumbnails-wrap").children("li"),l="number"==typeof t?t:a.index($(t.currentTarget).closest("li"));i=Math.floor(n/a.length),"mouse"!=o&&(secnavIndex=l),e.find(".secnavcontainer").hasClass("secnavcontainer-animate")||a.each(function(e,t){t.style.height=i+"px"})},filterTextTimeout,onDocumentScroll=function(){filterTextTimeout&&$timeout.cancel(filterTextTimeout);try{var e,t=$(".extra-nav-wrap"),n=$("#subheaderwrapper"),o=$(".secondary-navigation"),i=(o&&o.height(),$("#thumbnails-wrap"),$("#secnavchevroicon"));windowScrollTop=$(window).scrollTop(),fixedElemHeight=t.outerHeight(),windowScrollTop>63?(o.css("top",fixedElemHeight),thumbnailsWrapHeight=$(window).height()-((scope.optionalSections&&scope.optionalSections.length?193:150)+(fixedElemHeight-63)),t.hasClass("extra-nav-wrap-fixed")||(t.addClass("extra-nav-wrap-fixed"),n.addClass("extra-nav-wrap-fixed"))):(o.css("top","auto"),t.hasClass("extra-nav-wrap-fixed")&&(t.removeClass("extra-nav-wrap-fixed"),n.removeClass("extra-nav-wrap-fixed")),thumbnailsWrapHeight=$(window).height()-((scope.optionalSections&&scope.optionalSections.length?193:150)+fixedElemHeight-windowScrollTop)),o.height(thumbnailsWrapHeight+24),i.css("top",thumbnailsWrapHeight/2),e=o.length&&o.offset().top;var a=scope.sectionTrackerItems&&scope.sectionTrackerItems.length;if(!sectionItemClicked&&a)for(var l=element.find("#"+scope.formWidgetId+"-sortable").find(".cardParent"),r=0;a>r;r++){var s=element.find("#"+scope.formWidgetId+"-section-"+r);if(s.children().length>0){var c=s.offset().top-10,d=c+s.height();if((e>=c&&d>=e||thumbnailsWrapHeightTemp!=thumbnailsWrapHeight)&&(thumbnailsWrapHeightTemp=thumbnailsWrapHeight,newSelected=scope.sectionTrackerItems[r].sectionIndex,scope.sectionTrackerItems[newSelected].visible&&(filterTextTimeout=$timeout(function(){scope.sectionTrackerItems[currentSelectedSection].isActive=!1,scope.sectionTrackerItems[newSelected].isActive=!0,currentSelectedSection=newSelected,"undefined"!=typeof scope.sectionTrackerItems[newSelected].id&&persistenceService.nPlusOne.saveSelectedSection(scope.sectionTrackerItems[newSelected].id),secnavHeightCal(element,l.index(s),thumbnailsWrapHeight)})),l.children(".collapsible-container").removeClass("collapsible-focus"),s.children(".collapsible-container").addClass("collapsible-focus"),e>=c&&d>=e))break}s=null}}catch(u){console.log("onDocumentScroll")}},checkSubheaderHeight,subheaderHeight,newSelected=0,filterTextTimeout=null;setTimeout(function(){isCheckSecnav()},100),setTimeout(function(){isCheckWidget()},1e3);var activeItem;scope.onSectionItemClick=function(e,t,n){for(var o=scope.sectionTrackerItems.length,i=0;o>i;i++)scope.sectionTrackerItems[i].isActive=!1;scope.sectionTrackerItems[t].isActive=!0,currentSelectedSection=t;var a=scope.formConfig.sections[e.sectionIndex];a.isActive=!0,"undefined"!=typeof a.id&&persistenceService.nPlusOne.saveSelectedSection(a.id),scope.formConfig.sections[e.sectionIndex].isActive=!0,sectionItemClicked=!0,activeItem=n,ScrollTo.setScrollingTopMargin(staticTopmargin),ScrollTo.perform(element.find("#"+scope.formWidgetId+"-section-"+e.sectionIndex),angular.element("#"+scope.formWidgetId+"-sortable"),function(e){setTimeout(function(){secnavHeightCal(element,activeItem,thumbnailsWrapHeight),sectionItemClicked=!1},300)})},scope.onOptionalSectionItemClick=function(e,t){if(!e||!t.isVisible){scope.formConfig.sections[t.sectionIndex].isVisible=!scope.formConfig.sections[t.sectionIndex].isVisible;for(var n=scope.sectionTrackerItems.length,o=0;n>o;o++)if(scope.sectionTrackerItems[o].label===t.label){scope.sectionTrackerItems[o].visible=!t.visible;break}if(!scope.$eval(scope.isSequential)&&scope.formConfig.sections[t.sectionIndex].isVisible){var i=scope.formConfig.sections[t.sectionIndex];scope.formConfig.sections.splice(t.sectionIndex,1),scope.formConfig.sections.push(i);for(var o=0;o<scope.sectionTrackerItems.length;o++)if(scope.sectionTrackerItems[o].label===t.label){var i=scope.sectionTrackerItems[o];scope.sectionTrackerItems.splice(o,1),scope.sectionTrackerItems.push(i);break}for(var o=0;o<scope.formConfig.sections.length;o++)for(var a=0;a<scope.sectionTrackerItems.length;a++)scope.formConfig.sections[o].label==scope.sectionTrackerItems[a].label&&(scope.sectionTrackerItems[a].sectionIndex=o);for(var o=0;o<scope.formConfig.sections.length;o++)for(var a=0;a<scope.optionalSections.length;a++)scope.formConfig.sections[o].label==scope.optionalSections[a].label&&(scope.optionalSections[a].sectionIndex=o)}var l=!t.visible,r=setTimeout(function(){l&&(ScrollTo.setScrollingTopMargin(staticTopmargin),ScrollTo.perform(element.find("#"+scope.formWidgetId+"-section-"+t.sectionIndex),angular.element("#"+scope.formWidgetId+"-sortable"),function(){$(".secnavcontainer").hasClass("secnavcontainer-animate")?$(".secnavcontainer").find(".thumbnails-wrap").children("li").each(function(e,t){t.style.height="46px"}):secnavHeightCal(element,secnavIndex,thumbnailsWrapHeight)})),clearTimeout(r)},200);updateVisibleSectionTrackerItemsCount()}},scope.onOptionalFieldClick=function(e,t){t.visible||(ScrollTo.setScrollingTopMargin(staticTopmargin),ScrollTo.perform(element.find("#"+scope.formWidgetId+"-section-"+t.sectionIndex),angular.element("#"+scope.formWidgetId))),scope.$broadcast("optionalFieldClick",{isLabelClicked:e,item:t})},scope.showWidgetPanel=!1,scope.toggleWidgetPanel=function(){scope.showWidgetPanel=!scope.showWidgetPanel},scope.onSort=function(e){scope.sectionTrackerItems[currentSelectedSection].isActive=!1;var t=angular.copy(scope.sectionTrackerItems),n=t.splice(e.startIndex,1);t.splice(e.endIndex,0,n[0]);for(var o=[],i=scope.sectionTrackerItems.length,a=[],l=0;i>l;l++){var r=scope.formConfig.sections[scope.sectionTrackerItems[l].sectionIndex];o.push(r),"undefined"!=typeof r.id&&a.push(r.id)}if(a.length>0&&"undefined"!=typeof scope.formConfig.documentType&&(persistenceService.updateUserData("sections",a),persistenceService.saveUserData(scope.formConfig.documentType)),scope.onSectionSort({$event:{formConfig:o}}),element.find(".secnavcontainer").hasClass("secnavcontainer-animate")){var s=$("#form-widget-1-sortable"),c=s.children("li"),d=c.splice(e.startIndex,1);c.splice(e.endIndex,0,d[0]),s.append(c)}else{var u=$("#thumbnails-wrap"),p=u.children("li"),f=p.splice(e.startIndex,1),g=[],m=0;p.splice(e.endIndex,0,f[0]),$.each(u.get(0).childNodes,function(e,t){$(t).is("li")?(g[e]=p[m],m++):g[e]=t}),u.append(g)}setTimeout(function(){onDocumentScroll()},10)};var previousClickedSection=[];if(scope.initSectionFocus=function(){scope.$on("sectionFocus",function(e,t){var n=getOpenWidgetSection(t.id),o=n.sectionIndex;n&&scope.onSectionItemClick(n,o)})},scope.onSectionClick=function(e){if(attrs.onSave&&(e.hasOwnProperty("save")&&e!=previousClickedSection[previousClickedSection.length-1]&&previousClickedSection.push(e),previousClickedSection.length>2&&previousClickedSection.shift()),scope.sectionTrackerItems[currentSelectedSection].label!==e.label)for(var t=scope.sectionTrackerItems.length,n=0;t>n;n++)if(scope.sectionTrackerItems[n].label===e.label){scope.sectionTrackerItems[currentSelectedSection].isActive=!1,scope.sectionTrackerItems[n].isActive=!0,currentSelectedSection=n,"undefined"!=typeof scope.sectionTrackerItems[n].id&&persistenceService.nPlusOne.saveSelectedSection(scope.sectionTrackerItems[n].id);break}},scope.onSectionHeaderClick=function(section){angular.isDefined(section.onHeaderClick)&&eval("scope."+formWidgetUtils.generateFunctionWithParams(section.onHeaderClick,"$parent",!0)),section.isContentLoaded||(section.isContentLoaded=!0);var $itemSelected=element.find("#"+section.key);if(!$itemSelected.find(".collapsible-body").hasClass("displayBlock")){var displacementItem=$itemSelected.offset().top-angular.element("#"+scope.formWidgetId+"-sortable").offset().top;displacementItem+=staticTopmargin,setTimeout(function(){angular.element("body,html").animate({scrollTop:displacementItem},"medium")},200)}},attrs.onSave){var onDocumentClick=function(e){if(previousClickedSection.length){var t=$(e.target).closest("#"+previousClickedSection[0].key).length;(!t||t&&$(e.target).closest(".savable").length)&&($(e.target).closest(".modal").length||$(e.target).closest(".noSaveItem").length||$(e.target).closest(".lean-overlay").length||(scope.onSave({data:scope.modelData,prevObj:previousClickedSection[0]}),previousClickedSection.shift()))}};$(document).off("click.saveSection").on("click.saveSection",onDocumentClick),$(document).off("change.saveSelect").on("change.saveSelect",".select-wrapper select",function(e){var t=$(this).closest(".card.cardParent").attr("id").split("section-"),n=scope.formConfig.sections[t[1]];n.hasOwnProperty("save")&&n!=previousClickedSection[previousClickedSection.length-1]&&previousClickedSection.push(n),previousClickedSection.length>2&&previousClickedSection.shift(),onDocumentClick(e)})}scope.$on("$destroy",function(){$(document).off("scroll.secnav click.saveSection change.saveSelect"),$("#sevnav-overlay")&&$("#sevnav-overlay").remove(),element.off("mouseenter.secnav mouseleave.secnav click.secnavchevroicon mouseenter.secnavform"),onSubHeaderHeight(),onFormConfig()}),scope.iconClasses=APPCONSTANTS.formWidgetItemClasses}},templateUrl:"shared/directives/uiElements/smartFormWidget/smartFormWidgetTemplate.html"}}]),angular.module("SMART2").directive("smartSvgIcon",[function(){return{restrict:"A",link:function(e,t,n){t.html('<svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#'+n.smartSvgIcon+'"></use></svg>')}}}]),angular.module("SMART2").filter("highlight",["$sce",function(e){return function(t,n){return n&&(t=t.replace(new RegExp("("+n+")","gi"),'<span style="background: yellow">$1</span>')),e.trustAsHtml(t)}}])}(),function(){"use strict";angular.module("SMART2").directive("smartGrid",["$filter",function(e){return{restrict:"AE",scope:{gridConfig:"=config"},controller:function(t){t.currencyFormatter=function(n,o,i,a){var l=n;i&&(l=Number(n).toFixed(0));var r;return l>=1e6||-1e6>=l?(shortamount=l/1e6,r=t.currencyFormatter(shortamount,o,!1,a),r+=" MM"):(r=e("currency")(l),void 0!=a&&(o=a),0>l?r=void 0!==o?e("currency")(l,o).replace("(","-").replace(")",""):e("currency")(l).replace("(","-").replace(")",""):void 0!==o&&(r=e("currency")(l,o)),i&&0==parseInt(r.substring(r.length-2,r.length))&&(r=r.substring(0,r.length-3))),r.toString()},t.numberFormatter=function(t,n){var o=t;if(n&&(o=Number(t).toFixed(0)),o>=1e6||-1e6>=o){var i=o/1e6;return o=n?Number(i).toFixed(0):i,e("number")(o)+" MM"}return e("number")(o)}},link:function(e,t,n){var o,i,a,l,r,s,c,d,u,p;e.$watch("gridConfig",function(n,f){if(n){e.config=e.gridConfig,e.config&&e.config.headerTemplate&&(o=e.config.headerTemplate),e.config&&e.config.rowTemplate&&(i=e.config.rowTemplate),e.config&&e.config.headerData&&(a=e.config.headerData),e.config&&e.config.rowData&&(l=e.config.rowData),e.config&&e.config.dimension&&e.config.dimension.height?e.gridHeight=e.config.dimension.height:e.gridHeight=t.parent().outerHeight(!0),e.gridHeight=e.gridHeight-1,e.config&&e.config.cellRenderer&&(s=e.config.cellRenderer),e.config&&e.config.headerCellRenderer&&(c=e.config.headerCellRenderer),e.config&&e.config.onClick&&(d=e.config.onClick),e.config&&e.config.cellTemplate&&(r=e.config.cellTemplate),u=e.config&&e.config.rowHeight?e.config.rowHeight:40,e.config&&e.config.cellStyle&&(p=e.config.cellStyle);for(var g=[],m=t.parent().outerWidth()/a.length,h=0;h<a.length;h++)g.push({displayName:a[h].title,field:a[h].datamappingkey,suppressSorting:a[h].sortable?!1:!0,formatterType:a[h].formatterType,clickable:a[h].clickable?!0:!1,align:a[h].align,width:void 0!=a[h].width?a[h].width:m,cellStyle:void 0!=a[h].cellStyle?a[h].cellStyle:void 0}),"currency"==a[h].formatterType&&(g[g.length-1].defaultCurrency=a[h].defaultCurrency),void 0!=r?g[g.length-1].template=r:g[g.length-1].cellRenderer=s?s:function(t){var n,o;switch(t.colDef.formatterType){case"link":n=o="<a>"+t.value+"</a>";break;case"number":t.colDef.clickable&&(n=o="<a>"+t.value+"</a>");break;case"currency":n=o=e.currencyFormatter(t.value,void 0,!0,t.colDef.defaultCurrency),t.colDef.clickable&&(n="<a>"+n+"</a>");break;default:n=0===t.value||"0"===t.value?"0":"null"==t.value||null==t.value||""==t.value?'<span style="color: transparent;">-</span>':t.value,o=t.value,t.colDef.clickable&&(n="<a>"+n+"</a>")}return"null"==t.value||null==t.value||""==t.value?'<span style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; float: '+t.colDef.align+"; text-align: "+t.colDef.align+';">'+n+"</span>":'<span style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; float: '+t.colDef.align+"; text-align: "+t.colDef.align+';" title="'+o+'">'+n+"</span>"};for(var v=[],h=0;h<l.length;h++){v[h]={};for(var y=0;y<g.length;y++)v[h][g[y].field]=l[h][g[y].field]}e.angularGridConfig?(e.angularGridConfig.columnDefs=g,e.angularGridConfig.rowData=v,e.angularGridConfig.api.onNewRows()):e.angularGridConfig={columnDefs:g,rowData:v,enableSorting:!0,angularCompileRows:!0,virtualPaging:!0,enableColResize:!0,angularCompileHeaders:e.config&&e.config.angularCompileHeaders,headerCellRenderer:c?c:function(e){return'<span style="width: 80%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; float: '+e.colDef.align+"; text-align: "+e.colDef.align+';">'+e.colDef.displayName+"</span>"},cellClicked:d?function(e){d({dataMappingKey:e.colDef.field,value:e.value,rowIndex:e.rowIndex,rowData:l[e.rowIndex],clickable:e.colDef.clickable})}:void 0,rowHeight:void 0==u?void 0:u}}})},templateUrl:"shared/directives/uiElements/smartGrid/smartGrid.html"}}])}(),angular.module("SMART2").directive("smartInfotip",["$window",function(e){"use strict";var t={},n=function(e){t.target&&t.target.hasClass("isInfotipVisible")&&(t.target.removeClass("isInfotipVisible"),t.infotip.find(".infotip-popover").addClass("hide-popover-element"),t.infotip.find(".infotip-popover-triangle").addClass("hide-popover-element"),t._ev.value=!0)};return $(document).click(function(e){n()}),{restrict:"A",transclude:!0,scope:!0,link:function(o,i,a){var l,r,s=i.find(".infotip-popover-container"),c=s.parent(),d=i.find(".infotip-popover"),u=i.find(".infotip-popover-triangle"),p=15,f=30,g=i,m=""===c.css("position")||"static"===c.css("position")?"relative":c.css("position"),h=angular.element(e),v=a.bindOn?a.bindOn:"click mouseover interesected";
c.css({position:m,"z-index":"1",display:"inline-block"}),l=Math.sqrt(p*p/2),r=Math.sqrt(p*p*2);var y=""===a.mode||void 0===a.mode?"mouseover":a.mode,b=void 0===a.closeOnClick?"click"==y?!0:!1:"true"===a.closeOnClick,C=void 0===a.closeOnMouseleave?"mouseover"==y?!0:!1:"true"===a.closeOnMouseleave,w={value:"true"==a.hideOnDocHover};o.getContentPopover=a.templateUrl,o.isTemplateUrl=a.templateUrl?!0:!1;var S=function(){return"infotip-popover-triangle-"+a.position},x=function(){setTimeout(function(){!T()&&w.value&&(d.addClass("hide-popover-element"),u.addClass("hide-popover-element"))},0)},T=function(){return d.is(":hover")||g.is(":hover")||u.is(":hover")};o.triangleClass=S(),C&&(w.value?(g.bind("mouseleave blur",function(){x()}),d.bind("mouseleave blur",function(){x()}),u.bind("mouseleave blur",function(){x()})):g.bind("mouseleave blur ",function(){d.addClass("hide-popover-element"),u.addClass("hide-popover-element")})),"click"!=y&&b&&g.bind("click",function(){d.addClass("hide-popover-element"),u.addClass("hide-popover-element")}),d.on("click",function(e){e.stopPropagation()}),h.bind("scroll",function(e){d.addClass("hide-popover-element"),u.addClass("hide-popover-element")}),g.bind(v,function(e){e.stopImmediatePropagation();var r,c,m,h,v=$(this),b=v.outerHeight(),C=i.offset().top+23,x=i.offset().left;if("click"==e.type&&(n(),w.value=!1,v.addClass("isInfotipVisible"),t.target=v,t.infotip=s,t._ev=w),"canvas"==y&&(C=100,x=100,b=100),s.css("top",b),r=v.outerWidth(),d.hasClass("hide-popover-element")&&""!=a.message&&(d.removeClass("hide-popover-element"),u.removeClass("hide-popover-element")),a.message){var T=v.find(".infotip-popover-template");T.html(a.message)}var D=function(e){v.find("."+o.triangleClass).removeClass(o.triangleClass),u.removeClass(o.triangleClass),a.position=e,o.triangleClass=S(),u.addClass(o.triangleClass)};a.position=""===a.position||void 0===a.position?"top":a.position;var k=function(){var e=d.offset();$("body").scrollTop()||$("html").scrollTop();e.left+d.width()>$(window).width()?(h=!0,D("left")):e.left<10?D("right"):d[0].getBoundingClientRect().top<0?D("bottom"):d[0].getBoundingClientRect().top+d.height()>=$(window).height()&&D("top")},M=function(){if(c=d.outerHeight(),m=d.outerWidth(),"canvas"==y){if(c=100,m=100,g.attr("interesect")){var e,t=JSON.parse(g.attr("interesect"));d.css({top:t.y-l-100,left:t.x}),u.css({top:t.y-l-100,left:t.x-f})}return e=v.find(".infotip-popover-template"),void e.html(g.attr("message"))}switch(a.position){case"top":d.css({top:-b-c-l,left:(r-m)/2}),u.css({top:-b-l,left:(r-f)/2});break;case"bottom":d.css({top:l,left:(r-m)/2}),u.css({top:-(f-l),left:(r-f)/2});break;case"right":d.css({top:(b-c)/2-b,left:r+l}),u.css({top:(b-f)/2-b,left:r-(f-l)});break;case"left":h&&d.css({left:-(m+p)}),d.css({top:(b-c)/2-b,right:l}),u.css({top:(b-f)/2-b,left:-l}),"true"==a.customStyle&&(d.css({left:-(m+p-5)}),u.css({top:(b-f)/2-b+5}))}},F=function(){if("true"==a.isFixed){s.data("appended")||angular.element("body").append(s.data("appended",!0)),"true"==a.customStyle&&s.addClass("fullWidthInfo"),"true"==a.showFullTip&&s.addClass("showFullTip");var e=s.find(".infotip-popover-template");e.html(a.message),s.css({top:C+"px",left:x+"px"})}};M(),F(),k(),M(),F()})},templateUrl:"shared/directives/uiElements/smartInfotip/smartInfotipTemplate.html"}}]),function(){"use strict";angular.module("SMART2").directive("smartList",["$parse","$window","commonUtilities",function(e,t,n){return{restrict:"AE",replace:!1,scope:!0,link:function(t,o,i){t.styleClass="collection",t.itemClass="collection-item";var a=e(i.clickCallback);i.$observe("selectiveDisplayConfig",function(e){e?t.listDisplayConfig=t.$eval(e):t.listDisplayConfig={showIcon:!0,showAction:!1,importantAttribLimit:5}}),t.listClickHandler=function(e){angular.isFunction(a)&&a(t,{e:e})},i.$observe("height",function(e){e&&(t.listHeight=e)}),i.$observe("model",function(e){e&&(t.dataModel=t.$eval(e))}),i.$observe("styleClass",function(e){t.styleClass=e}),i.$observe("itemClass",function(e){t.itemClass=e}),i.$observe("template",function(e){t.template=e});var l=e(i.lazyLoadCallback),r=e(i.backToTopCallback),s=e(i.scrollInProgress);t.scrollEndCallback=function(){angular.isFunction(l)&&l(t,{e:""})},t.scrollToTopCallback=function(){angular.isFunction(r)&&r(t,{e:""})},t.scrollInProgress=function(){angular.isFunction(s)&&s(t,{e:""})},t.actionElementID=n.uniqueIDGenerator},templateUrl:"shared/directives/uiElements/smartList/smartListTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartListLookup",["$rootScope","$timeout","ScrollTo","lookup","debouncer",function($rootScope,$timeout,ScrollTo,lookup,debouncer){return{restrict:"E",replace:!0,scope:{label:"@",ngModel:"=?",options:"=?",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",callAddNew:"&",lookupOpen:"&",lookupHide:"&",searchtextKeyUp:"&",readonly:"@",displayformat:"@",multiselect:"@",addnew:"@",titleofmodel:"@",selecttypeoption:"="},link:function(scope,element,attrs){function generateName(e){for(var t="",n=formatedArray.length,o=0;n>o;o++)e.hasOwnProperty(formatedArray[o])&&(t=t+" "+e[formatedArray[o]]);return t}scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel;var multiselect=void 0==scope.multiselect||null==scope.multiselect?!1:"true"==scope.multiselect?!0:!1,addnew=void 0==scope.addnew||null==scope.addnew?!1:"true"==scope.addnew?!0:!1,formatedArray=eval(scope.displayformat);scope.valuetoshow=[""],scope.titleofmodel=void 0==scope.titleofmodel||null==scope.titleofmodel?"Title Of Model":scope.titleofmodel,scope.toolTip="";var isInfoTipEnable="true"==attrs.showInfoTip?!0:!1,checkInfoToolTip=function(){scope.ngModel;isInfoTipEnable&&(scope.toolTip=_.pluck(scope.ngModel,"name").join("</br>"))},deregisterWatchModel=scope.$watch("ngModel",function(e){if(scope.valuetoshow=[""],multiselect){if(angular.isDefined(e)&&e.length>0){scope.valuetoshow=[generateName(e[0])];var t=e.length;t>1&&scope.valuetoshow.push("+"+(t-1)+" More")}}else scope.valuetoshow=[generateName(e)];""==scope.valuetoshow[0]?scope.isActive=!1:scope.isActive=!0,checkInfoToolTip()});scope.openLookup=function(){debouncer.add(function(){if("true"===scope.readonly&&!scope.valuetoshow[1])return!1;$.isFunction(scope.lookupOpen)&&scope.lookupOpen();var e={modelData:scope.ngModel,config:{mutliselect:multiselect,displayProperties:formatedArray,options:scope.options,addnew:addnew,isMandatory:scope.isMandatory,onKeyUp:attrs.searchtextKeyUp?scope.searchtextKeyUp:"",titleOfModel:scope.titleofmodel,selectTypeOption:scope.selecttypeoption,readonly:void 0==scope.readonly||null==scope.readonly?!1:"true"==scope.readonly?!0:!1}},t=$timeout(function(){lookup.open(e,function(e){e.addnew&&$.isFunction(scope.callAddNew)&&scope.callAddNew(),scope.ngModel=e.result,scope.defaultselectiontext=e.defaultSelectionText,scope.selecttypeoption=e.selectTypeOption,$.isFunction(scope.lookupHide)&&scope.lookupHide({data:e})}),$timeout.cancel(t),t=null})},300)},scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel,scope.$on("$destroy",function(){deregisterWatchModel()})},templateUrl:"shared/directives/uiElements/smartListLookup/smartListLookupTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").factory("lookup",["$rootScope",function(e){var t={};return t.onCallback=void 0,t.on=function(e){t.onCallback=e},t.open=function(e,t){this.config=e,this.broadcastItem(),this.resultCallBack=function(e){t(e)}},t.optionUpdate=function(e){"undefined"!=typeof this.config&&(this.config.config.options=e)},t.getConfig=function(){return this.config},t.setTempModel=function(e){this.tempModel=e},t.getTempModel=function(){return this.tempModel},t.onScrollEnd=function(e){this.onScrollEndCall=function(){e()}},t.onScrollTop=function(e){this.onScrollTopCall=function(){e()}},t.onScrollInProgress=function(e){this.onScrollInProgressCall=function(){e()}},t.broadcastItem=function(){angular.isFunction(t.onCallback)&&t.onCallback()},t}]);var e=0;angular.module("SMART2").directive("smartLookup",["$rootScope","$timeout","$translate","ScrollTo","lookup",function(t,n,o,i,a){return{restrict:"E",replace:!0,scope:{label:"@"},link:function(t,i,l){function r(e,t){var n=function(){for(var e in t);return void 0==e?!1:!0};if(""==t||null==t||n()===!1)return!1;for(var o in t)if(t.hasOwnProperty(o)){if(!e.hasOwnProperty(o))return!1;if(t[o]!=e[o])return!1}return!0}function s(e,t,n){for(var o=0;o<t.length;o++)if(n){if(e.UserId==t[o])return!0}else if(r(e,t[o]))return!0;return!1}function c(e){var n="";if(1==t.displayProperties.length)n=e[t.displayProperties[0]];else for(var o=0;o<t.displayProperties.length;o++)n=void 0!==t.propSeparation&&o!==t.displayProperties.length-1?n+" "+e[t.displayProperties[o]]+" "+t.propSeparation:n+" "+e[t.displayProperties[o]];return n}function d(){if(t.propKey="counterProp"+e,void 0==t.options||void 0==t.config.options?t.options=[]:t.options=t.config.options,t.multiple){for(var n=0;n<t.options.length;n++)t.options[n].hasOwnProperty("ischecked")||f||(s(t.options[n],t.model,t.isObjectCompareCatalog)?(t.options[n].ischecked=!0,t.options[n][t.propKey]=c(t.options[n])):(t.options[n].ischecked=!1,t.options[n][t.propKey]=c(t.options[n])),t.descriptionKey&&(t.options[n].description=t.options[n][t.descriptionKey]));t.minMultiselect&&m()}else for(var n=0;n<t.options.length;n++)f||(r(t.options[n],t.model)?(t.options[n].ischecked=!0,t.options[n][t.propKey]=c(t.options[n])):(t.options[n].ischecked=!1,t.options[n][t.propKey]=c(t.options[n])),t.descriptionKey&&(t.options[n].description=t.options[n][t.descriptionKey]));t.limitToCount=t.isLazyLoadingEnabled?35:t.options.length}function u(){1==t.scrollAlwaysTopOnload&&0==t.scrollReload?t.scrollReload=!0:1==t.scrollAlwaysTopOnload&&1==t.scrollReload&&(t.scrollReload=!1)}function p(){f=!0;for(var e=0;e<t.options.length;e++)delete t.options[e].ischecked,delete t.options[e][t.propKey];n(function(){f=!1},500)}t.searchText={title:""},t.cancelTitle=""==t.searchText.title?o.instant("closeSearch"):o.instant("clearSearch"),t.smartScrollEnd=function(){angular.isFunction(a.onScrollEndCall)&&a.onScrollEndCall(),n(function(){t.isLazyLoadingEnabled&&t.limitToCount<=t.options.length&&(t.limitToCount=t.limitToCount+35)})},t.smartScrollTop=function(){angular.isFunction(a.onScrollTopCall)&&a.onScrollTopCall()},t.smartScrollInProgress=function(){angular.isFunction(a.onScrollInProgressCall)&&a.onScrollInProgressCall()},t.searchText={title:""},t.selectdCount=0,t.model=[],t.options=[],t.displayProperties=["name"],t.selectTypeOptionWith="",t.propKey="",e++;var f=!1;t.searchTextKeyUpFn=function(e){t.config.onKeyUp&&t.config.onKeyUp({$data:{text:e.target.value,type:"textfield",e:e}}),13==e.keyCode&&(i.find("#lookup-content-wrpper .scroll-content").scrollTop(0),t.clearModelOnEnter&&(t.model=[])),t.cancelTitle=""==e.target.value?o.instant("closeSearch"):o.instant("clearSearch")};new RegExp("","ig");t.triggerFlag=!1;var g={};a.on(function(){t.config=a.config.config,t.minMultiselect=t.config.minMultiselect,t.label=t.config.label,t.isSearchOpen=!1,t.multiple=!1,t.addnew=!1,t.readonly=!1,t.multiple="undefined"==typeof t.config.mutliselect?!1:t.config.mutliselect,t.addnew="undefined"==typeof t.config.addnew?!1:t.config.addnew,t.readonly="undefined"==typeof t.config.readonly?!1:t.config.readonly,t.titleOfModel="undefined"==typeof t.config.titleOfModel?o.instant("titleOfModel"):t.config.titleOfModel,t.config.defaultSelectOption="undefined"==typeof t.config.defaultSelectOption?!1:t.config.defaultSelectOption,t.config.defaultSelectionText="undefined"==typeof t.config.defaultSelectionText?"":t.config.defaultSelectionText,t.config.selectTypeOption="undefined"==typeof t.config.selectTypeOption?null:t.config.selectTypeOption,t.selectiontext=angular.copy(t.config.selectTypeOption),t.model=a.config.modelData,t.isLazyLoadingEnabled=t.config.isLazyLoadingEnabled,angular.isDefined(t.model)&&(""!=t.model||angular.equals(t.model,{}))?t.multiple?t.selectdCount=t.model.length||0:(t.model.hasOwnProperty("name")||t.model.hasOwnProperty("value")||t.model.hasOwnProperty("id"))&&(t.selectdCount=1):t.selectdCount=0,t.options=t.config.options,t.limitToCount=t.isLazyLoadingEnabled?35:t.options.length,t.displayProperties=t.config.displayProperties.length>0?t.config.displayProperties:t.displayProperties,t.descriptionKey=t.config.descriptionKey,t.propSeparation=t.config.propSeparation,t.scrollAlwaysTopOnload=void 0===t.config.scrollAlwaysTopOnload?!1:t.config.scrollAlwaysTopOnload,t.scrollReload=t.scrollAlwaysTopOnload?!1:!0,t.selectTypeOptionWith=t.config.selectTypeOptionWith?t.config.selectTypeOptionWith:t.selectTypeOptionWith,t.searchFilterKey=t.config.searchFilterKey,t.stopFilterOnKey=t.config.stopFilterOnKey,t.hideSelectedCount=t.config.hideSelectedCount,t.isObjectCompareCatalog=t.config.isObjectCompareCatalog,t.clearModelOnEnter=t.config.clearModelOnEnter,d(),t.triggerFlag=!0,u(),n(function(){i.find('.lookupPopupContent input[checked="checked"]').prop("checked",!0)}),t.$watch(function(){return a.config.config.options},function(e,t){d()},!0),g.addnew=!1,g.result=t.model,g.btnType="",g.defaultSelectionText=t.config.defaultSelectionText.trim(),g.selectTypeOption=t.config.selectTypeOption,g.errorModel=t.config.errorModel,t.defaultError=!1,0==t.selectdCount&&t.$eval(t.config.isMandatory)?t.itemSelected=!1:t.itemSelected=!0,t.isLimitmultiselect=t.minMultiselect?t.minMultiselect.event:!1,t.minMultiselect}),t.searchToggle=function(){0==t.isSearchOpen&&(t.isSearchOpen=!0,n(function(){$("#searchTextbox").find("input").length?$("#searchTextbox").find("input").focus():$("#searchTextbox").focus()})),t.config.onKeyUp&&t.config.onKeyUp({$data:{text:t.searchText.title,type:"search"}}),t.cancelTitle=""==t.searchText.title?o.instant("closeSearch"):o.instant("clearSearch")},t.closeSearch=function(){""!=t.searchText.title?t.searchText.title="":(t.isSearchOpen=!1,$("#btnShowSearch").focus()),t.config.onKeyUp&&t.config.onKeyUp({$data:{text:t.searchText.title,type:"close"}}),t.cancelTitle=""==t.searchText.title?o.instant("closeSearch"):o.instant("clearSearch")},t.ondefaultSelectItem=function(e){e.ischecked=!0,t.onChangeItem(e),t.defaultError=!1,t.config.errorModel=""};var m=function(){if(t.selectdCount>=parseInt(t.minMultiselect.value))for(var e=0;e<t.options.length;e++)t.options[e].ischecked?t.options[e].isdisable=!1:t.options[e].isdisable=!0;else for(var e=0;e<t.options.length;e++)t.options[e].isdisable=!1};t.optionUnSelected=[],t.onChangeItem=function(e){t.multiple?(e.ischecked?t.selectdCount++:(t.selectdCount--,t.optionUnSelected.push(e),t.$eval(t.config.isDefaultMandatory)&&e[t.propKey]===t.config.defaultSelectionText&&(t.config.defaultSelectionText="")),0==t.selectdCount&&t.$eval(t.config.isMandatory)?(t.itemSelected=!1,t.config.errorModel=o.instant("selectValueErrMsg")):(t.itemSelected=!0,t.config.errorModel=""),t.minMultiselect&&t.minMultiselect.event&&m()):(t.model=e,t.itemSelected=!0,t.config.errorModel="",d())},t.defaultError=!1,t.cancelButton={title:o.instant("cancelBtn")},t.doneButton={title:o.instant("doneBtn")},t.selectionCancel=function(){g.btnType="cancel"},t.selectionDone=function(){if(g.UnSelectedResult=[],t.itemSelected||!t.$eval(t.config.isMandatory)){if(t.$eval(t.config.isDefaultMandatory)&&""==t.config.defaultSelectionText)return t.defaultError=!0,void(t.config.errorModel=o.instant("markPaymentErrMsg"));if(t.multiple){var e=[];f=!0;for(var i=0;i<t.options.length;i++)delete t.options[i][t.propKey],t.options[i].ischecked&&(delete t.options[i].ischecked,t.config.defaultSelectionText.trim()===t.options[i].name?e.unshift(t.options[i]):e.push(t.options[i]));p(),n(function(){f=!1},500)}else f=!0,delete t.model.ischecked,delete t.model[t.propKey],e=t.model,null!=t.config.selectTypeOption&&(t.config.selectTypeOption.selectiontext=t.selectiontext.selectiontext),p(),n(function(){f=!1},500);g.result=e,g.UnSelectedResult=t.optionUnSelected,t.optionUnSelected=[],g.btnType="save",g.defaultSelectionText=t.config.defaultSelectionText.trim(),g.selectTypeOption=t.config.selectTypeOption,g.errorModel=t.config.errorModel,t.callbackOnHide()}},t.addNew=function(){p(),g.addnew=!0,t.triggerFlag=!1,u()},t.callbackOnHide=function(e){t.triggerFlag=!1,u(),t.searchText.title="",t.isLazyLoadingEnabled&&(t.limitToCount=35),t.isSearchOpen=!1,f=!0;for(var o=0;o<t.options.length;o++)delete t.options[o].ischecked,delete t.options[o][t.propKey];n(function(){f=!1}),a.resultCallBack(g)}},templateUrl:"shared/directives/uiElements/smartLookup/smartLookupTemplate.html"}}])}(),function(){"use strict";var multiSelectId=0;angular.module("SMART2").directive("smartMultiselect",["$timeout","$translate","RuleEngine",function($timeout,$translate,RuleEngine){return{restrict:"E",replace:!0,scope:{label:"@",options:"=?",ngModel:"=?",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",onChange:"&",onSelect:"&",onBlur:"&",disable:"@",readonly:"@",multiple:"@",datakey:"@",removable:"@",autocomplete:"@",filterkeys:"@",optionformat:"@",displayformat:"@",width:"@"},link:function(scope,element,attrs){function getFormattedData(data){var dataLen=data.length;if(!data||0==dataLen)return[];for(var i=0;dataLen>i;i++){var str=displayFormat;try{for(var parentSplit=str.split("{"),parentSplitLen=parentSplit.length,j=0;parentSplitLen>j;j++)for(var childSplit=parentSplit[j].split("}"),childSplitLen=childSplit.length,k=0;childSplitLen>k;k++){var childItem=childSplit[k];(childItem.indexOf(".")>0||data[i].hasOwnProperty(childItem))&&(str=str.replace(new RegExp("{"+childItem+"}","ig"),eval("data[i]."+childItem)))}}catch(e){}data[i].value=str.trim()}return data}var options,filterKeys;scope.defaultText="";var disableBlurEvent=!0;void 0!=attrs.id||null!=attrs.id?(scope.multiSelectId=attrs.id,element.removeAttr("id")):(multiSelectId+=multiSelectId,scope.multiSelectId="multiselect-"+multiSelectId),scope.labelForMultiSelectId="label-for-"+scope.multiSelectId,scope.displayformat=scope.displayformat?scope.displayformat:"{title}";var modelConfig=scope.$watch("ngModel",function(e){e&&(scope.selectedOptions=e)});scope.multiSelectFocus=function(){scope.$eval(scope.disable)||scope.$eval(scope.readonly)||$("#"+scope.multiSelectId).focus()},scope.setDisplayFormat=function(e){var t=scope.displayformat.substring(1,scope.displayformat.length-1);t=t.replace(/  +/g," ");for(var n="",o=t.split("} {"),i=o.length,a=0;i>a;a++)n+=e[o[a]]+" ";return n};var currentSelectForDelete=scope.ngModel.length;scope.ngKeyDown=function(e){var t=e.keyCode;if(40===t&&""==e.target.value&&e.stopImmediatePropagation(),scope.ngModel.length>0)if(8!==t&&46!==t||""!=scope.defaultText)if(37===t&&""==scope.defaultText)currentSelectForDelete>0&&(scope.ngModel[currentSelectForDelete-1].selectForDelete=!0,currentSelectForDelete<scope.ngModel.length&&(scope.ngModel[currentSelectForDelete].selectForDelete=!1),currentSelectForDelete--);else if(39===t&&""==scope.defaultText)currentSelectForDelete<scope.ngModel.length-1&&(scope.ngModel[currentSelectForDelete+1].selectForDelete=!0,currentSelectForDelete>=0&&(scope.ngModel[currentSelectForDelete].selectForDelete=!1),currentSelectForDelete++);else if(currentSelectForDelete<scope.ngModel.length)scope.ngModel[currentSelectForDelete].selectForDelete=!1;else{var n=_.find(scope.ngModel,{isInvalid:!0});n?scope.invalidEmailId=!0:(scope.invalidEmailId=!1,scope.validate=!1,scope.errorMessage=null)}else if(currentSelectForDelete>=scope.ngModel.length)if(currentSelectForDelete=scope.ngModel.length-1,scope.ngModel[currentSelectForDelete].selectForDelete===!1)scope.ngModel[currentSelectForDelete].selectForDelete=!0,currentSelectForDelete=scope.ngModel.length-1;else{scope.ngModel.splice(currentSelectForDelete,1),currentSelectForDelete=scope.ngModel.length;var n=_.find(scope.ngModel,{isInvalid:!0});n||(scope.invalidEmailId=!1,scope.validate=!1,scope.errorMessage=null)}else scope.ngModel[currentSelectForDelete].selectForDelete===!0&&(scope.ngModel.splice(currentSelectForDelete,1),currentSelectForDelete=scope.ngModel.length);else scope.invalidEmailId=!1,scope.validate=!1,scope.errorMessage=null};var checkEmailValidation=function(e,t){if(13==e.keyCode||9==e.keyCode||t){var n=element.find(".multiselect-input").val().split(";"),o=/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i,i=[],a=[];angular.forEach(n,function(e){e&&i.push(e.trim())});for(var l=i.length,r=0;l>r;r++){var s=i[r];if(""==s)return!1;var c={UserName:s,value:s};if(o.test(s)?(c.isInvalid=!1,scope.invalidEmailId=!1):(c.isInvalid=!0,scope.invalidEmailId=!0,a.push(c)),c.isInvalid)scope.validateRules();else{scope.ngModel.push(c),scope.setDisplayFormat(c),scope.defaultText="";var d=$timeout(function(){scope.onSelect({$event:{data:c}}),currentSelectForDelete=scope.ngModel.length,scope.validateRules(),disableBlurEvent=!0,$timeout.cancel(d),d=null})}}var u=a.map(function(e){return e.UserName});scope.defaultText=u.join(";"),u.length>0&&(scope.invalidEmailId=!0),scope.validateRules()}};scope.ngKeyUp=function(e,t){checkEmailValidation(e,t);var n=$(e.target),o=250,i=$timeout(function(){if(13==e.keyCode&&0==n.parent(".multiselect-chip-wrap").find(".multiselect-input").val().length)n.width(o);else{var t=n.parent(".multiselect-chip-wrap").find(".multiselect-input");t.val().length>=32?(o=t.val().length,n.width(10*o)):n.width(o)}$timeout.cancel(i),i=null})},scope.deleteSelected=function(e){disableBlurEvent=!1,scope.ngModel.splice(e,1),$("#"+scope.multiSelectId).focus();var t=_.find(scope.ngModel,{isInvalid:!0});return 0!==scope.ngModel.length&&t?void 0:(scope.invalidEmailId=!1,scope.validate=!1,void(scope.errorMessage=null))};var onvalidateConfig=scope.$watch("validate",function(e,t){e&&scope.validateRules()});scope.ngChange=function(e){scope.onChange({$event:{data:angular.element("#"+scope.multiSelectId)}})},scope.ngBlur=function(e){function t(){disableBlurEvent&&scope.ngKeyUp(e,!0),disableBlurEvent=!0,$timeout.cancel(n),n=null}var n=$timeout(t,200);scope.onBlur({$event:e})},scope.validateRules=function(){if("true"!=scope.readonly){var isInvalidId=_.find(scope.ngModel,{isInvalid:!0});if(scope.invalidEmailId||isInvalidId)return scope.validate=!0,void(scope.errorMessage=$translate.instant("invalidEmailErrMsg"));if(scope.$eval(scope.isMandatory)&&(scope.ngModel+""==""||null==scope.ngModel||void 0==scope.ngModel))return scope.validate=!0,void(scope.errorMessage=$translate.instant("enterValueErrMsg"));if(scope.validate=!1,scope.errorMessage=null,scope.rules)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,rulesLen=rules.length,i=0;rulesLen>i;i++){var rulesItem=rules[i];if("object"==typeof rulesItem){if(eval(rulesItem.rule.replace(/this/g,"scope.ngModel"))){scope.validate=!0,scope.errorMessage=rulesItem.error;break}}else{if(isFoundInvalid)break;if("object"!=typeof scope.ngModel)var data=scope.ngModel;else var data=scope.displayModel;RuleEngine.isValid(rulesItem,function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,isFoundInvalid=!0},data)}}}},filterKeys=angular.isDefined(scope.filterkeys)&&0==scope.filterkeys.trim().indexOf("[")?scope.filterkeys?scope.$eval(scope.filterkeys):["title"]:scope.filterkeys?scope.$eval("["+scope.filterkeys+"]"):["title"];var optionFormat=scope.optionformat?scope.optionformat:"{title}",displayFormat=scope.displayformat?scope.displayformat:"{title}",optionsConfig=scope.$watch("options",function(e){var t=$("#"+scope.multiSelectId);try{t.devbridgeAutocomplete()?t.devbridgeAutocomplete().setLookup(getFormattedData(e)):t.devbridgeAutocomplete({filterKeys:filterKeys,optionFormat:optionFormat,displayFormat:displayFormat,lookup:getFormattedData(e),width:scope.width,onSelect:function(e){scope.$evalAsync(function(){scope.ngModel.push(e)}),$(this).focus(),scope.defaultText="";var t=$timeout(function(){scope.defaultText="",scope.onSelect({$event:{data:e}}),currentSelectForDelete=scope.ngModel.length,scope.validateRules(),$timeout.cancel(t),t=null});angular.element(".autocomplete-suggestions").hide()}})}catch(n){}});scope.$on("$destroy",function(){$("#"+scope.multiSelectId).devbridgeAutocomplete()&&$("#"+scope.multiSelectId).devbridgeAutocomplete().dispose(),modelConfig(),onvalidateConfig(),optionsConfig()})},templateUrl:"shared/directives/uiElements/smartMultiselect/smartMultiselectTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartPopup",["$rootScope","$parse","$timeout","$smartModal","$focusOnField",function(e,t,n,o,i){return{restrict:"E",replace:!0,scope:!0,controller:["$controller","$scope","$attrs","$scoper",function(e,t,n,o){var i,a=t,l=o.getScope(a,n.popupConfig);if(l){if(l.controller){var r={$scope:a};if(l.resolve){var s;angular.forEach(l.resolve,function(e,t){s="function"==typeof e?e():e,this[t]=s},r)}i=e(l.controller,r),i.$$smartModal=!0}}else i=a;return i}],link:function(a,l,r,s){function c(){l.find("[id^=typeahead-]").each(function(e,t){var n=$(this).data().autocomplete;n&&n.visible&&n.hide()})}var d,u=t(r.onHide);if(r.afterCompleteClosePopup)var p=t(r.afterCompleteClosePopup);var f=0;a.isCancelButton=r.cancelButton?a.$eval(r.cancelButton):!1,a.headerUrl=r.headerUrl,a.contentUrl=r.contentUrl,a.footerUrl=r.footerUrl,a.templateUrl=r.templateUrl,a.modalType=r.type,a.isDraggable=r.isDraggable,a.isDraggable&&angular.element(l).draggable({start:function(){c()},containment:".is-popup-Draggable"});var g;r.$observe("expandCollapse",function(e){a.expandCollapse=e,g=setTimeout(function(){angular.element(a.expandCollapse).click(function(){var e=angular.element(a.expandCollapse),t=e.closest(".modal"),n=e.closest(".modal .modal-header"),o=e.parents("body").find(".lean-overlay");t.addClass("expand-css-trans");var i=setTimeout(function(){n.toggleClass("extra-nav-wrap expand-header expand-css-trans"),clearTimeout(i),i=null},500),l=setTimeout(function(){t.removeClass("expand-css-trans"),clearTimeout(l),l=null},200);t.toggleClass("expand-css"),e.parent(".modal-header").next().next(".modal-footer_new").find(".modal-close").click(function(){t.removeClass("expand-css"),n.removeClass("extra-nav-wrap expand-header expand-css-trans"),o.css("display","block")}),t.hasClass("expand-css")?(o.css("display","none"),t.css("border-radius","0")):o.css("display","block")})},1e3)});var m,h=function(){angular.element(".picker").attr("tabindex",0)},v=r.$observe("show",function(t){if(angular.isDefined(t))if(a.$eval(t))d=document.activeElement,angular.element(d).addClass("currentPopupTriggerer"),f=angular.element(document).scrollTop(),angular.element(l).openModal({dismissible:a.$eval(r.dismissible),beforeOpen:function(){m=angular.element(l).data(),a.isDraggable&&angular.element("body").addClass("is-popup-Draggable")},complete:function(){if(angular.isFunction(u)&&a.$apply(function(){u(a,{e:""})}),h(),window.isPopupOpenedByUIGridCompatibleElement&&(e.$emit("popupClosed"),window.isPopupOpenedByUIGridCompatibleElement=void 0),l.hasClass("noTransform"))var t=setTimeout(function(){l.css("top",0).removeClass("noTransform"),clearTimeout(t),t=null},100)},ready:function(){window.isPopupOpenedByUIGridCompatibleElement&&e.$emit("popupOpened");var t=n(function(){if(a.isDraggable){var e=angular.element("body"),o=angular.element(".modal.ui-draggable"),i=e.height()/2,r=o.height()/2,s=e.width()/2,c=o.width()/2;$(l).css({position:"absolute",top:(i-r)/2,margin:0,left:s-c})}else{var d=window.innerHeight/2-l.outerHeight()/2;l.css("top",d)}$(l).addClass("noTransform"),angular.element(".picker").removeAttr("tabindex"),n.cancel(t),t=null});n(function(){var e=l.find("a, input[type=text],input[type=radio]:checked,input[type=checkbox], button, textarea, [tabindex='0']").not(":disabled, :hidden, [tabindex = -1]").first();i(e)},600)}});else{var c=angular.element(l),g=void 0===c.data("overlay-id")?!1:!0;if(g&&(c.closeModal({complete:function(){r.afterCompleteClosePopup&&p(a,{}),a.isDraggable&&angular.element("body").removeClass("is-popup-Draggable"),s.$$smartModal===!0&&o.destroyModal({$view:c,$scope:a}),angular.element(".currentPopupTriggerer").focus().removeClass("currentPopupTriggerer"),d=null}}),l.hasClass("noTransform")))var v=setTimeout(function(){l.css("top",0).removeClass("noTransform"),clearTimeout(v),v=null},100);h(),window.isPopupOpenedByUIGridCompatibleElement&&(e.$emit("popupClosed"),window.isPopupOpenedByUIGridCompatibleElement=void 0)}});a.$on("$destroy",function(){v(),h(),m&&($(m.associatedOverlay).remove(),o.destroyModal({$view:l})),clearTimeout(g),g=null,angular.element(a.expandCollapse).off("click")})},templateUrl:"shared/directives/uiElements/smartPopUp/smartPopUpTemplate.html"}}]).factory("$scoper",function(){return{getScope:function(e,t){if(t){var n,o=t.split("."),i=o.length;if(i>1){n=e;for(var a=0;i>a;a++){var l=o[a].match(/(\[\d+\])+$/);if(l&&l.length>0){var r=o[a].substr(0,o[a].indexOf("["));n=n[r],l=l[0].replace(/\]\[/g,",").replace(/[\[\]]/g,"").split(",");for(var s=0;s<l.length;s++)n=n[l[s]]}else n=n[o[a]]}}else n=e[t]}return n}}}).service("$smartModal",["$timeout","$compile",function(e,t){var n=this;n.open=function(e){n.initModal(e)},n.initModal=function(e){var n=["show='{{"+(e.show||"")+"}}'","popup-config='"+(e.$config||"")+"'","on-hide='"+(e.onHide||"")+"'","after-complete-close-popup='{{"+(e.afterCompleteClosePopup||"")+"}}'","cancel-button='"+(e.cancelButton||"")+"'","template-url='"+(e.templateUrl||"")+"'","header-url='"+(e.headerUrl||"")+"'","content-url='"+(e.contentUrl||"")+"'","footer-url='"+(e.footerUrl||"")+"'","type='"+(e.type||"")+"'","is-draggable='"+(e.isDraggable||"")+"'","expand-collapse='"+(e.expandCollapse||"")+"'","dismissible='"+(e.dismissible||"")+"'","class='"+(e["class"]||"")+"'"],o="<smart-popup "+n.join(" ")+"> </smart-popup>",i=t(o)(e.$scope);i.appendTo("body")},n.destroyModal=function(e){e.$view&&e.$view.remove(),e.$scope&&e.$scope.$destroy()}}])}(),function(){"use strict";var radioGroupId=0;angular.module("SMART2").directive("smartRadio",["$timeout","$translate","ScrollTo","RuleEngine",function($timeout,$translate,ScrollTo,RuleEngine){return{restrict:"E",replace:!0,require:"?ngModel",scope:{label:"@",options:"=?",ngModelCopy:"=?ngModel",isMandatory:"@",isVisible:"=?",layout:"@",rules:"@",validate:"=?",focus:"=?",parentElement:"@",errorMessage:"@",onChange:"&",removable:"@",datakey:"@",optionId:"@",groupId:"@"},link:function(scope,element,attrs,ngModelCtrl){scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable);var isNgModelFunction="function"==typeof scope.ngModelCopy;if(scope.dataKey=scope.datakey?scope.datakey:"title",radioGroupId+=1,scope.radioGrouptId=attrs.groupId?attrs.groupId:"radio-group-"+radioGroupId,"undefined"!=typeof attrs.optionId&&(scope.optionId=attrs.optionId),scope.isGap=attrs.gap?scope.$eval(attrs.gap):!1,scope.layout=scope.layout?scope.layout:"horizontal",isNgModelFunction)try{ngModelCtrl.$render=function(){scope.ngModel=ngModelCtrl.$modelValue,scope.selectedOption=scope.ngModel}}catch(e){}var updateView=function(){if(isNgModelFunction)try{ngModelCtrl.$setViewValue(scope.ngModel)}catch(e){}},onFocus=scope.$watch("focus",function(e){e&&(ScrollTo.perform(element,angular.element("#"+scope.parentElement)),scope.focus=!1)}),onValidate=scope.$watch("validate",function(e){void 0!=e&&e&&scope.validateRules()}),onNgModel=scope.$watch(isNgModelFunction?"ngModel":"ngModelCopy",function(e){scope.selectedOption=e},!0);scope.validateRules=function(){
if(scope.$eval(scope.isMandatory)&&isNgModelFunction&&(""===scope.ngModel||void 0===scope.ngModel||null===scope.ngModel)||!isNgModelFunction&&(""===scope.ngModelCopy||void 0===scope.ngModelCopy||null===scope.ngModelCopy))return scope.validate=!0,void(scope.errorMessage=$translate.instant("selectOptionErrMsg"));if(scope.validate=!1,scope.errorMessage=null,scope.rules)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,ruleLen=rules.length,i=0;ruleLen>i;i++){var ruleT=rules[i];if("object"==typeof ruleT){if(eval(ruleT.rule.replace(/this/g,"scope.selectedOption"))){scope.validate=!0,scope.errorMessage=ruleT.error;break}if(isFoundInvalid)break;RuleEngine.isValid(ruleT,function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,isFoundInvalid=!0})}}},scope.ngChange=function(e){scope.selectedOption=e,scope.groupId||(isNgModelFunction?scope.ngModel=scope.selectedOption:scope.ngModelCopy=scope.selectedOption),updateView(),scope.validateRules();var t=$timeout(function(){scope.onChange(),$timeout.cancel(t)})},scope.$on("$destroy",function(){onFocus(),onValidate(),onNgModel(),element.remove(),scope=null})},templateUrl:"shared/directives/uiElements/smartRadio/smartRadioTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartReadErrors",function(e,t,n){return{restrict:"EA",templateUrl:"shared/directives/uiElements/smartReadErrors/smartReadErrorsTemplate.html",replace:!0,scope:!0,link:function(e,t,o){function i(t){var o,i=0,l=a.eq(t);l.closest(".collapsible-body").hasClass("displayBlock")||(l.closest(".collapsible-container").find(".collapsible-header").trigger("click"),i=350),n(function(){o=l.offset().top-$("#subheaderwrapper").height(),$(window).scrollTop(o-40),l.is("span")?l.closest("div").find("button, [href], input, select, textarea")[0].focus():l.closest("span").length?l.closest("span").find(".dropdown-button").focus():l.focus(),e.nextDisable=!1,e.prevDisable=!1},i+c)}e.counter=0,e.emptyText="",e.leftLabelText="Show only error field";var a=[],l=0,r="",s=!0,c=300,d="input.invalid, .invalid input, textarea.invalid";d+=o.customfieldsSelector?", "+o.customfieldsSelector:"",e.onErrorFound=e[o.showerrorsPanel],e.nextDisable=!1,e.prevDisable=!1;var u=o.frmWidgetId,p=function(){n(function(){a=$("#"+u).find(d);var t=a.length-1;e.counter!=t&&(l--,0>l&&(l=e.counter-t<0?0:t),e.counter=t),0===t&&n(function(){e.onErrorFound.isWarningHeader=!1},3e3),s=!0},c)},f=function(e){if(s){a=$("#"+u).find(d),r=$(this);var t=a.index(r);l=t>=0?t:l}};e.closeErrorHeader=function(){e.onErrorFound.isWarningHeader=!e.onErrorFound.isWarningHeader};var g=e.$watch("onErrorFound.error",function(t,o){t!==o&&n(function(){a=$("#"+u).find(d),a.length>0?(e.onErrorFound.noMoreErrors=!1,e.onErrorFound.isWarningHeader=!0,a.blur(p).focus(f),e.counter=a.length-1,i(0),s=!1):e.onErrorFound.noMoreErrors=!0},1e3)});e.next=function(){e.nextDisable=!0,e.prevDisable=!0,s=!0,a=$("#"+u).find(d);var t=a.length-1;t>l?(s=!1,i(l+1),e.counter===t&&l++):(s=!1,l=0,i(l))},e.prev=function(){e.nextDisable=!0,e.prevDisable=!0,s=!0,a=$("#"+u).find(d);var t=a.length-1;l>0?(s=!1,i(l-1),e.counter===t&&l--):(s=!1,i(t),l=t)},e.$on("$destroy",function(){g(),a.unbind(),a=[],e={}})}}})}(angular),function(){"use strict";angular.module("SMART2").directive("resizeableSidebar",[function(){return{restrict:"A",scope:{disableResize:"=?",collapseCallback:"&",scrollCallback:"&",leftPanelWidthCallback:"&"},link:function(e,t,n){var o=t.innerWidth(),i=e.$eval(e.collapseCallback),a=e.$eval(e.scrollCallback),l=e.$eval(e.leftPanelWidthCallback),r=t.find(".leftPanel"),s=document.createElement("div");s.id="panelexpandorreports",s.className="panelexpandorreports",r.prepend(s);var c=t.find(".panelexpandorreports"),d=document.createElement("div");d.id="panelexpandorreportsdiv",d.className="panelexpandorreportsdiv",c.prepend(d),e.$watch("disableResize",function(e){e?$("#panelexpandorreports").addClass("disableCursorAction"):$("#panelexpandorreports").removeClass("disableCursorAction")});var u=0,p=n.minWidth||100,f=n.lowWidth||100,g=n.midWidth||282,m=window.innerWidth/2,h=0,v=0,y=window.innerWidth,b=g/y*100,C=window.innerWidth;$(window).resize(function(){C=window.innerWidth,m=C/2,h=C*b/100,h=Math.max(g,h),y=C,$(".leftPanel").animate({"margin-left":-h,width:h},{duration:500,queue:!1}).addClass("overflowVisible"),$(".wrapper--withSidebar").animate({"margin-left":h},{duration:500,queue:!1}).addClass("overflowVisible"),$(".panelexpandorreports").animate({left:h,backgroundColor:"#ccc"},{duration:500,queue:!1,complete:function(){$(".panelexpandorreports").removeClass("dragLine")}}).addClass("dragLine"),l(h,o)}),t.on("click mouseover.leftPanel","#leftPanel",function(){var e=$("#panelexpandorreports");e.data("ui-draggable")||e.draggable({axis:"x",drag:function(e,t){u=m-p,$(".panelexpandorreports").addClass("panelexpandorreports-nohover"),t.position.left=Math.min(m,t.position.left),h=t.position.left,v=t.originalPosition.left,b=h/y*100,l(t.position.left,o)},stop:function(e,n){if(n.position.left<f)i(),$("#panelexpandorreports").css("left",n.originalPosition.left);else if(n.position.left>=f&&n.position.left<=g)t.removeClass("conditionalLftPanelTransition"),$(".leftPanel").animate({"margin-left":-g,width:g},{duration:500,queue:!1}).addClass("overflowVisible"),$(".wrapper--withSidebar").animate({"margin-left":g},{duration:500,queue:!1}).addClass("overflowVisible"),$(".panelexpandorreports").animate({left:g,backgroundColor:"#ccc"},{duration:500,queue:!1,complete:function(){$(".panelexpandorreports").removeClass("dragLine")}}).addClass("dragLine");else{t.removeClass("conditionalLftPanelTransition");var o=parseInt($(".wrapper--withSidebar").css("margin-left"))-(n.originalPosition.left-n.position.left);$(".leftPanel").animate({"margin-left":-o,width:n.position.left},{duration:500,queue:!1}).addClass("overflowVisible"),$(".wrapper--withSidebar").animate({"margin-left":o},{duration:500,queue:!1}).addClass("overflowVisible")}a(),$(".panelexpandorreports").removeClass("panelexpandorreports-nohover")}})})}}}])}(),function(){"use strict";var e=0;angular.module("SMART2").directive("smartScroll",["$parse","$timeout","$window",function(t,n,o){return{restrict:"EA",replace:!1,transclude:!0,scope:!0,link:function(i,a,l){function r(e,t){if(l.scrollBreakPoints){for(var n=JSON.parse(l.scrollBreakPoints),o=Object.keys(n),r=a.find(o.join(",")),s=0;s<o.length;s++)a.find(o[s]).data("configSele",o[s]);r.length>0&&r.each(function(e,o){var a=$(o),l=a.position(),r=n[a.data("configSele")],s=function(){var e;return e="number"==typeof r.top?r.top*parseInt(i.scrollHeight):parseInt(r.top)}();"upward"==t&&l.top<=s&&!a.data("fired")?(a.data("fired",!0),m(i,{e:{index:e,direction:"upward"}}),i.$digest()):"downward"==t&&(r.reverse===!0?l.top+a.outerHeight():l.top)>=s&&a.data("fired")&&(a.data("fired",!1),m(i,{e:{index:e,direction:"downward"}}),i.$digest())})}}function s(e){i.scrollHeight=a.parent().outerHeight(),i.$digest()}function c(e){a.find("input.datepicker").each(function(e,t){var n=$(t).data("daterangepicker");n&&n.isShowing&&n.hide()})}function d(e){a.find("[id^=typeahead-]").each(function(e,t){var n=$(this).data().autocomplete;n&&n.visible&&n.hide()});var t=o.lastOpenedDropdownConfig;t&&t!=k&&t.origin.hasClass("select-dropdown")&&t.origin.trigger("close"),k=t}function u(e){if(e){var t=a.find(".scroll-content");"true"==e?(t.data("scrolltop",t.scrollTop()),t.get(0).addEventListener("scroll",p,!0),h&&(h(i,{e:"locked"}),i.$digest())):"false"==e&&(t.get(0).removeEventListener("scroll",p,!0),h&&(h(i,{e:"unLocked"}),i.$digest()))}}function d(e){a.find("[id^=typeahead-]").each(function(e,t){var n=$(this).data().autocomplete;n&&n.visible&&n.hide()})}function p(e){var t=$(this).data("scrolltop");return this.scrollTop=t,e.stopPropagation(),!1}var f=l.isFixedHeader?!0:!1,g="true"==l.hideDate?!0:!1,m=l.onBreakPoints?t(l.onBreakPoints.replace(/\(\)/,"(e)")):!1,h=l.onScrollLockUnlock?t(l.onScrollLockUnlock.replace(/\(\)/,"(e)")):!1;i.fixedHeader=function(e){var t=$(e.target),n=t.find(">").eq(0).find(">").eq(0),o=t.scrollTop();if(o>0&&!t.data("appended")){n.find("thead, tbody, tfoot").css("display",""),n.find("tr:first-child th").each(function(e,t){var o=n.find("tbody > tr:first-child > td").eq(e),i=o.length?o.get(0).offsetWidth:t.offsetWidth;o.length&&o.css("width",i+"px"),t&&$(t).css("width",i+"px")});var i=$("<table>"),a=n.find("thead tr:first-child").clone();n.find("thead tr:first-child").css("opacity","0"),i.append(a),i.addClass("fixed-header-when-scrolled"),t.before(i),t.data("appended",!0)}else 0==o&&(t.parent().find(".fixed-header-when-scrolled").remove(),n.find("thead tr:first-child").css("opacity","1"),t.data("appended",!1))},e+=1,i.scrollid="scroll-"+e;var v;l.$observe("scrollConfig",function(e){e&&(v=i.$eval(l.scrollConfig))});var y={},b=t(l.onScrollEnd),C=t(l.onScrollToTop),w=t(l.onScrollInProgress);l.$observe("height",function(e){e&&((angular.isFunction(b)||angular.isFunction(C))&&(y.onScroll=function(e,t){e.maxScroll>0&&e.scroll>=e.maxScroll&&angular.isFunction(b)&&b(i,{e:""}),0==e.scroll&&angular.isFunction(C)?C(i,{e:""}):e.maxScroll>e.scroll>0&&angular.isFunction(w)&&w(i,{e:""}),angular.element(".fixeddd").hide()}),l.vOffset?l.vOffset?($(window).unbind("resize",s),i.scrollHeight=o.innerHeight-parseInt(l.vOffset)):i.scrollHeight=e:"parent"==e?(i.scrollHeight=a.parent().outerHeight(),$(window).resize(s)):i.scrollHeight=e)}),(l.vOffset||l.hOffset)&&$(window).bind("resize",function(){i.scrollHeight=o.innerHeight-parseInt(l.vOffset),i.$digest(),n(function(){if(l.vOffset&&a.closest(".modal").length>0){var e=a.closest(".modal").height();a.closest(".modal").css("top",window.innerHeight/2-e/2+"px")}})}),l.$observe("vOffset",function(e){i.scrollHeight=o.innerHeight-parseInt(e)}),i.$on("scrollTopToBottom",function(e,t){a.find(".scrollbar-outer").animate({scrollTop:t},"slow")});var S=t(l.onScrollHEnd),x=t(l.onScrollHToTop),T=t(l.onScrollHInProgress),D=a.css("width");i.scrollWidth=parseInt(D)?D:"100%",l.$observe("width",function(e){e&&((angular.isFunction(S)||angular.isFunction(x))&&(y.onScroll=function(e,t){t.maxScroll>0&&t.scroll==t.maxScroll&&angular.isFunction(S)&&S(i,{e:""}),0==t.scroll&&angular.isFunction(x)?x(i,{e:""}):t.maxScroll>t.scroll>0&&angular.isFunction(T)&&T(i,{e:""})}),i.scrollWidth=e)}),l.$observe("connectScrolls",function(e){if(e){var e=JSON.parse(e),t=0;y.onScroll=function(n,o){var i=$("."+e.vSource),a=i.parent().parent(),l=$("."+e.hSource),r=l.parent().parent(),s=$("."+e.vertical),c=s.parent().parent(),d=$("."+e.horizontal),u=(i.height(),a.scrollTop()),p=c.scrollTop();if(u>t)u>p&&c.scrollTop(u);else if(t>u)p>u&&c.scrollTop(u);else{var f=r.scrollLeft();d.scrollLeft(f)}t=u,angular.element(".fixeddd").hide()}}});var k,M=!1;l.$observe("lockScroll",function(e){M?u(e):(M=!0,n(u.bind(this,e)))});var F={handlers:[],addHandlers:function(e){this.handlers.push(e)}};y.onUpdate=function(){var e=this,t=arguments;F.handlers.forEach(function(n){"function"==typeof n&&n.apply(e,t)})},F.addHandlers(function(e,t){if(e.closest(".modal.noTransform").length>0){var n=e.closest(".modal").height();e.closest(".modal").css("top",window.innerHeight/2-n/2+"px")}});var I,O;l.scrollToElement&&(F.addHandlers(function(e,t){var n=e.find(O.content);O&&O.status&&n.length&&e.animate({scrollTop:n.offset().top-e.children("div").offset().top-10},"slow")}),I=l.$observe("scrollToElement",function(e){O=l.scrollToElement&&JSON.parse(l.scrollToElement)})),setTimeout(function(){var e=angular.element("#"+i.scrollid),t=angular.merge(y,v);e.scrollbar(t);var n;e.scroll(function(e){var t,o=$(this),a=o.scrollTop();f?i.fixedHeader(e):g&&c(e),l.scrollBreakPoints&&(a>n?t="upward":n>a&&(t="downward"),r(a,t)),d(e),n=a}),n=e.scrollTop();var o=window.navigator.userAgent,a=e.find("use");(void 0!==o.indexOf("MSIE")||void 0!==o.indexOf("Trident/")||void 0!==o.indexOf("Edge/"))&&a.length>0&&a.each(function(){var e=angular.element(this),t=e.attr("xlink:href");e.attr("xlink:href","").attr("xlink:href",t)})}),i.$on("$destroy",function(){I&&I()})},templateUrl:"shared/directives/uiElements/smartScroll/smartScrollTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartLazyLoad",function(){return{restrict:"A",scope:{smartLazyLoad:"&"},link:function(e,t,n){var o=t.closest(".scrollbar-outer");o.scroll(function(){this.scrollTop+this.offsetHeight>=this.scrollHeight&&e.$apply(function(){e.smartLazyLoad()})})}}})}(),function(){"use strict";angular.module("SMART2").directive("smartPlaceholder",["$translate","ScrollTo",function($translate,ScrollTo){return{restrict:"A",replace:!0,link:function(scope,element,attrs){window.activePlaceholder=element;var tmpPlaceholder=getHTMLPlaceholder(scope);element.addClass((scope.property.isMandatory?"":"optionalField ")+(scope.property.attributes.readonly?"readOnlyField":"")),element.find(".smart-ph-label").html("<span>"+$translate.instant(scope.property.label)+"</span>"),element.find(".smart-ph-value").html("<span>"+tmpPlaceholder+"</span>"),element.attr("title",tmpPlaceholder),""!=tmpPlaceholder&&element.find(".smart-ph-label").addClass("active"),scope.property.attributes.disable||scope.property.attributes.readonly?element.find(".smart-ph-value").addClass("disabled"):element.attr("tabindex",0);var onAttributesChange=scope.$watchGroup(["property.attributes.disable","property.attributes.readonly","model."+scope.property.data,"property.validate","property.focus"],function(e,t){angular.equals(e[0],t[0])&&angular.equals(e[1],t[1])||(e[0]||e[1]?(element.find(".smart-ph-value").addClass("disabled"),element.attr("tabindex",-1)):(element.find(".smart-ph-value").removeClass("disabled"),element.attr("tabindex",0))),angular.equals(e[2],t[2])||(tmpPlaceholder=getHTMLPlaceholder(scope),element.find(".smart-ph-value").html("<span>"+tmpPlaceholder+"</span>"),element.attr("title",tmpPlaceholder),""!=tmpPlaceholder?element.find(".smart-ph-label").addClass("active"):element.find(".smart-ph-label").removeClass("active")),angular.equals(e[3],t[3])||scope.property.validate&&(!angular.isUndefined(scope.property.attributes.readonly)&&0!=scope.property.attributes.readonly||!angular.isUndefined(scope.property.attributes.disable)&&0!=scope.property.attributes.disable||validate(),scope.property.validate=!1),angular.equals(e[4],t[4])||scope.property.focus&&(ScrollTo.perform(element,angular.element("#"+scope.formWidgetId)),scope.onFocus(),scope.property.focus=!1)}),validate=function(){var model=eval("scope.model."+scope.property.data),error;if(scope.property.isMandatory&&("text"!==scope.property.attributes.type&&!angular.isUndefined(scope.property.attributes.type)||!angular.isUndefined(model)&&null!=model&&""!=model.trim()?"autocomplete"==scope.property.attributes.type&&(angular.isUndefined(model)||null==model||""==model||model&&model.hasOwnProperty("value")&&""==model.value.trim())?error=$translate.instant("enterValueErrMsg"):"number"==scope.type&&isNaN(scope.ngModel)&&(error=$translate.instant("enterNumberErrMsg")):error=$translate.instant("enterValueErrMsg")),angular.isUndefined(error)&&scope.property.rules)for(var rules=scope.property.rules,i=0;i<rules.length;i++)if("object"==typeof rules[i]&&eval(rules[i].rule.replace(/this/g,model))){error=rules[i].error;break}error?(element.find(".smart-ph-label").addClass("active"),element.find(".smart-ph-value").addClass("invalid"),element.find(".smart-ph-error").html(error)):(element.find(".smart-ph-value").removeClass("invalid"),element.find(".smart-ph-error").html(""),""==tmpPlaceholder&&element.find(".smart-ph-label").removeClass("active"))};scope.onFocus=function(e){scope.property.attributes.disable||scope.property.attributes.readonly||(scope.$parent.isPreviewMode=!1)},scope.onRemoveButtonClick=function(e){scope.property.isVisible=!scope.property.isVisible,e.stopPropagation()},scope.$parent.onEditableRender=function(e,t){t.find("input").focus(),t.find("input").select(),element.attr("tabindex",-1),this.errorMessage&&(t.find("input").addClass("invalid"),t.find("label").attr("data-error",this.errorMessage),this.errorMessage=void 0)},scope.$parent.onStopEdit=function(e,t){this.isPreviewMode=!0,(void 0!=e.errorMessage||null!=e.errorMessage)&&(this.errorMessage=e.errorMessage,setTimeout(function(){window.activePlaceholder.find(".smart-ph-label").addClass("active"),window.activePlaceholder.find(".smart-ph-value").addClass("invalid"),window.activePlaceholder.find(".smart-ph-error").html(e.errorMessage)}))},scope.$on("$destroy",function(){onAttributesChange()})},templateUrl:"shared/directives/uiElements/smartSection/smartPlaceholderTemplate.html"}}]);var setPrecisionLimits=function(e,t,n){if(void 0!=e){var o=e.toString().split("e");o.length>1&&parseInt(o[1])<0&&(e=e.toFixed(6));var i=e.toString().split(".");if(void 0!=i&&i.length>1){var a=i[0];if(0!=a&&a.toString().length>20){var l=a.toString().substring(0,19);e=parseInt(l)}}else if(0!=e&&e.toString().length>20){var l=e.toString().substring(0,19);e=parseInt(l)}if(void 0!=t)e=parseFloat(parseFloat(e).toFixed(t));else if(void 0!==n&&""!==n){var r=JSON.parse(n);if(r.length>2||r.length<1);else{var s=r[0],c=r[1],d=void 0!=(e+"").split(".")[1]?(e+"").split(".")[1].length:0;if(0==d);else if(s>d&&c>d&&0!=d)e=parseFloat(parseFloat(e).toFixed(s));else if(d>=c&&0!=d){var u=Math.pow(10,c);e=Math.floor(e*u)/u}}}}return e},getFormattedDate=function(dateVal,dateFormat,isSetFromGrid){var output="";dateFormat=dateFormat.replace(/d/g,"D").replace(/y/g,"Y").replace(/E/g,"d");var isDateBlank=!1,doesContainDateString="true"==isSetFromGrid?!0:(dateVal+"").toLowerCase().indexOf("date")>-1?!0:!1;if(""==dateVal||null==dateVal)dateVal=Date.now(),isDateBlank=!0;else if(doesContainDateString){var tmpModel=(dateVal+"").replace(new RegExp("/","ig"),"");tmpModel=tmpModel.split("+"),tmpModel=eval("new "+(tmpModel.length>1?'Date("'+dateVal+'").getTime()':tmpModel[0])),output=moment(tmpModel).format(dateFormat)}else"[object Date]"!==Object.prototype.toString.call(dateVal)&&(dateVal=parseInt(dateVal));return isDateBlank?output="":doesContainDateString||(output=moment(dateVal).format(dateFormat)),output},getHTMLPlaceholder=function(scope){var placeHolder,tmpModel=eval("scope.model."+scope.property.data);switch(scope.property.type){case"textfield":switch(scope.property.attributes.type){case"number":placeHolder=setPrecisionLimits(tmpModel,scope.property.attributes.decimalprecision,scope.property.attributes.minmaxprecision);break;case"date":placeHolder=getFormattedDate(tmpModel,scope.property.attributes.format);break;case"autocomplete":if(void 0==tmpModel||null==tmpModel||""==tmpModel)return"";var str=scope.property.attributes.displayformat,evalResult,evaluatedKeysCounter=0,nullKeysCounter=0;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||tmpModel.hasOwnProperty(childSplit[k]))&&(evalResult=eval("tmpModel."+childSplit[k]),evaluatedKeysCounter++,(void 0==evalResult||null==evalResult||0==(evalResult+"").trim().length)&&(evalResult="",nullKeysCounter++),str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),evalResult));evaluatedKeysCounter==nullKeysCounter&&(str="")}catch(e){}placeHolder=str;break;default:placeHolder=eval("scope.model."+scope.property.data)}break;case"dropdown":case"select":placeHolder=eval("scope.model."+scope.property.data+(scope.property.attributes.displaykey?"."+scope.property.attributes.displaykey:scope.property.attributes.datakey?""+scope.property.attributes.datakey:""))}return null==placeHolder||void 0==placeHolder?"":placeHolder}}(),function(){"use strict";var e=0;angular.module("SMART2").directive("smartSection",["$timeout","$parse",function(t,n){return{restrict:"E",replace:!0,transclude:{header:"?smartSectionHeader",body:"?smartSectionBody"},scope:{config:"=?",model:"=?",label:"@",isSequential:"@",isMandatory:"@",isDraggable:"@",parentScope:"=?",formWidgetId:"@",isCollapsible:"@",enableFieldPreview:"@",headerTemplate:"@",isActive:"=?",isHeader:"@",plain:"@",onClick:"&",onHeaderClick:"&",revisionMode:"@",isSwitchable:"@",onClickSwitchable:"&"},link:function(t,n,o){t.isSwitchFunc=function(){t.onClickSwitchable({section:t.config})},""!==o.id||void 0!==o.id||null!==o.id?t.sectionId=o.id:(t.sectionId="section-"+e,e++),n.attr("id",t.sectionId),t.collapsible=1==t.$eval(t.isCollapsible)?!0:!1,t.active=angular.isUndefined(t.isActive)||1==t.isActive?!0:!1,t.header=t.$eval(t.isHeader)?!0:!1,t.collapsible?t.header=!0:t.active=!0,t.isCollapsed=t.active,t.headerTemplate||(t.headerTemplate=""),t.formLoaderConfig={bgwhite:!0,plain:!0,center:!0,message:""};var i=t.$watch("config.rows",function(e){if(e)for(var n=t.config.rows.length,o=0;n>o;o++)for(var i=t.config.rows[o].properties.length,l=0;i>l;l++){var r=t.config.rows[o].properties[l];r.isMandatory||a(r)}},!0),a=function(e){for(var n=t.config.optionalFields.length,o=0;n>o;o++){var i=t.config.optionalFields[o];if(e.label==i.label)return void(i.visible=e.isVisible)}},l=function(e){for(var n=0,o=t.config.rows[e].properties.length,i=0;o>i;i++){var a=t.config.rows[e].properties[i];a.isVisible&&!a.isHidden&&n++}return n};t.onOptionalFieldClick=function(e,n){if(!e||!n.isVisible){var o=t.config.rows[n.rowIndex],i=o.properties[n.propertyIndex];if(t.$eval(t.isSequential)||0!=l(n.rowIndex)||(t.config.rows.splice(n.rowIndex,1),t.config.rows.push(o),n.rowIndex=t.config.rows.length-1),i.isVisible=!i.isVisible,!t.$eval(t.isSequential)&&i.isVisible){o.properties.splice(n.propertyIndex,1),o.properties.push(i);for(var a=t.config.rows[n.rowIndex].properties.length,r=0;a>r;r++)for(var s=t.config.optionalFields.length,c=0;s>c;c++)o.properties[r].label==t.config.optionalFields[c].label&&(t.config.optionalFields[c].propertyIndex=r)}if(n.visible=!n.visible,n.visible)var u=setTimeout(function(){d(),clearTimeout(u),u=null},250)}};var r=!1,s=t.$watch("isActive",function(e){angular.isDefined(e)&&e&&(r=!0,d(),t.isActive=!1)}),c=t.$on("optionalFieldClick",function(e,n){try{n.item.sectionKey===t.config.key&&t.onOptionalFieldClick(n.isLabelClicked,n.item)}catch(o){}}),d=function(){var e=n.find(".collapsible-header");e.hasClass("active")?e.hasClass("active")||e.trigger("click"):e.trigger("click")},u=!1,p=setTimeout(function(){n.find(".collapsible-header").click(function(){var e=this;t.$evalAsync(function(){(!u||r)&&(u=!0,t.isCollapsed=angular.element(e).hasClass("active"),t.active=t.isCollapsed,t.onHeaderClick(),t.onClick(),setTimeout(function(){u=!1},500),r=!1,clearTimeout(p),p=null)})})});t.onSectionHeaderFocus=function(e){$(e.target).hasClass("section-header-focuser")&&!t.active&&(t.config.isContentLoaded=!0,t.active=!0,d());var n=t.config.key,o=t.formWidgetId,i=$("#"+n),a=64,l=i.offset().top-angular.element("#"+o+"-sortable").offset().top;l+=a,setTimeout(function(){angular.element("body,html").animate({scrollTop:l},"medium")},200)},t.$on("$destroy",function(){i(),s(),c(),n.find(".collapsible-header").off("click")})},templateUrl:"shared/directives/uiElements/smartSection/smartSectionTemplate.html"}}]);var t;angular.module("SMART2").directive("smartSectionItemRenderer",["$compile","formWidgetUtils","$translate","$templateCache","$timeout",function(e,n,o,i,a){return{restrict:"E",replace:!1,link:function(o,l,r){var s,c="";if(o.section){o.section.controller&&(o.formDataModel=o.$parent.$parent.$parent.modelData,c+='<div ng-controller="'+o.section.controller+'">'),o.section.isLazyLoadEnabled&&(o.section.isActive=!1),o.extendedSectionConfig=angular.extend({isMandatory:!1,isCollapsible:!0,isDraggable:!1,isHeader:!0,isActive:!0,isHidden:!0,isSwitchable:!1,isFieldPreviewEnabled:!1,isSectionDisable:!1,isLazyLoadEnabled:!1,headerTemplate:""},o.section),o.section.isLoading=!0,o.section.isContentLoaded=!1;var d=a(function(){o.section.isLoading=!1,o.section.isContentLoaded=!angular.copy(o.section.isLazyLoadEnabled),a.cancel(d),d=null},500*o.$index);s=' label="{{section.label | translate}}" config="section" model="modelData" plain="{{section.plain}}" is-sequential="{{isSequential}}" '+n.getAttributesMapping("primary",o.extendedSectionConfig,o,!0)+' parent-scope="'+(o.section.controller?"$parent.$$childTail":"$parent.$parent.$parent.$parent")+'" form-widget-id="{{formWidgetId}}" ',s+="revision-mode="+(o.revisionMode&&"false"!=o.revisionMode?"'true'":"'false'"),c+="<smart-section id="+o.formWidgetId+"-section-"+o.$index+" "+(o.enableFieldPreview?' enable-field-preview="true" ':" ")+s+n.mapEvents([{type:"on-click",listener:"onSectionClick(section)"},{type:"on-header-click",listener:"onSectionHeaderClick(section)"},{type:"on-click-switchable",listener:n.generateFunctionWithParams(o.section.onClickSwitchable,"$parent.$parent.$parent.$parent",!0)}])+"></smart-section>",o.section.controller&&(c+="</div>")}else{var u,p;if("subsection"==o.property.type)u='model-data="model.'+o.property.data+'"form-model="model"';else if("dropdown"==o.property.type)u='ng-model="model.'+o.property.data+'"',angular.isDefined(o.property.optionsData)&&(p='options="model.'+o.property.optionsData+'"');else{u='ng-model="model.'+o.property.data+'"';try{o.property.attributes.ngModelOptions.getterSetter&&(u='ng-model="parentScope.'+o.property.data+'"')}catch(f){}}var g=!1;switch("undefined"!=typeof o.property.attributes&&"undefined"!=typeof o.property.attributes.type&&"area"==o.property.attributes.type&&(g=!0),s=' class="'+n.getColspanClass(o.property.colspan)+("subsection"!=o.property.type?"textfield"==o.property.type&&g?" area-height-manager":" line-height-manager":"")+'" label="{{property.label | translate}}" focus="'+("string"==typeof o.property.focus?"parentScope."+o.property.focus:"property.focus")+'" validate="'+("string"==typeof o.property.validate?"parentScope."+o.property.validate:"property.validate")+'" '+u+" "+p+" "+n.getAttributesMapping("primary",o.property,o)+' parent-element="{{formWidgetId}}" '+n.getAttributesMapping("secondary",o.property.attributes,o),o.property.type){case"textfield":var m="true"==o.enableFieldPreview||1==o.enableFieldPreview;m?(o.isPreviewMode=!0,c='<div style="margin-bottom: 15px;" class="'+n.getColspanClass(o.property.colspan)+' input-field" smart-placeholder ng-if="isPreviewMode"></div>'):c="",c+="<smart-textfield"+(m?' ng-if="!isPreviewMode" ':" ")+s+n.mapEvents([{type:"on-change",listener:n.generateFunctionWithParams(o.property.onChange,"parentScope")},{type:"on-focus",listener:n.generateFunctionWithParams(o.property.onFocus,"parentScope")},{type:"on-blur",listener:n.generateFunctionWithParams(o.property.onBlur,"parentScope")},{type:"on-key-up",listener:n.generateFunctionWithParams(o.property.onKeyUp,"parentScope")},{type:"on-key-down",listener:n.generateFunctionWithParams(o.property.onKeyDown,"parentScope")},{type:"on-key-press",listener:n.generateFunctionWithParams(o.property.onKeyPress,"parentScope")},{type:"on-enter",listener:n.generateFunctionWithParams(o.property.onEnter,"parentScope")},{type:"on-select",listener:n.generateFunctionWithParams(o.property.onSelect,"parentScope")},{type:"on-date-change",listener:n.generateFunctionWithParams(o.property.onDateChange,"parentScope")},{type:"on-destroy",listener:n.generateFunctionWithParams(o.property.onDestroy,"parentScope")}])+"></smart-textfield>";break;case"dropdown":case"select":c='<smart-select validate="property.validate" '+s+n.mapEvents([{type:"on-change",listener:n.generateFunctionWithParams(o.property.onChange,"parentScope")},{type:"on-destroy",listener:n.generateFunctionWithParams(o.property.onDestroy,"parentScope")}])+"></smart-select>";break;case"radio":c='<smart-radio gap="true"'+s+n.mapEvents([{type:"on-change",listener:n.generateFunctionWithParams(o.property.onChange,"parentScope")},{type:"on-destroy",listener:n.generateFunctionWithParams(o.property.onDestroy,"parentScope")}])+"></smart-radio>";break;case"checkbox":c='<smart-checkbox fill="true" min-height="50px" '+s+n.mapEvents([{type:"on-change",listener:n.generateFunctionWithParams(o.property.onChange,"parentScope")},{type:"on-destroy",listener:n.generateFunctionWithParams(o.property.onDestroy,"parentScope")}])+"></smart-checkbox>";break;case"switch":c="<smart-switch "+s+n.mapEvents([{type:"on-change",listener:n.generateFunctionWithParams(o.property.onChange,"parentScope")},{type:"on-destroy",listener:n.generateFunctionWithParams(o.property.onDestroy,"parentScope")}])+"></smart-switch>";break;case"subsection":if(o.property.isAngular2Enabled)c=i.get(o.property.templateUrl);else{var h="";(""==o.property.onLoad||void 0==o.property.onLoad||null==o.property.onLoad)&&(o.property.onLoad=""),""!=o.property.onLoad&&(h=n.generateFunctionWithParams(o.property.onLoad,"parentScope"),h=h.replace("parentScope."+o.property.onLoad.split("(")[0],"$$$childHead."+o.property.onLoad.split("(")[0]),h=h.replace(",property","")),c='<smart-subsection class="'+n.getColspanClass(o.property.colspan)+' padding0" controller="{{property.controller}}" init="{{property.init}}" template-url="{{property.templateUrl}}" parent-scope="parentScope" widget-scope="parentScope.$parent.$parent.$parent"'+s+n.mapEvents([{type:"on-load",listener:h}])+"></smart-subsection>"}break;case"revision":var v=["class = '"+n.getColspanClass(o.property.colspan)+"'","label='{{::property.label | translate}}'","old-data='::property.attributes.oldData'","new-data='::property.attributes.newData' ng-if='::property.label'"].join(" ");c="<smart-revision "+v+"></smart-revision>"}}l.html(c),o.property&&o.property.isAngular2Enabled?(t&&(clearInterval(t),t=void 0),t=setInterval(function(){window.SmartAngular2&&(window.SmartAngular2.bootstrap(),clearInterval(t))},250)):e(l.contents())(o)}}}])}(),function(){"use strict";function smartSelectFunc1($timeout,$window,$translate,ScrollTo,RuleEngine){return{restrict:"E",replace:!0,require:"?ngModel",scope:{label:"@",options:"=?",ngModelCopy:"=?ngModel",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",parentElement:"@",onChange:"&",disable:"@",multiple:"@",datakey:"@",displaykey:"@",removable:"@",preview:"@",customoption:"@",showinfo:"@",showwarning:"@",customMessage:"@"},link:function(scope,element,attrs,ngModelCtrl){var options,isNgModelWatchAdded=!1,onNgModel=function(){};scope.selectOptions=[];var typeOfNgModel,isNgModelFunction="function"==typeof scope.ngModelCopy;if(selectId+=1,scope.dropDownId="dropdown-"+selectId,scope.dataKey=scope.datakey?scope.datakey:"title",scope.displayKey=scope.displaykey?scope.displaykey:scope.dataKey,isNgModelFunction)try{ngModelCtrl.$render=function(){scope.ngModel=ngModelCtrl.$modelValue,scope.selectedOption=scope.ngModel}}catch(e){}var updateView=function(){if(isNgModelFunction)try{ngModelCtrl.$setViewValue(scope.ngModel)}catch(e){}};scope.labelVal="",scope.customOptionReset=!1;var onOptions=scope.$watch("options",function(e){if(e){var t=e.length;if(e&&t>0){var n;n=scope.label?scope.label:$translate.instant("chooseOptionMsg");var o=!0;if(scope.customoption&&(n=scope.customoption,o=!1,scope.customOptionReset=!0),scope.dataKey===scope.displayKey)options=[{title:n,disable:o,id:"fakeOptionId"}].concat(e),options[0][scope.displayKey]=options[0].title;else{var i={disable:o,id:"fakeOptionId"};i[scope.dataKey]=n,i[scope.displayKey]=n,options=[i].concat(e)}for(var a=[],l=options.length,r=0;l>r;r++)options[r].hasOwnProperty("groupName")&&-1==a.indexOf(options[r].groupName)&&a.push(options[r].groupName);if(scope.optionGroups=angular.copy(a),scope.selectOptions=options,isNgModelWatchAdded)var s=setTimeout(function(){angular.element("#"+scope.dropDownId).material_select(),element.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var e,t=element.parent().find(".dropdown-content.select-dropdown.active");t.scrollTop(0),e=t.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),e&&t.scrollTop(e.top-t.offset().top)},0)}),clearTimeout(s),s=null});else onNgModel=scope.$watch(isNgModelFunction?"ngModel":"ngModelCopy",function(e){
angular.isUndefined(typeOfNgModel)&&""!==e&&void 0!=e&&null!=e&&(typeOfNgModel=typeof e);var t;if("string"==typeOfNgModel||"number"==typeOfNgModel){for(var n=0;l>n;n++)if(e==options[n][scope.dataKey]){t=options[n];break}}else t=e;scope.selectedOption=angular.copy(t);try{scope.selectedOption?scope.selectedOption[scope.displayKey]||(scope.selectedOption=angular.copy(options[0])):scope.selectedOption=angular.copy(options[0]),scope.selectedOptionString=angular.copy(scope.selectedOption[scope.dataKey]),options[0]!=scope.selectedOption[scope.dataKey]&&(scope.labelVal=scope.selectedOption[scope.dataKey],scope.customoption&&scope.customoption!=scope.selectedOption[scope.dataKey]&&(scope.customOptionReset=!1))}catch(o){}var i=setTimeout(function(){var e=angular.element("#"+scope.dropDownId);e.material_select(),e.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var t,n=e.parent().find(".dropdown-content.select-dropdown.active");n.scrollTop(0),t=n.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),t&&n.scrollTop(t.top-n.offset().top)},0)}),clearTimeout(i),i=null})},!0),isNgModelWatchAdded=!0;var c=setTimeout(function(){var e=angular.element("#"+scope.dropDownId);e.children().eq(0).attr("disabled","disabled"),e.material_select(),e.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var t,n=e.parent().find(".dropdown-content.select-dropdown.active");n.scrollTop(0),t=n.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),t&&n.scrollTop(t.top-n.offset().top)},0)}),clearTimeout(c),c=null})}}},!0);scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable);var sOption=scope.label,onDisable=scope.$watch("disable",function(e){var t=setTimeout(function(){var e=angular.element("#"+scope.dropDownId);e.material_select(),element.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var e,t=element.parent().find(".dropdown-content.select-dropdown.active");t.scrollTop(0),e=t.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),e&&t.scrollTop(e.top-t.offset().top)},0)}),e.parent().find("input.select-dropdown").bind("close",function(){scope.validateRules()}),clearTimeout(t),t=null})}),onFocus=scope.$watch("focus",function(e){e&&(ScrollTo.perform(element,angular.element("#"+scope.parentElement)),scope.focus=!1)}),onValidate=scope.$watch("validate",function(e){void 0!=e&&e&&scope.validateRules()});scope.validateRules=function(){if(scope.validate=!1,scope.errorMessage=null,scope.$eval(scope.isMandatory)&&scope.label&&(!scope.ngModelCopy||scope.ngModelCopy.name===scope.label||scope.customoption&&scope.ngModelCopy.name===scope.customoption||scope.ngModelCopy[scope.dataKey]===scope.label))return scope.validate=!0,void(scope.errorMessage=scope.customMessage?scope.customMessage:$translate.instant("selectOptionErrMsg"));if(scope.rules)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,ruleLength=rules.length,i=0;ruleLength>i;i++)if("object"==typeof rules[i]){if(eval(rules[i].rule.replace(/this/g,"scope.selectedOption"))){scope.validate=!0,scope.errorMessage=rules[i].error;break}}else{if(isFoundInvalid)break;RuleEngine.isValid(rules[i],function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,isFoundInvalid=!0})}};var ch=!1;scope.ngChange=function(e,t){t||(ch=!0),sOption=e,e==scope.customoption?scope.customOptionReset=!0:scope.customOptionReset=!1;var n;if(scope.$eval(scope.isMandatory)||e!=options[0][scope.displayKey]||0!=scope.optionGroups.length){for(var o=options.length,i=0;o>i;i++)if(options[i][scope.dataKey]==e){n=options[i];break}}else n="";isNgModelFunction?"string"==typeOfNgModel||"number"==typeOfNgModel?scope.ngModel=n[scope.dataKey]:scope.ngModel=n:"string"==typeOfNgModel||"number"==typeOfNgModel?scope.$eval(scope.isMandatory)||e!=options[0][scope.displayKey]&&void 0!=e&&"fakeOptionId"!=e?scope.ngModelCopy=n[scope.dataKey]:scope.ngModelCopy="":scope.ngModelCopy=n,scope.labelVal="",e==scope.label&&e==options[0][scope.displayKey]&&(scope.labelVal=e),updateView(),scope.selectedOption=""==n?options[0]:angular.copy(n),scope.validateRules();var a=$timeout(function(){scope.onChange(),$timeout.cancel(a),a=null})},scope.$on("$destroy",function(){angular.element("#"+scope.dropDownId).material_select("destroy"),onOptions(),onDisable(),onNgModel(),onFocus(),onValidate(),angular.element($window).off("scroll.smartFixedSmartSelect")})},templateUrl:"shared/directives/uiElements/smartSelect/smartSelectTemplate.html"}}function smartSelectFunc2($timeout,$window,$translate,ScrollTo,RuleEngine,smartSelectService){return{restrict:"E",replace:!0,require:"?ngModel",scope:{label:"@",options:"=?",ngModelCopy:"=?ngModel",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",parentElement:"@",onChange:"&",disable:"@",multiple:"@",datakey:"@",displaykey:"@",removable:"@",preview:"@",customoption:"@",showinfo:"@",showwarning:"@",clienterror:"=?",customMessage:"@"},compile:function(){return{post:function(scope,element,attrs,ngModelCtrl){$(document).ready(function(){function watchOptions(e){var t=e.length;if(e&&t>0){var n,o=!0;if(n=scope.label?scope.label:$translate.instant("chooseOptionMsg"),scope.customoption&&(n=scope.customoption,o=!1,scope.customOptionReset=!0),scope.dataKey===scope.displayKey)options=[{title:n,disable:o,id:"fakeOptionId"}].concat(e),options[0][scope.displayKey]=options[0].title;else{var i={disable:o,id:"fakeOptionId"};i[scope.dataKey]=n,i[scope.displayKey]=n,options=[i].concat(e)}scope.selectOptions=options;for(var a=[],l=options.length,r=0;l>r;r++){var s=options[r];s.hasOwnProperty("groupName")&&-1==a.indexOf(s.groupName)&&a.push(s.groupName)}scope.optionGroups=angular.copy(a),watchModel(),smartSelectService.buildOptionsList(scope.optionGroups,scope.selectOptions,scope,element)}}function watchModel(){if(isNgModelWatchAdded)var e=setTimeout(function(){angular.element("#"+scope.dropDownId).material_select(),element.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var e,t=element.parent().find(".dropdown-content.select-dropdown.active");t.scrollTop(0),e=t.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),e&&t.scrollTop(e.top-t.offset().top)},0)}),element.parent().find("input.select-dropdown").bind("close",function(){scope.validateRules()}),clearTimeout(e),e=null});else onNgModel=scope.$watch(isNgModelFunction?"ngModel":"ngModelCopy",function(e){angular.isUndefined(typeOfNgModel)&&""!==e&&void 0!=e&&null!=e&&(typeOfNgModel=typeof e);var t;if("string"==typeOfNgModel||"number"==typeOfNgModel)for(var n=options.length,o=0;n>o;o++){var i=options[o];if(e==i[scope.dataKey]){t=i;break}}else"object"==typeOfNgModel?scope.ngModel=t=e:t=e;scope.selectedOption=angular.copy(t);try{scope.selectedOption?scope.selectedOption[scope.displayKey]||(scope.selectedOption=angular.copy(options[0])):scope.selectedOption=angular.copy(options[0]),scope.selectedOptionString=angular.copy(scope.selectedOption[scope.dataKey]),options[0]!=scope.selectedOption[scope.dataKey]&&(scope.labelVal=scope.selectedOption[scope.dataKey],scope.customoption&&scope.customoption!=scope.selectedOption[scope.dataKey]&&(scope.customOptionReset=!1))}catch(a){}smartSelectService.buildOptionsList(scope.optionGroups,scope.selectOptions,scope,element),smartSelectService.updateLabelTemplate(scope,element),angular.element("#"+scope.dropDownId).material_select(),element.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var e,t=element.parent().find(".dropdown-content.select-dropdown.active");t.scrollTop(0),e=t.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),e&&t.scrollTop(e.top-t.offset().top)},0)}),element.parent().find("input.select-dropdown").bind("close",function(){scope.validateRules()})}),isNgModelWatchAdded=!0}var options=[],isNgModelWatchAdded=!1,onNgModel=function(){},typeOfNgModel,isNgModelFunction="function"==typeof scope.ngModelCopy;if(scope.selectOptions=[],selectId+=1,scope.dropDownId="dropdown_"+selectId,scope.dataKey=scope.datakey?scope.datakey:"title",scope.displayKey=scope.displaykey?scope.displaykey:scope.dataKey,isNgModelFunction)try{ngModelCtrl.$render=function(){scope.ngModel=ngModelCtrl.$modelValue,scope.selectedOption=scope.ngModel}}catch(e){}var updateView=function(){if(isNgModelFunction)try{ngModelCtrl.$setViewValue(scope.ngModel)}catch(e){}};scope.labelVal="",scope.customOptionReset=!1;var collectionWatch=scope.$watchCollection("options",function(e){e&&watchOptions(e)});scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable);var sOption=scope.label;scope.disable=scope.disable?scope.disable:1,scope.validate=scope.validate?scope.validate:2;var watchGrp=scope.$watchGroup(["disable","validate","clienterror","showinfo","showwarning"],function(e,t){if(e[0]!==t[0]){var n=angular.element("#"+scope.dropDownId);scope.disable===!0&&1!==scope.disable||"string"===jQuery.type(scope.disable)&&"true"===scope.disable?(n.prop("disabled","disabled"),n.prop("readonly",!0),n.attr("tabindex",-1),n.material_select(),n.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var e,t=n.parent().find(".dropdown-content.select-dropdown.active");t.scrollTop(0),e=t.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),e&&t.scrollTop(e.top-t.offset().top)},0)}),n.parent().find("input.select-dropdown").bind("close",function(){scope.validateRules()})):(n.prop("disabled",!1),n.prop("readonly",!1),n.removeAttr("tabindex")),angular.element("#"+scope.dropDownId).material_select(),element.parent().find("input.select-dropdown").off("openSelectList").on("openSelectList",function(){""!==this.value&&void 0!==this.value&&null!==this.value&&setTimeout(function(){var e,t=element.parent().find(".dropdown-content.select-dropdown.active");t.scrollTop(0),e=t.find("li").eq(_.indexOf(scope.selectOptions,scope.selectOptions.find(function(e){return e[scope.dataKey]==scope.ngModelCopy[scope.dataKey]}))).offset(),e&&t.scrollTop(e.top-t.offset().top)},0)})}(e[1]!==t[1]||e[2]!==t[2])&&scope.validateRules(),(e[3]!=t[3]||e[4]!=t[4])&&(scope.showinfo||scope.showwarning?element.addClass("field-has-icon"):element.removeClass("field-has-icon"))}),onFocus=scope.$watch("focus",function(e){if(e){ScrollTo.perform(element,angular.element("#"+scope.parentElement)),scope.focus=!1;var t=setTimeout(function(){element.find("input").focus(),clearTimeout(t),t=null},1e3)}});scope.validateRules=function(){if(scope.validate=!1,scope.errorMessage=null,scope.$eval(scope.isMandatory)&&scope.label&&!scope.clienterror&&(!scope.ngModelCopy||scope.ngModelCopy.name===scope.label||scope.customoption&&scope.ngModelCopy.name===scope.customoption||scope.ngModelCopy[scope.dataKey]===scope.label)&&(scope.validate=!0,scope.errorMessage=scope.customMessage?scope.customMessage:$translate.instant("selectOptionErrMsg")),scope.clienterror&&(scope.validate=!0,scope.errorMessage=$translate.instant("clientErrMsg")),scope.rules&&!scope.clienterror)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,len=rules.length,i=0;len>i;i++){var tmp=rules[i];if("object"==typeof tmp){if(eval(tmp.rule.replace(/this/g,"scope.selectedOption"))){scope.validate=!0,scope.errorMessage=tmp.error;break}}else{if(isFoundInvalid)break;RuleEngine.isValid(tmp,function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,isFoundInvalid=!0})}}var containerElm=element,validateElm=$(element).find("#"+scope.dropDownId+"_validate");1==scope.validate&&null!=scope.errorMessage?(containerElm.hasClass("invalid")||containerElm.addClass("invalid"),validateElm.length>0?validateElm.html(scope.errorMessage):(containerElm.append(smartSelectService.buildValidationTemplate(scope)),validateElm=$(element).find("#"+scope.dropDownId+"_validate"),validateElm.html(scope.errorMessage))):(containerElm.hasClass("invalid")&&containerElm.removeClass("invalid"),validateElm.length>0&&validateElm.remove())},scope.hideShowField=function(){scope.isVisible=!scope.isVisible};var onSelectChange=function(e){if(scope.selectOptions&&scope.selectOptions.length>0){var t,n=e.target.options[e.target.options.selectedIndex].value;t=n,sOption=t,t==scope.customoption?scope.customOptionReset=!0:scope.customOptionReset=!1;var o;if(scope.$eval(scope.isMandatory)||t!=options[0][scope.displayKey]||0!=scope.optionGroups.length){for(var i=options.length,a=0;i>a;a++)if("string"==typeof options[a][scope.dataKey]){if(options[a][scope.dataKey].replace(/&quot;/g,'"')==t){o=options[a];break}}else if(options[a][scope.dataKey]==t){o=options[a];break}}else o="";isNgModelFunction?"string"==typeOfNgModel||"number"==typeOfNgModel?scope.ngModel=o[scope.dataKey]:scope.ngModel=o:"string"==typeOfNgModel||"number"==typeOfNgModel?scope.$eval(scope.isMandatory)||t!=options[0][scope.displayKey]&&void 0!=t&&"fakeOptionId"!=t?scope.ngModelCopy=o[scope.dataKey]:scope.ngModelCopy="":(scope.ngModelCopy=o,scope.ngModel=scope.ngModelCopy),scope.labelVal="",t==scope.label&&t==options[0][scope.displayKey]&&(scope.labelVal=t),updateView(),$(element).find("#"+scope.dropDownId+"_label").html(scope.label),scope.selectedOption=""==o?options[0]:angular.copy(o),scope.validateRules();var l=$timeout(function(){scope.$apply(),scope.onChange(),$timeout.cancel(l),l=null})}};smartSelectService.buildTemplate(scope,element,onSelectChange),scope.clienterror&&scope.validateRules(),scope.$on("$destroy",function(){angular.element("#"+scope.dropDownId).material_select("destroy"),collectionWatch(),watchGrp(),angular.element($window).off("scroll.smartFixedSmartSelect"),$(element).find("input.select-dropdown").unbind("focus"),$(element).find("input.select-dropdown").unbind("close")}),setTimeout(function(){""!=scope.label&&void 0!=scope.label&&$(element).find("#"+scope.dropDownId+"_label").html(scope.label)},0)})}}}}}function smartSelectServiceFunc(e,t,n,o){var i=function(e){if(void 0!=e.isMandatory&&"false"==e.isMandatory&&1==e.isRemovable){var t=n.get("shared/directives/uiElements/smartSelect/smartSelectOptionalFieldTemplate.html");return t=t.replace("{{id}}",e.dropDownId+"_opField")}return""},a=function(e){var t=n.get("shared/directives/uiElements/smartSelect/smartSelectOptionTemplate.html");return t=t.replace("{{id}}",e.dropDownId)},l=function(e){var t=n.get("shared/directives/uiElements/smartSelect/smartSelectValidationTemplate.html");return t=t.replace("{{id}}",e.dropDownId+"_validate")},r=function(e,t){var n=t.find("#"+e.dropDownId+"_label");e.label!=e.labelVal?n.removeClass("ng-hide"):n.addClass("ng-hide")},s=function(e){if(e.label&&e.label!=e.labelVal){var t=n.get("shared/directives/uiElements/smartSelect/smartSelectLabelTemplate.html");return t=t.replace("{{id}}",e.dropDownId+"_label"),t=t.replace("{{dropDownId}}",e.dropDownId),t=t.replace("{{label}}",e.label),t=t.replace("{{title}}",e.label)}return""},c=function(e){var t=n.get("shared/directives/uiElements/smartSelect/smartSelectInfoTemplate.html");return t},d=function(e,t,n){var r=t,d="input-field";"false"==e.isMandatory&&1==e.isRemovable&&(d+=" optionalField line-height-manager"),e.preview===!0&&(d+=" selectPreview"),e.customoption||(d+=" defaultSelected"),e.validate===!0&&e.errorMessage&&(d+=" invalid"),(e.showinfo||e.showwarning)&&(d+=" field-has-icon"),e.showinfo&&e.showwarning&&(d+=" field-has-two-icons"),r.attr("id",e.dropDownId+"_container").addClass(d),r.append(i(e)),r.append(s(e)),r.append(a(e)),r.append(l(e)),r.append(o(c(e))(e)),t.append(r);var u=$(t).find("#"+e.dropDownId);u.bind("change",function(e){n(e)});var p=$(t).find("#"+e.dropDownId+"_opField > i");"undefined"!=typeof p&&p.length>0&&p.bind("click",e.hideShowField),("true"===e.disable||e.disable===!0)&&(u.prop("readonly",!0),u.attr("disabled","disabled"),u.attr("tabindex",-1))},u=function(e,t,n,o){var i="",a=t.length;e&&e.length>0||(t&&a>0&&n.dataKey===n.displayKey?angular.forEach(t,function(e){var t="";(angular.equals(e,n.selectedOption)||angular.equals(n.ngModel,e)||angular.equals(n.ngModelCopy,e)||angular.equals(e[n.dataKey],n.selectedOptionString))&&(t=' selected="selected"'),i+='<option value="'+e[n.dataKey]+'"  '+(e.disable?'disabled="disabled"':"")+" "+t+">"+e[n.displayKey]+"</option>"}):t&&a>0&&n.dataKey!==n.displayKey&&angular.forEach(t,function(e){var t="";(angular.equals(e,n.selectedOption)||angular.equals(n.ngModel,e)||angular.equals(n.ngModelCopy,e)||angular.equals(e[n.dataKey],n.selectedOptionString))&&(t=' selected="selected"'),i+='<option value="'+e[n.dataKey]+'"  '+(e.disable?'disabled="disabled"':"")+" "+t+">"+e[n.displayKey]+"</option>"})),t[0][n.datakey]!=n.label||!t[0].disable||"title"!=n.datakey||n.selectedOption&&t[0]!=n.selectedOption||$(o).find("#"+n.dropDownId+"_label").html(""),$(o).find("#"+n.dropDownId).html(i)},p={buildOptionsList:u,buildTemplate:d,buildValidationTemplate:l,updateLabelTemplate:r};return p}var selectId=0;angular.module("SMART2").directive("smartSelect",["$timeout","$window","$translate","ScrollTo","RuleEngine","smartSelectService","undefined"!=typeof isDirectiveV2enabled&&1==isDirectiveV2enabled()?smartSelectFunc2:smartSelectFunc1]),angular.module("SMART2").factory("smartSelectService",["ScrollTo","RuleEngine","$templateCache","$compile",smartSelectServiceFunc])}(),function(){"use strict";angular.module("SMART2").directive("optionalField",["$timeout","$translate",function(e,t){return{restrict:"A",link:function(n,o,i){e(function(){"true"!==i.isMandatory&&(o.find("label").append('<span class="optionalFieldTxt">('+t.instant("textfieldOptionalLabel")+")</span>"),o.addClass("optionalFieldInPopup")),o.hasClass("hierarchylinktxt")&&o.append('<span class="optionalFieldTxt">('+t.instant("textfieldOptionalLabel")+")</span>")},500)}}}])}(),function(){"use strict";angular.module("SMART2").service("StickyElements",[function(){var e=[];this.get=function(){var t=0;return e.length>0&&angular.forEach(e,function(e,n){t+=e.height()}),{height:t,listOfElements:e}},this.set=function(t){e=t}}]).directive("stickyHeader",["$window","StickyElements",function(e,t){return{restrict:"A",scope:!0,link:function(n,o,i){function a(e,t){var n=e;angular.element(r.querySelectorAll("thead, tbody, tfoot")).css("display",""),angular.forEach(r.querySelectorAll("tr:first-child th"),function(e,t){var n="tbody tr"+(i.columnMap?i.columnMap:"")+":first-child td:nth-child("+(t+1)+")",o=r.querySelector(n),a=o?o.offsetWidth:e.offsetWidth;o&&(o.style.width=a+"px"),e&&(e.style.width=a+"px")}),angular.element(r.querySelectorAll("thead")).css({top:n,position:"fixed",background:"#ffffff","z-index":"2"}),angular.element(r.querySelectorAll("tbody")).css({height:"inherit",overflow:"hidden"})}var l=angular.element(e),r=o[0];n.scrollType=i.scrollType,"page"===n.scrollType&&l.bind("scroll",function(e){if(null!==r.offsetParent){var o=l[0].scrollY||l[0].pageYOffset,s=$(r).offset().top,c=$(r).offset().top,d=t.get().height;angular.isDefined(angular.element(".grid-fixed-container").height())&&(d+=angular.element(".grid-fixed-container").height()),angular.isDefined(angular.element(".alert-bar--fixed-to-nav").height())&&(d+=angular.element(".alert-bar--fixed-to-nav").height()),angular.isDefined(angular.element(".breadcrum-container").height())&&(d+=angular.element(".breadcrum-container").height());var u=angular.element(i.stickyHeader);u&&u.length>0&&(d+=u.height());var p=$(r).find("thead").height(),f=$(r).find("tbody").not(".dummyThead").height(),g=$(r).find(".dummyThead");o+d>s&&s+f>o+d?(c=s,a(d,n.scrollType),g.length||$("<tbody class='dummyThead'><tr><td style='height:"+p+"px'></td></tr></tbody>").insertAfter($(r).find("thead"))):(angular.element(r.querySelectorAll("thead")).css({display:"",top:"",position:"",background:""}),g.length&&g.remove())}})}}}])}(),function(){"use strict";var e=0;angular.module("SMART2").directive("smartSubsection",["$compile","ScrollTo",function(t,n){return{restrict:"E",replace:!0,scope:{modelData:"=?",templateUrl:"@",controller:"@",isMandatory:"@",isVisible:"=",focus:"=?",parentElement:"@",parentScope:"=?",removable:"@",formModel:"=?",init:"@"},link:function(o,i,a){if(o.onLoad=a.onLoad,e+=1,o.subsectionId="subsection-"+e,"function"==typeof o.modelData)o.ngModel={data:o.modelData()};else{o.ngModel={data:o.modelData};var l=o.$watch("modelData",function(e){o.ngModel={data:e}},!0),r=o.$watch("ngModel.data",function(e){o.modelData=e},!0)}var s=o.$watch("focus",function(e,t){e&&(n.perform(i,angular.element("#"+o.parentElement)),o.focus=!1)});o.isRemovable=void 0==o.$eval(o.removable)?!0:o.$eval(o.removable),""==o.controller?i.html('<div ng-class="{\'optionalField\': isMandatory == \'false\' && isRemovable}"><div class="optionalFieldHover highlight" ng-if="isMandatory == \'false\' && isRemovable" ng-include="\'shared/directives/uiElements/commonTemplates/optionalFieldRemoveButton.html\'"></div><div ng-include="templateUrl" on-subsection-load></div></div>'):i.html('<div ng-class="{\'optionalField\': isMandatory == \'false\' && isRemovable}"><div class="optionalFieldHover highlight" ng-if="isMandatory == \'false\' && isRemovable" ng-include="\'shared/directives/uiElements/commonTemplates/optionalFieldRemoveButton.html\'"></div><div ng-controller="'+o.controller+'" ng-init="'+o.init+'" ng-include="templateUrl" on-subsection-load></div></div>'),t(i.contents())(o),o.$on("$destroy",function(){l(),r(),s()})}}}]),angular.module("SMART2").directive("onSubsectionLoad",["$parse",function(e){return{restrict:"A",link:function(e,t,n){angular.isDefined(e.onLoad)&&e.$eval(e.onLoad)}}}])}(),function(){"use strict";angular.module("SMART2").directive("smartSwitch",["$timeout","ScrollTo","RuleEngine",function($timeout,ScrollTo,RuleEngine){return{restrict:"E",replace:!0,require:"?ngModel",scope:{disable:"@",isMandatory:"@",isVisible:"=?",label:"@",rightLabel:"=?",leftLabel:"=?",minHeight:"@",fill:"@",rules:"@",validate:"=?",focus:"=?",parentElement:"@",errorMessage:"@",onChange:"&",removable:"@",additionaltext:"=additionaltext"},link:function(scope,element,attrs,ngModelCtrl){scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable),scope.fill=void 0==scope.$eval(scope.fill)?!0:scope.$eval(scope.fill),scope.leftLbl="Off",scope.rightLbl="On","undefined"!=typeof scope.leftLabel&&(scope.leftLbl=scope.leftLabel),"undefined"!=typeof scope.rightLabel&&(scope.rightLbl=scope.rightLabel);try{ngModelCtrl.$render=function(){scope.ngModel=ngModelCtrl.$modelValue}}catch(e){}var updateView=function(){try{ngModelCtrl.$setViewValue(scope.ngModel)}catch(e){}},onFocus=scope.$watch("focus",function(e){e&&(ScrollTo.perform(element,angular.element("#"+scope.parentElement)),scope.focus=!1)}),onValidate=scope.$watch("validate",function(e){void 0!=e&&e&&scope.validateRules()});scope.validateRules=function(){if(scope.validate=!1,scope.errorMessage=null,scope.rules)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,i=0;i<rules.length;i++)if("object"==typeof rules[i]){if(eval(rules[i].rule.replace(/this/g,"scope.ngModel"))){scope.validate=!0,scope.errorMessage=rules[i].error;break}if(isFoundInvalid)break;RuleEngine.isValid(rules[i],function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,isFoundInvalid=!0})}},scope.ngChange=function(){updateView(),scope.validateRules(),$timeout(function(){scope.onChange()})},scope.$on("$destroy",function(){onFocus(),onValidate()})},templateUrl:"shared/directives/uiElements/smartSwitch/smartSwitchTemplate.html"}}])}(),function(){"use strict";var e=0;angular.module("SMART2").directive("smartTabs",["$timeout","$parse","$focusOnField",function(t,n,o){return{restrict:"E",replace:!0,scope:!0,link:function(i,a,l){function r(){t(function(){h=a.find("#tabs-horizontal-"+i.uniqueID).width(),y=a.find("#tabs-horizontal-"+i.uniqueID).find(".tabs-wrapper")[0].scrollWidth,y>h&&(i.showTabArrows=!0),t(function(){v=a.find("#tabs-horizontal-"+i.uniqueID).find(".tabs-wrapper").width(),b=y-v})})}"true"==l.showCount&&(i.showCount=!0);var s=(new Date).getTime();i.uniqueID="xxx2xxxpxxxoxxx".replace(/[xy]/g,function(e){var t=(s+16*Math.random())%16|0;return s=Math.floor(s/16),("x"==e?t:3&t|8).toString(16)});var c,d=n(l.onSelect),u=l.width,p=a.find(".tabparent");i.revisionMode=l.revisionMode&&"false"!=l.revisionMode?!0:!1,p.css("width",u);var f=t(function(){var e=a.find(".tabs");e.tabs(),t.cancel(f)});i.vertical=l.vertical,i.tabPanelHeight=angular.isDefined(l.tabPanelHeight)&&"true"==i.vertical?l.tabPanelHeight:"100%",e+=1,i.tabId="tab-"+e;var g=parseFloat(u),m=100-g+"%";i.headerStyle={width:m,"margin-left":u,height:"48px"},i.headerTemplate=l.headerTemplate,l.$observe("tabConfig",function(e){i.tabConfig=i.$eval(e);var t=c,n=_.find(i.tabConfig,function(e){return 1==e.active});if(c&&c.htmlmode&&void 0==n)for(var o=0;o<i.tabConfig.length;o++){var a=i.tabConfig[o];a.title.toLowerCase()===t.title.toLowerCase()&&(a.active=!0)}c=_.find(i.tabConfig,function(e){return e.active}),c&&(c.isLoaded=!0,i.selectedTabContentUrl=c.contentUrl)}),i.tabClickCallback=function(e){var t=angular.copy(e);t.previousTab=c,t.previousTab.active=!1,c=e,e.active=!0,e.isLoaded=!0,angular.isFunction(d)&&d(i,{e:t})},i.tabbingOnKeyDown=function(e,t,n){var l;if(38==e.keyCode&&angular.isDefined(n)||37==e.keyCode&&!angular.isDefined(n))l=t-1,0>l||a.find(".tab").eq(l).focus();else if(40==e.keyCode&&angular.isDefined(n)||39==e.keyCode&&!angular.isDefined(n))l=t+1,l>=i.tabConfig.length||a.find(".tab").eq(l).focus();else if(13==e.keyCode)i.tabClickCallback(i.tabConfig[t]);else if(9==e.keyCode){var r=a.find("tabContent").find("a, input, textarea, [tabindex]").first();o(r)}e.stopPropagation()},i.showTabArrows=!1,i.disableNext=!1,i.disablePrev=!0;var h,v,y,b,C,w=!0,S=0;i.$on("LastRepeaterElement",function(e,t){t.is("li")&&w&&e.nextback&&(r(),w=!1)}),i.getTabsDimensions=function(){return{w:a.find("#tabs-horizontal-"+i.uniqueID).width()}},i.$watch(i.getTabsDimensions,function(e,t){e.w!=t.w&&l.nextback&&r()},!0),i.goRight=function(){i.disableNext||(S+=175,b>S?(C=-Math.abs(S),a.find("#tabs-horizontal-"+i.uniqueID).find(".tabs-wrapper ul.tabs").css("transform","translateX("+C+"px)"),i.disablePrev=!1):(S=b,C=-Math.abs(S),a.find("#tabs-horizontal-"+i.uniqueID).find(".tabs-wrapper ul.tabs").css("transform","translateX("+C+"px)"),i.disablePrev=!1,i.disableNext=!0))},i.goLeft=function(){i.disablePrev||(S-=175,b>S&&S>0?(C=-Math.abs(S),a.find("#tabs-horizontal-"+i.uniqueID).find(".tabs-wrapper ul.tabs").css("transform","translateX("+C+"px)"),i.disableNext=!1):(S=0,C=S,a.find("#tabs-horizontal-"+i.uniqueID).find(".tabs-wrapper ul.tabs").css("transform","translateX("+C+"px)"),i.disableNext=!1,i.disablePrev=!0))},i.$on("$destroy",function(){p=null,a.remove(),i=null})},templateUrl:"shared/directives/uiElements/smartTabs/smartTabsTemplate.html"}}])}(),function(e){"use strict";e.module("SMART2").directive("smartCharacterRestrict",function(){return{restrict:"A",link:function(e,t,n){var o,i=new RegExp(n.patternreg,"ig"),a=n.validationreg?new RegExp(n.validationreg,"ig"):!1,l=n.allowpaste;t.off("keypress.smartcharacterrestrict").on("keypress.smartcharacterrestrict","input",function(e){return i.compile(n.patternreg,"ig"),null==e.key?"":(i.test(e.key)&&e.preventDefault(),void(a&&(a.compile(n.validationreg,"ig"),o=a.test(e.target.value+e.key),0==o&&e.preventDefault())))}),t.off("paste.smartcharacterrestrict").on("paste.smartcharacterrestrict","input",function(e){return"true"!==l?!1:void 0})}}})}(angular),function(){"use strict";function smartTextFieldFunc($rootScope,$timeout,$translate,ScrollTo,RuleEngine,$window){return{restrict:"E",replace:!0,require:"?ngModel",scope:{label:"@",modelOptions:"=?",options:"=?",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",parentElement:"@",onChange:"&",onFocus:"&",onBlur:"&",onKeyUp:"&",onKeyDown:"&",onKeyPress:"&",onEnter:"&",onSelect:"&",onDestroy:"&",onDateChange:"&",errorMessage:"@",errorModel:"=?",setFromGrid:"@",type:"@",align:"@",datanumeric:"@",spinner:"@",step:"@",format:"@",timePicker:"@",isValueDateObj:"@",readonly:"@",disable:"@",prefixicon:"@",suffixicon:"@",maxlength:"@",min:"@",max:"@",timePicker12Hour:"@",minuteIncrement:"@",charactercounter:"@",decimalprecision:"@",minmaxprecision:"@",placeholder:"@",autocomplete:"@",removable:"@",datakey:"@",filterkeys:"@",optionformat:"@",displayformat:"@",width:"@",minchars:"@",loading:"@",count:"@",noSuggestionNotice:"@",showNoSuggestion:"@",clearListOnFocus:"@",retainDisplayModelAutocomplete:"@",showinfo:"@",showwarning:"@"},link:function(scope,element,attrs,ngModelCtrl){function checkIfActive(){return"true"==scope.readonly?!0:("number"!=scope.type||"0"===scope.ngModel||""!==scope.placeholder||""!==scope.ngModel&&!isNaN(scope.ngModel)&&void 0!==scope.ngModel&&null!==scope.ngModel)&&("number"==scope.type||"autocomplete"==scope.type||""!==scope.placeholder||""!==scope.ngModel&&void 0!==scope.ngModel&&null!==scope.ngModel)&&("autocomplete"!=scope.type||""!==scope.placeholder||""!==scope.displayModel&&void 0!==scope.displayModel&&null!==scope.displayModel)?!0:!1}function setPrecisionLimits(){if(number=scope.ngModel,void 0!=number){var e=number.toString().split("e");e.length>1&&parseInt(e[1])<0&&(number=number.toFixed(6),scope.ngModel=number);var t=number.toString().split(".");if(void 0!=t&&t.length>1){var n=t[0];if(0!=n&&n.toString().length>20){var o=n.toString().substring(0,19);scope.ngModel=parseInt(o)}}else if(0!=number&&number.toString().length>20){var o=number.toString().substring(0,19);scope.ngModel=parseInt(o)}if(void 0!=scope.decimalprecision)scope.ngModel=parseFloat(parseFloat(scope.ngModel).toFixed(scope.decimalprecision));else if(void 0!==scope.minmaxprecision&&""!==scope.minmaxprecision){var i=JSON.parse(scope.minmaxprecision);if(i.length>2||i.length<1)return;var a=i[0],l=i[1],r=void 0!=(scope.ngModel+"").split(".")[1]?(scope.ngModel+"").split(".")[1].length:0;if(0==r)return;if(a>r&&l>r&&0!=r)scope.ngModel=parseFloat(parseFloat(scope.ngModel).toFixed(a));else if(r>=l&&0!=r){var s=Math.pow(10,l);scope.ngModel=Math.floor(scope.ngModel*s)/s}}}}function getFormattedData(data){if(!data||0==data.length)return[];for(var i=0;i<data.length;i++){var str=displayFormat;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data[i].hasOwnProperty(childSplit[k]))&&(str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),eval("data[i]."+childSplit[k])))}catch(e){}data[i].value=str.trim()}return data}function getDisplayData(data){if(void 0==data||null==data||""==data)return"";var str=displayFormat,evalResult,evaluatedKeysCounter=0,nullKeysCounter=0;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data.hasOwnProperty(childSplit[k]))&&(evalResult=eval("data."+childSplit[k]),evaluatedKeysCounter++,(void 0==evalResult||null==evalResult||0==(evalResult+"").trim().length)&&(evalResult="",nullKeysCounter++),
str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),evalResult));evaluatedKeysCounter==nullKeysCounter&&(str="")}catch(e){}return void 0===str||null===str||"undefined"===str||"null"===str?"":str}function toUTC(e){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function getGridFormatToTimestamp(e){var t=(e+"").replace(new RegExp("/","ig"),"");return moment(t).format(dateFormate)}function createDatePicker(){$timeout(function(){function e(e){if(doesContainDateString)scope.ngModel="/Date("+1e3*e.unix()+")/";else if(scope.isValueDateObj){var t=e.format();scope.ngModel=new Date(t)}else scope.ngModel=1e3*e.unix();ngModelCtrl.$setViewValue(scope.ngModel),isDateBlank=!1,angular.isFunction(scope.onDateChange)&&scope.onDateChange({$date:scope.ngModel})}var t=angular.element("#"+scope.textfieldId),n=!0,o=angular.isDefined(scope.min)?doesContainDateString?getGridFormatToTimestamp(scope.min):moment(parseInt(scope.min)).format(dateFormate):"",i=angular.isDefined(scope.max)?doesContainDateString?getGridFormatToTimestamp(scope.max):moment(parseInt(scope.max)).format(dateFormate):"",a=angular.isDefined(scope.timePicker12Hour)?!1:!0,l=angular.isDefined(scope.minuteIncrement)?scope.$eval(scope.minuteIncrement):1;pickerObj=t.daterangepicker({singleDatePicker:!0,showDropdowns:!0,timePicker:timePicker,timePicker24Hour:a,timePickerIncrement:l,autoApply:!1,opens:"right",drops:"down",minDate:o,maxDate:i,locale:{format:dateFormate,cancelLabel:$translate.instant("cancelBtn"),applyLabel:$translate.instant("applyBtn")}},function(t,o,i){n=!1,e(o)}).bind("show.daterangepicker",function(){var e=pickerObj.container.offset(),t=window.innerHeight,n=$(window).scrollTop();e.top+pickerObj.container.outerHeight()-n>t?(pickerObj.drops="up",pickerObj.move()):e.top<n&&(pickerObj.drops="down",pickerObj.move())}).data("daterangepicker"),t.on("apply.daterangepicker",function(t,o){n&&e(o.endDate),n=!0}),isDateBlank&&(t.val(""),scope.ngModel="",ngModelCtrl.$setViewValue(""))})}function hideAutoOnScroll(){void 0!=autoCompleteField&&autoCompleteField.visible&&autoCompleteField.hide()}function destroyEverythingElse(){element.off(),$("#"+scope.textfieldId).off(),$("#"+scope.labelForTextfieldId).off(),unbindValidate&&unbindValidate(),unbindFocus&&unbindFocus(),unbindOptions&&unbindOptions(),unbindNumber&&unbindNumber(),unbindDateModel&&unbindDateModel(),angular.isFunction(scope.onDestroy)&&scope.onDestroy({}),$("#"+scope.textfieldId).remove(),$("#"+scope.labelForTextfieldId).remove()}scope.modelOptions=scope.modelOptions===!1?{}:scope.modelOptions?scope.modelOptions:{updateOn:"default blur change",debounce:{"default":300,blur:0,change:0}},scope.placeholder=void 0==scope.placeholder||null==scope.placeholder?"":scope.placeholder,scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel,scope.textAlign=void 0==scope.align||null==scope.align?"left":scope.align,scope.suffixicon=void 0!=scope.suffixicon&&null!=scope.suffixicon||"date"!=scope.type?scope.suffixicon:"#icon_Calendar";var timePicker=void 0==typeof scope.timePicker?!1:"true"==scope.timePicker?!0:!1;scope.format=scope.format?scope.format:timePicker?"DD/MM/YYYY h:mm":"DD/MM/YYYY",scope.count=0;var noSuggestionNotice=angular.isDefined(scope.noSuggestionNotice)?scope.noSuggestionNotice:$translate.instant("noResultsErrMsg"),showNoSuggestion=angular.isDefined(scope.showNoSuggestion)&&"true"==scope.showNoSuggestion?!0:!1;showNoSuggestion=""==noSuggestionNotice?!1:showNoSuggestion;var number,rulesValidationEvent;scope.type=angular.isDefined(scope.type)?scope.type:"text","number"==scope.type&&element.bind("DOMMouseScroll mousewheel onmousewheel",function(e){e.returnValue=!1,e.preventDefault&&e.preventDefault()});var uniqueIDGenerator=function(){var e=(new Date).getTime(),t="xx2xxpxxoxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t};rulesValidationEvent=attrs.validateOn?attrs.validateOn:"blur";try{ngModelCtrl.$render=function(){scope.ngModel=ngModelCtrl.$modelValue}}catch(e){}var updateView=function(){try{ngModelCtrl.$setViewValue(scope.ngModel)}catch(e){}};scope.isActive=checkIfActive(),scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable),void 0!=attrs.id||null!=attrs.id?(scope.textfieldId=attrs.id,element.removeAttr("id")):(textfieldId=uniqueIDGenerator(),scope.textfieldId="txt-"+textfieldId),scope.labelForTextfieldId="label-for-"+scope.textfieldId,setTimeout(function(){"true"==scope.readonly&&"date"!=scope.type&&angular.element("#"+scope.textfieldId).attr("tabindex",-1);try{angular.isDefined(scope.$parent.$parent.onEditableRender)&&scope.$parent.$parent.onEditableRender(scope,element)}catch(e){}});var unbindValidate=scope.$watch("validate",function(e,t){e&&scope.validateRules()}),unbindFocus=scope.$watch("focus",function(e,t){e&&(ScrollTo.perform(element,angular.element("#"+scope.parentElement)),setTimeout(function(){var e=angular.element("#"+scope.textfieldId);scope.label?(e.trigger("click"),e.focus()):e.is("input")?e.focus():e.find("input").focus()},100),scope.focus=!1)}),checkRule=function(){for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,i=0;i<rules.length;i++)if("object"==typeof rules[i]){if(eval(rules[i].rule.replace(/this/g,"autocomplete"==scope.type?"scope.displayModel":"scope.ngModel"))){scope.validate=!0,scope.errorMessage=rules[i].error,scope.errorModel=rules[i].error;break}"date"===scope.type&&angular.element("#"+scope.textfieldId).removeClass("invalid")}else{if(isFoundInvalid)break;if("object"!=typeof scope.ngModel)var data=scope.ngModel;else var data=scope.displayModel;RuleEngine.isValid(rules[i],function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,scope.errorModel=e.errorData.error,isFoundInvalid=!0},data)}};scope.validateRules=function(){if("true"==scope.readonly)return void(scope.isActive=!0);if("text"!==scope.type&&"area"!==scope.type||!angular.isString(scope.ngModel)||("true"==attrs.noTrim?scope.ngModel=scope.ngModel:scope.ngModel=scope.ngModel.trim(),ngModelCtrl.$setViewValue(scope.ngModel)),"autocomplete"==scope.type&&scope.$eval(scope.isMandatory)&&(""==scope.displayModel||null==scope.displayModel||void 0==scope.displayModel||0===scope.ngModel.id)||"autocomplete"!=scope.type&&scope.$eval(scope.isMandatory)&&(scope.ngModel+""==""||null==scope.ngModel||void 0==scope.ngModel))return scope.validate=!0,scope.errorMessage=$translate.instant("enterValueErrMsg"),void(scope.errorModel=$translate.instant("enterValueErrMsg"));if("number"==scope.type){if(!scope.$eval(scope.isMandatory)&&isNaN(scope.ngModel))return void angular.element("#"+scope.textfieldId).val("");if(!scope.$eval(scope.isMandatory)&&null===scope.ngModel)return void(scope.rules&&checkRule());if(scope.$eval(scope.isMandatory)&&isNaN(scope.ngModel)||!scope.$eval(scope.isMandatory)&&void 0==number)return scope.validate=!0,scope.errorMessage=$translate.instant("enterNumberErrMsg"),void(scope.errorModel=$translate.instant("enterNumberErrMsg"))}if("date"!=scope.type||scope.rules||$("#"+scope.textfieldId).removeClass("invalid"),scope.validate=!1,scope.errorMessage=null,scope.errorModel=null,scope.rules)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,i=0;i<rules.length;i++)if("object"==typeof rules[i]){if(eval(rules[i].rule.replace(/this/g,"autocomplete"==scope.type?"scope.displayModel":"scope.ngModel"))){scope.validate=!0,scope.errorMessage=rules[i].error;break}}else{if(isFoundInvalid)break;if("object"!=typeof scope.ngModel)var data=scope.ngModel;else var data=scope.displayModel;RuleEngine.isValid(rules[i],function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,isFoundInvalid=!0},data)}};var isDateBlank=!1;scope.ngChange=function(e){"number"==scope.type&&((null==scope.ngModel||void 0==scope.ngModel)&&(scope.count=0),setPrecisionLimits()),scope.isActive=checkIfActive(),"change"==rulesValidationEvent&&scope.validateRules(),"autocomplete"!=scope.type&&updateView(),scope.onChange({$event:{data:angular.element("#"+scope.textfieldId),displayModel:scope.displayModel}})},scope.ngFocus=function(e){if("autocomplete"===scope.type||"true"===scope.clearListOnFocus){var t=element.find("input").devbridgeAutocomplete();""==element.find("input").val()&&t&&t.clear()}scope.isActive=!0,scope.validate=!1,"focus"==rulesValidationEvent&&scope.validateRules(),scope.onFocus({$event:e})},scope.ngBlur=function(e){if("number"==scope.type&&(void 0!=scope.min||null!=scope.min)&&(void 0==scope.ngModel||null==scope.ngModel||isNaN(scope.ngModel))&&$("#"+scope.textfieldId).val(""),"date"==scope.type&&isDateBlank&&$timeout(function(){var e=document.activeElement;angular.element(e).hasClass("monthselect")||angular.element(e).hasClass("yearselect")||angular.element(e).hasClass("hourselect")||angular.element(e).hasClass("minuteselect")||(scope.dateModel=null),angular.isFunction(scope.onDateChange)&&scope.onDateChange({$date:scope.ngModel})}),"autocomplete"===scope.type&&scope.ngModel&&scope.displayformat){var splittedDisplayFormat=[];splittedDisplayFormat=scope.displayformat.indexOf(":")>0?scope.displayformat.split(":"):scope.displayformat.indexOf("-")>0?scope.displayformat.split("-"):scope.displayformat.split("-");for(var result="",i=0;i<splittedDisplayFormat.length;i++)result+=eval("scope.ngModel."+splittedDisplayFormat[i].replace("{","").replace("}","")),i<splittedDisplayFormat.length-1&&(scope.displayformat.indexOf("-")>0?result+="-":scope.displayformat.indexOf(":")>0&&(result+=":"));"true"!==scope.retainDisplayModelAutocomplete&&result!==scope.displayModel&&(scope.displayModel="")}$timeout(function(){if("date"==scope.type){if(pickerObj&&pickerObj.isShowing)return;scope.validateRules(),scope.isActive=checkIfActive()}else{scope.validateRules(),scope.isActive=checkIfActive();try{angular.isDefined(scope.$parent.$parent.onStopEdit)&&scope.$parent.$parent.onStopEdit(scope,element)}catch(e){}}}),scope.isActive||scope.validate?angular.element("#"+scope.labelForTextfieldId).addClass("active"):angular.element("#"+scope.labelForTextfieldId).removeClass("active"),attrs.charactercounter&&(scope.validate&&scope.errorMessage?angular.element("#"+scope.textfieldId).addClass("invalid"):angular.element("#"+scope.textfieldId).removeClass("invalid")),scope.focus=!1,scope.onBlur({$event:e})},scope.ngKeyUp=function(e){if("date"==scope.type&&32!=e.which){var t=$("#"+scope.textfieldId).val();""==t&&(scope.ngModel=null,scope.dateModel="",isDateBlank=!0,ngModelCtrl.$setViewValue(""),angular.isFunction(scope.onDateChange)&&scope.onDateChange({$date:scope.ngModel}))}"keyUp"==rulesValidationEvent&&scope.validateRules(),scope.onKeyUp({$event:e})},scope.ngKeyDown=function(e){"keyDown"==rulesValidationEvent&&scope.validateRules(),"number"!==scope.type||38!=e.keyCode&&40!=e.keyCode||e.preventDefault(),scope.onKeyDown({$event:e})},scope.ngKeyPress=function(e){if("number"==scope.type||attrs.datanumeric){var t=e.charCode||e.keyCode,n=e.currentTarget.value,o=[],i=String.fromCharCode(t),a=[37,38,39,40,46,8];isNaN(i)&&-1==a.indexOf(t)&&e.preventDefault(),-1!==n.toString().indexOf(".")&&46==t&&e.preventDefault(),n&&(o=n.toString().split(".")),attrs.decimalprecision&&(46==t&&0==parseInt(attrs.decimalprecision)&&e.preventDefault(),2==o.length&&o[1]&&o[1].length>=parseInt(attrs.decimalprecision,10)&&e.preventDefault()),(void 0!=scope.min||null!=scope.min)&&scope.min>=0&&45==e.charCode&&e.preventDefault()}"keyPress"==rulesValidationEvent&&scope.validateRules(),scope.onKeyPress({$event:e}),13==e.charCode&&scope.onEnter({$event:e}),e.target.value.length===attrs.maxlength&&0!==e.charCode&&e.preventDefault()},scope.isValueDateObj=!1;var doesContainDateString=!1,dateFormate=scope.format,pickerObj;switch(scope.type){case"autocomplete":var filterKeys;filterKeys=angular.isDefined(scope.filterkeys)&&0==scope.filterkeys.trim().indexOf("[")?scope.filterkeys?scope.$eval(scope.filterkeys):["title"]:scope.filterkeys?scope.$eval("["+scope.filterkeys+"]"):["title"];var optionFormat=scope.optionformat?scope.optionformat:"{title}",displayFormat=scope.displayformat?scope.displayformat:"{title}",autoCompleteField,unbindOptions=scope.$watch("options",function(e){try{$("#"+scope.textfieldId).devbridgeAutocomplete()?$("#"+scope.textfieldId).devbridgeAutocomplete().setLookup(getFormattedData(e)):autoCompleteField=$("#"+scope.textfieldId).devbridgeAutocomplete({filterKeys:filterKeys,optionFormat:optionFormat,displayFormat:displayFormat,lookup:getFormattedData(e),width:scope.width,showNoSuggestionNotice:showNoSuggestion,noSuggestionNotice:noSuggestionNotice,minChars:angular.isDefined(scope.minchars)?parseInt(scope.minchars):1,onSelect:function(e){angular.element("#"+scope.labelForTextfieldId).trigger("click"),scope.$evalAsync(function(){scope.displayModel=getDisplayData(e),scope.ngModel=e,updateView(),$timeout(function(){scope.onSelect({$event:{data:e}})})})}}).devbridgeAutocomplete()}catch(t){}});scope.$on("$destroy",function(){$("#"+scope.textfieldId).devbridgeAutocomplete()&&$("#"+scope.textfieldId).devbridgeAutocomplete().dispose(),destroyEverythingElse()});break;case"date":scope.$on("$destroy",function(){angular.element("#"+scope.textfieldId+"_root").remove(),destroyEverythingElse()});break;case"text":case"area":case"number":scope.$on("$destroy",function(){destroyEverythingElse()})}switch(angular.element($window).scroll(function(e){hideAutoOnScroll()}),angular.element(".modal, .modal-content").scroll(function(e){hideAutoOnScroll()}),scope.type){case"autocomplete":case"text":case"area":case"number":var unbindNumber=scope.$watch("ngModel",function(e){"autocomplete"==scope.type&&angular.isDefined(e)&&(scope.displayModel=getDisplayData(e)),"number"==scope.type&&setPrecisionLimits(),attrs.decimalprecision&&attrs.datanumeric&&setPrecisionLimits(),scope.isActive=checkIfActive(),"change"==rulesValidationEvent&&scope.validateRules(),"area"==scope.type&&$timeout(function(){angular.element("#"+scope.textfieldId).trigger("autoresize")})});break;case"date":var unbindDateModel=scope.$watch("dateModel",function(e){scope.isActive=checkIfActive(),"change"==rulesValidationEvent&&scope.validateRules()}),unbindNgModel=scope.$watch("ngModel",function(newVal){if(dateFormate=scope.format.replace(/d/g,"D").replace(/y/g,"Y").replace(/E/g,"d"),isDateBlank=!1,doesContainDateString="true"==scope.setFromGrid?!0:(newVal+"").toLowerCase().indexOf("date")>-1?!0:!1,""==newVal||null==newVal)newVal=Date.now(),isDateBlank=!0,scope.isValueDateObj=!1;else if(doesContainDateString){var tmpModel=(newVal+"").replace(new RegExp("/","ig"),"");tmpModel=tmpModel.split("+"),tmpModel=eval("new "+(tmpModel.length>1?'Date("'+newVal+'").getTime()':tmpModel[0])),scope.dateModel=moment(tmpModel).format(dateFormate)}else"[object Date]"===Object.prototype.toString.call(newVal)?scope.isValueDateObj=!0:newVal=parseInt(newVal);scope.placeholder=void 0==scope.placeholder||null==scope.placeholder||""==scope.placeholder?"DD/MM/YYYY":scope.placeholder,isDateBlank?scope.dateModel="":doesContainDateString||(scope.dateModel=moment(newVal).format(dateFormate)),createDatePicker()}),unbindMin=scope.$watch("min",function(e){createDatePicker()}),unbindMax=scope.$watch("max",function(e){createDatePicker()});break;default:var unbindNgModel=scope.$watch("ngModel",function(e){scope.isActive=checkIfActive(),"change"==rulesValidationEvent&&scope.validateRules()})}"true"==scope.datanumeric&&(scope.spinner="undefined"==typeof attrs.spinner?"true":scope.spinner,scope.step="undefined"==typeof attrs.step?1:scope.step,$timeout(function(){angular.element("#"+scope.textfieldId).inputNumber(scope.spinner,scope.step)}))},templateUrl:"shared/directives/uiElements/smartTextfield/smartTextfieldTemplate.html"}}function smartTextField2Func(e,t,n,o,i,a,l,r){return{restrict:"E",replace:!0,require:"?ngModel",scope:{label:"@",ngModel:"=?",options:"=?",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",parentElement:"@",onChange:"&",onFocus:"&",onBlur:"&",onKeyUp:"&",onKeyDown:"&",onKeyPress:"&",onEnter:"&",onSelect:"&",onDestroy:"&",onDateChange:"&",errorMessage:"@",errorModel:"=?",setFromGrid:"@",type:"@",align:"@",datanumeric:"@",spinner:"@",step:"@",format:"@",timePicker:"@",isValueDateObj:"@",readonly:"@",disable:"@",prefixicon:"@",suffixicon:"@",maxlength:"@",min:"@",max:"@",timePicker12Hour:"@",minuteIncrement:"@",charactercounter:"@",decimalprecision:"@",minmaxprecision:"@",placeholder:"@",autocomplete:"@",removable:"@",datakey:"@",filterkeys:"@",optionformat:"@",displayformat:"@",width:"@",minchars:"@",loading:"@",count:"@",noSuggestionNotice:"@",showNoSuggestion:"@",clearListOnFocus:"@",retainDisplayModelAutocomplete:"@",showinfo:"@",showwarning:"@",clienterror:"=?",isTitleVisible:"@"},compile:function(){return{post:function(e,o,i,l){function s(e,t,n,o,i,a,l){e.placeholder=void 0==e.placeholder||null==e.placeholder?"":e.placeholder,e.ngModel=void 0==e.ngModel||null==e.ngModel?"":e.ngModel,e.textAlign=void 0==e.align||null==e.align?"left":e.align,e.suffixicon=void 0!=e.suffixicon&&null!=e.suffixicon||"date"!=e.type?e.suffixicon:"#icon_Calendar",e.count=0;var r=angular.isDefined(e.noSuggestionNotice)?e.noSuggestionNotice:l.instant("noResultsErrMsg"),s=angular.isDefined(e.showNoSuggestion)&&"true"==e.showNoSuggestion?!0:!1;s=""==r?!1:s;var c;e.type=angular.isDefined(e.type)?e.type:"text",textfieldId++,e.textfieldId="tf_"+textfieldId,e.isRemovable=void 0==e.$eval(e.removable)?!0:e.$eval(e.removable),c=n.validateOn?n.validateOn:"blur",e.onTextChange=function(a){e.ngModel=a.target.value,i.updateTextValue(e,t),i.setActiveClass(e,t),i.validateRules(e,o,t,n),i.updateTextFieldClass(e,t),e.onChange({$event:a})},e.ngBlur=function(a){e.focus=!1,i.updateTextValue(e,t),i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t),e.onBlur({$event:a})},e.ngKeyPress=function(t){e.onKeyPress({$event:t})},e.prevModel=e.ngModel;var d=e.$watch("ngModel",function(n){e.isActive=i.checkIfActive(e,t),i.updateTextValue(e,t),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)}),u=e.$watchGroup(["isMandatory","disable","readonly","focus","validate","isRemovable"],function(a,l){a[4]!=l[4]&&i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)});e.hideShowField=function(){e.isVisible=!e.isVisible},i.buildTemplate(e,t,e.onTextChange),e.$on("$destroy",function(){d(),u()})}void 0===e.type||"text"===e.type||"area"===e.type||"password"===e.type?smartTextField_TextFunc(e,o,i,l,a,t,n):"date"===e.type?SmartTextField_DateFunc(e,o,i,l,a,t,n):"autocomplete"===e.type?SmartTextField_AutocompleteFunc(e,o,i,l,a,t,n):"number"==e.type?smartTextField_NumFunc(e,o,i,l,a,t,r,n):s(e,o,i,l,a,t,n)}}}}}function smartTextField3Func(e,t,n,o,i,a,l,r,s,c){return{restrict:"E",replace:!0,require:"?ngModel",scope:{label:"@",ngModel:"=?",options:"=?",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",parentElement:"@",onChange:"&",onFocus:"&",onBlur:"&",onKeyUp:"&",onKeyDown:"&",onKeyPress:"&",onEnter:"&",onSelect:"&",onDestroy:"&",onDateChange:"&",errorMessage:"@",errorModel:"=?",setFromGrid:"@",type:"@",align:"@",datanumeric:"@",spinner:"@",step:"@",format:"@",regionalFormat:"@",timePicker:"@",isValueDateObj:"@",readonly:"@",disable:"@",prefixicon:"@",suffixicon:"@",maxlength:"@",min:"@",max:"@",timePicker12Hour:"@",minuteIncrement:"@",charactercounter:"@",decimalprecision:"@",minmaxprecision:"@",placeholder:"@",autocomplete:"@",removable:"@",datakey:"@",filterkeys:"@",optionformat:"@",displayformat:"@",width:"@",minchars:"@",loading:"@",count:"@",noSuggestionNotice:"@",showNoSuggestion:"@",clearListOnFocus:"@",retainDisplayModelAutocomplete:"@",showinfo:"@",showwarning:"@",isTitleVisible:"@",clienterror:"=?",id:"@",masterData:"@",currencySymbol:"=?"},compile:function(){return{post:function(e,o,i,a){function d(e,t,n,o,i,a,l){e.placeholder=void 0==e.placeholder||null==e.placeholder?"":e.placeholder,e.ngModel=void 0==e.ngModel||null==e.ngModel?"":e.ngModel,e.textAlign=void 0==e.align||null==e.align?"left":e.align,e.suffixicon=void 0!=e.suffixicon&&null!=e.suffixicon||"date"!=e.type?e.suffixicon:"#icon_Calendar",e.count=0;var r=angular.isDefined(e.noSuggestionNotice)?e.noSuggestionNotice:l.instant("noResultsErrMsg"),s=angular.isDefined(e.showNoSuggestion)&&"true"==e.showNoSuggestion?!0:!1;s=""==r?!1:s;var c;e.type=angular.isDefined(e.type)?e.type:"text",textfieldId++,e.textfieldId="tf_"+textfieldId,e.isRemovable=void 0==e.$eval(e.removable)?!0:e.$eval(e.removable),c=n.validateOn?n.validateOn:"blur",e.onTextChange=function(a){e.ngModel=a.target.value,i.updateTextValue(e,t),i.setActiveClass(e,t),i.validateRules(e,o,t,n),i.updateTextFieldClass(e,t),e.onChange({$event:a})},e.ngBlur=function(a){e.focus=!1,i.updateTextValue(e,t),i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t),e.onBlur({$event:a})},e.ngKeyPress=function(t){e.onKeyPress({$event:t})},e.prevModel=e.ngModel;var d=e.$watch("ngModel",function(n){e.isActive=i.checkIfActive(e,t),i.updateTextValue(e,t),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)}),u=e.$watchGroup(["isMandatory","disable","readonly","focus","validate","isRemovable"],function(a,l){a[4]!=l[4]&&i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)});e.hideShowField=function(){e.isVisible=!e.isVisible},i.buildTemplate(e,t,e.onTextChange),e.$on("$destroy",function(){d(),u()})}void 0===e.type||"text"===e.type||"area"===e.type||"password"===e.type?smartTextField3_TextFunc(e,o,i,a,l,t,n):"date"===e.type?SmartTextField3_DateFunc(e,o,i,a,l,t,n):"autocomplete"===e.type?SmartTextField3_AutocompleteFunc(e,o,i,a,l,t,n,s,c):"number"==e.type?smartTextField3_NumFunc(e,o,i,a,l,t,r,n):d(e,o,i,a,l,t,n)}}}}}function smartTextField_TextFunc(e,t,n,o,i,a,l){e.placeholder=void 0==e.placeholder||null==e.placeholder?"":e.placeholder,e.ngModel=void 0==e.ngModel||null==e.ngModel?"":e.ngModel,e.textAlign=void 0==e.align||null==e.align?"left":e.align,e.suffixicon=void 0!=e.suffixicon&&null!=e.suffixicon||"date"!=e.type?e.suffixicon:"#icon_Calendar",e.count=0;var r=angular.isDefined(e.noSuggestionNotice)?e.noSuggestionNotice:l.instant("noResultsErrMsg"),s=angular.isDefined(e.showNoSuggestion)&&"true"==e.showNoSuggestion?!0:!1;s=""==r?!1:s;var c;e.type=angular.isDefined(e.type)?e.type:"text",textfieldId++,e.textfieldId="tf_"+textfieldId,e.isRemovable=void 0==e.$eval(e.removable)?!0:e.$eval(e.removable),e.showTitle=void 0==e.isTitleVisible||null==e.isTitleVisible||"true"==e.isTitleVisible?!0:!1,c=n.validateOn?n.validateOn:"blur",e.onTextChange=function(a){i.modal.setModal(e,a.target.value,o),i.updateTextValue(e,t,o),i.setActiveClass(e,t),i.validateRules(e,o,t,n),i.updateTextFieldClass(e,t),e.onChange({$event:a})},e.ngBlur=function(l){e.focus=!1,e.onBlur({$event:l}),a(function(){i.updateTextValue(e,t,o),i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)})},e.ngKeyPress=function(t){e.typing=!0,i.modal.setModal(e,t.target.value,o),u(),n.onKeyPress&&e.onKeyPress({$event:t}),n.onEnter&&13==t.charCode&&e.onEnter({$event:t})},e.ngKeyUp=function(t){e.validate=!1,e.typing=!0,i.modal.setModal(e,t.target.value,o),u(),e.onKeyUp({$event:t})},e.ngKeyDown=function(t){e.typing=!0,i.modal.setModal(e,t.target.value,o),u(),e.onKeyDown({$event:t})},e.ngFocus=function(t){e.onFocus({$event:t})},e.prevModel=i.modal.getModal(e,o);var d,u=function(){try{i.modal.getModal(e,o)!==e.prevModel&&a(function(){e.prevModel=i.modal.getModal(e,o),"function"==typeof e.ngModel&&i.updateTextValue(e,t,o)}),i.updateTextValue(e,t,o)}catch(n){}};d="function"!=typeof e.ngModel?e.$watch("ngModel",function(a){e.isActive=i.checkIfActive(e,t),i.validateRules(e,o,t,n),e.typing===!0&&(e.typing=!1),i.updateTextValue(e,t,o),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)}):e.$watch(function(){return e.ngModel()},function(n,a){n!=a&&(e.typing=!1,e.isActive=i.checkIfActive(e,t),i.updateTextValue(e,t,o),i.setActiveClass(e,t),i.updateTextFieldClass(e,t))},!0);var p,f=e.$watchGroup(["disable","readonly"],function(n,o){(n[0]!==o[0]||n[1]!==o[1])&&(i.setActiveClass(e,t),i.updateTextFieldClass(e,t),bindOtherWatcher())});p=e.$watchGroup(["isMandatory","focus","validate","isRemovable","clienterror","showinfo","showwarning"],function(a,l){(a[2]!=l[2]||a[4]!=l[4])&&(i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)),(a[5]!=l[5]||a[6]!=l[6])&&(e.showinfo||e.showwarning?t.find("> .input-field").addClass("field-has-icon"):t.find("> .input-field").removeClass("field-has-icon")),(a[1]||"true"==a[1])&&t.find("input").focus()}),e.hideShowField=function(){e.isVisible=!e.isVisible},i.buildTemplate(e,t,e.onTextChange,n),u(),e.clienterror&&i.validateRules(e,o,t,n),e.$on("$destroy",function(){d(),f(),angular.isDefined(p)&&p()})}function SmartTextField_DateFunc(scope,element,attrs,ngModelCtrl,smartTextFieldService,$timeout,$translate){function bindOtherWatcher(){angular.isDefined(scope.disable)&&(0==scope.disable||"false"==scope.disable)||angular.isDefined(scope.readonly)&&(0==scope.readonly||"false"==scope.readonly)?(angular.isDefined(unbindOtherWatcher)||(unbindOtherWatcher=scope.$watchGroup(["isMandatory","focus","validate","isRemovable","clienterror","showinfo","showwarning"],function(e,t){(e[2]!=t[2]||e[4]!=t[4])&&(smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)),(e[1]||"true"==e[1])&&element.find("input").focus(),(e[5]!=t[5]||e[6]!=t[6])&&(scope.showinfo||scope.showwarning?element.find("> .input-field").addClass("field-has-icon"):element.find("> .input-field").removeClass("field-has-icon"))})),angular.isDefined(unbindMin)||(unbindMin=scope.$watch("min",function(e){smartTextFieldService.createDatePicker(scope,element,ngModelCtrl)})),angular.isDefined(unbindMax)||(unbindMax=scope.$watch("max",function(e){smartTextFieldService.createDatePicker(scope,element,ngModelCtrl)}))):(angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher(),angular.isDefined(unbindMin)&&unbindMin(),angular.isDefined(unbindMax)&&unbindMax())}"true"===scope.timePicker&&(scope.timePicker=!0),scope.placeholder=void 0==scope.placeholder||null==scope.placeholder||""==scope.placeholder?moment.localeData()._longDateFormat.L:scope.placeholder,1==scope.timePicker&&(scope.placeholder=moment.localeData()._longDateFormat.L+" "+moment.localeData()._longDateFormat.LT),scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel,scope.textAlign=void 0==scope.align||null==scope.align?"left":scope.align,scope.suffixicon=void 0!=scope.suffixicon&&null!=scope.suffixicon||"date"!=scope.type?scope.suffixicon:"#icon_Calendar",scope.count=0,scope.datetimePicker=void 0==typeof scope.timePicker?!1:scope.timePicker===!0?!0:!1,scope.format=scope.format?scope.format:scope.datetimePicker?"DD/MM/YYYY h:mm":"DD/MM/YYYY";var number,rulesValidationEvent;scope.type=angular.isDefined(scope.type)?scope.type:"text",textfieldId++,scope.textfieldId="tf_"+textfieldId,scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable),scope.applyClientZone=!1,scope.isValueDateObj=!1,scope.doesContainDateString=!1,scope.dateFormat=scope.format,scope.isDateBlank=!1,"undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable&&(scope.dateFormat=moment.localeData().longDateFormat("L"),1==scope.timePicker&&(scope.dateFormat=moment.localeData().longDateFormat("L")+" "+moment.localeData().longDateFormat("LT")),scope.format=scope.dateFormat),scope.convertIntoUTC=!1,"undefined"!=typeof convertIntoUTC&&(scope.convertIntoUTC=convertIntoUTC),rulesValidationEvent=attrs.validateOn?attrs.validateOn:"blur",scope.onTextChange=function(e){smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.updateTextFieldClass(scope,element),scope.onChange({$event:e})},scope.ngBlur=function(e){if(scope.isDateBlank){var t=document.activeElement;angular.element(t).hasClass("monthselect")||angular.element(t).hasClass("yearselect")||angular.element(t).hasClass("hourselect")||angular.element(t).hasClass("minuteselect")||(scope.dateModel=null),angular.isFunction(scope.onDateChange)&&scope.onDateChange({$date:scope.ngModel})}scope.focus=!1,smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element),scope.onBlur({$event:e})},scope.ngKeyUp=function(e){if(32!=e.which){var t=$("#"+scope.textfieldId).val();""==t&&(scope.ngModel=null,scope.dateModel="",scope.isDateBlank=!0,angular.isFunction(scope.onDateChange)&&scope.onDateChange({$date:scope.ngModel}))}"keyUp"==rulesValidationEvent&&scope.validateRules(),scope.onKeyUp({$event:e})},scope.ngKeyDown=function(e){"keyDown"==rulesValidationEvent&&scope.validateRules(),scope.onKeyDown({$event:e})},scope.ngKeyPress=function(e){"keyPress"==rulesValidationEvent&&scope.validateRules(),scope.onKeyPress({$event:e}),13==e.charCode&&scope.onEnter({$event:e})},scope.prevModel=scope.ngModel;var updateView=function(){try{scope.ngModel!==scope.prevModel&&$timeout(function(){scope.prevModel=scope.ngModel}),smartTextFieldService.updateDateValue(scope,element)}catch(e){}},unbindOtherWatcher,unbindMin,unbindMax,unbindAttributesWatcher=scope.$watchGroup(["disable","readonly"],function(e,t){(e[0]!==t[0]||e[1]!==t[1])&&(smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element),bindOtherWatcher())});scope.hideShowField=function(){scope.isVisible=!scope.isVisible},smartTextFieldService.buildTemplate(scope,element,scope.onTextChange),smartTextFieldService.updateDateClass(scope,element),smartTextFieldService.assignDateEvents(scope,element),bindOtherWatcher();var unbindDateModel=scope.$watch("dateModel",function(e){e&&(scope.isActive=smartTextFieldService.checkIfActive(scope,element),"change"==rulesValidationEvent&&scope.validateRules(),smartTextFieldService.updateDateValue(scope,element))}),timeOffset=20;scope.updatingDateModel=function(e){if("undefined"!=typeof timeZoneOffset&&(timeOffset=timeZoneOffset),20==timeOffset){var t=0;-720==moment().zone()&&(t=-1),scope.dateModel=moment(e).add(t,"second").format(scope.dateFormat)}else{var t=0;-12==timeOffset&&(t=-1),"object"==typeof e?20!=timeZoneOffset?scope.dateModel=moment(e).add(60*timeOffset,"minute").add(t,"second").format(scope.dateFormat):scope.dateModel=moment(e).add(t,"second").format(scope.dateFormat):20!=timeZoneOffset?scope.dateModel=moment(e).utc().zone(-1*timeOffset).add(t,"second").format(scope.dateFormat):scope.dateModel=moment(e).utc().add(t,"second").format(scope.dateFormat)}};var unbindNgModel=scope.$watch("ngModel",function(newVal){if("true"===scope.timePicker&&(scope.timePicker=!0),!scope.dateModifiedbyUser){if(scope.dateFormat=scope.format.replace(/d/g,"D").replace(/y/g,"Y").replace(/E/g,"d"),"undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable&&(scope.dateFormat=moment.localeData().longDateFormat("L"),1==scope.timePicker&&(scope.dateFormat=moment.localeData().longDateFormat("L")+" "+moment.localeData().longDateFormat("LT")),scope.format=scope.dateFormat),scope.isDateBlank=!1,scope.doesContainDateString="true"==scope.setFromGrid?!0:(newVal+"").toLowerCase().indexOf("date")>-1?!0:!1,""==newVal||null==newVal||"function"==typeof newVal)newVal=Date.now(),scope.isDateBlank=!0,scope.isValueDateObj=!1;else if(scope.doesContainDateString){var dateStr=(newVal+"").replace(new RegExp("/","ig"),""),tmpModel=dateStr;dateStr.indexOf("Date")<=-1&&(tmpModel=tmpModel.split("+"),tmpModel=eval("new "+(tmpModel.length>1?'Date("'+newVal+'").getTime()':tmpModel[0]))),scope.updatingDateModel(tmpModel)}else"[object Date]"===Object.prototype.toString.call(newVal)?scope.isValueDateObj=!0:"[object String]"===Object.prototype.toString.call(newVal)&&newVal.indexOf("T")>0||(newVal=parseInt(newVal));scope.placeholder=scope.format,scope.isDateBlank?scope.dateModel="":scope.doesContainDateString||scope.updatingDateModel(newVal),
smartTextFieldService.updateDateValue(scope,element),smartTextFieldService.createDatePicker(scope,element,ngModelCtrl)}scope.isActive=smartTextFieldService.checkIfActive(scope,element),scope.dateModifiedbyUser=!1,smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)});scope.clienterror&&smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),scope.$on("$destroy",function(){unbindAttributesWatcher(),unbindNgModel(),unbindDateModel(),angular.isDefined(unbindMin)&&unbindMin(),angular.isDefined(unbindMax)&&unbindMax(),angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher()})}function SmartTextField_AutocompleteFunc(scope,element,attrs,ngModelCtrl,smartTextFieldService,$timeout,$translate){function bindOtherWatcher(){angular.isDefined(scope.disable)&&(0==scope.disable||"false"==scope.disable)||angular.isDefined(scope.readonly)&&(0==scope.readonly||"false"==scope.readonly)?angular.isDefined(unbindOtherWatcher)||(unbindOtherWatcher=scope.$watchGroup(["focus","isRemovable"],function(e,t){smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)})):angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher()}scope.placeholder=void 0==scope.placeholder||null==scope.placeholder?"":scope.placeholder,scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel,scope.textAlign=void 0==scope.align||null==scope.align?"left":scope.align,scope.suffixicon=void 0!=scope.suffixicon&&null!=scope.suffixicon||"date"!=scope.type?scope.suffixicon:"#icon_Calendar",scope.count=0;var noSuggestionNotice=angular.isDefined(scope.noSuggestionNotice)?scope.noSuggestionNotice:$translate.instant("noResultsErrMsg"),showNoSuggestion=angular.isDefined(scope.showNoSuggestion)&&"true"==scope.showNoSuggestion?!0:!1;showNoSuggestion=""==noSuggestionNotice?!1:showNoSuggestion;var number,rulesValidationEvent;scope.type=angular.isDefined(scope.type)?scope.type:"text",textfieldId++,scope.textfieldId="tf_"+textfieldId,scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable),rulesValidationEvent=attrs.validateOn?attrs.validateOn:"blur",scope.onTextChange=function(e){console.log(scope.displayModel),scope.onChange({$event:{data:element.find("#"+scope.textfieldId),displayModel:scope.displayModel}})},scope.ngBlur=function(e){if(scope.ngModel&&scope.displayformat){var splittedDisplayFormat=[];splittedDisplayFormat=scope.displayformat.indexOf(":")>0?scope.displayformat.split(":"):scope.displayformat.indexOf("-")>0?scope.displayformat.split("-"):scope.displayformat.split("-");for(var result="",i=0;i<splittedDisplayFormat.length;i++)result+=eval("scope.ngModel."+splittedDisplayFormat[i].replace("{","").replace("}","")),i<splittedDisplayFormat.length-1&&(scope.displayformat.indexOf("-")>0?result+="-":scope.displayformat.indexOf(":")>0&&(result+=":"));"true"!==scope.retainDisplayModelAutocomplete&&(""==e.target.value.trim()||result!==scope.displayModel)&&(scope.displayModel="")}scope.focus=!1,smartTextFieldService.updateAutocompleteValue(scope,element),$timeout(function(){smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs)}),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element);try{angular.isDefined(scope.$parent.$parent.onStopEdit)&&scope.$parent.$parent.onStopEdit(scope,element)}catch(e){}scope.onBlur({$event:e})},scope.ngKeyPress=function(e){"keyPress"==rulesValidationEvent&&scope.validateRules(),scope.onKeyPress({$event:e}),13==e.charCode&&scope.onEnter({$event:e})},scope.elmVal=null,scope.ngKeyUp=function(e){},scope.search=function(e){""!=e.target.value&&e.target.value!=scope.elmVal&&(scope.elmVal=e.target.value,scope.onChange({$event:{data:element.find("#"+scope.textfieldId),displayModel:e.target.value}}))},scope.ngFocus=function(e){var t=element.find("#"+scope.textfieldId),n=t.devbridgeAutocomplete();""==t.val()&&n&&(n.clear(),scope.elmVal=""),scope.onFocus({$event:e})},scope.prevModel=scope.ngModel;var updateView=function(){try{scope.ngModel!==scope.prevModel&&$timeout(function(){scope.prevModel=scope.ngModel}),smartTextFieldService.updateAutocompleteValue(scope,element)}catch(e){}},unbindModelWatcher=scope.$watch("ngModel",function(e){scope.displayModel=smartTextFieldService.getDisplayData(e,scope),scope.isActive=smartTextFieldService.checkIfActive(scope,element),smartTextFieldService.updateAutocompleteValue(scope,element),smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)}),unbindOtherWatcher,unbindAttributesWatcher=scope.$watchGroup(["disable","readonly"],function(e,t){(e[0]!==t[0]||e[1]!==t[1])&&(smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element),bindOtherWatcher())});scope.hideShowField=function(){scope.isVisible=!scope.isVisible};var unbindValidationWatcher=scope.$watchGroup(["isMandatory","validate","clienterror","showinfo","showwarning"],function(e,t){(e[1]!=t[1]||e[2]!=t[2])&&smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),(e[3]!=t[3]||e[4]!=t[4])&&(scope.showinfo||scope.showwarning?element.find("> .input-field").addClass("field-has-icon"):element.find("> .input-field").removeClass("field-has-icon")),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)}),filterKeys;filterKeys=angular.isDefined(scope.filterkeys)&&0==scope.filterkeys.trim().indexOf("[")?scope.filterkeys?scope.$eval(scope.filterkeys):["title"]:scope.filterkeys?scope.$eval("["+scope.filterkeys+"]"):["title"];var optionFormat=scope.optionformat?scope.optionformat:"{title}";scope.ndisplayFormat=scope.displayformat?scope.displayformat:"{title}";var unbindOptions=scope.$watch("options",function(e){try{$("#"+scope.textfieldId).devbridgeAutocomplete()?$("#"+scope.textfieldId).devbridgeAutocomplete().setLookup(smartTextFieldService.getFormattedData(e,scope)):$("#"+scope.textfieldId).devbridgeAutocomplete({filterKeys:filterKeys,optionFormat:optionFormat,displayFormat:scope.ndisplayFormat,lookup:smartTextFieldService.getFormattedData(e,scope),width:scope.width,showNoSuggestionNotice:showNoSuggestion,noSuggestionNotice:noSuggestionNotice,minChars:angular.isDefined(scope.minchars)?parseInt(scope.minchars):1,onSelect:function(e){angular.element(document).trigger("click"),scope.$evalAsync(function(){scope.displayModel=smartTextFieldService.getDisplayData(e,scope),scope.ngModel=e,updateView(),$timeout(function(){scope.onSelect({$event:{data:e}})})})}})}catch(t){}});smartTextFieldService.buildTemplate(scope,element,scope.onTextChange,attrs),smartTextFieldService.assignAutocompleteEvents(scope,element),bindOtherWatcher(),scope.clienterror&&smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),scope.$on("$destroy",function(){unbindModelWatcher(),unbindAttributesWatcher(),unbindOptions(),angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher(),unbindValidationWatcher()})}function smartTextField_NumFunc(e,t,n,o,i,a,l,r){function s(){angular.isDefined(e.disable)&&(0==e.disable||"false"==e.disable)||angular.isDefined(e.readonly)&&(0==e.readonly||"false"==e.readonly)?angular.isDefined(p)||(p=e.$watchGroup(["isMandatory","focus","validate","isRemovable","clienterror","showinfo","showwarning"],function(a,l){(a[2]!=l[2]||a[4]!=l[4])&&(i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)),(a[5]!=l[5]||a[6]!=l[6])&&(e.showinfo||e.showwarning?t.find("> .input-field").addClass("field-has-icon"):t.find("> .input-field").removeClass("field-has-icon")),(a[1]||"true"==a[1])&&t.find("input").focus()})):angular.isDefined(p)&&p()}e.placeholder=void 0==e.placeholder||null==e.placeholder?"":e.placeholder,e.ngModel=void 0==e.ngModel||null==e.ngModel?"":e.ngModel,e.textAlign=void 0==e.align||null==e.align?"left":e.align,e.suffixicon=void 0!=e.suffixicon&&null!=e.suffixicon||"date"!=e.type?e.suffixicon:"#icon_Calendar",e.count=0;var c=angular.isDefined(e.noSuggestionNotice)?e.noSuggestionNotice:r.instant("noResultsErrMsg"),d=angular.isDefined(e.showNoSuggestion)&&"true"==e.showNoSuggestion?!0:!1;d=""==c?!1:d;var u;e.type=angular.isDefined(e.type)?e.type:"text",textfieldId++,e.textfieldId="tf_"+textfieldId,e.isRemovable=void 0==e.$eval(e.removable)?!0:e.$eval(e.removable),e.showTitle=void 0==e.isTitleVisible||null==e.isTitleVisible||"true"==e.isTitleVisible?!0:!1,u=n.validateOn?n.validateOn:"blur",e.onTextChange=function(a){var l=t.find("#"+e.textfieldId).autoNumeric("get");""!=l?e.ngModel=parseFloat(t.find("#"+e.textfieldId).autoNumeric("get")):e.ngModel=null,f(),i.setActiveClass(e,t),i.validateRules(e,o,t,n),i.updateTextFieldClass(e,t),e.onChange({$event:a})},e.ngBlur=function(a){var l=t.find("#"+e.textfieldId).autoNumeric("get");""!=l?e.ngModel=parseFloat(t.find("#"+e.textfieldId).autoNumeric("get")):e.ngModel=null,f(),e.focus=!1,i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t),e.onBlur({$event:a})},e.ngKeyPress=function(a){if("number"==e.type||n.datanumeric){var l=a.charCode||a.keyCode,r=a.currentTarget.value,s=[],c=String.fromCharCode(l),d=[37,38,39,40,46,8];isNaN(c)&&-1==d.indexOf(l)&&a.preventDefault(),-1!==r.toString().indexOf(".")&&46==l&&a.preventDefault(),r&&(s=r.toString().split(".")),n.decimalprecision&&(46==l&&0==parseInt(n.decimalprecision)&&a.preventDefault(),2==s.length&&s[1]&&s[1].length>=parseInt(n.decimalprecision,10)&&a.preventDefault()),(void 0!=e.min||null!=e.min)&&e.min>=0&&45==a.charCode&&a.preventDefault()}"keyPress"==u&&i.validateRules(e,o,t,n),e.onKeyPress({$event:a}),13==a.charCode&&e.onEnter({$event:a}),angular.isDefined(n.maxlength)&&a.target.value.length==n.maxlength&&0!==a.charCode&&a.preventDefault()},e.prevModel=e.ngModel;var p,f=function(){try{if(i.updateTextValue(e,t),null!=e.ngModel){var n=0,o=0;if("undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable)void 0==e.minmaxprecision||""==e.minmaxprecision?(n=0,o=0):(n=MinPrecessionValue,o=MaxPrecessionValue);else if(void 0!==e.minmaxprecision&&""!==e.minmaxprecision){var r=JSON.parse(e.minmaxprecision);2==r.length&&(n=r[0],o=r[1])}try{e.minmaxprecision&&(n=JSON.parse(e.minmaxprecision)[0],o=JSON.parse(e.minmaxprecision)[1])}catch(s){console.log(s)}if(t.find("#"+e.textfieldId).val(l("minPrecisionHandler")(e.ngModel,n,o,!1)),!e.ngModel){var c=t.find("#"+e.textfieldId).autoNumeric("get");""!=c?(e.ngModel=parseFloat(t.find("#"+e.textfieldId).autoNumeric("get")),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)):e.ngModel=null}e.ngModel!==e.prevModel&&a(function(){e.prevModel=e.ngModel})}}catch(s){}},g=e.$watch("ngModel",function(n){e.isActive=i.checkIfActive(e,t),f(),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)}),m=e.$watchGroup(["disable","readonly"],function(n,o){(n[0]!==o[0]||n[1]!==o[1])&&(i.setActiveClass(e,t),i.updateTextFieldClass(e,t),s())});if(e.hideShowField=function(){e.isVisible=!e.isVisible},i.buildTemplate(e,t,e.onTextChange),"undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable)void 0==e.minmaxprecision||""==e.minmaxprecision?t.find("#"+e.textfieldId).autoNumeric("init",{mDec:0,aPad:!1,aSep:h,aDec:v,vMin:Number.NEGATIVE_INFINITY,vMax:Number.POSITIVE_INFINITY}):t.find("#"+e.textfieldId).autoNumeric();else{var h=",",v=".",y=0;if(void 0!==e.minmaxprecision&&""!==e.minmaxprecision){var b=JSON.parse(e.minmaxprecision);if(2==b.length){b[0];y=b[1]}}t.find("#"+e.textfieldId).autoNumeric("init",{mDec:y,aPad:!1,aSep:h,aDec:v,vMin:Number.NEGATIVE_INFINITY,vMax:Number.POSITIVE_INFINITY})}s(),e.clienterror&&i.validateRules(e,o,t,n),e.$on("$destroy",function(){g(),m(),angular.isDefined(p)&&p()})}function smartTextField3_TextFunc(e,t,n,o,i,a,l){e.placeholder=void 0==e.placeholder||null==e.placeholder?"":e.placeholder,e.ngModel=void 0==e.ngModel||null==e.ngModel?"":e.ngModel,e.textAlign=void 0==e.align||null==e.align?"left":e.align,e.suffixicon=void 0!=e.suffixicon&&null!=e.suffixicon||"date"!=e.type?e.suffixicon:"#icon_Calendar",e.count=0;var r=angular.isDefined(e.noSuggestionNotice)?e.noSuggestionNotice:l.instant("noResultsErrMsg"),s=angular.isDefined(e.showNoSuggestion)&&"true"==e.showNoSuggestion?!0:!1;s=""==r?!1:s;var c;e.type=angular.isDefined(e.type)?e.type:"text",textfieldId++,e.textfieldId="tf_"+textfieldId,e.isRemovable=void 0==e.$eval(e.removable)?!0:e.$eval(e.removable),e.showTitle=void 0==e.isTitleVisible||null==e.isTitleVisible||"true"==e.isTitleVisible?!0:!1,e.typing=!1,c=n.validateOn?n.validateOn:"blur","area"===e.type&&a(function(){angular.element("#"+e.textfieldId).trigger("autoresize")}),e.onTextChange=function(a){i.modal.setModal(e,a.target.value,o),i.updateTextValue(e,t,o),i.setActiveClass(e,t),i.validateRules(e,o,t,n),i.updateTextFieldClass(e,t),e.onChange({$event:a})},e.ngBlur=function(l){a(function(){e.focus=!1,e.typing=!1,i.updateTextValue(e,t,o),i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t),e.onBlur({$event:l}),"area"==e.type&&""==e.ngModel&&$(angular.element("#"+e.textfieldId)).css("overflow","hidden")})},e.ngKeyPress=function(t){e.typing=!0,i.modal.setModal(e,t.target.value,o),p(),n.onKeyPress&&e.onKeyPress({$event:t}),n.onEnter&&13==t.charCode&&e.onEnter({$event:t})};var d;e.ngKeyUp=function(t){e.typing=!0,i.modal.setModal(e,t.target.value,o),clearInterval(d),d=setInterval(function(){clearInterval(d),p()},1500),e.onKeyUp({$event:t}),"area"==e.type&&($(angular.element("#"+e.textfieldId)).height()<64?$(angular.element("#"+e.textfieldId)).css("overflow","hidden"):$(angular.element("#"+e.textfieldId)).css("overflow","auto"))},e.ngKeyDown=function(t){e.typing=!0,i.modal.setModal(e,t.target.value,o),p(),e.onKeyDown({$event:t})},e.ngFocus=function(t){e.onFocus({$event:t})},e.prevModel=i.modal.getModal(e,o);var u,p=function(){try{i.modal.getModal(e,o)!==e.prevModel&&a(function(){e.prevModel=i.modal.getModal(e,o),"function"==typeof e.ngModel&&i.updateTextValue(e,t,o)}),i.updateTextValue(e,t,o)}catch(n){}};u="function"!=typeof e.ngModel?e.$watch("ngModel",function(n){e.isActive=i.checkIfActive(e,t),i.updateTextValue(e,t,o),i.setActiveClass(e,t),i.updateTextFieldClass(e,t),"area"===e.type&&a(function(){angular.element("#"+e.textfieldId).trigger("autoresize")})}):e.$watch(function(){return e.ngModel()},function(n,l){n!=l&&(e.isActive=i.checkIfActive(e,t),i.updateTextValue(e,t,o),i.setActiveClass(e,t),i.updateTextFieldClass(e,t),"area"===e.type&&a(function(){angular.element("#"+e.textfieldId).trigger("autoresize")}))},!0);var f,g=e.$watchGroup(["disable","readonly"],function(a,l){(a[0]!==l[0]||a[1]!==l[1])&&(i.setActiveClass(e,t),i.updateTextFieldClass(e,t),"area"===e.type&&(i.buildTemplate(e,t,e.onTextChange,n),i.updateTextValue(e,t,o)),bindOtherWatcher())});f=e.$watchGroup(["isMandatory","focus","validate","isRemovable","clienterror","showinfo","showwarning"],function(a,l){(a[2]!=l[2]||a[4]!=l[4])&&(i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)),(a[5]!=l[5]||a[6]!=l[6])&&(e.showinfo||e.showwarning?t.find("> .input-field").addClass("field-has-icon"):t.find("> .input-field").removeClass("field-has-icon")),(a[1]||"true"==a[1])&&t.find("input").focus()}),e.hideShowField=function(){e.isVisible=!e.isVisible},i.buildTemplate(e,t,e.onTextChange,n),p(),e.clienterror&&i.validateRules(e,o,t,n),e.$on("$destroy",function(){u(),g(),angular.isDefined(f)&&f()})}function SmartTextField3_DateFunc(scope,element,attrs,ngModelCtrl,smartTextFieldService,$timeout,$translate){function bindOtherWatcher(){angular.isDefined(scope.disable)&&(0==scope.disable||"false"==scope.disable)||angular.isDefined(scope.readonly)&&(0==scope.readonly||"false"==scope.readonly)?(angular.isDefined(unbindOtherWatcher)||(unbindOtherWatcher=scope.$watchGroup(["isMandatory","focus","validate","isRemovable","clienterror","showinfo","showwarning"],function(e,t){(e[2]!=t[2]||e[4]!=t[4])&&(smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)),(e[1]||"true"==e[1])&&element.find("input").focus(),(e[5]!=t[5]||e[6]!=t[6])&&(scope.showinfo||scope.showwarning?element.find("> .input-field").addClass("field-has-icon"):element.find("> .input-field").removeClass("field-has-icon"))})),angular.isDefined(unbindMin)||(unbindMin=scope.$watch("min",function(e){smartTextFieldService.createDatePicker(scope,element,ngModelCtrl)})),angular.isDefined(unbindMax)||(unbindMax=scope.$watch("max",function(e){smartTextFieldService.createDatePicker(scope,element,ngModelCtrl)}))):(angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher(),angular.isDefined(unbindMin)&&unbindMin(),angular.isDefined(unbindMax)&&unbindMax())}"true"===scope.timePicker&&(scope.timePicker=!0),scope.placeholder=void 0==scope.placeholder||null==scope.placeholder||""==scope.placeholder?moment.localeData()._longDateFormat.L:scope.placeholder,1==scope.timePicker&&("undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable?scope.placeholder=scope.regionalFormat?scope.regionalFormat:moment.localeData()._longDateFormat.L+" "+moment.localeData()._longDateFormat.LT:scope.placeholder=moment.localeData()._longDateFormat.L+" "+moment.localeData()._longDateFormat.LT),scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel,scope.textAlign=void 0==scope.align||null==scope.align?"left":scope.align,scope.suffixicon=void 0!=scope.suffixicon&&null!=scope.suffixicon||"date"!=scope.type?scope.suffixicon:"#icon_Calendar",scope.count=0,scope.datetimePicker=void 0==typeof scope.timePicker?!1:scope.timePicker===!0?!0:!1,scope.format=scope.format?scope.format:scope.datetimePicker?"DD/MM/YYYY h:mm":"DD/MM/YYYY";var number,rulesValidationEvent;scope.type=angular.isDefined(scope.type)?scope.type:"text",textfieldId++,scope.textfieldId="tf_"+textfieldId,scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable),scope.applyClientZone=!1,scope.isValueDateObj=!1,scope.doesContainDateString=!1,scope.dateFormat=scope.format,scope.isDateBlank=!1,"undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable&&(scope.regionalFormat?scope.dateFormat=scope.regionalFormat:1==scope.timePicker?scope.dateFormat=moment.localeData().longDateFormat("L")+" "+moment.localeData().longDateFormat("LT"):scope.dateFormat=moment.localeData().longDateFormat("L"),scope.format=scope.dateFormat),scope.convertIntoUTC=!1,"undefined"!=typeof convertIntoUTC&&(scope.convertIntoUTC=convertIntoUTC),rulesValidationEvent=attrs.validateOn?attrs.validateOn:"blur",scope.onTextChange=function(e){smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.updateTextFieldClass(scope,element),scope.onChange({$event:e})},scope.ngBlur=function(e){if(scope.isDateBlank){var t=document.activeElement;angular.element(t).hasClass("monthselect")||angular.element(t).hasClass("yearselect")||angular.element(t).hasClass("hourselect")||angular.element(t).hasClass("minuteselect")||(scope.dateModel=null),angular.isFunction(scope.onDateChange)&&scope.onDateChange({$date:scope.ngModel})}var n=smartTextFieldService.getSelectedDate();""==n&&$("#"+scope.textfieldId).val(""),$("#"+scope.textfieldId).find("input").daterangepicker()&&$("#"+scope.textfieldId).find("input").daterangepicker().daterangepicker(),angular.isDefined(n)&&scope.datetimePicker&&n.indexOf("Date(")<=-1&&$("#"+scope.textfieldId).val(smartTextFieldService.getPreviousDate()),smartTextFieldService.setSelectedDate(void 0),scope.focus=!1,smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element),scope.onBlur({$event:e})},scope.ngKeyUp=function(e){if(32!=e.which){var t=$("#"+scope.textfieldId).val();smartTextFieldService.setSelectedDate($("#"+scope.textfieldId).val()),""==t&&(scope.ngModel=null,scope.dateModel="",scope.isDateBlank=!0,angular.isFunction(scope.onDateChange)&&scope.onDateChange({$date:scope.ngModel}))}"keyUp"==rulesValidationEvent&&scope.validateRules(),scope.onKeyUp({$event:e})},scope.ngKeyDown=function(e){"keyDown"==rulesValidationEvent&&scope.validateRules(),scope.onKeyDown({$event:e})},scope.ngKeyPress=function(e){"keyPress"==rulesValidationEvent&&scope.validateRules(),scope.onKeyPress({$event:e}),13==e.charCode&&scope.onEnter({$event:e})},scope.prevModel=scope.ngModel;var updateView=function(){try{scope.ngModel!==scope.prevModel&&$timeout(function(){scope.prevModel=scope.ngModel}),smartTextFieldService.updateDateValue(scope,element)}catch(e){}},unbindOtherWatcher,unbindMin,unbindMax,unbindAttributesWatcher=scope.$watchGroup(["disable","readonly"],function(e,t){(e[0]!==t[0]||e[1]!==t[1])&&(smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element),bindOtherWatcher())});scope.hideShowField=function(){scope.isVisible=!scope.isVisible},smartTextFieldService.buildTemplate(scope,element,scope.onTextChange),smartTextFieldService.updateDateClass(scope,element),smartTextFieldService.assignDateEvents(scope,element),bindOtherWatcher();var unbindDateModel=scope.$watch("dateModel",function(e){e&&(scope.isActive=smartTextFieldService.checkIfActive(scope,element),"change"==rulesValidationEvent&&scope.validateRules(),smartTextFieldService.updateDateValue(scope,element))}),timeOffset=20;scope.updatingDateModel=function(e){if("undefined"!=typeof timeZoneOffset&&(timeOffset=timeZoneOffset),"undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable&&scope.regionalFormat&&(timeOffset=0),20==timeOffset){var t=0;-720==moment().zone()&&(t=-1),scope.dateModel=moment(e).add(t,"second").format(scope.dateFormat)}else{var t=0;-12==timeOffset&&(t=-1),"object"==typeof e?20!=timeZoneOffset?scope.dateModel=moment(e).add(60*timeOffset,"minute").add(t,"second").format(scope.dateFormat):scope.dateModel=moment(e).add(t,"second").format(scope.dateFormat):20!=timeZoneOffset?scope.dateModel=moment(e).utc().zone(-1*timeOffset).add(t,"second").format(scope.dateFormat):scope.dateModel=moment(e).utc().add(t,"second").format(scope.dateFormat)}};var unbindNgModel=scope.$watch("ngModel",function(newVal){if("true"===scope.timePicker&&(scope.timePicker=!0),"undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable&&scope.regionalFormat&&$timeout(function(){scope.dateModel=element.find("input").val()},250),!scope.dateModifiedbyUser){if("undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable?(scope.regionalFormat?scope.dateFormat=scope.regionalFormat:1==scope.timePicker?scope.dateFormat=moment.localeData().longDateFormat("L")+" "+moment.localeData().longDateFormat("LT"):scope.dateFormat=moment.localeData().longDateFormat("L"),scope.dateFormat=scope.dateFormat.replace(/d/g,"D").replace(/y/g,"Y").replace(/E/g,"d"),scope.format=scope.dateFormat):scope.dateFormat=scope.format.replace(/d/g,"D").replace(/y/g,"Y").replace(/E/g,"d"),scope.isDateBlank=!1,scope.doesContainDateString="true"==scope.setFromGrid?!0:(newVal+"").toLowerCase().indexOf("date")>-1?!0:!1,""==newVal||null==newVal||"function"==typeof newVal)newVal=Date.now(),scope.isDateBlank=!0,scope.isValueDateObj=!1;else if(scope.doesContainDateString){var dateStr=(newVal+"").replace(new RegExp("/","ig"),""),tmpModel=dateStr;dateStr.indexOf("Date")<=-1&&(tmpModel=tmpModel.split("+"),tmpModel=eval("new "+(tmpModel.length>1?'Date("'+newVal+'").getTime()':tmpModel[0]))),scope.updatingDateModel(tmpModel)}else"[object Date]"===Object.prototype.toString.call(newVal)?scope.isValueDateObj=!0:"[object String]"===Object.prototype.toString.call(newVal)&&newVal.indexOf("T")>0||(newVal=parseInt(newVal));scope.placeholder=scope.format,scope.isDateBlank?scope.dateModel="":scope.doesContainDateString||scope.updatingDateModel(newVal),smartTextFieldService.updateDateValue(scope,element),smartTextFieldService.createDatePicker(scope,element,ngModelCtrl)}scope.isActive=smartTextFieldService.checkIfActive(scope,element),scope.dateModifiedbyUser=!1,smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)});scope.clienterror&&smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),scope.$on("$destroy",function(){unbindAttributesWatcher(),unbindNgModel(),unbindDateModel(),angular.isDefined(unbindMin)&&unbindMin(),angular.isDefined(unbindMax)&&unbindMax(),angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher()})}function SmartTextField3_AutocompleteFunc(scope,element,attrs,ngModelCtrl,smartTextFieldService,$timeout,$translate,$window,persistenceService){function getMasterDataList(e,t){"string"==typeof t&&(t=JSON.parse(t),scope.masterData=t);try{if(persistenceService.masterPersistenceService.getAutoSuggestList(e,t).length>0)if((!$("#"+scope.textfieldId).devbridgeAutocomplete()||$("#"+scope.textfieldId).devbridgeAutocomplete()&&$("#"+scope.textfieldId).devbridgeAutocomplete().options.filterKeys!=filterOptions.filterKeys&&$("#"+scope.textfieldId).devbridgeAutocomplete().options.displayFormat!=filterOptions.displayFormat&&$("#"+scope.textfieldId).devbridgeAutocomplete().options.optionFormat!=filterOptions.optionFormat)&&($("#"+scope.textfieldId).devbridgeAutocomplete()&&($("#"+scope.textfieldId).devbridgeAutocomplete("dispose"),$("#"+scope.textfieldId).devbridgeAutocomplete()),filterOptions.lookup=persistenceService.masterPersistenceService.getAutoSuggestList(e,t),autoCompleteField=$("#"+scope.textfieldId).devbridgeAutocomplete(filterOptions).devbridgeAutocomplete()),$("#"+scope.textfieldId).devbridgeAutocomplete().setLookup(persistenceService.masterPersistenceService.getAutoSuggestList(e,t)),$("#"+scope.textfieldId).devbridgeAutocomplete().options.lookup!=[]&&0==$("#"+scope.textfieldId).val().length){var n=$(element).find("#"+scope.textfieldId);n.off("change",!1),n.off("blur",!1),scope.checkMasterFlag=!0}else{var n=$(element).find("#"+scope.textfieldId);n.on("change",function(e){}),n.on("blur",scope.ngBlur)}}catch(o){console.log(o)}}function bindOtherWatcher(){angular.isDefined(scope.disable)&&(0==scope.disable||"false"==scope.disable)||angular.isDefined(scope.readonly)&&(0==scope.readonly||"false"==scope.readonly)?angular.isDefined(unbindOtherWatcher)||(unbindOtherWatcher=scope.$watchGroup(["focus","isRemovable"],function(e,t){smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)})):angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher()}function hideAutoOnScroll(){void 0!=autoCompleteField&&autoCompleteField.visible&&autoCompleteField.hide()}"undefined"!=typeof scope.id&&"undefined"!=typeof scope.masterData&&(scope.masterData=JSON.parse(scope.masterData),scope.masterData.hasOwnProperty("parentId")?persistenceService.setDocumentFields(scope.masterData.parentId,scope.id):persistenceService.setDocumentFields(null,scope.id)),scope.placeholder=void 0==scope.placeholder||null==scope.placeholder?"":scope.placeholder,scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel,scope.textAlign=void 0==scope.align||null==scope.align?"left":scope.align,scope.suffixicon=void 0!=scope.suffixicon&&null!=scope.suffixicon||"date"!=scope.type?scope.suffixicon:"#icon_Calendar",scope.count=0;var noSuggestionNotice=angular.isDefined(scope.noSuggestionNotice)?scope.noSuggestionNotice:$translate.instant("noResultsErrMsg"),showNoSuggestion=angular.isDefined(scope.showNoSuggestion)&&"true"==scope.showNoSuggestion?!0:!1;showNoSuggestion=""==noSuggestionNotice?!1:showNoSuggestion;var number,rulesValidationEvent;scope.type=angular.isDefined(scope.type)?scope.type:"text",textfieldId++,scope.textfieldId="tf_"+textfieldId,scope.isRemovable=void 0==scope.$eval(scope.removable)?!0:scope.$eval(scope.removable),rulesValidationEvent=attrs.validateOn?attrs.validateOn:"blur",scope.onTextChange=function(e){console.log(scope.displayModel),scope.onChange({$event:{data:element.find("#"+scope.textfieldId),displayModel:scope.displayModel}})},scope.ngBlur=function(e){if(scope.ngModel&&scope.displayformat){var splittedDisplayFormat=[];splittedDisplayFormat=scope.displayformat.indexOf(":")>0?scope.displayformat.split(":"):scope.displayformat.indexOf("-")>0?scope.displayformat.split("-"):scope.displayformat.split("-");for(var result="",i=0;i<splittedDisplayFormat.length;i++)result+=eval("scope.ngModel."+splittedDisplayFormat[i].replace("{","").replace("}","")),i<splittedDisplayFormat.length-1&&(scope.displayformat.indexOf("-")>0?result+="-":scope.displayformat.indexOf(":")>0&&(result+=":"));"true"!==scope.retainDisplayModelAutocomplete&&(""==e.target.value.trim()||result!==scope.displayModel)&&(scope.displayModel="")}scope.focus=!1,smartTextFieldService.updateAutocompleteValue(scope,element),$timeout(function(){smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs)}),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element);try{angular.isDefined(scope.$parent.$parent.onStopEdit)&&scope.$parent.$parent.onStopEdit(scope,element)}catch(e){}scope.onBlur({$event:e})},scope.ngKeyPress=function(e){"keyPress"==rulesValidationEvent&&scope.validateRules(),scope.onKeyPress({$event:e}),13==e.charCode&&scope.onEnter({$event:e})},scope.elmVal=null,scope.ngKeyUp=function(e){},scope.search=function(e){scope.checkMasterFlag=!1,""!=e.target.value&&e.target.value!=scope.elmVal?(scope.elmVal=e.target.value,scope.onChange({$event:{data:element.find("#"+scope.textfieldId),displayModel:e.target.value}})):"undefined"!=typeof scope.id&&getMasterDataList(scope.id,scope.masterData)},scope.ngFocus=function(e){var t=element.find("#"+scope.textfieldId),n=t.devbridgeAutocomplete();""==t.val()&&n&&(scope.checkMasterFlag=!0,n.clear(),scope.elmVal=""),"undefined"!=typeof scope.id&&""==t.val()&&getMasterDataList(scope.id,scope.masterData),scope.onFocus({$event:e})},scope.prevModel=scope.ngModel;var updateView=function(){try{scope.ngModel!==scope.prevModel&&$timeout(function(){scope.prevModel=scope.ngModel}),smartTextFieldService.updateAutocompleteValue(scope,element)}catch(e){}},unbindModelWatcher=scope.$watch("ngModel",function(e){scope.displayModel=smartTextFieldService.getDisplayData(e,scope),scope.isActive=smartTextFieldService.checkIfActive(scope,element),scope.id&&persistenceService.masterPersistenceService.setSelectedValue(scope.id,scope.masterData,e),smartTextFieldService.updateAutocompleteValue(scope,element),smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)}),unbindOtherWatcher,unbindAttributesWatcher=scope.$watchGroup(["disable","readonly"],function(e,t){(e[0]!==t[0]||e[1]!==t[1])&&(smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element),bindOtherWatcher())});scope.hideShowField=function(){scope.isVisible=!scope.isVisible};var unbindValidationWatcher=scope.$watchGroup(["isMandatory","validate","clienterror","showinfo","showwarning"],function(e,t){(e[1]!=t[1]||e[2]!=t[2])&&smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),(e[3]!=t[3]||e[4]!=t[4])&&(scope.showinfo||scope.showwarning?element.find("> .input-field").addClass("field-has-icon"):element.find("> .input-field").removeClass("field-has-icon")),smartTextFieldService.setActiveClass(scope,element),smartTextFieldService.updateTextFieldClass(scope,element)}),filterKeys;filterKeys=angular.isDefined(scope.filterkeys)&&0==scope.filterkeys.trim().indexOf("[")?scope.filterkeys?scope.$eval(scope.filterkeys):["title"]:scope.filterkeys?scope.$eval("["+scope.filterkeys+"]"):["title"];var optionFormat=scope.optionformat?scope.optionformat:"{title}";scope.ndisplayFormat=scope.displayformat?scope.displayformat:"{title}";var autoCompleteField,unbindOptions=scope.$watch("options",function(e){
try{var t={};if("undefined"!=typeof scope.id){scope.id;t=scope.masterData}if(scope.checkMasterFlag){var n=_.filter(e,function(e){return e[t.filterKey]==scope.suggestedObject.filterKey});if(n.length>0){var o=n[0];angular.element(document).trigger("click"),scope.$evalAsync(function(){scope.displayModel=scope.suggestedObject.displayKey,scope.ngModel=o,updateView(),$timeout(function(){scope.onSelect({$event:{data:o}})})})}}else(!$("#"+scope.textfieldId).devbridgeAutocomplete()||$("#"+scope.textfieldId).devbridgeAutocomplete()&&$("#"+scope.textfieldId).devbridgeAutocomplete().options.filterKeys!=searchOptions.filterKeys&&$("#"+scope.textfieldId).devbridgeAutocomplete().options.displayFormat!=searchOptions.displayFormat)&&($("#"+scope.textfieldId).devbridgeAutocomplete()&&($("#"+scope.textfieldId).devbridgeAutocomplete("dispose"),$("#"+scope.textfieldId).devbridgeAutocomplete()),searchOptions.lookup=smartTextFieldService.getFormattedData(e,scope),autoCompleteField=$("#"+scope.textfieldId).devbridgeAutocomplete(searchOptions).devbridgeAutocomplete()),$("#"+scope.textfieldId).devbridgeAutocomplete().setLookup(smartTextFieldService.getFormattedData(e,scope))}catch(i){}});smartTextFieldService.buildTemplate(scope,element,scope.onTextChange,attrs),smartTextFieldService.assignAutocompleteEvents(scope,element),bindOtherWatcher(),scope.clienterror&&smartTextFieldService.validateRules(scope,ngModelCtrl,element,attrs),angular.element($window).scroll(function(e){hideAutoOnScroll()}),angular.element(".modal, .modal-content").scroll(function(e){hideAutoOnScroll()});var checkMasterFlag=!1,searchOptions={filterKeys:filterKeys,optionFormat:optionFormat,displayFormat:scope.ndisplayFormat,width:scope.width,showNoSuggestionNotice:showNoSuggestion,noSuggestionNotice:noSuggestionNotice,minChars:angular.isDefined(scope.minchars)?parseInt(scope.minchars):1,onSelect:function(e){angular.element(document).trigger("click"),scope.$evalAsync(function(){scope.suggestedObject=e,scope.displayModel=smartTextFieldService.getDisplayData(e,scope),scope.ngModel=e,updateView(),$timeout(function(){scope.id&&persistenceService.masterPersistenceService.saveMasterDataForRootField(scope.id,scope.masterData,scope.suggestedObject),scope.onSelect({$event:{data:e}})})})}},filterOptions={filterKeys:"[displayKey]",optionFormat:"{displayKey}",displayFormat:"{displayKey}",width:scope.width,showNoSuggestionNotice:showNoSuggestion,noSuggestionNotice:noSuggestionNotice,minChars:0,onSelect:function(e){angular.element(document).trigger("click"),scope.$evalAsync(function(){scope.suggestedObject=e,$timeout(function(){persistenceService.masterPersistenceService.saveMasterDataForRootField(scope.id,scope.masterData,scope.suggestedObject),scope.onChange({$event:{data:element.find("#"+scope.textfieldId),displayModel:element.find("#"+scope.textfieldId).val()}}),element.find("#"+scope.textfieldId).focus(),scope.checkMasterFlag=!0})})}};scope.$on("$destroy",function(){unbindModelWatcher(),unbindAttributesWatcher(),unbindOptions(),angular.isDefined(unbindOtherWatcher)&&unbindOtherWatcher(),unbindValidationWatcher()})}function smartTextField3_NumFunc(e,t,n,o,i,a,l,r){function s(){angular.isDefined(e.disable)&&(0==e.disable||"false"==e.disable)||angular.isDefined(e.readonly)&&(0==e.readonly||"false"==e.readonly)?angular.isDefined(p)||(p=e.$watchGroup(["isMandatory","focus","validate","isRemovable","clienterror","showinfo","showwarning"],function(a,l){(a[2]!=l[2]||a[4]!=l[4])&&(i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)),(a[5]!=l[5]||a[6]!=l[6])&&(e.showinfo||e.showwarning?t.find("> .input-field").addClass("field-has-icon"):t.find("> .input-field").removeClass("field-has-icon")),(a[1]||"true"==a[1])&&t.find("input").focus()})):angular.isDefined(p)&&p()}e.placeholder=void 0==e.placeholder||null==e.placeholder?"":e.placeholder,e.ngModel=void 0==e.ngModel||null==e.ngModel?"":e.ngModel,e.textAlign=void 0==e.align||null==e.align?"left":e.align,e.suffixicon=void 0!=e.suffixicon&&null!=e.suffixicon||"date"!=e.type?e.suffixicon:"#icon_Calendar",e.count=0;var c=angular.isDefined(e.noSuggestionNotice)?e.noSuggestionNotice:r.instant("noResultsErrMsg"),d=angular.isDefined(e.showNoSuggestion)&&"true"==e.showNoSuggestion?!0:!1;d=""==c?!1:d;var u;e.type=angular.isDefined(e.type)?e.type:"text",textfieldId++,e.textfieldId="tf_"+textfieldId,e.isRemovable=void 0==e.$eval(e.removable)?!0:e.$eval(e.removable),e.showTitle=void 0==e.isTitleVisible||null==e.isTitleVisible||"true"==e.isTitleVisible?!0:!1,u=n.validateOn?n.validateOn:"blur",e.onTextChange=function(a){var l=t.find("#"+e.textfieldId).autoNumeric("get");""!=l?e.ngModel=parseFloat(t.find("#"+e.textfieldId).autoNumeric("get")):e.ngModel=null,f(),i.setActiveClass(e,t),i.validateRules(e,o,t,n),i.updateTextFieldClass(e,t),e.onChange({$event:a})},e.ngBlur=function(a){var l=t.find("#"+e.textfieldId).autoNumeric("get");""!=l?e.ngModel=parseFloat(t.find("#"+e.textfieldId).autoNumeric("get")):e.ngModel=null,f(),e.focus=!1,i.validateRules(e,o,t,n),i.setActiveClass(e,t),i.updateTextFieldClass(e,t),e.onBlur({$event:a})},e.ngKeyPress=function(a){if("number"==e.type||n.datanumeric){var l=a.charCode||a.keyCode,r=a.currentTarget.value,s=[],c=String.fromCharCode(l),d=[37,38,39,40,46,8];isNaN(c)&&-1==d.indexOf(l)&&a.preventDefault(),-1!==r.toString().indexOf(".")&&46==l&&a.preventDefault(),r&&(s=r.toString().split(".")),n.decimalprecision&&(46==l&&0==parseInt(n.decimalprecision)&&a.preventDefault(),2==s.length&&s[1]&&s[1].length>=parseInt(n.decimalprecision,10)&&a.preventDefault()),(void 0!=e.min||null!=e.min)&&e.min>=0&&45==a.charCode&&a.preventDefault()}"keyPress"==u&&i.validateRules(e,o,t,n),e.onKeyPress({$event:a}),13==a.charCode&&e.onEnter({$event:a}),angular.isDefined(n.maxlength)&&a.target.value.length==n.maxlength&&0!==a.charCode&&a.preventDefault()},e.prevModel=e.ngModel;var p,f=function(){try{if(i.updateTextValue(e,t),null!=e.ngModel){var n=0,o=0;if("undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable)void 0==e.minmaxprecision||""==e.minmaxprecision?(n=0,o=0):(n=MinPrecessionValue,o=MaxPrecessionValue);else if(void 0!==e.minmaxprecision&&""!==e.minmaxprecision){var r=JSON.parse(e.minmaxprecision);2==r.length&&(n=r[0],o=r[1])}try{e.minmaxprecision&&(n=JSON.parse(e.minmaxprecision)[0],o=JSON.parse(e.minmaxprecision)[1])}catch(s){console.log(s)}var c;if(c=""===e.ngModel?e.ngModel:e.currencySymbol?e.currencySymbol+l("minPrecisionHandler")(e.ngModel,n,o,!1):l("minPrecisionHandler")(e.ngModel,n,o,!1),t.find("#"+e.textfieldId).val(c),!e.ngModel){var d=t.find("#"+e.textfieldId).autoNumeric("get");""!=d?(e.ngModel=parseFloat(t.find("#"+e.textfieldId).autoNumeric("get")),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)):e.ngModel=null}e.ngModel!==e.prevModel&&a(function(){e.prevModel=e.ngModel})}}catch(s){}},g=e.$watch("ngModel",function(n){e.isActive=i.checkIfActive(e,t),f(),i.setActiveClass(e,t),i.updateTextFieldClass(e,t)}),m=e.$watchGroup(["disable","readonly"],function(n,o){(n[0]!==o[0]||n[1]!==o[1])&&(i.setActiveClass(e,t),i.updateTextFieldClass(e,t),s())});if(e.hideShowField=function(){e.isVisible=!e.isVisible},i.buildTemplate(e,t,e.onTextChange),"undefined"!=typeof RegionalSettingEnable&&RegionalSettingEnable)void 0==e.minmaxprecision||""==e.minmaxprecision?t.find("#"+e.textfieldId).autoNumeric("init",{aSign:e.currencySymbol,mDec:0,aPad:!1,aSep:h,aDec:v,vMin:Number.NEGATIVE_INFINITY,vMax:Number.POSITIVE_INFINITY}):t.find("#"+e.textfieldId).autoNumeric();else{var h=",",v=".",y=0;if(void 0!==e.minmaxprecision&&""!==e.minmaxprecision){var b=JSON.parse(e.minmaxprecision);if(2==b.length){b[0];y=b[1]}}t.find("#"+e.textfieldId).autoNumeric("init",{aSign:e.currencySymbol,mDec:y,aPad:!1,aSep:h,aDec:v,vMin:Number.NEGATIVE_INFINITY,vMax:Number.POSITIVE_INFINITY})}s(),e.clienterror&&i.validateRules(e,o,t,n),e.$on("$destroy",function(){g(),m(),angular.isDefined(p)&&p()})}function smartTextFieldServiceFunc(ScrollTo,RuleEngine,$templateCache,$compile,$translate,$timeout){function debounce(e,t,n){var o;return function(){var i=this,a=arguments,l=function(){o=null,n||e.apply(i,a)},r=n&&!o;clearTimeout(o),o=setTimeout(l,t),r&&e.apply(i,a)}}var checkIfActive=function(e){return"undefined"!=typeof e.readonly&&"true"==e.readonly?!0:("number"!=e.type||"0"===e.ngModel||"undefined"==typeof e.placeholder||""!==e.placeholder||"undefined"!=typeof e.ngModel&&""!==e.ngModel&&!isNaN(e.ngModel)&&void 0!==e.ngModel&&null!==e.ngModel)&&("number"==e.type||"autocomplete"==e.type||"undefined"==typeof e.placeholder||""!==e.placeholder||"undefined"!=typeof e.ngModel&&""!==e.ngModel&&void 0!==e.ngModel&&null!==e.ngModel)&&("autocomplete"!=e.type||"undefined"==typeof e.placeholder||""!==e.placeholder||"undefined"!=typeof e.ngModel&&""!==e.displayModel&&void 0!==e.displayModel&&null!==e.displayModel)?!0:!1},setActiveClass=function(e,t,n){e.active=checkIfActive(e);var o=t.find("#"+e.textfieldId+"_label");"undefined"!=typeof e.active&&1==e.active||"undefined"!=typeof e.validate&&1==e.validate?o.hasClass("active")||o.addClass("active"):o.hasClass("active")&&o.removeClass("active")},updateTextFieldClass=function(e,t){var n=$(t).find("#"+e.textfieldId),o=$(t).find("#"+e.textfieldId+"_container"),i=$(t).find("#"+e.textfieldId+"_label");"undefined"!=typeof e.validate&&1==e.validate&&"undefined"!=typeof e.errorMessage&&e.errorMessage?n.hasClass("invalid")||(n.addClass("invalid"),i.attr("data-error",$translate.instant(e.errorMessage))):n.hasClass("invalid")&&(n.removeClass("invalid"),i.attr("data-error","")),"undefined"!=typeof e.textAlign&&"right"==e.textAlign?(n.hasClass("right-align")||n.addClass("right-align"),i.hasClass("right-align")||i.addClass("right-align")):(n.hasClass("right-align")&&n.removeClass("right-align"),i.hasClass("right-align")&&i.removeClass("right-align")),"undefined"!=typeof e.textAlign&&"left"==e.textAlign?(n.hasClass("left-align")||n.addClass("left-align"),i.hasClass("left-align")||i.addClass("left-align")):(n.hasClass("left-align")&&n.removeClass("left-align"),i.hasClass("left-align")&&i.removeClass("left-align")),"undefined"!=typeof e.readonly&&(1==e.readonly||"true"==e.readonly)||"undefined"!=typeof e.disable&&("true"===e.disable||e.disable===!0)?(n.prop("readonly",!0),n.attr("disabled","disabled"),n.attr("tabindex",-1),o.addClass("readOnlyField"),n.hasClass("invalid")&&(n.removeClass("invalid"),i.attr("data-error",""))):(n.prop("readonly",!1),n.attr("disabled",!1),n.removeAttr("tabindex"),o.removeClass("readOnlyField")),"undefiend"!=typeof e.autocomplete&&("true"==e.autocomplete||1==e.autocomplete),n.hasClass("ng-valid")||n.addClass("ng-pristine ng-valid ng-scope ng-touched"),"undefined"!=typeof e.placeholder&&""!=e.placeholder&&n.attr("placeholder",e.placeholder);var a=$(t).find("#"+e.textfieldId+"_opField");if("undefined"==typeof e.isMandatory||"false"!=e.isMandatory&&0!=e.isMandatory||1!=e.isRemovable&&"true"!=e.isRemovable)"undefiend"!=typeof a&&a.length>0&&a.remove();else{var l=$(t).find("#"+e.textfieldId+"_container");("undefiend"==typeof a||"undefiend"!=typeof a&&0==a.length)&&(l.append(buildOptionalFieldTemplate(e)),a=$(t).find("#"+e.textfieldId+"_opField"),"undefined"!=typeof a&&a.length>0&&a.bind("click",e.hideShowField)),l.hasClass("optionalField")||l.addClass("optionalField")}("text"===e.type||"number"===e.type||"area"===e.type)&&"undefined"!=typeof e.maxlength&&parseInt(e.maxlength)>-1&&n.attr("maxlength",parseInt(e.maxlength));var r="";t.length>0&&(r=t[0].className,r=r.replace("ng-hide",""),t.removeClass(r)),o.addClass(r)},buildOptionalFieldTemplate=function(e){if(!("undefined"==typeof e.isMandatory||"false"!=e.isMandatory&&e.isMandatory!==!1||1!=e.isRemovable&&"true"!=e.isRemovable)){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldOptionalFieldTemplate.html");return t=t.replace("{{id}}",e.textfieldId+"_opField")}return""},buildPrefixiconTemplate=function(e){if("undefined"!=typeof e.prefixicon&&e.prefixicon){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldprefixiconTemplate.html");return t=t.replace("{{id}}",e.textfieldId+"_prefixicon"),t=t.replace("{{prefixicon}}",e.prefixicon)}return""},buildSpinnerTemplate=function(e){if("autocomplete"==!e.type&&"undefined"!=typeof e.loading&&1==e.loading){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldSpinnerTemplate.html");return t=t.replace("{{id}}",e.textfieldId+"_spinner")}return""},buildTextFieldTemplate=function(e){var t="";return t="area"===e.type&&"true"===e.readonly?$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextareaReadonlyElementTemplate.html"):"area"===e.type?$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextareaElementTemplate.html"):$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldElementTemplate.html"),"password"===e.type&&(t=t.replace('type="text"','type="password"')),t=t.replace("{{id}}",e.textfieldId),t=t.replace("{{showHideReadMoreContent}}","showHideReadMoreContent"+e.textfieldId),t=t.replace("{{showLessContent}}",$translate.instant("showLess")),t=t.replace("{{showMoreContent}}",$translate.instant("showMoreContent"))},buildInfoIconTemplate=function(e){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldinfoiconTemplate.html");return t},buildLabelTemplate=function(e){var t="";return t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldLabelTemplate.html"),t=t.replace("{{id}}",e.textfieldId+"_label"),t=t.replace("{{textfieldId}}",e.textfieldId),t=t.replace("{{label}}","undefined"==typeof e.label?"":e.label),e.label||(t=t.replace('class=""','class="empty-label"')),t},buildTemplate=function(e,t,n,o){var i=$("<div/>",{id:e.textfieldId+"_container"}),a="";e.isMandatory!==!1&&"false"!==e.isMandatory||e.isRemovable!==!0||(a+=" optionalField"),(e.showinfo||e.showwarning)&&(a+=" field-has-icon"),("true"===e.readonly||"true"===e.disable)&&(a+=" readOnlyField");var l="";t.length>0&&(l=t[0].className,t.removeClass(l)),i.addClass(l+" input-field "+a),i.append('<div class="elements-include">'+buildOptionalFieldTemplate(e)+buildPrefixiconTemplate(e)+buildSpinnerTemplate(e)+buildTextFieldTemplate(e)+buildLabelTemplate(e)+"</div>"),i.append($compile(buildInfoIconTemplate(e))(e)),t.html(i);var r=$(t).find("#"+e.textfieldId);r.on("change",function(e){n(e)}),r.on("blur",e.ngBlur),void 0!=e.type&&"number"==e.type?(void 0!=e.min&&null!=e.min&&$.isNumeric(e.min)&&r.attr("min",e.min),void 0!=e.max&&null!=e.max&&$.isNumeric(e.max)&&r.attr("max",e.max),r.bind("keypress",e.ngKeyPress)):void 0!=e.type&&"autocomplete"==e.type?(r.on("focus",e.ngFocus),(o.onKeyPress||o.onEnter)&&r.bind("keypress",debounce(e.ngKeyPress,250))):void 0==e.type||"area"!=e.type&&"text"!=e.type||((o.onKeyPress||o.onEnter)&&r.bind("keypress",debounce(e.ngKeyPress,250)),o.onKeyDown&&r.bind("keydown",debounce(e.ngKeyDown,250)),o.onFocus&&r.bind("focus",e.ngFocus),r.bind("keyup",e.ngKeyUp));var s=$(t).find("#"+e.textfieldId+"_opField > i");"undefined"!=typeof s&&s.length>0&&s.bind("click",e.hideShowField),updateTextFieldClass(e,t),setActiveClass(e,t),angular.isDefined(e.charactercounter)&&"true"==e.charactercounter&&(r.attr("length",e.maxlength),r.characterCounter())},updateTextValue=function(e,t,n){var o=t.find("#"+e.textfieldId),i=t.find("#showHideReadMoreContent"+e.textfieldId),a=t.find(".readOnlyshowLess"),l=t.find(".readOnlyShowMore");i.hasClass("areareadOnlyContentPara2")||(modal.getModal(e,n).length<150?(a.hide(),l.hide()):modal.getModal(e,n).length>150&&(a.hide(),l.show())),i.hasClass("areareadOnlyContentPara2")||i.addClass("ellipsis areareadOnlyContentPara1"),"area"===e.type&&"true"===e.readonly?(o.text()!==modal.getModal(e,n)&&o.text(modal.getModal(e,n)),$(a).off("click").on("click",function(){$(this).hide(),$(l).show(),$(i).removeClass("areareadOnlyContentPara2"),$(i).addClass("ellipsis areareadOnlyContentPara1")}),$(l).off("click").on("click",function(){$(this).hide(),$(a).show(),$(i).removeClass("ellipsis areareadOnlyContentPara1"),$(i).addClass("areareadOnlyContentPara2")})):(o.val()===modal.getModal(e,n)||e.typing||o.val(modal.getModal(e,n)),e.showTitle&&o.attr("title",modal.getModal(e,n)),""===modal.getModal(e,n)?o.addClass("ng-empty").removeClass("ng-not-empty"):o.removeClass("ng-empty").addClass("ng-not-empty"),o.hasClass("materialize-textarea")||"true"!==e.readonly&&"true"!==e.disable?o.removeClass("truncate"):o.addClass("truncate"))},modal={getModal:function(e,t){return"function"==typeof e.ngModel?t.$modelValue:e.ngModel},setModal:function(e,t,n){"function"==typeof e.ngModel?(n.$setViewValue(t),n.$render()):e.ngModel=t}},updateDateValue=function(e,t){var n=t.find("#"+e.textfieldId);n.val(e.dateModel),n.attr("title",e.dateModel)},updateAutocompleteValue=function(e,t){var n=t.find("#"+e.textfieldId);n.val(e.displayModel),n.attr("title",e.displayModel)},checkRule=function(scope,element){for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,i=0;i<rules.length;i++)if("object"==typeof rules[i]){if(eval(rules[i].rule.replace(/this/g,"autocomplete"==scope.type?"scope.displayModel":"scope.ngModel"))){scope.validate=!0,scope.errorMessage=rules[i].error,scope.errorModel=rules[i].error;break}"date"===scope.type&&angular.element("#"+scope.textfieldId).removeClass("invalid")}else{if(isFoundInvalid)break;if("object"!=typeof scope.ngModel)var data=scope.ngModel;else var data=scope.displayModel;RuleEngine.isValid(rules[i],function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,scope.errorModel=rules[i].error,isFoundInvalid=!0},data)}},validateRules=function(e,t,n,o){if("undefined"!=typeof e.readonly&&"true"==e.readonly)return void(e.isActive=!0);if("text"!==e.type&&"area"!==e.type||!angular.isString(e.ngModel)||"true"==o.noTrim||modal.setModal(e,modal.getModal(e,t).trim(),t),"autocomplete"==e.type&&e.$eval(e.isMandatory)&&!e.clienterror&&("undefined"==typeof e.ngModel||""==e.displayModel||null==e.displayModel||void 0==e.displayModel||0===e.ngModel.id)||"autocomplete"!=e.type&&e.$eval(e.isMandatory)&&!e.clienterror&&(e.ngModel+""==""||null==e.ngModel||void 0==e.ngModel))return e.validate=!0,e.errorMessage=$translate.instant("enterValueErrMsg"),void(e.errorModel=$translate.instant("enterValueErrMsg"));if(e.clienterror)return e.validate=!0,e.errorMessage=$translate.instant("clientErrMsg"),void(e.errorModel=$translate.instant("clientErrMsg"));if("number"==e.type){if(!e.$eval(e.isMandatory)&&isNaN(e.ngModel))return void angular.element("#"+e.textfieldId).val("");if(!e.$eval(e.isMandatory)&&null===e.ngModel)return void(e.rules&&checkRule(e,n))}"date"!=e.type||e.rules||$("#"+e.textfieldId).removeClass("invalid"),e.validate=!1,e.errorMessage=null,e.errorModel=null,e.rules&&checkRule(e,n)},debounce=function(e,t,n){var o;return function(){var i=this,a=arguments,l=function(){o=null,n||e.apply(i,a)},r=n&&!o;clearTimeout(o),o=setTimeout(l,t),r&&e.apply(i,a)}},updateDateClass=function(e,t){var n=t.find("#"+e.textfieldId);"date"==e.type&&(n.hasClass("datepicker")||n.addClass("datepicker"))},assignDateEvents=function(e,t){var n=t.find("#"+e.textfieldId);n.bind("keydown",e.ngKeyDown),n.bind("keypress",e.ngKeyPress),n.bind("keyup",e.ngKeyUp)},assignAutocompleteEvents=function(e,t){var n=t.find("#"+e.textfieldId);n.bind("keyup",debounce(e.ngKeyUp,250)),n.on("input",debounce(e.search,250))},getFormattedData=function(data,scope){if(!data||0==data.length)return[];for(var i=0;i<data.length;i++){var str=scope.ndisplayFormat;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data[i].hasOwnProperty(childSplit[k]))&&(str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),eval("data[i]."+childSplit[k])))}catch(e){}data[i].value=str.trim()}return data},toUTC=function(e){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},getGridFormatToTimestamp=function(e,t){var n=(t+"").replace(new RegExp("/","ig"),"");return moment(n).format(e.dateFormat)},updateNgModel=function(e,t){e.dateModifiedbyUser=!0,1==e.timePicker?e.convertIntoUTC||20!=timeZoneOffset?e.ngModel=moment(1e3*t).add(-60*timeZoneOffset,"minute").format("YYYY-MM-DDTHH:mm:ss"):e.ngModel="/Date("+1e3*t+")/":20!=timeZoneOffset?e.ngModel=moment(1e3*t).format("YYYY-MM-DD")+"T12:00:00":e.ngModel="/Date("+(1e3*t+432e5)+")/"},createDatePicker=function(e,t,n){setTimeout(function(){function n(t){updateNgModel(e,t.unix()),$timeout(function(){e.isDateBlank=!1,angular.isFunction(e.onDateChange)&&e.onDateChange({$event:{date:e.ngModel}})})}var o=t.find("#"+e.textfieldId),i=!0,a=angular.isDefined(e.min)?e.doesContainDateString?getGridFormatToTimestamp(e.min):moment(parseInt(e.min)).format(e.dateFormat):"",l=angular.isDefined(e.max)?e.doesContainDateString?getGridFormatToTimestamp(e.max):moment(parseInt(e.max)).format(e.dateFormat):"",r=angular.isDefined(e.timePicker12Hour)?!1:!0,s=angular.isDefined(e.minuteIncrement)?e.$eval(e.minuteIncrement):1,c=o.daterangepicker({singleDatePicker:!0,showDropdowns:!0,timePicker:e.datetimePicker,timePicker24Hour:r,timePickerIncrement:s,autoApply:!1,opens:"right",drops:"down",minDate:a,maxDate:l,autoUpdateInput:!1,locale:{format:e.dateFormat,cancelLabel:$translate.instant("cancelBtn"),applyLabel:$translate.instant("applyBtn")}},function(e,t,o){i=!1,n(e)}).bind("show.daterangepicker",function(){var e=c.container.offset(),t=window.innerHeight,n=$(window).scrollTop();e.top+c.container.outerHeight()-n>t?(c.drops="up",c.move()):e.top<n&&(c.drops="down",c.move())}).data("daterangepicker");o.on("apply.daterangepicker",function(e,t){i&&n(t.startDate),i=!0,t.autoUpdateInput=!0,t.updateElement(),t.autoUpdateInput=!1}),e.isDateBlank&&(o.val(""),e.ngModel="")})},getDisplayData=function(data,scope){if(void 0==data||null==data||""==data)return"";var str=scope.ndisplayFormat,evalResult,evaluatedKeysCounter=0,nullKeysCounter=0;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data.hasOwnProperty(childSplit[k]))&&(evalResult=eval("data."+childSplit[k]),evaluatedKeysCounter++,(void 0==evalResult||null==evalResult||0==(evalResult+"").trim().length)&&(evalResult="",nullKeysCounter++),str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),evalResult));evaluatedKeysCounter==nullKeysCounter&&(str="")}catch(e){}return void 0===str||null===str||"undefined"===str||"null"===str?"":str},service={buildTemplate:buildTemplate,setActiveClass:setActiveClass,updateTextFieldClass:updateTextFieldClass,checkIfActive:checkIfActive,validateRules:validateRules,checkRule:checkRule,updateTextValue:updateTextValue,debounce:debounce,updateDateClass:updateDateClass,assignDateEvents:assignDateEvents,getFormattedData:getFormattedData,toUTC:toUTC,getGridFormatToTimestamp:getGridFormatToTimestamp,createDatePicker:createDatePicker,updateDateValue:updateDateValue,updateAutocompleteValue:updateAutocompleteValue,getDisplayData:getDisplayData,assignAutocompleteEvents:assignAutocompleteEvents,modal:modal};return service}function smartTextField3ServiceFunc(ScrollTo,RuleEngine,$templateCache,$compile,$translate,$timeout){function debounce(e,t,n){var o;return function(){var i=this,a=arguments,l=function(){o=null,n||e.apply(i,a)},r=n&&!o;clearTimeout(o),o=setTimeout(l,t),r&&e.apply(i,a)}}var _selectedDate,_previousDate,getSelectedDate=function(){return _selectedDate},setSelectedDate=function(e){_selectedDate=e},getPreviousDate=function(){return _previousDate},setPreviousDate=function(e){_previousDate=e},checkIfActive=function(e){return"undefined"!=typeof e.readonly&&"true"==e.readonly?!0:("number"!=e.type||"0"===e.ngModel||"undefined"==typeof e.placeholder||""!==e.placeholder||"undefined"!=typeof e.ngModel&&""!==e.ngModel&&!isNaN(e.ngModel)&&void 0!==e.ngModel&&null!==e.ngModel)&&("number"==e.type||"autocomplete"==e.type||"undefined"==typeof e.placeholder||""!==e.placeholder||"undefined"!=typeof e.ngModel&&""!==e.ngModel&&void 0!==e.ngModel&&null!==e.ngModel)&&("autocomplete"!=e.type||"undefined"==typeof e.placeholder||""!==e.placeholder||"undefined"!=typeof e.ngModel&&""!==e.displayModel&&void 0!==e.displayModel&&null!==e.displayModel)?!0:!1},setActiveClass=function(e,t,n){e.active=checkIfActive(e);var o=t.find("#"+e.textfieldId+"_label");"undefined"!=typeof e.active&&1==e.active||"undefined"!=typeof e.validate&&1==e.validate?o.hasClass("active")||o.addClass("active"):o.hasClass("active")&&o.removeClass("active")},updateTextFieldClass=function(e,t){var n=$(t).find("#"+e.textfieldId),o=$(t).find("#"+e.textfieldId+"_container"),i=$(t).find("#"+e.textfieldId+"_label");"undefined"!=typeof e.validate&&1==e.validate&&"undefined"!=typeof e.errorMessage&&e.errorMessage?n.hasClass("invalid")||(n.addClass("invalid"),i.attr("data-error",$translate.instant(e.errorMessage))):n.hasClass("invalid")&&(n.removeClass("invalid"),i.attr("data-error","")),"undefined"!=typeof e.textAlign&&"right"==e.textAlign?n.hasClass("right-align")||n.addClass("right-align"):n.hasClass("right-align")&&n.removeClass("right-align"),"undefined"!=typeof e.textAlign&&"left"==e.textAlign?n.hasClass("left-align")||n.addClass("left-align"):n.hasClass("left-align")&&n.removeClass("left-align"),"undefined"!=typeof e.readonly&&(1==e.readonly||"true"==e.readonly)||"undefined"!=typeof e.disable&&("true"===e.disable||e.disable===!0)?(n.prop("readonly",!0),n.attr("disabled","disabled"),n.attr("tabindex",-1),o.addClass("readOnlyField"),n.hasClass("invalid")&&(n.removeClass("invalid"),i.attr("data-error",""))):(n.prop("readonly",!1),n.attr("disabled",!1),n.removeAttr("tabindex"),o.removeClass("readOnlyField")),"undefiend"!=typeof e.autocomplete&&("true"==e.autocomplete||1==e.autocomplete),n.hasClass("ng-valid")||n.addClass("ng-pristine ng-valid ng-scope ng-touched"),"undefined"!=typeof e.placeholder&&""!=e.placeholder&&n.attr("placeholder",e.placeholder);var a=$(t).find("#"+e.textfieldId+"_opField");if("undefined"==typeof e.isMandatory||"false"!=e.isMandatory&&0!=e.isMandatory||1!=e.isRemovable&&"true"!=e.isRemovable)"undefiend"!=typeof a&&a.length>0&&a.remove();else{var l=$(t).find("#"+e.textfieldId+"_container");("undefiend"==typeof a||"undefiend"!=typeof a&&0==a.length)&&(l.append(buildOptionalFieldTemplate(e)),a=$(t).find("#"+e.textfieldId+"_opField"),"undefined"!=typeof a&&a.length>0&&a.bind("click",e.hideShowField)),l.hasClass("optionalField")||l.addClass("optionalField")}("text"===e.type||"number"===e.type||"area"===e.type)&&"undefined"!=typeof e.maxlength&&parseInt(e.maxlength)>-1&&n.attr("maxlength",parseInt(e.maxlength));var r="";t.length>0&&(r=t[0].className,r=r.replace("ng-hide",""),t.removeClass(r)),o.addClass(r)},buildOptionalFieldTemplate=function(e){if(!("undefined"==typeof e.isMandatory||"false"!=e.isMandatory&&e.isMandatory!==!1||1!=e.isRemovable&&"true"!=e.isRemovable)){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldOptionalFieldTemplate.html");return t=t.replace("{{id}}",e.textfieldId+"_opField")}return""},buildPrefixiconTemplate=function(e){if("undefined"!=typeof e.prefixicon&&e.prefixicon){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldprefixiconTemplate.html");return t=t.replace("{{id}}",e.textfieldId+"_prefixicon"),t=t.replace("{{prefixicon}}",e.prefixicon)}return""},buildSpinnerTemplate=function(e){if("autocomplete"==!e.type&&"undefined"!=typeof e.loading&&1==e.loading){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldSpinnerTemplate.html");return t=t.replace("{{id}}",e.textfieldId+"_spinner")}return""},buildTextFieldTemplate=function(e){var t="";return t="area"!==e.type||"true"!==e.readonly&&"true"!==e.disable?"area"===e.type?$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextareaElementTemplate.html"):$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldElementTemplate.html"):$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextareaReadonlyElementTemplate.html"),"password"===e.type&&(t=t.replace('type="text"','type="password"')),t=t.replace("{{id}}",e.textfieldId),t=t.replace("{{showHideReadMoreContent}}","showHideReadMoreContent"+e.textfieldId),t=t.replace("{{showLessContent}}",$translate.instant("showLess")),t=t.replace("{{showMoreContent}}",$translate.instant("showMoreContent"))},buildInfoIconTemplate=function(e){var t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldinfoiconTemplate.html");return t},buildLabelTemplate=function(e){var t="";return t=$templateCache.get("shared/directives/uiElements/smartTextfield/smartTextfieldLabelTemplate.html"),t=t.replace("{{id}}",e.textfieldId+"_label"),t=t.replace("{{textfieldId}}",e.textfieldId),t=t.replace("{{label}}","undefined"==typeof e.label?"":e.label),e.label||(t=t.replace('class=""','class="empty-label"')),t},buildTemplate=function(e,t,n,o){var i=$("<div/>",{id:e.textfieldId+"_container"}),a="";e.isMandatory!==!1&&"false"!==e.isMandatory||e.isRemovable!==!0||(a+=" optionalField"),(e.showinfo||e.showwarning)&&(a+=" field-has-icon"),("true"===e.readonly||"true"===e.disable)&&(a+=" readOnlyField");var l="";t.length>0&&(l=t[0].className,t.removeClass(l),l&&(e.className=l)),i.addClass(e.className+" input-field "+a),i.append('<div class="elements-include">'+buildOptionalFieldTemplate(e)+buildPrefixiconTemplate(e)+buildSpinnerTemplate(e)+buildTextFieldTemplate(e)+buildLabelTemplate(e)+"</div>"),i.append($compile(buildInfoIconTemplate(e))(e)),t.html(i);var r=$(t).find("#"+e.textfieldId);r.on("change",function(e){n(e)}),r.on("blur",e.ngBlur),void 0!=e.type&&"number"==e.type?(void 0!=e.min&&null!=e.min&&$.isNumeric(e.min)&&r.attr("min",e.min),void 0!=e.max&&null!=e.max&&$.isNumeric(e.max)&&r.attr("max",e.max),r.bind("keypress",e.ngKeyPress)):void 0!=e.type&&"autocomplete"==e.type?(r.on("focus",e.ngFocus),(o.onKeyPress||o.onEnter)&&r.bind("keypress",debounce(e.ngKeyPress,250))):void 0==e.type||"area"!=e.type&&"text"!=e.type||((o.onKeyPress||o.onEnter)&&r.bind("keypress",debounce(e.ngKeyPress,250)),o.onKeyDown&&r.bind("keydown",debounce(e.ngKeyDown,250)),o.onFocus&&r.bind("focus",e.ngFocus),r.bind("keyup",e.ngKeyUp));var s=$(t).find("#"+e.textfieldId+"_opField > i");"undefined"!=typeof s&&s.length>0&&s.bind("click",e.hideShowField),updateTextFieldClass(e,t),setActiveClass(e,t),angular.isDefined(e.charactercounter)&&"true"==e.charactercounter&&(r.attr("length",e.maxlength),r.characterCounter())},updateTextValue=function(e,t,n){var o=t.find("#"+e.textfieldId),i=t.find("#showHideReadMoreContent"+e.textfieldId),a=t.find(".readOnlyshowLess"),l=t.find(".readOnlyShowMore");if(a.hide(),l.hide(),i.hasClass("areareadOnlyContentPara2")||(modal.getModal(e,n)&&modal.getModal(e,n).length<150?(a.hide(),l.hide()):modal.getModal(e,n)&&modal.getModal(e,n).length>150&&(i.addClass("ellipsis areareadOnlyContentPara1"),a.hide(),l.show())),"area"!==e.type||"true"!==e.readonly&&"true"!==e.disable){if("function"==typeof e.ngModel)$timeout(function(){o=t.find("#"+e.textfieldId);var i=modal.getModal(e,n);o.val()!==i&&o.val(i),e.showTitle&&o.attr("title",i),""===i||"undefined"==typeof i?(o.addClass("ng-empty").removeClass("ng-not-empty"),o.attr("title","")):(angular.element("#"+e.textfieldId+"_label").addClass("active"),o.removeClass("ng-empty").addClass("ng-not-empty"))});else if("number"==e.type){var r=modal.getModal(e,n);"function"==typeof o.autoNumeric?(o.autoNumeric("get")!=r&&o.autoNumeric("set",r),e.showTitle&&o.attr("title",o.autoNumeric("get"))):(o.val()!==r&&o.val(r),e.showTitle&&o.attr("title",r)),null===r&&""===e.placeholder?o.addClass("ng-empty").removeClass("ng-not-empty"):o.removeClass("ng-empty").addClass("ng-not-empty")}else o.val()!==modal.getModal(e,n)&&(e.typing?smartTextFieldService.modal.setModal(e,o.val(),n):o.val(modal.getModal(e,n))),
e.showTitle&&o.attr("title",modal.getModal(e,n)),""===modal.getModal(e,n)?o.addClass("ng-empty").removeClass("ng-not-empty"):o.removeClass("ng-empty").addClass("ng-not-empty");o.hasClass("materialize-textarea")||"true"!==e.readonly&&"true"!==e.disable?o.removeClass("truncate"):o.addClass("truncate")}else o.text(modal.getModal(e,n)),$(a).off("click").on("click",function(){$(this).hide(),$(l).show(),$(i).removeClass("areareadOnlyContentPara2"),$(i).addClass("ellipsis areareadOnlyContentPara1")}),$(l).off("click").on("click",function(){$(this).hide(),$(a).show(),$(i).removeClass("ellipsis areareadOnlyContentPara1"),$(i).addClass("areareadOnlyContentPara2")});"area"===e.type&&$timeout(function(){angular.element("#"+e.textfieldId).trigger("autoresize")})},modal={getModal:function(e,t){return"function"==typeof e.ngModel?t.$modelValue:e.ngModel},setModal:function(e,t,n){"function"==typeof e.ngModel?(n.$setViewValue(t),n.$render()):e.ngModel=t}},updateDateValue=function(e,t){var n=t.find("#"+e.textfieldId);n.val(e.dateModel),n.attr("title",e.dateModel)},updateAutocompleteValue=function(e,t){var n=t.find("#"+e.textfieldId);n.val(e.displayModel),n.attr("title",e.displayModel)},checkRule=function(scope,element){for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,i=0;i<rules.length;i++)if("object"==typeof rules[i]){if(eval(rules[i].rule.replace(/this/g,"autocomplete"==scope.type?"scope.displayModel":"scope.ngModel"))){scope.validate=!0,scope.errorMessage=rules[i].error,scope.errorModel=rules[i].error;break}"date"===scope.type&&angular.element("#"+scope.textfieldId).removeClass("invalid")}else{if(isFoundInvalid)break;if("object"!=typeof scope.ngModel)var data=scope.ngModel;else var data=scope.displayModel;RuleEngine.isValid(rules[i],function(e){scope.validate=!0,scope.errorMessage=e.errorData.error,scope.errorModel=rules[i].error,isFoundInvalid=!0},data)}},validateRules=function(e,t,n,o){if("undefined"!=typeof e.readonly&&"true"==e.readonly)return void(e.isActive=!0);if(("text"===e.type||"area"===e.type)&&angular.isString(e.ngModel))if("true"==o.noTrim);else{var i=modal.getModal(e,t);i.trim().length<=0?modal.setModal(e,i.trim(),t):modal.setModal(e,i,t)}if("autocomplete"==e.type&&e.$eval(e.isMandatory)&&!e.clienterror&&("undefined"==typeof e.ngModel||""==e.displayModel||null==e.displayModel||void 0==e.displayModel||0===e.ngModel.id)||"autocomplete"!=e.type&&e.$eval(e.isMandatory)&&!e.clienterror&&(e.ngModel+""==""||null==e.ngModel||void 0==e.ngModel))return e.validate=!0,e.errorMessage=$translate.instant("enterValueErrMsg"),void(e.errorModel=$translate.instant("enterValueErrMsg"));if(e.clienterror)return e.validate=!0,e.errorMessage=$translate.instant("clientErrMsg"),void(e.errorModel=$translate.instant("clientErrMsg"));if("number"==e.type){if(!e.$eval(e.isMandatory)&&isNaN(e.ngModel))return void angular.element("#"+e.textfieldId).val("");if(!e.$eval(e.isMandatory)&&null===e.ngModel)return void(e.rules&&checkRule(e,n))}"date"!=e.type||e.rules||$("#"+e.textfieldId).removeClass("invalid"),e.validate=!1,e.errorMessage=null,e.errorModel=null,e.rules&&checkRule(e,n)},debounce=function(e,t,n){var o;return function(){var i=this,a=arguments,l=function(){o=null,n||e.apply(i,a)},r=n&&!o;clearTimeout(o),o=setTimeout(l,t),r&&e.apply(i,a)}},updateDateClass=function(e,t){var n=t.find("#"+e.textfieldId);"date"==e.type&&(n.hasClass("datepicker")||n.addClass("datepicker"))},assignDateEvents=function(e,t){var n=t.find("#"+e.textfieldId);n.bind("keydown",e.ngKeyDown),n.bind("keypress",e.ngKeyPress),n.bind("keyup",e.ngKeyUp)},assignAutocompleteEvents=function(e,t){var n=t.find("#"+e.textfieldId);n.bind("keyup",debounce(e.ngKeyUp,250)),n.on("input",debounce(e.search,250))},getFormattedData=function(data,scope){if(!data||0==data.length)return[];for(var i=0;i<data.length;i++){var str=scope.ndisplayFormat;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data[i].hasOwnProperty(childSplit[k]))&&(str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),eval("data[i]."+childSplit[k])))}catch(e){}data[i].value=str.trim()}return data},toUTC=function(e){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},getGridFormatToTimestamp=function(e,t){var n=(t+"").replace(new RegExp("/","ig"),"");return moment(n).format(e.dateFormat)},updateNgModel=function(e,t){e.dateModifiedbyUser=!0,1==e.timePicker?e.convertIntoUTC||20!=timeZoneOffset?e.ngModel=moment(1e3*t).add(-60*timeZoneOffset,"minute").format("YYYY-MM-DDTHH:mm:ss"):e.ngModel="/Date("+1e3*t+")/":20!=timeZoneOffset?e.ngModel=moment(1e3*t).format("YYYY-MM-DD")+"T12:00:00":e.ngModel="/Date("+(1e3*t+432e5)+")/"},createDatePicker=function(e,t,n){setTimeout(function(){function o(t){updateNgModel(e,t.unix()),n.$setViewValue(e.ngModel),e.$apply(),$timeout(function(){e.isDateBlank=!1,angular.isFunction(e.onDateChange)&&e.onDateChange({$event:{date:e.ngModel}})})}var i=t.find("#"+e.textfieldId),a=!0,l=angular.isDefined(e.min)?e.doesContainDateString?getGridFormatToTimestamp(e.min):moment(parseInt(e.min)).format(e.dateFormat):"",r=angular.isDefined(e.max)?e.doesContainDateString?getGridFormatToTimestamp(e.max):moment(parseInt(e.max)).format(e.dateFormat):"",s=angular.isDefined(e.timePicker12Hour)?!1:!0,c=angular.isDefined(e.minuteIncrement)?e.$eval(e.minuteIncrement):1,d=i.daterangepicker({singleDatePicker:!0,showDropdowns:!0,timePicker:e.datetimePicker,timePicker24Hour:s,timePickerIncrement:c,autoApply:!1,opens:"right",drops:"down",minDate:l,maxDate:r,autoUpdateInput:!1,locale:{format:e.dateFormat,cancelLabel:$translate.instant("cancelBtn"),applyLabel:$translate.instant("applyBtn")}},function(e,t,n){a=!1,o(e)}).bind("show.daterangepicker",function(){setPreviousDate(d.element.val());var e=d.container.offset(),t=window.innerHeight,n=$(window).scrollTop();e.top+d.container.outerHeight()-n>t?(d.drops="up",d.move()):e.top<n&&(d.drops="down",d.move())}).data("daterangepicker");i.on("apply.daterangepicker",function(e,t){a&&o(t.startDate),a=!0,t.autoUpdateInput=!0,t.updateElement(),t.autoUpdateInput=!1,setPreviousDate(t.element.val()),setSelectedDate("/Date("+(1e3*t.startDate.unix()+432e5)+")/")}),e.isDateBlank&&(i.val(""),e.ngModel="")})},getDisplayData=function(data,scope){if(void 0==data||null==data||""==data)return"";var str=scope.ndisplayFormat,evalResult,evaluatedKeysCounter=0,nullKeysCounter=0;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data.hasOwnProperty(childSplit[k]))&&(evalResult=eval("data."+childSplit[k]),evaluatedKeysCounter++,(void 0==evalResult||null==evalResult||0==(evalResult+"").trim().length)&&(evalResult="",nullKeysCounter++),str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),evalResult));evaluatedKeysCounter==nullKeysCounter&&(str="")}catch(e){}return void 0===str||null===str||"undefined"===str||"null"===str?"":str},service={buildTemplate:buildTemplate,setActiveClass:setActiveClass,updateTextFieldClass:updateTextFieldClass,checkIfActive:checkIfActive,validateRules:validateRules,checkRule:checkRule,updateTextValue:updateTextValue,debounce:debounce,updateDateClass:updateDateClass,assignDateEvents:assignDateEvents,getFormattedData:getFormattedData,toUTC:toUTC,getGridFormatToTimestamp:getGridFormatToTimestamp,createDatePicker:createDatePicker,updateDateValue:updateDateValue,updateAutocompleteValue:updateAutocompleteValue,getDisplayData:getDisplayData,assignAutocompleteEvents:assignAutocompleteEvents,modal:modal,setSelectedDate:setSelectedDate,getSelectedDate:getSelectedDate,setPreviousDate:setPreviousDate,getPreviousDate:getPreviousDate};return service}var textfieldId=19820116;$(function(){angular.element("body").off("click").on("click",".daterangepicker",function(e){e.stopPropagation()})}),angular.module("SMART2").directive("smartTextfield",["$rootScope","$timeout","$translate","ScrollTo","RuleEngine","smartTextFieldService","smartTextField3Service","$filter","$window","persistenceService","undefined"!=typeof isDirectiveV2enabled&&(isDirectiveV2enabled()===!0||"V3"===isDirectiveV2enabled())?smartTextField3Func:smartTextFieldFunc]),angular.module("SMART2").factory("smartTextFieldService",["ScrollTo","RuleEngine","$templateCache","$compile","$translate","$timeout",smartTextFieldServiceFunc]),angular.module("SMART2").factory("smartTextField3Service",["ScrollTo","RuleEngine","$templateCache","$compile","$translate","$timeout",smartTextField3ServiceFunc]),function(e){e.extend({debounce:function(e,t,n,o){3==arguments.length&&"boolean"!=typeof n&&(o=n,n=!1);var i;return function(){var a=arguments;o=o||this,n&&!i&&e.apply(o,a),clearTimeout(i),i=setTimeout(function(){!n&&e.apply(o,a),i=null},t)}},throttle:function(e,t,n){var o,i,a;return function(){i=arguments,a=!0,n=n||this,o||!function(){a?(e.apply(n,i),a=!1,o=setTimeout(arguments.callee,t)):o=null}()}}})}(jQuery),angular.module("SMART2").directive("smartCharacterCount",[function(){return{restrict:"A",link:function(e,t,n){parseInt(n.smartCharacterCount)>-1&&(t.attr("length",n.smartCharacterCount),t.characterCounter())}}}])}(),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports&&"function"==typeof require?require("jquery"):jQuery)}(function($){"use strict";function Autocomplete(el,options){var noop=function(){},that=this,defaults={ajaxSettings:{},autoSelectFirst:!1,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:Autocomplete.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:noop,onSearchComplete:noop,onSearchError:noop,preserveInput:!1,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(suggestion,originalQuery,queryLowerCase){try{for(var str="",i=0;i<that.filterKeys.length;i++)str=str+eval("suggestion."+that.filterKeys[i]).toLowerCase().trim()+" ";str=str.trim()}catch(e){}return str.indexOf(queryLowerCase)>-1},paramName:"query",transformResult:function(e){return"string"==typeof e?$.parseJSON(e):e},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1,multiselect:!1,showLookup:!1,addnew:!1,loading:!1};that.element=el,that.el=$(el),that.suggestions=[],that.badQueries=[],that.selectedIndex=-1,that.currentValue=that.element.value,that.intervalId=0,that.cachedResponse={},that.onChangeInterval=null,that.onChange=null,that.isLocal=!1,that.suggestionsContainer=null,that.noSuggestionsContainer=null,that.options=$.extend({},defaults,options),that.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},that.hint=null,that.hintValue="",that.selection=null,that.displayKey=options.displayKey?options.displayKey:"value",that.filterKeys=options.filterKeys?options.filterKeys:[that.displayKey],that.optionFormat=options.optionFormat?options.optionFormat:"{"+that.displayKey+"}",that.setLookup=function(e){that.options.lookup=e,$(that.element).is(":focus")&&that.onValueChange()},that.setLoading=function(e){that.options.loading=e,$(that.element).is(":focus")&&that.onValueChange()},that.initialize(),that.setOptions(options),$(that.element).is(":focus")&&(that.onValueChange(),that.suggest())}function isHTML(e){var t=document.createElement("div");t.innerHTML=e;for(var n=t.childNodes,o=n.length;o--;)if(1==n[o].nodeType)return!0;return!1}var getCompiledOption=function(str,option){try{for(var parentSplit=str.split("{"),i=0;i<parentSplit.length;i++)for(var childSplit=parentSplit[i].split("}"),j=0;j<childSplit.length;j++)(childSplit[j].indexOf(".")>0||option.hasOwnProperty(childSplit[j]))&&(str=str.replace(new RegExp("{"+childSplit[j]+"}","ig"),eval("option."+childSplit[j])))}catch(e){}return str},utils=function(){return{escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t.onclick="event.stopPropagation()",t.addEventListener("click",function(){event.stopPropagation()}),t}}}(),keys={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};Autocomplete.utils=utils,$.Autocomplete=Autocomplete,Autocomplete.formatResult=function(e,t,n){var o=e.optionFormat?e.optionFormat:n;if(o=getCompiledOption(o,e),isHTML(o))return o;var i=new RegExp(t,"gi");return o.replace(i,function(e){return"<strong>"+e+"</strong>"})},Autocomplete.prototype={killerFn:null,initialize:function(){var e,t=this,n="."+t.classes.suggestion,o=t.classes.selected,i=t.options;t.element.setAttribute("autocomplete","off"),t.killerFn=function(e){0===$(e.target).closest("."+t.options.containerClass).length&&(t.killSuggestions(),t.disableKillerFn())},t.noSuggestionsContainer=$('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),t.suggestionsContainer=Autocomplete.utils.createNode(i.containerClass),e=$(t.suggestionsContainer),e.appendTo(i.appendTo),"auto"!==i.width&&e.width(i.width),e.on("mouseover.autocomplete",n,function(){t.activate($(this).data("index"))}),e.on("mouseout.autocomplete",function(){t.selectedIndex=-1,e.children("."+o).removeClass(o)}),e.on("click.autocomplete",n,function(){t.select($(this).data("index"))}),t.fixPositionCapture=function(){t.visible&&t.fixPosition()},$(window).on("resize.autocomplete",t.fixPositionCapture),t.el.on("keydown.autocomplete",function(e){t.onKeyPress(e)}),t.el.on("keyup.autocomplete",function(e){t.onKeyUp(e)}),t.el.on("blur.autocomplete",function(){t.onBlur()}),t.el.on("focus.autocomplete",function(e){t.onFocus()}),t.el.on("change.autocomplete",function(e){t.onKeyUp(e)}),t.el.on("input.autocomplete",function(e){t.onKeyUp(e)}),t.el.on("click.autocomplete",function(e){e.stopPropagation()})},onFocus:function(){var e=this;e.fixPosition(),$(e.element).is(":focus")&&(e.onValueChange(),e.suggest())},onBlur:function(){if(!$(document.activeElement).hasClass("scroll-inner-wrapp")){var e=this;-1===e.selectedIndex&&e.hide(),this.enableKillerFn()}},abortAjax:function(){var e=this;e.currentRequest&&(e.currentRequest.abort(),e.currentRequest=null)},setOptions:function(e){var t=this,n=t.options;$.extend(n,e),t.isLocal=$.isArray(n.lookup),t.isLocal&&(n.lookup=t.verifySuggestionsFormat(n.lookup)),n.orientation=t.validateOrientation(n.orientation,"bottom"),$(t.suggestionsContainer).css({"max-height":n.maxHeight+"px",width:n.width+"px","z-index":n.zIndex})},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var e=this;e.disabled=!0,clearInterval(e.onChangeInterval),e.abortAjax()},enable:function(){this.disabled=!1},fixPosition:function(){var e=this,t=$(e.suggestionsContainer),n=t.parent().get(0);if(n===document.body||e.options.forceFixPosition){var o=e.options.orientation,i=t.outerHeight(),a=e.el.outerHeight(),l=e.el.offset(),r={top:l.top,left:l.left};if("auto"===o){var s=$(window).height(),c=$(window).scrollTop(),d=-c+l.top-i,u=c+s-(l.top+a+i);o=Math.max(d,u)===d?"top":"bottom"}if("top"===o?r.top+=-i:r.top+=a,n!==document.body){var p,f=t.css("opacity");e.visible||t.css("opacity",0).show(),p=t.offsetParent().offset(),r.top-=p.top,r.left-=p.left,e.visible||t.css("opacity",f).hide()}"auto"===e.options.width&&(r.width=e.el.outerWidth()-2+"px"),t.css(r)}},enableKillerFn:function(){var e=this;$(document).on("click.autocomplete",e.killerFn)},disableKillerFn:function(){var e=this;$(document).off("click.autocomplete",e.killerFn)},killSuggestions:function(){var e=this;e.stopKillSuggestions(),e.intervalId=window.setInterval(function(){e.visible&&(e.el.val(e.currentValue),e.hide()),e.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e,t=this,n=t.el.val().length,o=t.element.selectionStart;return"number"==typeof o?o===n:document.selection?(e=document.selection.createRange(),e.moveStart("character",-n),n===e.text.length):!0},onKeyPress:function(e){var t=this;if(!t.disabled&&!t.visible&&e.which===keys.DOWN&&t.currentValue)return void t.suggest();if(!t.disabled&&t.visible){switch(e.which){case keys.ESC:t.el.val(t.currentValue),t.hide();break;case keys.RIGHT:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case keys.TAB:if(t.hint&&t.options.onHint)return void t.selectHint();if(t.suggestions.length>0&&t.currentValue.length>=t.options.minChars&&-1===t.selectedIndex&&t.currentValue.length>0&&(t.selectedIndex=0),-1===t.selectedIndex)return void t.hide();if(t.select(t.selectedIndex),t.options.tabDisabled===!1)return;break;case keys.RETURN:if(-1===t.selectedIndex)return void t.hide();t.select(t.selectedIndex);break;case keys.UP:t.moveUp();break;case keys.DOWN:t.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case keys.UP:case keys.DOWN:return}clearInterval(t.onChangeInterval),t.currentValue!==t.el.val()&&(t.findBestHint(),t.options.deferRequestBy>0?t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var e=this,t=e.options,n=e.el.val(),o=e.getQuery(n);return e.selection&&e.currentValue!==o&&(e.selection=null,(t.onInvalidateSelection||$.noop).call(e.element)),clearInterval(e.onChangeInterval),e.currentValue=n,e.selectedIndex=-1,t.triggerSelectOnValidInput&&e.isExactMatch(o)?void e.select(0):void(o.length<t.minChars?e.options.showLookup||e.options.addnew||e.hide():e.getSuggestions(o))},isExactMatch:function(e){return!1},getQuery:function(e){var t,n=this.options.delimiter;return n?(t=e.split(n),$.trim(t[t.length-1])):e},getSuggestionsLocal:function(e){var t,n=this,o=n.options,i=e.toLowerCase(),a=o.lookupFilter,l=parseInt(o.lookupLimit,10);return t={suggestions:$.grep(o.lookup,function(t){return null==t.filterable&&void 0==t.filterable||t.filterable!==!1?a(t,e,i):!0})},l&&t.suggestions.length>l&&(t.suggestions=t.suggestions.slice(0,l)),t},getSuggestions:function(e){var t,n,o,i,a=this,l=a.options,r=l.serviceUrl;if(l.params[l.paramName]=e,n=l.ignoreParams?null:l.params,l.onSearchStart.call(a.element,l.params)!==!1){if($.isFunction(l.lookup))return void l.lookup(e,function(t){a.suggestions=t.suggestions,a.suggest(),l.onSearchComplete.call(a.element,e,t.suggestions)});a.isLocal?t=a.getSuggestionsLocal(e):($.isFunction(r)&&(r=r.call(a.element,e)),o=r+"?"+$.param(n||{}),t=a.cachedResponse[o]),t&&$.isArray(t.suggestions)?(a.suggestions=t.suggestions,a.suggest(),l.onSearchComplete.call(a.element,e,t.suggestions)):a.isBadQuery(e)?l.onSearchComplete.call(a.element,e,[]):(a.abortAjax(),i={url:r,data:n,type:l.type,dataType:l.dataType},$.extend(i,l.ajaxSettings),a.currentRequest=$.ajax(i).done(function(t){var n;a.currentRequest=null,n=l.transformResult(t,e),a.processResponse(n,e,o),l.onSearchComplete.call(a.element,e,n.suggestions)}).fail(function(t,n,o){l.onSearchError.call(a.element,e,t,n,o)}))}},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;for(var t=this.badQueries,n=t.length;n--;)if(0===e.indexOf(t[n]))return!0;return!1},hide:function(){var e=this,t=$(e.suggestionsContainer);$.isFunction(e.options.onHide)&&e.visible&&e.options.onHide.call(e.element,t),e.visible=!1,e.selectedIndex=-1,clearInterval(e.onChangeInterval),$(e.suggestionsContainer).hide(),e.signalHint(null)},suggest:function(){if(!this.options.showLookup&&!this.options.addnew&&0===this.suggestions.length)return void(this.options.showNoSuggestionNotice?this.noSuggestions():this.hide());var e,t=this,n=t.options,o=n.groupBy,i=n.formatResult,a=t.getQuery(t.currentValue),l=t.classes.suggestion,r=t.classes.selected,s=$(t.suggestionsContainer),c=$(t.noSuggestionsContainer),d=n.beforeRender,u="",p=function(t,n){var i=t.data[o];return e===i?"":(e=i,'<div class="autocomplete-group"><strong>'+e+"</strong></div>")};if(n.triggerSelectOnValidInput&&t.isExactMatch(a))return void t.select(0);var f,g,m=t.options.loading&&t.options.minChars<=t.currentValue.length?'<div class="autocomplete-suggestion center">                    <div class="preloader-wrapper x-small field-suffix-loader active">                        <div class="spinner-layer spinner-blue-only">                            <div class="circle-clipper circle-clipper--x left">                                <div class="circle"></div>                            </div>                            <div class="gap-patch">                                <div class="circle"></div>                            </div>                            <div class="circle-clipper circle-clipper--x right">                                <div class="circle"></div>                            </div>                        </div>                    </div>                </div>':"",h=0,v=1==t.options.addnew||1==t.options.showLookup?t.options.maxHeight-40:t.options.maxHeight-2;u+="<div class='scroll-inner-wrapp' style='max-height:"+v+"px;'>",t.options.loading?u+=m:$.each(t.suggestions,function(e,n){o&&(u+=p(n,a,e)),f=i(n,a,t.optionFormat);try{g=escape(f),g=unescape(g.replace(/%28/g,"openingroundbracket").replace(/%29/g,"closingroundbracket")),g=g.replace(/<("[^"]*"|'[^']*'|[^'">])*>/g,"")}catch(r){}g=g.replace(/openingroundbracket/g,"(").replace(/closingroundbracket/g,")"),u+='<div class="'+l+'" data-index="'+e+'" title="'+unescape(g)+'">'+f+"</div>",h=e+1}),u+="</div>";var y=t.suggestions.length<1&&t.options.showNoSuggestionNotice&&t.options.minChars<=t.currentValue.length?$("<i></i>").append(t.noSuggestionsContainer).html():"";1==t.options.addnew&&1==t.options.showLookup?(u+=t.options.loading?"":y,u+='<div class="typeaHeade-add-new blue-text autocomplete-suggestion-half '+l+'" data-index="'+h+'" title="'+t.options.addNewKey+'"><i class="icon icon-fix-overlay iconSmall" smart-tooltip position="bottom" delay="50" message="'+t.options.addNewKey+'"><svg><use xlink:href="#icon_CirclePlus"></use></svg></i></div>',u+='<div class="typeaHeade-open-lookup autocomplete-suggestion-half '+l+'" data-index="'+ ++h+'"><a href="javascript:void(0)" class="waves-effect waves-light">'+t.options.showLookupKey+"</a></div>"):(1==t.options.addnew&&(u+=t.options.loading?"":y,u+='<div class="typeaHeade-add-new width-adj-to blue-text '+l+'" data-index="'+h+'" title="'+t.options.addNewKey+'"><i class="icon icon-fix-overlay iconSmall" smart-tooltip position="bottom" delay="50" message="'+t.options.addNewKey+'"><svg><use xlink:href="#icon_CirclePlus"></use></svg></i></div>'),1==t.options.showLookup&&(u+=t.options.loading?"":y,u+='<div class="typeaHeade-open-lookup width-adj-to '+l+'" data-index="'+ ++h+'"><a href="javascript:void(0)" class="waves-effect waves-light">'+t.options.showLookupKey+"</a></div>")),this.adjustContainerWidth(),c.detach(),s.html(u),$.isFunction(d)&&d.call(t.element,s),t.fixPosition(),s.show(),n.autoSelectFirst&&(t.selectedIndex=0,s.scrollTop(0),s.children("."+l).first().addClass(r)),t.visible=!0,t.findBestHint()},noSuggestions:function(){var e=this,t=$(e.suggestionsContainer),n=$(e.noSuggestionsContainer);this.adjustContainerWidth(),n.detach(),t.empty(),t.append(n),e.fixPosition(),t.show(),e.visible=!0},adjustContainerWidth:function(){var e,t=this,n=t.options,o=$(t.suggestionsContainer);"auto"===n.width&&(e=t.el.outerWidth()-2,o.width(e>0?e:300))},findBestHint:function(){var e=this,t=e.el.val().toLowerCase(),n=null;t&&($.each(e.suggestions,function(o,i){var a=i.optionFormat?i.optionFormat:e.optionFormat;a=getCompiledOption(a,i);var l=0===a.toLowerCase().indexOf(t);return l&&(n=i),!l}),e.signalHint(n))},signalHint:function(e){var t="",n=this;if(e){var o=e.optionFormat?e.optionFormat:n.optionFormat;o=getCompiledOption(o,e),t=n.currentValue+o.substr(n.currentValue.length)}n.hintValue!==t&&(n.hintValue=t,n.hint=e,(this.options.onHint||$.noop)(t))},verifySuggestionsFormat:function(e){return e.length&&"string"==typeof e[0]?$.map(e,function(e){return{value:e,data:null}}):e},validateOrientation:function(e,t){return e=$.trim(e||"").toLowerCase(),-1===$.inArray(e,["auto","bottom","top"])&&(e=t),e},processResponse:function(e,t,n){var o=this,i=o.options;e.suggestions=o.verifySuggestionsFormat(e.suggestions),i.noCache||(o.cachedResponse[n]=e,i.preventBadQueries&&0===e.suggestions.length&&o.badQueries.push(t)),t===o.getQuery(o.currentValue)&&(o.suggestions=e.suggestions,o.suggest())},activate:function(e){var t,n=this,o=n.classes.selected,i=$(n.suggestionsContainer),a=i.find("."+n.classes.suggestion);return i.find("."+o).removeClass(o),n.selectedIndex=e,-1!==n.selectedIndex&&a.length>n.selectedIndex?(t=a.get(n.selectedIndex),$(t).addClass(o),t):null},selectHint:function(){var e=this,t=$.inArray(e.hint,e.suggestions);e.select(t)},select:function(e){var t=this;t.options.multiselect||t.hide(),t.onSelect(e)},moveUp:function(){var e=this;if(-1!==e.selectedIndex)return 0===e.selectedIndex?($(e.suggestionsContainer).children().first().removeClass(e.classes.selected),e.selectedIndex=-1,e.el.val(e.currentValue),void e.findBestHint()):void e.adjustScroll(e.selectedIndex-1)},moveDown:function(){var e=this;e.selectedIndex!==e.suggestions.length-1&&e.adjustScroll(e.selectedIndex+1)},adjustScroll:function(e){var t=this,n=t.activate(e);if(n){var o,i,a,l=$(n).outerHeight();o=n.offsetTop,i=$(t.suggestionsContainer).children(".scroll-inner-wrapp").scrollTop(),a=i+t.options.maxHeight-l,i>o?$(t.suggestionsContainer).children(".scroll-inner-wrapp").scrollTop(o):o>a&&$(t.suggestionsContainer).children(".scroll-inner-wrapp").scrollTop(o-t.options.maxHeight+l),t.options.preserveInput||t.el.val(t.getValue(t.suggestions[e].value)),t.signalHint(null)}},onSelect:function(e){var t=this,n=t.suggestions.length;if(e>n&&1==t.options.showLookup&&(t.hide(),$.isFunction(t.options.onClickShowLookup)))return void t.options.onClickShowLookup.call(t.element,"ShowLookup");if(e==n&&1==t.options.addnew&&(t.hide(),$.isFunction(t.options.onClickAddNew)))return void t.options.onClickAddNew.call(t.element,"AddNEW");var o=t.options.onSelect,i=t.suggestions[e];t.currentValue=i.value?t.getValue(i.value):t.getValue(i[t.options.displayFormat.slice(1,t.options.displayFormat.length-1)]),t.currentValue===t.el.val()||t.options.preserveInput||t.el.val(t.currentValue),t.signalHint(null),t.suggestions=[],t.selection=i,$.isFunction(o)&&o.call(t.element,i)},getValue:function(e){var t,n,o=this,i=o.options.delimiter;return i?(t=o.currentValue,n=t.split(i),1===n.length?e:t.substr(0,t.length-n[n.length-1].length)+e):e},dispose:function(){var e=this;e.el.off(".autocomplete").removeData("autocomplete"),e.disableKillerFn(),$(window).off("resize.autocomplete",e.fixPositionCapture),$(e.suggestionsContainer).remove()}},$.fn.autocomplete=$.fn.devbridgeAutocomplete=function(e,t){var n="autocomplete";return 0===arguments.length?this.first().data(n):this.each(function(){var o=$(this),i=o.data(n);"string"==typeof e?i&&"function"==typeof i[e]&&i[e](t):(i&&i.dispose&&i.dispose(),i=new Autocomplete(this,e),o.data(n,i))})},$(document).on("click",function(e){$(".autocomplete-suggestions").is(":visible")&&$(".autocomplete-suggestions").hide()})}),function(){"use strict";var e=0;angular.module("SMART2").directive("smartTimeline",["$rootScope","$timeout","$translate","ScrollTo","lookup","APPCONSTANTS",function(t,n,o,i,a,l){return{restrict:"E",replace:!0,scope:{label:"@",ngModel:"=?",readonly:"@",dateFormat:"@",selectable:"@",showCurrentTime:"@",zoomMin:"@",zoomMax:"@",marginSpace:"@",onSelect:"&",onLoad:"&",groupOrder:"&"},link:function(t,i,a){function r(e,t){e=parseInt(e),t=parseInt(t);var n=new Date,o=n.getTime();return o>e&&t>o?0:o>t?-1:e>o?1:void 0}function s(e){return e.replace(/d/g,"D").replace(/y/g,"Y").replace(/E/g,"d")}var c=l.userPreferences.UserBasicDetails.Culture,d=null==t.readonly||"undefined"==t.readonly?!1:"true"==t.readonly?!0:!1,u=null==t.selectable||"undefined"==t.selectable?!0:"true"==t.selectable?!0:!1,p=angular.isDefined(t.showCurrentTime)?"true"==t.showCurrentTime?!0:!1:!0;t.ngModel=t.ngModel?t.ngModel:null;var f=864e5,g=80352e5,m=angular.isDefined(t.zoomMin)&&""!=t.zoomMin?parseInt(t.zoomMin):f,h=angular.isDefined(t.zoomMax)&&""!=t.zoomMax?parseInt(t.zoomMax):g,v=null==t.marginSpace||"undefined"==t.marginSpace?20:parseInt(t.marginSpace,10),y=null,b=function(e,n){return angular.isDefined(a.groupOrder)?t.groupOrder({$a:e,$b:n}):angular.isDefined(t.ngModel[e.id])&&angular.isDefined(t.ngModel[n.id])?t.ngModel[e.id].lines[0].start-t.ngModel[n.id].lines[0].start:void 0};t.timelineID="TimeLineId-"+e,e++,t.$watch("ngModel",function(e){function i(){moment.locale(c),f=[],g=[];for(var e=0,n=0;n<t.ngModel.length;n++){f.push({id:n,content:t.ngModel[n].title,className:"undefined"==typeof t.ngModel[n].className?"":t.ngModel[n].className,style:"undefined"==typeof t.ngModel[n].style?"":t.ngModel[n].style});for(var i=0;i<t.ngModel[n].lines.length;i++){var a={id:e,group:n};C[e]=i;var s=!1,d=!1,u="vis-timeline-cstyle-"+n%10;if(null!=t.ngModel[n].lines[i].start&&""!=t.ngModel[n].lines[i].start&&"undefined"!=typeof t.ngModel[n].lines[i].start&&(a.start=new Date(1*t.ngModel[n].lines[i].start),a.startFormated=moment.unix(t.ngModel[n].lines[i].start/1e3).format(l),s=!0),null!=t.ngModel[n].lines[i].end&&""!=t.ngModel[n].lines[i].end&&"undefined"!=typeof t.ngModel[n].lines[i].end&&(a.end=new Date(1*t.ngModel[n].lines[i].end),a.endFormated=moment.unix(t.ngModel[n].lines[i].end/1e3).format(l),d=!0),s&&d){var p=r(a.start.getTime(),a.end.getTime());-1==p&&(u+=" line-ended"),1==p&&(u+=" line-not-started")}var m="undefined"==typeof t.ngModel[n].lines[i].className?"":t.ngModel[n].lines[i].className;u=u+" "+m,a.className=u;var h="undefined"==typeof t.ngModel[n].lines[i].style?"":t.ngModel[n].lines[i].style;a.style=h,"undefined"==typeof t.ngModel[n].lines[i].content?a.content="<div class='padding5' smart-tooltip title='"+a.startFormated+" - "+a.endFormated+"' position='top' delay='500' message= "+o.instant("tooltipMsg")+"></div>":a.content=t.ngModel[n].lines[i].content,g.push(a),e++}}}t.ngModel=e,t.getCultureCode=function(e){switch(e){case"en-US":return"MM/dd/yyyy hh:mm a";case"zh-CN":return"yyyy-MM-dd hh:mm a";case"zh-CHT":return"yyyy-MM-dd hh:mm a";case"da-DK":return"dd/MM/yyyy hh:mm a";case"de-DE":return"dd/MM/yyyy hh:mm a";case"en-AU":return"dd/MM/yyyy hh:mm a";case"es-ES":return"dd/MM/yyyy hh:mm a";case"fr-FR":return"yyyy/MM/dd hh:mm a";case"it-IT":return"yyyy/MM/dd hh:mm a";case"ja-JP":return"dd/MM/yyyy hh:mm a";case"ko-KR":return"dd/MM/yyyy hh:mm a";case"nl-NL":return"dd/MM/yyyy hh:mm a";case"pl-PL":return"dd/MM/yyyy hh:mm a";case"pt-PT":return"dd/MM/yyyy hh:mm a";case"ru-RU":return"dd/MM/yyyy hh:mm a";case"sv-SE ":return"dd/MM/yyyy hh:mm a";case"th-TH ":return"dd/MM/yyyy hh:mm a";default:return"dd/MM/yyyy hh:mm a"}};var l=t.getCultureCode(c)?t.getCultureCode(c):"dd/MM/yyyy hh:mm a";l=s(l);var f=[],g=[],C=[];i(),n(function(){var e=new vis.DataSet(f),i=new vis.DataSet(g),l=document.getElementById(t.timelineID);null==y&&(y=new vis.Timeline(l),l.addEventListener("touchmove",function(e){e.preventDefault()})),y.setGroups(e),y.setItems(i);var r={editable:d,groupOrder:b,selectable:u,showCurrentTime:p,zoomMin:m,zoomMax:h,margin:{item:v},locales:{},locale:c,format:{minorLabels:{millisecond:"SSS",second:"s",minute:"hh:mm a",hour:"hh:mm a",weekday:"ddd D",day:"D",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"hh:mm:ss a",second:"D MMMM hh:mm a",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",month:"YYYY",year:""}}};r.locales[c]={current:o.instant("labelCurrent"),time:o.instant("labelTime")},y.setOptions(r),"true"===a.fittobound&&y.fit(r),n(function(){angular.isFunction(t.onLoad)&&t.onLoad()},2e3),$(y.currentTime.bar).append('<span class="timelineLabelToday">'+o.instant("timelineLabelToday")+"</span>"),
y.on("select",function(e){var n=y.getEventProperties(e.event),o=null!=n.group?t.ngModel[n.group]:null,i=null!=n.item?t.ngModel[n.group].lines[C[n.item]]:null,a={item:i,group:o,properties:n};angular.isFunction(t.onSelect)&&t.onSelect({$res:a})})})},!0)},templateUrl:"shared/directives/uiElements/smartTimeline/smartTimelineTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartTooltip",[function(){return{restrict:"A",replace:!0,scope:{customStyle:"="},link:function(e,t,n){var o=n.$observe("message",function(e){t.attr("data-tooltip",e)});if(t.attr("data-position",n.position?n.position:"left"),t.attr("data-delay",n.delay?n.delay:"50"),t.attr("data-tooltip",n.message?n.message:""),t.addClass("tooltipped"),"undefined"!=typeof e.customStyle)var i={customStyle:e.customStyle};t.tooltip(i),t.on("click",function(){t.trigger("mouseleave")}),e.$on("$destroy",function(){t.tooltip("remove"),o()})}}}])}(),function(){"use strict";var typeaheadId=0;angular.module("SMART2").directive("smartTypeahead",["$rootScope","$timeout","$translate","ScrollTo","lookup","RuleEngine","$window",function($rootScope,$timeout,$translate,ScrollTo,lookup,RuleEngine,$window){return{restrict:"E",replace:!0,require:"ngModel",scope:{label:"@",ngModel:"=?",options:"=?",isMandatory:"@",isVisible:"=?",rules:"@",validate:"=?",focus:"=?",parentElement:"@",onChange:"&",onFocus:"&",onBlur:"&",onKeyUp:"&",onKeyDown:"&",onKeyPress:"&",onEnter:"&",onSelect:"&",callbackOnIconClick:"&",callAddNew:"&",lookupOpen:"&",lookupHide:"&",onScrollEnd:"&",onScrollTop:"&",onScrollInProgress:"&",searchtextKeyUp:"&",errorMessage:"@",align:"@",format:"@",readonly:"@",disable:"@",prefixicon:"@",maxlength:"@",charactercounter:"@",decimalprecision:"@",minmaxprecision:"@",placeholder:"@",autocomplete:"@",removable:"@",datakey:"@",filterkeys:"@",optionformat:"@",displayformat:"@",desckey:"@",multiselect:"@",showLookup:"@",infoIcon:"@",infoIconTooltip:"@",addnew:"@",titleofmodel:"@",selecttypeoption:"=?",showInfoIcon:"=?",isSupplier:"=?",defaultselectoption:"@",defaultselectiontext:"=?",width:"@",height:"@",isDefaultMandatory:"@",minCharForTrigger:"@",noSuggestionNotice:"@",showNoSuggestion:"@",errorModel:"=?",loading:"=?",minMultiselect:"@",showinfo:"@",showwarning:"@",clienterror:"=?",isLazyLoadingEnabled:"@"},link:function(scope,element,attrs,ngModel){function checkIfActive(){return""!==scope.placeholder||""!==scope.displayModel&&void 0!==scope.displayModel&&null!==scope.displayModel?!0:!1}function setModel(e,t){if(e=e?e:multiselect?[]:{},"function"==typeof scope.ngModel){if(multiselect&&"autocomplete"==t){var n=e;e=ngModel.$modelValue,e.push(n)}ngModel.$setViewValue(e),ngModel.$render(),"autocomplete"!=t&&setValues(e)}else multiselect&&"autocomplete"==t?scope.ngModel.push(e):multiselect===!0?"string"==typeof scope.ngModel?scope.ngModel=e:(scope.ngModel==e&&(e=angular.copy(e)),scope.ngModel.length=0,[].push.apply(scope.ngModel,e)):scope.ngModel=e,setValues(scope.ngModel)}function getModel(){var e;return e="function"==typeof scope.ngModel?ngModel.$modelValue:scope.ngModel}function DuplicateData(e,t){var n="";if(e||188==t.keyCode||"keyup"==t.type){for(var o=e.split(","),i=o.length,a=0;i>a;a++)o[a]=o[a].replace(/^\s*/,"").replace(/\s*$/,"");angular.forEach(o,function(e){var t=copyArray.indexOf(e.toLowerCase());if(selectedArrIndex=newOptionsSelected.map(function(e){return e.value.toLowerCase()}).indexOf(e.toLowerCase()),-1!=selectedArrIndex&&-1==newArr.indexOf(e)){selectedArr.push(selectedArrIndex);var n=newOptionsSelected.splice(selectedArrIndex,1)[0];newArr.push(n),n._$index=t}}),t&&(8==t.keyCode||46==t.keyCode||3==e.length)&&angular.forEach(o,function(e,t,o){var i=newArr.map(function(e){return e.value}).indexOf(e);if(-1==i){n=newArr.length;for(var a=0;n>a;a++){var l=newArr[a];-1==newOptionsSelected.indexOf(l)&&-1==o.indexOf(l.value)&&(newOptionsSelected.splice(l._$index,0,l),newArr.splice(a,1))}}})}else{n=newArr.length;for(var a=0;n>a;a++)-1==newOptionsSelected.indexOf(newArr[a])&&(newOptionsSelected.splice(newArr[a]._$index,0,newArr[a]),newArr.splice(a,1))}}function getFormattedData(data){var dataLength=data.length;if(!data||0==dataLength)return[];for(var i=0;dataLength>i;i++){var str=displayFormat;try{for(var parentSplit=str.split("{"),parentSplitLen=parentSplit.length,j=0;parentSplitLen>j;j++)for(var childSplit=parentSplit[j].split("}"),childSplitLen=childSplit.length,k=0;childSplitLen>k;k++){var childObj=childSplit[k];(childObj.indexOf(".")>0||data[i].hasOwnProperty(childObj))&&(str=str.replace(new RegExp("{"+childObj+"}","ig"),eval("data[i]."+childObj)))}}catch(e){}data[i].value=str.trim()}return data}function getOpFormate(){for(var e="",t=filterKeys.length,n=0;t>n;n++)e=e+"{"+filterKeys[n]+"} ";return""==e?"{title}":(e.trim(),e)}function getDispFormate(){for(var e="<span>",t=filterKeys.length,n=0;t>n;n++)e=e+"{"+filterKeys[n]+"} ";return"<span>"==e?"{title}":(e.trim(),e+="</span>")}function getDisplayData(data){if(void 0==data||null==data||""==data)return"";var str=displayFormat,evalResult,evaluatedKeysCounter=0,nullKeysCounter=0;try{for(var parentSplit=str.split("{"),parentSplitLen=parentSplit.length,j=0;parentSplitLen>j;j++)for(var childSplit=parentSplit[j].split("}"),childSplitLen=childSplit.length,k=0;childSplitLen>k;k++){var tChild=childSplit[k];(tChild.indexOf(".")>0||data.hasOwnProperty(tChild))&&(evalResult=eval("data."+tChild),evaluatedKeysCounter++,(void 0==evalResult||null==evalResult||0==(evalResult+"").trim().length)&&(evalResult="",nullKeysCounter++),str=str.replace(new RegExp("{"+tChild+"}","ig"),evalResult))}evaluatedKeysCounter==nullKeysCounter&&(str="")}catch(e){}return void 0===str||null===str||"undefined"===str||"null"===str?"":str}function getFormatedArray(e){var t=e.trim();try{for(var n=t.split("{"),o=[],i=n.length,a=0;i>a;a++){var l=n[a].split("}");0!=a&&o.push(l[0].trim())}}catch(r){}return void 0===o||null===o||"undefined"===o||"null"===o?"":o}function alignLookUp(e){var t=$(this),n=$("html").scrollTop()||$("body").scrollTop(),o=t.offset(),i=t.outerHeight(),a=$(autoCompleteField.suggestionsContainer),l=(a.offset(),a.outerHeight()),r=o.top-n+i+l>window.innerHeight;a.css("opacity",0),r?"top"!=autoCompleteField.options.orientation&&(autoCompleteField.options.orientation="top",autoCompleteField.fixPosition()):"top"==autoCompleteField.options.orientation&&(autoCompleteField.options.orientation="bottom",autoCompleteField.fixPosition()),a.css("opacity",1)}function setValues(e){if(scope.mutiselectVal=[""],angular.isDefined(e)&&null!=e){var t="",n=e.length;if(1==multiselect){if(n>0){if(minMultiselect.event&&n==minMultiselect.value&&getModel().length==minMultiselect.value&&scope.validateRules(),showLookup&&(scope.multiselectFlag=!0),scope.defaultselectoption){scope.defaultselectiontext||(scope.defaultselectiontext=getDisplayData(e[0]).replace(/(^\s*)|(\s*$)/gi,""),scope.mutiselectVal=[scope.defaultselectiontext+" (Default)"]);for(var o=0;n>o;o++)if(e[o].name===scope.defaultselectiontext){scope.mutiselectVal=[getDisplayData(e[o])+" (Default)"];break}}else scope.mutiselectVal=[getDisplayData(e[0])];n>1&&scope.mutiselectVal.push("+"+(n-1)+" More")}else scope.multiselectFlag=!1;for(var o=0;n>o;o++)t+=t&&n>1?","+getDisplayData(e[o]):getDisplayData(e[o])}else t=getDisplayData(e),scope.showInfoIcon=""==t||scope.isSupplier?!1:!0;scope.displayModel=t.trim()}scope.isActive=checkIfActive(),checkInfoToolTip()}function destroyEverythingElse(){element.off(),$("#"+scope.typeaheadId).off(),$("#"+scope.labelFortypeaheadId).off(),unbindFocus&&unbindFocus(),angular.isFunction(unbindOptions)&&unbindOptions(),unbindNumber&&unbindNumber(),$("#"+scope.typeaheadId).remove(),$("#"+scope.labelFortypeaheadId).remove(),$timeout.cancel(toutOptions)}scope.placeholder=void 0==scope.placeholder||null==scope.placeholder?"":scope.placeholder,scope.ngModel=void 0==scope.ngModel||null==scope.ngModel?"":scope.ngModel,scope.label=void 0==scope.label||null==scope.label?"":scope.label,scope.textAlign=void 0==scope.align||null==scope.align?"left":scope.align,scope.infoIconFlag=void 0==scope.infoIcon||null==scope.infoIcon?!1:!0,scope.titleofmodel=void 0==scope.titleofmodel||null==scope.titleofmodel?$translate.instant("titleOfModel"):scope.titleofmodel,scope.infoIconTooltip=void 0==scope.infoIconTooltip||null==scope.infoIconTooltip?"":scope.infoIconTooltip,scope.isLazyLoadingEnabled=angular.isDefined(scope.isLazyLoadingEnabled)?scope.isLazyLoadingEnabled:!1;var multiselect=void 0==scope.multiselect||null==scope.multiselect?!1:"true"==scope.multiselect?!0:!1,minMultiselect=void 0==scope.minMultiselect||null==scope.minMultiselect?{event:!1}:{event:!0,value:scope.minMultiselect},showLookup=void 0==scope.showLookup||null==scope.showLookup?!0:"true"==scope.showLookup?!0:!1,addnew=void 0==scope.addnew||null==scope.addnew?!1:"true"==scope.addnew?!0:!1,readonly=void 0==scope.readonly||null==scope.readonly?!1:"true"==scope.readonly?!0:!1,minCharForTrigger=scope.minCharForTrigger?parseInt(scope.minCharForTrigger):3,noSuggestionNotice=angular.isDefined(scope.noSuggestionNotice)?scope.noSuggestionNotice:$translate.instant("noResultsErrMsg"),showNoSuggestion=angular.isDefined(scope.showNoSuggestion)&&"true"==scope.showNoSuggestion?!0:!1,loading=angular.isDefined(scope.loading)?scope.loading:!1;""==noSuggestionNotice&&(showNoSuggestion=!1);var number,rulesValidationEvent,showLookupKey=$translate.instant("showLookupLabel"),addNewKey=$translate.instant("addNew");scope.disabled="",scope.showInfoIcon=void 0==scope.showInfoIcon||null==scope.showInfoIcon?!1:scope.showInfoIcon;var isInfoTipEnable="true"==attrs.showInfoTip?!0:!1,checkInfoToolTip=function(){isInfoTipEnable?scope.infotipData=scope.displayModel.replace(/,/g,"  ").trim().replace(/  /g,"<br>"):scope.infotipData=""},selectedArr=[],newOptionsSelected=[],newArr=[],copyArray=[],selectedArrIndex;readonly&&(scope.disabled="disabled");var uniqueIDGenerator=function(){var e=(new Date).getTime(),t="xx2xxpxxoxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t};if(scope.isActive=checkIfActive(),void 0!=attrs.id||null!=attrs.id)scope.typeaheadId=attrs.id,element.removeAttr("id");else{var typeaheadId=uniqueIDGenerator();scope.typeaheadId="typeahead-"+typeaheadId}scope.labelFortypeaheadId="label-for-"+scope.typeaheadId;var cancelMe=setTimeout(function(){readonly&&angular.element("#"+scope.typeaheadId).attr("tabindex",-1),clearTimeout(cancelMe),cancelMe=null}),unbindFocus=scope.$watch("focus",function(e,t){if(e){ScrollTo.perform(element,angular.element("#"+scope.parentElement));var n=setTimeout(function(){angular.element("#"+scope.labelFortypeaheadId).trigger("click"),clearTimeout(n),n=null});scope.focus=!1}}),changeTimeout,keyUpTimeout,keyDownTimeout,keyPressTimeout;scope.ngChange=function(e){scope.isActive=checkIfActive(),changeTimeout&&$timeout.cancel(changeTimeout),changeTimeout=$timeout(function(){scope.onChange({$event:{data:angular.element("#"+scope.typeaheadId)}})},500)},scope.ngFocus=function(e){scope.isActive=!0,scope.onFocus({$event:e}),autoCompleteField.suggestions.length=0},scope.ngBlur=function(e){var t=getModel();setValues(t),multiselect&&t.length>0&&(scope.multiselectFlag=!0),scope.isActive=checkIfActive(),scope.onBlur({$event:e}),void 0==t||null==t||""==t||0===Object.getOwnPropertyNames(t).length?scope.showInfoIcon=!1:scope.showInfoIcon=!0;var n=$timeout(function(){showLookupTrigger?showLookupTrigger=!1:scope.validateRules(),$timeout.cancel(n),n=null},200)};var preventKeyArray=[37,38,39,40],showLookupTrigger=!1;scope.ngKeyUp=function(e){multiselect&&""==e.target.value&&setModel([]),multiselect||""!=e.target.value||setModel(null),scope.showInfoIcon=!1,keyUpTimeout&&$timeout.cancel(keyUpTimeout),keyUpTimeout=$timeout(function(){var t="which"in e?e.which:e.keyCode;preventKeyArray.indexOf(t)>-1||scope.onKeyUp({$event:e})},500),DuplicateData(scope.displayModel,e)},scope.ngKeyDown=function(e){scope.showInfoIcon=!1,keyDownTimeout&&$timeout.cancel(keyDownTimeout),keyDownTimeout=$timeout(function(){var t="which"in e?e.which:e.keyCode;preventKeyArray.indexOf(t)>-1||scope.onKeyDown({$event:e})},500);var t=getFormattedData(newOptionsSelected);copyArray=angular.copy(t).map(function(e){return e.value.toLowerCase()}),DuplicateData(scope.displayModel,e)},scope.ngKeyPress=function(e){keyPressTimeout&&$timeout.cancel(keyPressTimeout),keyPressTimeout=$timeout(function(){var t="which"in e?e.which:e.keyCode;preventKeyArray.indexOf(t)>-1||scope.onKeyPress({$event:e}),13==e.charCode&&scope.onEnter({$event:e})},500),DuplicateData(scope.displayModel,e)},scope.clickedOnIcon=function(e){scope.callbackOnIconClick({$event:e})},scope.validateRules=function(){var model=getModel();if("true"==scope.readonly)return void(scope.isActive=!0);if(scope.$eval(scope.isMandatory)&&!scope.clienterror&&(0==Object.keys(model).length||null==model||void 0==model||""==model||0==model.id))return scope.validate=!0,scope.errorMessage=$translate.instant("enterValueErrMsg"),void(scope.errorModel=$translate.instant("enterValueErrMsg"));if(scope.clienterror)return scope.validate=!0,scope.errorMessage=$translate.instant("clientErrMsg"),void(scope.errorModel=$translate.instant("clientErrMsg"));if(scope.validate=!1,scope.errorMessage=null,scope.errorModel=null,scope.rules)for(var rules=scope.$eval(scope.rules),isFoundInvalid=!1,ruleLlen=rules.length,i=0;ruleLlen>i;i++){var tRule=rules[i];if("object"==typeof tRule){if(eval(tRule.rule.replace(/this/g,"scope.displayModel"))){scope.validate=!0,scope.errorMessage=tRule.error,scope.errorModel=tRule.error;break}}else{if(isFoundInvalid)break;RuleEngine.isValid(tRule,function(e){scope.validate=!0,scope.errorMessage=$translate.instant(e.errorData.error),scope.errorModel=$translate.instant(e.errorData.error),isFoundInvalid=!0})}}};var unbindValidate=scope.$watchGroup(["validate","clienterror","showinfo","showwarning"],function(e,t){(e[0]||e[1]!=t[1])&&scope.validateRules(),(e[2]!=t[2]||e[3]!=t[3])&&(scope.showinfo||scope.showwarning?element.hasClass("input-field").addClass("field-has-icon"):element.hasClass(".input-field").removeClass("field-has-icon"))});scope.clienterror&&scope.validateRules();var filterKeys;filterKeys=angular.isDefined(scope.filterkeys)&&0==scope.filterkeys.trim().indexOf("[")?scope.filterkeys?scope.$eval(scope.filterkeys):["title"]:scope.filterkeys?scope.$eval("["+scope.filterkeys+"]"):["title"],scope.filterKeys=scope.$eval(scope.filterkeys);var optionFormat=scope.optionformat?scope.optionformat:getDispFormate(),displayFormat=scope.displayformat?scope.displayformat:getOpFormate(),formatedArray=getFormatedArray(displayFormat),delimiterVal=null;1==multiselect&&(delimiterVal=/(,|;)\s*/);var unbindOptions,autoCompleteField,toutOptions=$timeout(function(){unbindOptions=scope.$watch("options",function(e){try{newOptionsSelected=e;var t=getFormattedData(newOptionsSelected);copyArray=angular.copy(t).map(function(e){return e.value.toLowerCase()}),readonly||($("#"+scope.typeaheadId).devbridgeAutocomplete()?$("#"+scope.typeaheadId).devbridgeAutocomplete().setLookup(getFormattedData(e)):(autoCompleteField=$("#"+scope.typeaheadId).devbridgeAutocomplete({filterKeys:filterKeys,optionFormat:optionFormat,displayFormat:displayFormat,lookup:t,width:scope.width,maxHeight:scope.height,multiselect:multiselect,showLookup:showLookup,addnew:addnew,minChars:minCharForTrigger,delimiter:delimiterVal,showNoSuggestionNotice:showNoSuggestion,noSuggestionNotice:noSuggestionNotice,loading:loading,minMultiselect:minMultiselect,showLookupKey:showLookupKey,addNewKey:addNewKey,onSelect:function(e){angular.element("#"+scope.labelFortypeaheadId).trigger("click"),scope.$evalAsync(function(){1==multiselect?(scope.displayModel="",setModel(e,"autocomplete"),angular.forEach(getModel(),function(e){scope.displayModel=scope.displayModel+e.value+", "}),DuplicateData(scope.displayModel)):(scope.displayModel=getDisplayData(e),setModel(e,"autocomplete"));var t=$timeout(function(){scope.onSelect(e),$timeout.cancel(t),t=null})})},onClickAddNew:function(e){if(addnew){scope.callAddNew({$event:e}),document.body.style.height=document.body.scrollHeight+2+"px";var t=setTimeout(function(){window.scrollTo(0,document.body.scrollTop+1),window.scrollTo(0,document.body.scrollTop-1),document.body.style.height="",clearTimeout(t),t=null})}},onClickShowLookup:function(e){showLookup&&scope.openLookup()}}).devbridgeAutocomplete(),$(autoCompleteField.element).focus(function(e){alignLookUp.call(this,e,autoCompleteField);var t=$window.lastOpenedDropdownConfig;!t||t.activates.is(":hidden")||angular.element(this).closest(t.activates).length||t.origin.trigger("close")}).keyup(function(e){alignLookUp.call(this,e,autoCompleteField)}),angular.element($window).scroll(function(e){autoCompleteField.visible&&autoCompleteField.hide()})))}catch(n){}});scope.$watch("loading",function(e,t){(1==e||0==e)&&$("#"+scope.typeaheadId).devbridgeAutocomplete().setLoading(e)})});scope.openLookup=function(){showLookupTrigger=!0;for(var e=newArr.length,t=0;e>t;t++){var n=newArr[t];-1==newOptionsSelected.indexOf(n)&&(newOptionsSelected.splice(n._$index,0,n),newArr.splice(t,1))}if("true"===scope.readonly&&!scope.mutiselectVal[1])return!1;$.isFunction(scope.lookupOpen)&&scope.lookupOpen();var o={modelData:lookup.getTempModel()||getModel(),config:{mutliselect:multiselect,displayProperties:formatedArray,options:scope.options,descriptionKey:scope.desckey,addnew:addnew,onKeyUp:attrs.searchtextKeyUp?scope.searchtextKeyUp:"",titleOfModel:scope.titleofmodel,defaultSelectOption:scope.defaultselectoption,defaultSelectionText:scope.defaultselectiontext,selectTypeOption:scope.selecttypeoption,readonly:void 0==scope.readonly||null==scope.readonly?!1:"true"==scope.readonly?!0:!1,isMandatory:scope.isMandatory,isDefaultMandatory:scope.isDefaultMandatory,errorModel:scope.errorModel,minMultiselect:minMultiselect,label:scope.label,searchFilterKey:scope.$eval(scope.filterkeys),isLazyLoadingEnabled:scope.isLazyLoadingEnabled}},i=$timeout(function(){lookup.open(o,function(e){e.addnew&&$.isFunction(scope.callAddNew)&&scope.callAddNew(),setModel(e.result),scope.defaultselectiontext=e.defaultSelectionText,scope.selecttypeoption=e.selectTypeOption,scope.errorModel=e.errorModel,scope.validateRules(),$.isFunction(scope.lookupHide)&&scope.lookupHide({data:e})}),lookup.onScrollEnd(function(){scope.onScrollEnd({})}),lookup.onScrollTop(function(){scope.onScrollTop({})}),lookup.onScrollInProgress(function(){scope.onScrollInProgress({})}),$timeout.cancel(i),i=null})},scope.$on("$destroy",function(){$("#"+scope.typeaheadId).devbridgeAutocomplete()&&$("#"+scope.typeaheadId).devbridgeAutocomplete().dispose(),destroyEverythingElse()}),scope.multiselectFlag=!1;var unbindNumber=scope.$watch("ngModel",function(e){setValues("function"==typeof scope.ngModel?ngModel.$modelValue:e)})},templateUrl:"shared/directives/uiElements/smartTypeahead/smartTypeaheadTemplate.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartUiGrid",["$timeout","$filter","gridConfigProvider","APPCONSTANTS","httpService","uiGridConstants","$injector",function($timeout,$filter,gridConfigProvider,APPCONSTANTS,httpService,uiGridConstants,$injector){return{restrict:"AE",scope:{colDef:"@",model:"=",callback:"&",focusRowCol:"@",validationService:"@",searchTerm:"@",otherGridOptions:"@",api:"=",onRenderingStart:"&",onRenderingFinish:"&",dynamicPaginationPageSizes:"=",dynamicItemTotal:"="},link:function(scope,element,attr){function getCellValue(e,t){var n=gridInstance.grid.getCellDisplayValue(e,t);return n?n.toString():""}function outerSearchCallback(rows,cols){return scope.searchTerm&&"string"==typeof scope.searchTerm&&scope.searchTerm.length>0&&_.each(rows,function(row,rowIndex){var match=!1;_.each(cols,function(col){var cellValue=$filter("translate")(getCellValue(row,col));if(col.colDef.attributes&&col.colDef.attributes.type&&"date"==col.colDef.attributes.type.toLowerCase()){var formattedDate=cellValue.replace(new RegExp("/","ig"),"");formattedDate=formattedDate.split("+"),formattedDate=eval("new "+formattedDate[0]+(formattedDate.length>1?")":""));var month=formattedDate.getMonth()+1+"";1===month.length&&(month="0"+month),formattedDate=formattedDate.getDate()+"/"+month+"/"+formattedDate.getFullYear();var decession=formattedDate.toLowerCase().trim().indexOf(escape(scope.searchTerm).replace(/%5C/g,"").trim())>-1;decession&&(match=!0)}else cellValue.match(new RegExp(scope.searchTerm,"i"))&&(match=!0)}),row.visible=match}),rows}function onCheckboxSelect(e){angular.isFunction(callback)&&callback("composedGridCheckBoxDispatcher",{row:e})}function getGridInstanceCallback(e){angular.isFunction(callback)&&callback("gridInstance",e),gridInstance=e,void 0!=typeof scope.api&&null!=scope.api&&scope.api.rowSelectionCallback&&(scope.gridConfig.isRowSelectable=scope.api.rowSelectionCallback),gridInstance.grid.registerRowsProcessor(outerSearchCallback,200),gridInstance.core.on.rowsRendered(scope,function(e){rowsRenderedTimeout&&($timeout.cancel(rowsRenderedTimeout),rowsRenderedTimeout=void 0),rowsRenderedTimeout=$timeout(function(){angular.isFunction(callback)&&callback("composedGridRowsRenderedDispatcher",{row:e}),setHeightForGrid(),angular.isFunction(scope.onRenderingFinish)&&scope.onRenderingFinish()},500)}),gridInstance.selection.on.rowSelectionChanged(scope,onCheckboxSelect),gridInstance.cellNav.on.navigate(scope,function(e,t){e.col.colDef.isRegFocusCol&&angular.isFunction(callback)&&callback("composedGridFocusColumnDispatcher",{focusedRowColObj:e,bluredRowColObj:t,instance:gridInstance})}),gridInstance.edit.on.afterCellEdit(scope,function(e,t){angular.isFunction(callback)&&callback("composedGridUpdateColumnDispatcher",{rowModel:e,colDef:t,instance:gridInstance})}),gridInstance.edit.on.beginCellEdit(scope,function(e,t){switch(t.uiType){case"dropdown":t.attributes.serviceObj&&0==t.attributes.options.length?getDataFolDropDown(t,e):(t.attributes.options.map(function(e){e[t.attributes.dataKey]=$filter("translate")(e[t.attributes.dataKey])}),scope.dropDownOptions=t.attributes.options)}t.isRegBeginEditCol&&angular.isFunction(callback)&&callback("composedGridBeginEditColumnDispatcher",{rowModel:e,colDef:t})}),gridInstance.pagination.on.paginationChanged(scope,function(e,t){angular.isFunction(callback)&&callback("composedGridDynamicPaginationCallback",{gridConfig:scope.gridConfig,index:e,pageSize:t})})}function setHeightForGrid(){var e,t=gridInstance.core.getVisibleRows(gridInstance.grid).length;0!=t&&(e=scope.gridConfig.rowHeight>0?(t+1)*scope.gridConfig.rowHeight+54:35*t+54,$($(".ui-grid")[0]).css({width:"100%",height:e}),$($(".ui-grid")[0]).find("ui-grid-header-canvas").css("width","100%"))}function getDataFolDropDown(e,t){var n=e.attributes.serviceObj,o={method:"GET",url:n.url,params:n.param,headers:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(APPCONSTANTS.userPreferences.UserBasicDetails)}};httpService.directhttp(o).then(function(n){if("object"!=typeof t[e.field]){var o=[];_.each(n,function(t,n){var i={};i[e.attributes.dataKey]=$filter("translate")(t),i[e.attributes.idKey]=n,o.push(i)}),e.attributes.options=o}else e.attributes.options=n;scope.dropDownOptions=e.attributes.options},function(){})}var paginationOptions={pageNumber:1,pageSize:12,sort:null};if(void 0!=scope.validationService){var service=$injector.get(scope.validationService);scope.$parent[scope.validationService]=service,scope.cellClassFunction=scope.validationService+".validateGridRow",scope.cellEditableConditionFunction=scope.validationService+".isEditableGridRow"}var gridInstance,defaultGridOptions={paginationPageSizes:scope.dynamicPaginationPageSizes?scope.dynamicPaginationPageSizes:[10,25,50,75],paginationPageSize:scope.dynamicPaginationPageSizes&&scope.dynamicPaginationPageSizes[0]?scope.dynamicPaginationPageSizes[0]:10,useExternalPagination:scope.dynamicPaginationCallback?!0:!1,enableCellEditOnFocus:!0,enableFiltering:!0,enableVerticalScrollbar:uiGridConstants.scrollbars.NEVER,treeRowHeaderAlwaysVisible:!1,showTreeExpandNoChildren:!1},callback=scope.$eval(scope.callback),cellClassFunction=scope.$parent.$eval(scope.cellClassFunction),cellEditableConditionFunction=scope.$parent.$eval(scope.cellEditableConditionFunction);scope.gridConfig=defaultGridOptions;var modifiedColDef;scope.api&&(scope.api.getActiveColumns=function(){return scope.gridConfig.columnDefs}),scope.$watch("focusRowCol",function(e,t){e&&gridInstance.cellNav.scrollToFocus(e.row.entity,e.col.colDef)}),scope.$watch("scope.dynamicItemTotal",function(e,t){scope.gridConfig.totalItems=scope.dynamicItemTotal}),scope.$watch("searchTerm",function(e,t){e&&"string"==typeof e&&gridInstance.grid.refresh()}),scope.$watch("colDef",function(n,o){if(angular.isFunction(scope.onRenderingStart)&&scope.onRenderingStart(),scope.$eval(n)){modifiedColDef=gridConfigProvider.getMassagedGirdConfig(scope.$eval(n),scope,cellClassFunction,cellEditableConditionFunction),_.each(modifiedColDef,function(def,idx,defs){def.customTreeAggregationFinalizerFn&&(def.customTreeAggregationFinalizerFn=eval("("+def.customTreeAggregationFinalizerFn+")")),def.customTreeAggregationFn&&(def.customTreeAggregationFn=eval("("+def.customTreeAggregationFn+")"))}),scope.gridConfig.columnDefs=null,scope.gridConfig.columnDefs=modifiedColDef;var groupingCol=_.filter(scope.gridConfig.columnDefs,function(e){return e.isGrouped});groupingCol&&groupingCol.length>0&&gridInstance&&(gridInstance.grouping.clearGrouping(),_.each(groupingCol,function(e){gridInstance.grouping.groupColumn(e.field)}))}}),scope.$watch("otherGridOptions",function(n,o){if(angular.isFunction(scope.onRenderingStart)&&scope.onRenderingStart(),scope.$eval(n)){var modifiedOtherGridOptions=angular.merge({},scope.gridConfig,scope.$eval(n));_.each(modifiedOtherGridOptions.appScopeProvider,function(prop,i,props){modifiedOtherGridOptions.appScopeProvider[i]=eval(prop)}),scope.gridConfig=null,scope.gridConfig=modifiedOtherGridOptions}}),scope.$watch("model",function(e){if(angular.isFunction(scope.onRenderingStart)&&scope.onRenderingStart(),!e)return void(scope.gridConfig.data=[]);var t=treeViewColumnsToBeCreated(scope.gridConfig.columnDefs);t.length>0?(scope.gridConfig=angular.extend(scope.gridConfig,{showTreeRowHeader:!0,enableRowHeaderSelection:!0,showTreeExpandNoChildren:!1}),scope.gridConfig.data=assignTreeLevel($filter("orderBy")(e,t[0].field),t[0].field)):scope.gridConfig.data=e}),gridInstance||(scope.gridConfig.onRegisterApi=getGridInstanceCallback);var treeViewColumnsToBeCreated=function(e){return _.filter(e,function(e){return e.isTree})},sortData=function(data,key){return data.slice(0).sort(function(a,b){return eval("a."+key)>eval("b."+key)?1:eval("a."+key)<eval("b."+key)?-1:0})},assignTreeLevel=function(data,key){for(var loopedItems=[],i=0;i<data.length;i++){if(data[i].$$treeLevel=0,loopedItems.indexOf(eval("data[i]."+key))>-1&&(data[i].$$treeLevel=1),eval("data[i]."+key).toString().indexOf(".")>-1){var SplitLevelArr=eval("data[i]."+key).toString().split(".");data[i].$$treeLevel=SplitLevelArr.length-1,loopedItems.indexOf(eval("data[i]."+key))>-1&&(data[i].$$treeLevel=parseInt(data[i].$$treeLevel)+1)}loopedItems.push(eval("data[i]."+key))}return data},rowsRenderedTimeout;scope.autoSuggestOptions=[],scope.autoSuggestOnChange=function(e,t,n){if(!angular.isUndefined(e.data)&&0!=e.data.length){if(callback("composedGridAutoSuggestChange",{row:n,col:t,val:void 0!==e.data[0]?e.data[0].value:e.displayModel}),""==e.data[0].value){var o,i=n.entity[t.colDef.field.split(".")[0]];null!=i&&void 0!=i&&t.colDef.field.indexOf("split")>=0&&(n.entity.id>0?o=_.findIndex(scope.model,{id:n.entity.id}):_.each(scope.model,function(e,t){return _.isEqual(e,n.entity)?void(o=t):void 0}),scope.model[o][t.colDef.field.split(".")[0]]={entityType:i.entityType,fieldId:i.fieldId,splitEntityId:i.splitEntityId,code:0,entityCode:null,name:null,title:null})}var a=t.colDef.attributes.serviceObj;if(void 0!=a){var l={type:"POST"===a.method?"POST":"GET",url:a.url,params:JSON.parse(JSON.stringify(a.param).replace("@term",e.data[0].value)),timeout:12e4,headers:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(APPCONSTANTS.userPreferences.UserBasicDetails)}};"POST"===l.type&&(l.data=JSON.parse(JSON.stringify(a.param).replace("@term",e.data[0].value)),delete l.params),httpService.directhttp(l).then(function(o){a.CallbackObj&&(o=a.CallbackObj(o,t.colDef.name));var i=[];"string"==typeof o&&(o=JSON.parse(o)),a.isFlatArray?_.each(o,function(e,t){var n={};n.name=e,n.code=e,i.push(n)}):_.each(o,function(e){var t={};_.each(a.mapper,function(n){var o="";angular.isArray(n.toBeMapped)?(_.each(n.toBeMapped,function(t){o+=e[t]+" "}),o.trim()):o=e[n.toBeMapped],t[n.key]=o}),_.each(a.staticValues,function(e){t[e.key]=e.value}),i.push(t)}),scope.autoSuggestOptions=i,a.responseRequired&&callback("composedGridParseItemMasterData",{rowModel:n,colDef:t,response:o,value:e.data[0].value})},function(){})}}},scope.autoSuggestOnSelect=function(e,t,n,o){t=e.data,callback("composedGridSelectItemMasterData",{data:t,row:n,col:o,isModified:!0})},scope.isObject=function(e){return"object"==typeof e},scope.dropDownOnChange=function(e,t,n){angular.isFunction(callback)&&callback("composedGridDropDownOnSelectDispatcher",{row:e,col:t,val:n})},scope.dropDownOptions=[],scope.popUpButtonClickCallback=function(e,t){angular.isFunction(callback)&&(t.colDef.isChargesGrid?callback("composedChargesGridPopupButtonClickDispatcher",{row:e,col:t}):callback("composedGridPopupButtonClickDispatcher",{row:e,col:t}))},scope.checkBoxOnChange=function(e,t,n){callback("composedGridCheckBoxOnChangeDispatcher",{row:e,col:t,val:n})},scope.textOrNumberKeyUp=function(e,t,n){callback("composedGridTextKeyUp",{row:n,col:t,val:e.target.value})}},templateUrl:"shared/directives/uiElements/smartUiGrid/smartUiGrid.html"}}])}(),function(){"use strict";angular.module("SMART2").directive("smartUiTable",["$timeout","$filter","gridConfigProvider","APPCONSTANTS","httpService","uiGridConstants","$injector",function($timeout,$filter,gridConfigProvider,APPCONSTANTS,httpService,uiGridConstants,$injector){return{restrict:"AE",scope:{colDef:"@",model:"=",callback:"&",focusRowCol:"@",validationService:"@",searchTerm:"@",otherGridOptions:"@",api:"=",onRenderingStart:"&",onRenderingFinish:"&",dynamicPaginationPageSizes:"=",dynamicItemTotal:"="},link:function(scope,element,attr){function getCellValue(e,t){var n=gridInstance.grid.getCellDisplayValue(e,t);return n?n.toString():""}function outerSearchCallback(rows,cols){return scope.searchTerm&&"string"==typeof scope.searchTerm&&scope.searchTerm.length>0&&_.each(rows,function(row,rowIndex){var match=!1;_.each(cols,function(col){var cellValue=$filter("translate")(getCellValue(row,col));if(col.colDef.attributes&&col.colDef.attributes.type&&"date"==col.colDef.attributes.type.toLowerCase()){var formattedDate=cellValue.replace(new RegExp("/","ig"),"");formattedDate=formattedDate.split("+"),formattedDate=eval("new "+formattedDate[0]+(formattedDate.length>1?")":""));var month=formattedDate.getMonth()+1+"";1===month.length&&(month="0"+month),formattedDate=formattedDate.getDate()+"/"+month+"/"+formattedDate.getFullYear();var decession=formattedDate.toLowerCase().trim().indexOf(escape(scope.searchTerm).replace(/%5C/g,"").trim())>-1;decession&&(match=!0)}else cellValue.match(new RegExp(scope.searchTerm,"i"))&&(match=!0)}),row.visible=match}),rows}function onCheckboxSelect(e){angular.isFunction(callback)&&callback("composedGridCheckBoxDispatcher",{row:e})}function getGridInstanceCallback(e){angular.isFunction(callback)&&callback("gridInstance",e),gridInstance=e,void 0!=typeof scope.api&&null!=scope.api&&scope.api.rowSelectionCallback&&(scope.gridConfig.isRowSelectable=scope.api.rowSelectionCallback),gridInstance.selection.on.rowSelectionChanged(scope,onCheckboxSelect),gridInstance.edit.on.afterCellEdit(scope,function(e,t){angular.isFunction(callback)&&callback("composedGridUpdateColumnDispatcher",{
rowModel:e,colDef:t,instance:gridInstance})}),gridInstance.edit.on.beginCellEdit(scope,function(e,t){switch(t.uiType){case"dropdown":t.attributes.serviceObj&&0==t.attributes.options.length?getDataFolDropDown(t,e):(t.attributes.options.map(function(e){e[t.attributes.dataKey]=$filter("translate")(e[t.attributes.dataKey])}),scope.dropDownOptions=t.attributes.options)}t.isRegBeginEditCol&&angular.isFunction(callback)&&callback("composedGridBeginEditColumnDispatcher",{rowModel:e,colDef:t})}),gridInstance.cell.on.click(scope,function(e,t){callback("smartTableClick",{row:e,col:t})})}function setHeightForGrid(){var e,t=gridInstance.core.getVisibleRows(gridInstance.grid).length;0!=t&&(e=scope.gridConfig.rowHeight>0?(t+1)*scope.gridConfig.rowHeight+54:35*t+54,$($(".ui-grid")[0]).css({width:"100%",height:e}),$($(".ui-grid")[0]).find("ui-grid-header-canvas").css("width","100%"))}function getDataFolDropDown(e,t){var n=e.attributes.serviceObj,o={method:"GET",url:n.url,params:n.param,headers:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(APPCONSTANTS.userPreferences.UserBasicDetails)}};httpService.directhttp(o).then(function(n){if("object"!=typeof t[e.field]){var o=[];_.each(n,function(t,n){var i={};i[e.attributes.dataKey]=$filter("translate")(t),i[e.attributes.idKey]=n,o.push(i)}),e.attributes.options=o}else e.attributes.options=n;scope.dropDownOptions=e.attributes.options},function(){})}var paginationOptions={pageNumber:1,pageSize:12,sort:null};if(void 0!=scope.validationService){var service=$injector.get(scope.validationService);scope.$parent[scope.validationService]=service,scope.cellClassFunction=scope.validationService+".validateGridRow",scope.cellEditableConditionFunction=scope.validationService+".isEditableGridRow"}var gridInstance,defaultGridOptions={paginationPageSizes:scope.dynamicPaginationPageSizes?scope.dynamicPaginationPageSizes:[10,25,50,75],paginationPageSize:scope.dynamicPaginationPageSizes&&scope.dynamicPaginationPageSizes[0]?scope.dynamicPaginationPageSizes[0]:10,useExternalPagination:scope.dynamicPaginationCallback?!0:!1,enableCellEditOnFocus:!0,enableFiltering:!0,enableVerticalScrollbar:uiGridConstants.scrollbars.NEVER,treeRowHeaderAlwaysVisible:!1,showTreeExpandNoChildren:!1,enableRowSelection:!0},callback=scope.$eval(scope.callback),cellClassFunction=scope.$parent.$eval(scope.cellClassFunction),cellEditableConditionFunction=scope.$parent.$eval(scope.cellEditableConditionFunction);scope.gridConfig=defaultGridOptions;var modifiedColDef;scope.api&&(scope.api.getActiveColumns=function(){return scope.gridConfig.columnDefs}),scope.$watch("focusRowCol",function(e,t){e&&gridInstance.cellNav.scrollToFocus(e.row.entity,e.col.colDef)}),scope.$watch("scope.dynamicItemTotal",function(e,t){scope.gridConfig.totalItems=scope.dynamicItemTotal}),scope.$watch("searchTerm",function(e,t){e&&"string"==typeof e&&gridInstance.grid.refresh()}),scope.$watch("colDef",function(n,o){if(angular.isFunction(scope.onRenderingStart)&&scope.onRenderingStart(),scope.$eval(n)){modifiedColDef=gridConfigProvider.getMassagedGirdConfig(scope.$eval(n),scope,cellClassFunction,cellEditableConditionFunction),_.each(modifiedColDef,function(def,idx,defs){def.customTreeAggregationFinalizerFn&&(def.customTreeAggregationFinalizerFn=eval("("+def.customTreeAggregationFinalizerFn+")")),def.customTreeAggregationFn&&(def.customTreeAggregationFn=eval("("+def.customTreeAggregationFn+")"))}),scope.gridConfig.columnDefs=null,scope.gridConfig.columnDefs=modifiedColDef;var groupingCol=_.filter(scope.gridConfig.columnDefs,function(e){return e.isGrouped});groupingCol&&groupingCol.length>0&&gridInstance&&(gridInstance.grouping.clearGrouping(),_.each(groupingCol,function(e){gridInstance.grouping.groupColumn(e.field)}))}}),scope.$watch("otherGridOptions",function(n,o){if(angular.isFunction(scope.onRenderingStart)&&scope.onRenderingStart(),scope.$eval(n)){var modifiedOtherGridOptions=angular.merge({},scope.gridConfig,scope.$eval(n));_.each(modifiedOtherGridOptions.appScopeProvider,function(prop,i,props){modifiedOtherGridOptions.appScopeProvider[i]=eval(prop)}),scope.gridConfig=null,scope.gridConfig=modifiedOtherGridOptions}}),scope.$watch("model",function(e){if(angular.isFunction(scope.onRenderingStart)&&scope.onRenderingStart(),!e)return void(scope.gridConfig.data=[]);var t=treeViewColumnsToBeCreated(scope.gridConfig.columnDefs);t.length>0?(scope.gridConfig=angular.extend(scope.gridConfig,{showTreeRowHeader:!0,enableRowHeaderSelection:!0,showTreeExpandNoChildren:!1}),scope.gridConfig.data=assignTreeLevel($filter("orderBy")(e,t[0].field),t[0].field)):scope.gridConfig.data=e}),gridInstance||(scope.gridConfig.onRegister=getGridInstanceCallback);var treeViewColumnsToBeCreated=function(e){return _.filter(e,function(e){return e.isTree})},sortData=function(data,key){return data.slice(0).sort(function(a,b){return eval("a."+key)>eval("b."+key)?1:eval("a."+key)<eval("b."+key)?-1:0})},assignTreeLevel=function(data,key){for(var loopedItems=[],i=0;i<data.length;i++){if(data[i].$$treeLevel=0,loopedItems.indexOf(eval("data[i]."+key))>-1&&(data[i].$$treeLevel=1),eval("data[i]."+key).toString().indexOf(".")>-1){var SplitLevelArr=eval("data[i]."+key).toString().split(".");data[i].$$treeLevel=SplitLevelArr.length-1,loopedItems.indexOf(eval("data[i]."+key))>-1&&(data[i].$$treeLevel=parseInt(data[i].$$treeLevel)+1)}loopedItems.push(eval("data[i]."+key))}return data},rowsRenderedTimeout;scope.autoSuggestOptions=[],scope.autoSuggestOnChange=function(e,t,n){if(!angular.isUndefined(e.data)&&0!=e.data.length){if(callback("composedGridAutoSuggestChange",{row:n,col:t,val:void 0!==e.data[0]?e.data[0].value:e.displayModel}),""==e.data[0].value){var o,i=n.entity[t.colDef.field.split(".")[0]];null!=i&&void 0!=i&&t.colDef.field.indexOf("split")>=0&&(n.entity.id>0?o=_.findIndex(scope.model,{id:n.entity.id}):_.each(scope.model,function(e,t){return _.isEqual(e,n.entity)?void(o=t):void 0}),scope.model[o][t.colDef.field.split(".")[0]]={entityType:i.entityType,fieldId:i.fieldId,splitEntityId:i.splitEntityId,code:0,entityCode:null,name:null,title:null})}var a=t.colDef.attributes.serviceObj;if(void 0!=a){var l={type:"POST"===a.method?"POST":"GET",url:a.url,params:JSON.parse(JSON.stringify(a.param).replace("@term",e.data[0].value)),timeout:12e4,headers:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(APPCONSTANTS.userPreferences.UserBasicDetails)}};"POST"===l.type&&(l.data=JSON.parse(JSON.stringify(a.param).replace("@term",e.data[0].value)),delete l.params),httpService.directhttp(l).then(function(o){a.CallbackObj&&(o=a.CallbackObj(o,t.colDef.name));var i=[];"string"==typeof o&&(o=JSON.parse(o)),a.isFlatArray?_.each(o,function(e,t){var n={};n.name=e,n.code=e,i.push(n)}):_.each(o,function(e){var t={};_.each(a.mapper,function(n){var o="";angular.isArray(n.toBeMapped)?(_.each(n.toBeMapped,function(t){o+=e[t]+" "}),o.trim()):o=e[n.toBeMapped],t[n.key]=o}),_.each(a.staticValues,function(e){t[e.key]=e.value}),i.push(t)}),scope.autoSuggestOptions=i,a.responseRequired&&callback("composedGridParseItemMasterData",{rowModel:n,colDef:t,response:o,value:e.data[0].value})},function(){})}}},scope.autoSuggestOnSelect=function(e,t,n,o){t=e.data,callback("composedGridSelectItemMasterData",{data:t,row:n,col:o,isModified:!0})},scope.isObject=function(e){return"object"==typeof e},scope.dropDownOnChange=function(e,t,n){angular.isFunction(callback)&&callback("composedGridDropDownOnSelectDispatcher",{row:e,col:t,val:n})},scope.dropDownOptions=[],scope.popUpButtonClickCallback=function(e,t){angular.isFunction(callback)&&(t.colDef.isChargesGrid?callback("composedChargesGridPopupButtonClickDispatcher",{row:e,col:t}):callback("composedGridPopupButtonClickDispatcher",{row:e,col:t}))},scope.checkBoxOnChange=function(e,t,n){callback("composedGridCheckBoxOnChangeDispatcher",{row:e,col:t,val:n})},scope.textOrNumberKeyUp=function(e,t,n){callback("composedGridTextKeyUp",{row:n,col:t,val:e.target.value})}},templateUrl:"shared/directives/uiElements/smartUiTable/smartUiTable.html"}}])}(),function(e){"use strict";e.module("SMART2").service("trackStatusService",["$http","$q",function(e,t){var n=this;n.statusDataChange={dataChange:""},n.legendChange={dataChange:""},n.dataChange=function(){n.statusDataChange.dataChange=(new Date).getTime()},n.getChange=function(){return n.statusDataChange.dataChange},n.legendChange=function(){n.legendChange.dataChange=(new Date).getTime()},n.getLegendChange=function(){return n.legendChange.dataChange}}])}(angular),function(e){"use strict";e.module("SMART2").directive("smartTrackStatus",["trackStatusService","$filter","$translate",function(e,t,n){return{restrict:"E",replace:!0,scope:{data:"=trackstatusData",onTabChange:"=onTabChange",cycleChange:"=onCycleChange",statusLegend:"=statusLegend",approverLegend:"=approverLegend",fileDownloadCallback:"=fileDownloadCallback",scrollToStatus:"=scrollToStatus",downloadAllAttachment:"=downloadAllAttachment"},templateUrl:"shared/directives/uiElements/trackStatus/popupNewTrackStatus.html",link:function(t,o,i){function a(e){t.statusLists=e.datailedData}function l(e){var n=e.cycles,o=n.length;t.cycleObject=n;for(var i=0;o>i;i++)n[i].selected===!0&&(t.selectedCycle=n[i])}function r(e){for(var n=e.trackStatusTabs,o=n.length,i=0;o>i;i++){var a=n[i];a.active===!0&&(a.contentUrl=m)}t.trackStatusTabs=n}function s(e){t.headerSecData=e,t.headerSecData.Comments.date=t.getDate(e.Comments.date),t.docCreatedOn=t.getDate(e.createdOn)}function c(){for(var e=t.data.datailedData,n=e.length,o=0;n>o;o++){for(var i=e[o].actionerDetails,a=i.length,l=0;a>l;l++)i[l].uniqueId=l+"-"+d();e[o].uniqueId="details"+d()+"-"+o}}function d(){var e=(new Date).getTime(),t="xxx2xxxpxxxoxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}function u(){var e=t.statusLegend?t.statusLegend:!1,n=t.approverLegend?t.approverLegend:!1;t.approverLegend=n?t.approverLegend:h,t.statusLegend=e?e:v}function p(){var e=$("#trackStatusTabId").children(":first");e.hasClass("borderBtmGray")&&e.css({"z-index":2,position:"relative"})}function f(){var e="",n=t.data.datailedData.length,o=t.scrollToStatus&&""!=t.scrollToStatus?Number(t.scrollToStatus):n-1,i=t.data.datailedData[o].uniqueId;p(),e=$("[uniqueid="+i+"]");var a=$("#scroll-8").scrollTop()+e.parent().position().top;return $(".scrollbar-outer").animate({scrollTop:a},"slow","swing"),!1}t.trackStatusService=e,t.headerLable=n.instant("TRACK_STATUS"),t.tsDocName=n.instant("TRACK_STATUS_DOC_NAME"),t.tsCreatedOn="milestone"===i.trackStatusType?n.instant("ACHIEVED_ON"):n.instant("CREATED_ON"),t.tsCurrStatus=n.instant("CURRENT_STATUS"),t.labelOn=n.instant("ON"),t.legend=n.instant("Legend"),t.by=n.instant("By"),t.defContentCommentLen=60;var g,m="shared/directives/uiElements/trackStatus/trackStatusDetail.html";g=i.dateFormat&&""!=i.dateFormat?i.dateFormat:"DD/MM/YYYY",t.getDate=function(e){return moment(parseInt(e)).format(g)},t.tabClicked=function(e){t.onTabChange(e)},t.changeCycle=function(e){t.cycleChange(e)},a(t.data),t.cycleObject=[],l(t.data),t.trackStatusTabs=[],r(t.data),s(t.data.projectStatus),t.hasComments=function(e){var t=""!==e&&e?!0:!1;return t},t.showLess={},t.showMore={},t.showMoreLess=function(e,n){"less"===n?(t.showMore[e]=!0,t.showLess[e]=!1):"more"===n&&(t.showLess[e]=!0,t.showMore[e]=!1)},t.showMoreComment={},t.initShowModel=function(e){t.showMore[e]=!0,t.showLess[e]=!1},t.$watch("trackStatusService.getChange()",function(e,n){e!==n&&e&&(a(t.data),l(t.data),r(t.data),setTimeout(function(){f()},1e3))}),t.getString=function(e,t){var n=e.length,o="";return o=n>t?e.substr(0,t)+"...":e.substr(0,t)},t.applyStatusColor=function(e){switch(e.toLowerCase()){case"approved":case"accepted":case"approval":case"auto_approved":return"color-approved";case"approval pending":case"delegated":case"withdrawn":case"approval withdrawn":case"withdraw":case"approval withdraw":return"color-approved-pending";case"rejected":return"color-rejected";case"pending":return"color-approved-pending";case"budget overriden":return"color-bud-overrid";default:return"grey-text"}},t.IconStatus=function(e){var t={pending:"",approval:"",rejected:"",accepted:"",approved:"",auto_approved:"","approval pending":"","approval withdrawn":"",withdrawn:"","approval withdraw":"",withdraw:""};return e&&t.hasOwnProperty([e.toLowerCase()])?"#icon_TSHexOutlin":"#icon_Info_i"},t.InnerIconStatus=function(e){switch(e.toLowerCase()){case"pending":case"approval pending":return"#icon_TSPending";case"approval":case"accepted":case"approved":return"#icon_TSAccepted";case"rejected":return"#icon_TSRejected";case"auto_approved":return"#Icon_AppAuto";case"approval withdrawn":case"withdrawn":case"approval withdraw":case"withdraw":return"icon_TSWithdrawn";default:return"#icon_Info"}},t.approvalGroupType=function(e){switch(e.toLowerCase()){case"pool approval":return"a-g-pool-approval";case"parallel approval":return"a-g-parallel-approval";case"hr approval":return"a-g-HR-approval";case"group approval":return"a-g-group-approval";default:return!1}},t.slideDetailsTS=function(e){for(var n=t.data.datailedData,o=n.length,i=0;o>i;i++)n[i].uniqueId===e&&(n[i].isDetailShow=!n[i].isDetailShow)},t.changeScreenSize=function(e){t.isFullscreen=!t.isFullscreen},c(),t.$watch("trackStatusService.getLegendChange()",function(e,t){e!==t&&e&&u()});var h=[{icon:"#icon_AppOne",color:"color-approved-pending",text:n.instant("POOL_APP_ATLEAST_ONE")},{icon:"#icon_AppAll",color:"color-approved-pending",text:n.instant("PARALLEL_APPROVAL_FORALL")},{icon:"#icon_AppSingle",color:"color-approved-pending",text:n.instant("INDIVIDUAL_MUST_APPROVE")},{icon:"#Icon_AppAuto",color:"color-approved",text:n.instant("AUTO_SYSTEM_APPROVE")},{icon:"#icon_AppHoc",color:"color-add-Hoc",text:n.instant("ADHOC_APPROVER")}],v=[{icon:"#icon_TSAccepted",color:"color-approved",text:n.instant("APPROVED")},{icon:"#icon_TSRejected",color:"color-rejected",text:n.instant("REJECTED")},{icon:"#icon_TSPartialAc",color:"color-approved",text:n.instant("PARTIALLY_APPROVED")},{icon:"#icon_TSPartialRe",color:"color-rejected",text:n.instant("PARTIALLY_REJECTED")},{icon:"#icon_TSPending",color:"color-approved-pending",text:n.instant("PENDING")},{icon:"#icon_TSWithdrawn",color:"color-approved-pending",text:n.instant("Approval Withdrawn")},{icon:"#icon_Info_i",color:"grey-text",text:n.instant("INFORMATION")}];u(),t.isFullscreen=!1,t.changeScreenSize=function(e){t.isFullscreen=!t.isFullscreen,t.isFullscreen?t.defContentCommentLen=95:t.defContentCommentLen=60},i.$observe("focusLatest",function(e){"true"==e&&setTimeout(function(){f()},200)})},controller:["$scope",function(e){this.getFDownloadCallback=function(){return e.fileDownloadCallback},this.getDownloadAllAttchment=function(){return e.downloadAllAttachment}}]}}]).directive("attachmentsCallout",["$timeout",function(e){return{restrict:"EA",scope:{attachments:"=attachments",identifier:"=identifier",id:"=id"},require:"^smartTrackStatus",templateUrl:"shared/directives/uiElements/trackStatus/attachmentsDownload.html",link:function(e,t,n,o){e.downloadFile=o.getFDownloadCallback(),e.showDownloadAllAttachment=o.getDownloadAllAttchment(),e.filedownload=function(t){e.downloadFile(t)}}}}])}(angular),function(){function e(e,t,n){return{require:["?^uiGrid","?^uiGridRenderContainer"],restrict:"A",link:function(o,i,a,l){var r=l[0],s=l[1],c=!1,d=!1;if(window.lastRenderedElementScope)try{window.lastRenderedElementScope.stopEdit(),window.lastRenderedElementScope=void 0}catch(u){}window.lastRenderedElementScope=o;var p=n.$on("popupClosed",function(){r.focus()}),f=n.$on("closedPopup",function(){r.focus()}),g=n.$on("popupOpened",function(){document.activeElement.blur()}),m=r.grid.api.cellNav.on.viewPortKeyDown(o,function(e,t){var n=i.find("input"),a=i.find("a");switch(e.keyCode){case 32:a.length>0?(window.isPopupOpenedByUIGridCompatibleElement=!0,a.trigger("click")):n.length>0&&!c?(n.focus(),c=!0):d&&v.focus();break;case 9:o.stopEdit();break;default:"date"!==i.attr("type")&&n.focus()}});o.stopEdit=function(e){d&&v.blur(),o.$emit(t.events.END_CELL_EDIT)};var h=function(n){switch(n.keyCode){case 32:var a=(i.find("input"),i.find("a"));a.length>0?(window.isPopupOpenedByUIGridCompatibleElement=!0,a.trigger("click")):d&&v.focus();break;case e.keymap.ESC:n.stopPropagation(),o.$emit(t.events.CANCEL_CELL_EDIT)}if(r&&r.grid.api.cellNav)n.uiGridTargetRenderContainerId=s.containerId,null!==r.cellNav.handleKeyDown(n)&&o.stopEdit(n);else switch(n.keyCode){case e.keymap.ENTER:case e.keymap.TAB:o.stopEdit(n)}};i.on("keydown",h);var v=i.find("select");d=v.length>0,d&&setTimeout(function(){v.focus()}),window.isCellClicked&&(setTimeout(function(){var e=i.find("a");e.length>0&&(window.isPopupOpenedByUIGridCompatibleElement=!0,e.trigger("click"))}),window.isCellClicked=!1),o.$on("$destroy",function(){p(),f(),g(),m(),i.off("keydown",h)})}}}window.onkeydown=function(e){return 32==e.keyCode&&$(e.target).hasClass("ui-grid-focuser")?(e.preventDefault(),!1):void 0},angular.module("SMART2").directive("uigridCompatible",["uiGridConstants","uiGridEditConstants","$rootScope",e])}();
//# sourceMappingURL=directives.min.js.map
