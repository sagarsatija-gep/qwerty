!function(e){"use strict";function t(){function e(e){l=e}function t(){return void 0!=typeof l?l:void 0}function r(e){s=e}function i(){return void 0!=typeof s?s:void 0}function a(e){c=e}function n(){return void 0!=typeof c?c:void 0}function o(e,t){var r;return r=t?_.find(e,function(e){return 1==e.IsSystemDefault}):_.find(e,function(e){return 0==e.IsSystemDefault&&(1==e.isDefault||1==e.IsDefaultView)})}var l,s,c,u={setColDef:e,getColDef:t,setFilterDef:r,getFilterDef:i,setGroupDef:a,getGroupDef:n,getDefaultSavedView:o};return u}e.module("SMART2").service("cacheHelperService",[t])}(angular),function(){"use strict";angular.module("SMART2").factory("cellTemplateProvider",["$filter","$translate","smartDateFormatFilter",function(e,t,r){function i(t,r){if("calculated"==t.type)return t.field&&"IsCloseForReceiving"!=t.field&&"IsCloseForInvoicing"!=t.field?'<div ng-class="{\'text-strikethrough\': row.entity.ItemStatus.id===121}"><div ng-if="!row.groupHeader" >{{'+t.attributes.rule+"|  minPrecisionHandler:"+t.attributes.minmaxprecisionfilter+"}}</div></div>":'<div ng-class="{\'text-strikethrough\': row.entity.ItemStatus.id===121}"><div ng-if="!row.groupHeader" >{{'+t.attributes.rule+"}}</div></div>";if("editable"==t.type){if(t.attributes&&t.attributes.type&&"number"==t.attributes.type){if("cellTemplate"==r)return"<div ng-class=\"{'text-strikethrough': row.entity.ItemStatus.id===121, 'ui-grid-cell-contents right-align paddingRight5': true}\" ng-style=\"{color: COL_FIELD === '' || COL_FIELD == undefined || COL_FIELD == null ? 'transparent' : ''}\" title=\"{{COL_FIELD}}\">{{COL_FIELD === '' || COL_FIELD == undefined || COL_FIELD == null ? '-' : row.entity."+(void 0!=t.data?t.data:t.field)+"}}</div>";if("editableCellTemplate"==r){var i="";void 0!=t.attributes.minmaxprecision&&(i='minmaxprecision="'+t.attributes.minmaxprecision+'"');var a="";return void 0!=t.attributes.maxlength&&(a='maxlength="'+t.attributes.maxlength+'"'),'<div title="{{COL_FIELD }}"><div><smart-textfield  class="ui-grid-cell-contents" type="number" focus="true" '+i+' ng-model="row.entity.'+t.field+'" '+a+' on-key-up="grid.appScope.textOrNumberKeyUp($event,col,row)" zero-case-handler uigrid-compatible></smart-textfield></div></div>'}}else if(t.attributes&&t.attributes.type&&"autocomplete"==t.attributes.type){if("cellTemplate"==r)return"<div ng-class=\"{'text-strikethrough': row.entity.ItemStatus.id===121, 'padding0': true}\" ng-style=\"{color: COL_FIELD === '' || COL_FIELD == undefined || COL_FIELD == null ? 'transparent' : ''}\" title=\"{{COL_FIELD}}\">{{COL_FIELD === '' || COL_FIELD == undefined || COL_FIELD == null ? '-' : COL_FIELD}}</div>";if("editableCellTemplate"==r)return'<div class="padding0" title="{{COL_FIELD}}"><div><smart-textfield class="ui-grid-cell-contents" type="autocomplete" width="230px"  displayformat="'+t.attributes.displayformat+'" optionformat="'+t.attributes.optionformat+'" filterkeys="'+("['"+t.attributes.filterkeys.join("','")+"']")+'" ng-model="row.entity.'+t.attributes.model+'" options="grid.appScope.autoSuggestOptions"  on-change="grid.appScope.autoSuggestOnChange($event,col,row)" on-select="grid.appScope.autoSuggestOnSelect($event,row.entity.'+t.attributes.model+',row,col)" uigrid-compatible></smart-textfield></div></div>'}else if(t.attributes&&t.attributes.type&&"date"==t.attributes.type){if("cellTemplate"==r)return'<div  ng-class=\'{"text-strikethrough": row.entity.ItemStatus.id===121}\' ng-style=\'{color: COL_FIELD === "" || COL_FIELD == undefined || COL_FIELD == null ? "transparent" : "", height: "100%"}\'>{{COL_FIELD === \'\' || COL_FIELD == undefined || COL_FIELD == null ? \'-\' : (COL_FIELD | smartDateFormat:\''+t.attributes.format+"')}}</div>";if("editableCellTemplate"==r)return"<div grid-date-template-provider></div>"}var a="";if(void 0!=t.attributes.maxlength&&(a='maxlength="'+t.attributes.maxlength+'"'),"cellTemplate"==r)return"<div ng-class=\"{'text-strikethrough': row.entity.ItemStatus.id===121, 'padding0': true}\" ng-style=\"{color: COL_FIELD === '' || COL_FIELD == undefined || COL_FIELD == null ? 'transparent' : ''}\" title=\"{{COL_FIELD | translate}}\">{{COL_FIELD === '' || COL_FIELD == undefined || COL_FIELD == null ? '-' : (row.entity."+(void 0!=t.data?t.data:t.field)+" | translate)}}</div>";if("editableCellTemplate"==r)return'<div title="{{COL_FIELD}}"><div><smart-textfield class="ui-grid-cell-contents" type="text" ng-model="row.entity.'+t.field+'" '+a+' on-key-up="grid.appScope.textOrNumberKeyUp($event,col,row)" uigrid-compatible></smart-textfield></div></div>'}else if("dropdown"==t.type){if(t.attributes.options.map(function(r){r[t.attributes.datakey]=e("translate")(r[t.attributes.datakey])}),"cellTemplate"==r)return"<div ng-class='{\"text-strikethrough\": row.entity.ItemStatus.id===121}'><div ng-if='grid.appScope.isObject(COL_FIELD)' style='height:100%;' uigrid-compatible>{{COL_FIELD."+t.attributes.dataKey+" | translate}}</div><div ng-if='!grid.appScope.isObject(COL_FIELD)' IDK={{"+t.attributes.idKey+"}} style='height:100%;' uigrid-compatible>{{COL_FIELD | translate}}</div></div>";if("editableCellTemplate"==r)return"<div class='ui-grid-cell-contents'><form name='inputForm'><select model = {{row.entity."+t.attributes.model+"}} ui-grid-edit-dropdown ng-model='row.entity."+t.attributes.model+"' ng-change='grid.appScope.dropDownOnChange(row.entity, col , row.entity."+t.field+")' ng-options='option."+t.attributes.dataKey+" for option in grid.appScope.dropDownOptions track by option."+t.attributes.idKey+"' uigrid-compatible></select></form></div>"}else if("checkbox"==t.type){if("cellTemplate"==r)return'<div title="{{COL_FIELD}}"><div><smart-checkbox fill="true" class="ui-grid-cell-contents" ng-model="row.entity.'+t.attributes.model+'" on-change="grid.appScope.checkBoxOnChange(row.entity, col , row.entity.'+t.field+')"  uigrid-compatible></smart-checkbox></div></div>'}else if("popup"==t.type){var n="",o='+"-"+';if("undefined"!=typeof t.appendedLabels){for(var l=0;l<t.appendedLabels.length;l++)n=n+"row.entity."+t.appendedLabels[l]+o;n="("+n.slice(0,-o.length)+")"}else n="cellTemplate"==r?"row.entity."+t.field:"COL_FIELD";var s='"'+t.attributes.defaultTitle+'"';if("undefined"!=typeof t.attributes.defaultLabelCondition)var s=t.attributes.defaultLabelCondition;if("cellTemplate"==r)return"categoryPopup"===t.attributes.type?'<div title = "{{COL_FIELD}}" class="ui-grid-cell-contents padding0"><a ng-if="!row.groupHeader" ng-class="{\'waves-effect waves-light btn-flat\': true, \'disabled\': row.entity.source.id!==1,\'text-strikethrough\': row.entity.ItemStatus.id===121}">{{(COL_FIELD != undefined && (COL_FIELD != "") && (COL_FIELD != "1")) ?'+n+" : "+s+"}}</a></div>":'<div title = "{{COL_FIELD}}" class="ui-grid-cell-contents padding0"><a ng-if="!row.groupHeader" ng-class="{\'waves-effect waves-light btn-flat\': true, \'disabled\': '+!t.enableCellEdit+',\'text-strikethrough\': row.entity.ItemStatus.id===121}">{{(COL_FIELD != undefined && (COL_FIELD != "") && (COL_FIELD != "1")) ?'+n+" : "+s+"}}</a></div>";if("editableCellTemplate"==r)return'<div title="{{COL_FIELD}}"><smart-button flat="true"  config=\'{"title": (row.entity.'+t.field+" != undefined && row.entity."+t.field+' != "1" && row.entity.'+t.field+' != "")?'+n+" : "+s+' }\' on-click="grid.appScope.popUpButtonClickCallback(row,col)" uigrid-compatible></smart-button></div>'}else if("subsection"==t.type&&"notes"==t.data){if(t.data&&t.attributes&&void 0!==t.attributes.readonly)return'<div><smart-button flat="true" disable="grid.appScope.IsCellReadOnly(row.entity,\''+t.data+"',"+t.attributes.readonly+')" config=\'{"title":grid.appScope.getCommentText(row.entity.notes)}\' callback-params="row.entity"} callback="grid.appScope.showCommentsPopupCallback"  uigrid-compatible></smart-button><div>'}else if("subsection"==t.type&&"manufacturer"==t.data){if(t.data&&t.attributes&&void 0!==t.attributes.readonly)return'<div title="{{COL_FIELD}}"><smart-button flat="true" disable="grid.appScope.IsCellReadOnly(row.entity,\''+t.data+"',"+t.attributes.readonly+')" config=\'{"title":grid.appScope.setManufacturerDisplayName(row.entity)}\' callback-params="row.entity" callback="grid.appScope.showManufacturerPopupCallback"  uigrid-compatible></smart-button><div>'}else{if("splitType"==t.data)return t.data&&t.attributes&&void 0!==t.attributes.readonly?'<div title="{{COL_FIELD}}"><smart-button flat="true" disable="grid.appScope.IsCellReadOnly(row.entity,\''+t.data+"',"+t.attributes.readonly+')"  config=\'{"title":grid.appScope.splitType(row.entity.splitType)}\'  callback-params="row.entity"} callback="grid.appScope.showSplitsPopup"  uigrid-compatible></smart-button><div>':'<div title="{{COL_FIELD}}"><smart-button flat="true" config=\'{"title":grid.appScope.splitType(row.entity.splitType)}\'  callback-params="row.entity"} callback="grid.appScope.showSplitsPopup"  uigrid-compatible></smart-button><div>';if("splitValue"==t.data)return'<div title="{{COL_FIELD | minPrecisionHandler: '+t.attributes.minmaxprecisionfilter+'}}" class="ui-grid-cell-contents">{{grid.appScope.getSplitValue(row.entity) | minPrecisionHandler: '+t.attributes.minmaxprecisionfilter+"}}</div>";if("taxes"==t.data){if(t.data&&t.attributes&&void 0!==t.attributes.readonly)return'<div title="{{COL_FIELD}}"><smart-button flat="true" disable="grid.appScope.IsCellReadOnly(row.entity,\''+t.data+"',"+t.attributes.readonly+')" config=\'{"title":grid.appScope.showExempted(row.entity)}\' callback-params="row.entity"} callback="grid.appScope.openTaxPopup"  uigrid-compatible></smart-button></div>'}else if("total"==t.data)return'<div title="{{COL_FIELD | minPrecisionHandler:'+t.attributes.minmaxprecisionfilter+'}}" class="ui-grid-cell-contents">{{grid.appScope.getTotal(row.entity) | minPrecisionHandler:'+t.attributes.minmaxprecisionfilter+"}}</div>"}}var a={getCellTemplate:i};return a}]),angular.module("SMART2").directive("gridDateTemplateProvider",["$rootScope","$timeout","$filter",function($rootScope,$timeout,$filter){return{restrict:"A",link:function(scope,element,attrs){function getServerDateFormat(e){e||(e=0);var t=getServerDateInNumber(e);return t?"/Date("+t+")/":t}function getServerDateInNumber(value){var IS_UNEXPECTED_DATE_VALUE=!1;if(value){if("string"===(typeof value).toLowerCase())if(value.indexOf("Date")>-1){var a=(value+"").replace(new RegExp("/","ig"),"");a=a.split("+");var b=eval("new "+a[0]+(a.length>1?")":""))}else IS_UNEXPECTED_DATE_VALUE=!0;else IS_UNEXPECTED_DATE_VALUE=!0;if(IS_UNEXPECTED_DATE_VALUE){if(isNaN(new Date(value)))return new Date(0).getTime();var b=new Date(value)}return b.getTime()}return null}scope.onDateChange=function(e){""!=e&&(scope.row.entity[scope.col.colDef.field]=getServerDateFormat(e),$rootScope.$broadcast("closedPopup"))}},template:'<div style="width:100%;height:100%" ><smart-textfield focus="" set-from-grid=true on-date-change="onDateChange($date)" type="date" ng-model="row.entity[col.colDef.field]" format="{{col.colDef.attributes.format}}" uigrid-compatible></smart-textfield></div>'}}]),angular.module("SMART2").filter("smartDateFormat",["$filter","Common",function(e,t){return function(r,i){var a;try{if(r){var n=t.convertServerDateTimeToNormalDateTime(r);_.contains(i.split(" "),"hh:mm")||(n=new Date(n.getFullYear(),n.getMonth(),n.getDate())),a=e("date")(n,i)}else a=""}catch(o){a=r}return a}}]),angular.module("SMART2").directive("zeroCaseHandler",[function(){return{require:"ngModel",link:function(e,t,r,i){i.$parsers.push(function(e){return isNaN(e)?0:e})}}}])}(),function(){"use strict";angular.module("SMART2").service("Common",[function(){this.convertServerDateTimeToNormalDateTime=function(input){var IS_UNEXPECTED_DATE_INPUT=!1;if("string"===(typeof input).toLowerCase())if(input.indexOf("Date")>-1){var a=(input+"").replace(new RegExp("/","ig"),"");a=a.split("+");var b=eval("new "+a[0]+(a.length>1?")":""))}else IS_UNEXPECTED_DATE_INPUT=!0;else IS_UNEXPECTED_DATE_INPUT=!0;if(IS_UNEXPECTED_DATE_INPUT){if(isNaN(new Date(input)))return input;var b=new Date(input)}return b},this.uniqueIDGenerator=function(){var e=(new Date).getTime(),t="xxx2xxxpxxxoxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)});return t}}]),angular.module("SMART2").filter("minPrecisionHandler",["$filter",function(e){var t=0;return function(r,i,a,n){if("undefined"==typeof RegionalSettingEnable||!RegionalSettingEnable){if(void 0!=r){if(0==r)return e("number")(0,i);if(0!=r){if(t=void 0!=(r+"").split(".")[1]?(r+"").split(".")[1].length:0,t>a){var o=a||0,l=Math.pow(10,o),s=+(o?r*l:r),c=Math.floor(s),u=s-c,d=.5==u?c%2==0?c:c+1:Math.round(s),p=o?d/l:d,f=void 0!=(p+"").split(".")[1]?(p+"").split(".")[1].length:0;return i>f?e("number")(p,i):e("addCommasToNumbers")(p)}if(t>i&&a>t)return e("addCommasToNumbers")(r);if(i>=t)return e("number")(r,i)}return n&&1==n&&0!=r?"":r}return n&&1==n?"":0}var m="";if(isNaN(r))return m+r;var g=r;try{var y,h,v,b=$("<input>"),C=void 0!=i?i:MinPrecessionValue?MinPrecessionValue:2,D=void 0!=a?a:MaxPrecessionValue?MaxPrecessionValue:4;C=parseInt(C),D=parseInt(D),C>D&&(D=C);var o=D||0,l=Math.pow(10,o),s=+(o?g*l:g),c=Math.floor(s),u=s-c,d=.5==u?c%2==0?c:c+1:Math.round(s);if(v=o?d/l:d,Number.isInteger(v))h=C;else{if(Number.isNaN(v))throw"Value cannot change to number.";h=v.toString().split(".")[1].length}y=C>=h?C:h>=D?D:h,b.autoNumeric("init",{mDec:y,aPad:!0}),b.autoNumeric("set",v);var O=b.val();return m+O}catch(S){return console.log(S),console.log("error happend at numberformat filter. value : ("+g+") minPrecessionValue : "+C+" maxPrecessionValue : "+D),m+g}}}]),angular.module("SMART2").service("SmartToast",[function(){this.show=function(e){Materialize.toast(e.message,e.duration?e.duration:500)}}]),angular.module("SMART2").filter("addCommasToNumbers",["$filter",function(e){return function(t){var r=void 0!=(t+"").split(".")[1]?(t+"").split(".")[1]:0,i=void 0!=(t+"").split(".")[0]?(t+"").split(".")[0]:0;return i=e("number")(i),i+"."+r}}]),angular.module("SMART2").service("smartPaginate",[function(){var e,t=[],r=10,i=function(e){t=e},a=function(e,r){return t.slice(e,r)},n=function(t){e=t},o=function(){return e},l=function(){return t},s=function(){return t.length},c=function(){return Math.ceil(t.length/r)-1};return{externalPaginationThreshold:300,setLineItems:i,getLineItems:a,getAllLineItems:l,getLineItemsCount:s,getLineItemsPagesCount:c,setSmartTableInstance:n,getSmartTableInstance:o}}])}(),function(){"use strict";angular.module("SMART2").service("debouncer",["$timeout",function(e){var t;this.add=function(r,i){t&&e.cancel(t),t=e(function(){angular.isFunction(r)&&r()},i?i:1e3)},this.cancel=function(){e.cancel(t),t=null}}])}(),function(){"use strict";angular.module("SMART2").service("$focusOnField",[function(){return function(e){if(e){var t=$(e);"checkbox"==t.attr("type")||"radio"==t.attr("type")?t.focus().addClass("tabbed"):t.focus()}}}])}(),function(){"use strict";angular.module("SMART2").service("formWidgetUtils",[function(){var _this=this;this.getColspanClass=function(e){switch(e){case 1:return"col s12 m6 l4 xl3 xxl2";case 2:return"col s12 m12 l8 xl6 xxl4";case 3:return"col s12 m12 l12 xl9 xxl6";case 4:return"col s12 m12 l12 xl12 xxl8";case 5:return"col s12 m12 l12 xl12 xxl10";case 6:return"col s12 m12 l12 xl12 xxl12";default:return"col s12 m6 l4 xl3 xxl2"}},this.convertAndGetValue=function(val,scope,property){if(""==val||void 0==val||null==val)return!1;var dataType;try{dataType=typeof eval(val)}catch(e){}if(void 0==dataType){if(val.indexOf(")")==val.length-1)return eval(this.generateFunctionWithParams(val,"scope.$parent"));var result=eval("scope.$parent."+val);if(dataType=typeof result,"boolean"==dataType)return result;dataType="function"==dataType?"function":"string"}return"function"==dataType?eval(this.generateFunctionWithParams(val,"scope.$parent")):"string"==dataType?eval("scope.$parent."+val):eval(val)},this.mapEvents=function(e){if("object"==typeof e){for(var t="",r=e.length,i=0;r>i;i++){var a=e[i];a.listener&&(t=t+" "+a.type+'="'+a.listener+'"')}return t+" "}return""},this.getParamsFromEvents=function(event,scopeString){var params=event.split("(");if(params.length>1){params=params[1].trim().split(")"),params=params[0].split(",");for(var arrIndexesToBeDeleted=[],tLen=params.length,i=0;tLen>i;i++)if(params[i]=params[i].trim(),"$event"!=params[i])if(""==params[i])arrIndexesToBeDeleted.push(params[i]);else{var paramValue=void 0;try{paramValue=eval(params[i])}catch(e){}angular.isDefined(paramValue)?params[i]=params[i].trim():params[i]=(""==scopeString||void 0==scopeString||null==scopeString?"":scopeString+".")+params[i].trim()}for(var deleteLength=arrIndexesToBeDeleted.length,i=0;deleteLength>i;i++)params.splice(arrIndexesToBeDeleted[i],1)}else params=[];return params},this.generateFunctionWithParams=function(e,t,r){var i="";if(!e)return i;var a=this.getParamsFromEvents(e,t);return i=e.split("(")[0].trim(),a.length>0?(a.push(r?"section":"property"),i=t+"."+i+"("+a.join(",")+")"):i=t+"."+i+(r?"(section)":"(property)"),i},this.convertAndGetAttributeMapping=function(attributeType,key,attr,bindingType,scope,isSection){var str=attr+'="'+("@"==bindingType?"{{":"")+(isSection?"section.":"primary"==attributeType?"property.":"property.attributes.")+key+("@"==bindingType?"}}":"")+'"',dataType,objProperty;objProperty="primary"==attributeType&&isSection?scope.section:"primary"!=attributeType||isSection?scope.property.attributes:scope.property;try{dataType=typeof eval(objProperty[key])}catch(e){}return void 0==dataType&&(dataType=typeof eval("scope.parentScope."+objProperty[key]),str="function"==dataType?attr+'="'+("@"==bindingType?"{{":"")+this.generateFunctionWithParams(objProperty[key],"parentScope",isSection)+("@"==bindingType?"}}":"")+'"':attr+'="'+("@"==bindingType?"{{":"")+"parentScope."+objProperty[key]+("@"==bindingType?"}}":"")+'"')," "+str+" "},this.getAttributesMapping=function(attributeType,attrs,scope,isSection){var str="";if("primary"==attributeType)for(var key in attrs)switch(key){case"isMandatory":str+=this.convertAndGetAttributeMapping(attributeType,key,"is-mandatory","@",scope,isSection);break;case"isVisible":str+=this.convertAndGetAttributeMapping(attributeType,key,"is-visible","=",scope,isSection);break;case"isCollapsible":str+=this.convertAndGetAttributeMapping(attributeType,key,"is-collapsible","@",scope,isSection);break;case"isDraggable":str+=this.convertAndGetAttributeMapping(attributeType,key,"is-draggable","@",scope,isSection);break;case"isActive":str+=this.convertAndGetAttributeMapping(attributeType,key,"is-active","=",scope,isSection);break;case"isHeader":str+=this.convertAndGetAttributeMapping(attributeType,key,"is-header","@",scope,isSection);break;case"headerTemplate":str+=' header-template="{{section.'+key+'}}" ';break;case"modelOptions":str+=this.convertAndGetAttributeMapping(attributeType,key,"model-options","=",scope,isSection);break;case"id":str+=' id="{{property.'+key+'}}" ';break;case"masterData":str+=' master-data="{{property.'+key+'}}" ';break;case"enableMasterData":str+=' enable-master-data="{{property.'+key+'}}" ';break;case"rules":str+=this.convertAndGetAttributeMapping(attributeType,key,"rules","@",scope,isSection);break;case"errorModel":str+=this.convertAndGetAttributeMapping(attributeType,key,"error-model","=",scope,isSection);break;case"clienterror":str+=this.convertAndGetAttributeMapping(attributeType,key,"clienterror","=",scope,isSection);break;case"currencySymbol":str+=this.convertAndGetAttributeMapping(attributeType,key,"currency-symbol","=",scope,isSection)}else for(var key in attrs)switch(key){case"type":if("textfield"==scope.property.type){var textfieldTypes=["text","number","date","time","dateTime","area","autocomplete"];if(-1==textfieldTypes.indexOf(scope.property.attributes.type)){var arrSplitFunction=scope.property.attributes.type.split("("),evalResult,property=scope.property;arrSplitFunction.length>1?evalResult=eval("scope."+this.generateFunctionWithParams(scope.property.attributes.type,"parentScope")):(evalResult=eval("scope.parentScope."+scope.property.attributes.type),"function"==typeof evalResult&&(evalResult=eval("scope."+this.generateFunctionWithParams(scope.property.attributes.type,"parentScope")))),str+=' type="'+evalResult+'"'}else str+=' type="{{property.attributes.type}}" '}break;case"options":str+="string"==typeof eval("scope.property.attributes.options")?' options="parentScope.'+scope.property.attributes.options+'" ':' options="property.attributes.options" ';break;case"readonly":case"disable":str+=this.convertAndGetAttributeMapping(attributeType,key,key,"@",scope,isSection);break;case"ngModelOptions":str+=' ng-model-options="property.attributes.ngModelOptions" ';break;case"validateOn":str+=' validate-on="{{property.attributes.validateOn}}" ';break;default:var attrList=[];"textfield"==scope.property.type?attrList=["validate","focus","parentelement","errormessage","setfromgrid","align","datanumeric","spinner","patternreg","step","format","timepicker","isvaluedateobj","prefixicon","suffixicon","maxlength","min","max","timepicker12hour","minuteincrement","charactercounter","decimalprecision","minmaxprecision","placeholder","autocomplete","removable","datakey","filterkeys","optionformat","displayformat","width","minchars","loading","count","nosuggestionnotice","shownosuggestion","ngmodel","smart-character-restrict","showinfo","showwarning","allowpaste","currency-symbol"]:"select"==scope.property.type||"dropdown"==scope.property.type?attrList=["label","ngmodelcopy","validate","focus","parentelement","multiple","datakey","displaykey","removable","preview","customoption","ngmodel","config","show","stopprog","showinfo","showwarning"]:"radio"==scope.property.type?attrList=["label","ngmodelcopy","layout","validate","focus","parentelement","errormessage","datakey","optionid","removable","groupid","ngmodel"]:"checkbox"==scope.property.type?attrList=["label","minheight","fill","validate","focus","parentelement","errormessage","removable","ngmodel","showinfo"]:"switch"==scope.property.type&&(attrList=["label","rightlabel","leftlabel","validate","focus","parentelement","errormessage","removable","minheight","fill","ngmodel"]),attrList.indexOf(key.toLowerCase())>-1&&(str+=" "+key+'="{{property.attributes.'+key+'}}" ')}return str};var arrEvents=[],eventCounter=0;this.removeEventListener=function(e){for(var t=arrEvents.length,r=0;t>r;r++){var i=arrEvents[r];if(i.eventName==e.eventName&&i.eventId==e.eventId){i.callback=null,arrEvents.splice(r,1);break}}},this.on=function(e,t){eventCounter++,arrEvents.push({eventName:e,callback:t,eventId:"smart-broadcast-event-"+eventCounter});var r={eventName:e,eventId:"smart-broadcast-event-"+eventCounter};return function(){_this.removeEventListener(r)}},this.broadcast=function(e,t){for(var r=arrEvents.length,i=0;r>i;i++){var a=arrEvents[i];e==a.eventName&&angular.isFunction(a.callback)&&a.callback({},t)}},this.watch=function(e,t,r){Object.defineProperty(angular.isDefined(e)&&angular.isObject(e)?e:window,t,{get:function(){return this["custom_watcher_"+t]},set:function(e){if(!angular.equals(this["custom_watcher_"+t],e)){var i=this["custom_watcher_"+t];this["custom_watcher_"+t]=e,angular.isFunction(r)&&r(e,i)}},enumerable:!0,configurable:!0})},this.showPleaseWait=function(){angular.element("#divPleaseWait").css("display","table")},this.hidePleaseWait=function(){angular.element("#divPleaseWait").css("display","none")}}])}(),function(){"use strict";angular.module("SMART2").service("gridConfigProvider",["cellTemplateProvider","$filter","formWidgetUtils","APPCONSTANTS",function(cellTemplateProvider,$filter,formWidgetUtils,APPCONSTANTS){function getDefaultGridConfigObject(){return{field:"",displayName:"",groupingShowAggregationMenu:!1,enableHiding:!1,groupingShowGroupingMenu:!1,enablePinning:!1}}function getGridConfig(conf,scope,cellClassFunction,cellEditableConditionFunction){var finalObject=_.extend(new getDefaultGridConfigObject,conf);if(void 0!=finalObject.isVisible&&(finalObject.visible=formWidgetUtils.convertAndGetValue(finalObject.isVisible,scope,finalObject)),finalObject.enableCellEdit=!0,void 0!=finalObject.isReadOnly&&(finalObject.enableCellEdit=!formWidgetUtils.convertAndGetValue(finalObject.isReadOnly,scope,finalObject)),finalObject.isFixed&&("Left"==finalObject.isFixed&&(finalObject.pinnedLeft=!0),"Right"==finalObject.isFixed&&(finalObject.pinnedRight=!0),finalObject.maxWidth=260),finalObject.isGrouped&&(finalObject.grouping={groupPriority:0}),finalObject.aggregation&&(finalObject.treeAggregationType=2),finalObject.displayKey=finalObject.displayName,finalObject.isMandatory?finalObject.displayName=$filter("translate")(finalObject.displayName)+" *":finalObject.displayName=$filter("translate")(finalObject.displayName),finalObject.type)switch(finalObject.type){case"popup":finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"cellTemplate"),finalObject.editableCellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"editableCellTemplate");break;case"editable":finalObject.attributes&&"date"==finalObject.attributes.type&&(finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"cellTemplate"),finalObject.editableCellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"editableCellTemplate")),finalObject.attributes&&"autocomplete"==finalObject.attributes.type&&((void 0==finalObject.cellTemplate||null==finalObject.cellTemplate)&&(finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"cellTemplate")),finalObject.editableCellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"editableCellTemplate")),finalObject.attributes&&"number"==finalObject.attributes.type&&(finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"cellTemplate"),finalObject.editableCellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"editableCellTemplate")),!finalObject.attributes||"text"!=finalObject.attributes.type&&void 0!=finalObject.attributes.type||(finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"cellTemplate"),finalObject.editableCellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"editableCellTemplate"));break;case"dropdown":finalObject.attributes.idKey||(finalObject.attributes.idKey="id"),finalObject.editableCellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"editableCellTemplate"),finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"cellTemplate");break;case"calculated":finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject),finalObject.enableCellEdit&&(finalObject.enableCellEdit=!1);break;case"checkbox":finalObject.cellTemplate=cellTemplateProvider.getCellTemplate(finalObject,"cellTemplate")}return finalObject.cellClass=cellClassFunction,finalObject.cellEditableCondition=cellEditableConditionFunction,finalObject.hasOwnProperty("filterObject")?(finalObject.enableFiltering=finalObject.filterObject.enableFiltering,finalObject.enableFiltering&&(finalObject.filter={placeholder:$filter("translate")("P2P_Common_Search")},finalObject.filterObject.hasOwnProperty("filterKeys")?finalObject.filter.condition=function(searchTerm,cellValue,row,col){var result=!1;("object"!=typeof finalObject.filterObject.filterKeys||"object"!=typeof cellValue||"object"==typeof finalObject.filterObject.filterKeys&&0==finalObject.filterObject.filterKeys.length)&&(result=!0);for(var key in cellValue)finalObject.filterObject.filterKeys.indexOf(key)>-1&&"string"==typeof cellValue[key]&&cellValue[key].toLowerCase().indexOf(searchTerm.toLowerCase())>-1&&(result=!0);var cellConditionResult=!0;if(angular.isDefined(finalObject.filterObject.cellCondition))try{cellConditionResult=eval(finalObject.filterObject.cellCondition)}catch(e){}return result&&cellConditionResult}:finalObject.filterObject.isDate?finalObject.filter.condition=function(searchTerm,cellValue,row,col){var result=!1;if((void 0==searchTerm||null==searchTerm||angular.isDefined(searchTerm)&&""==searchTerm.trim())&&(result=!0),!angular.isDefined(searchTerm)||void 0!=cellValue&&null!=cellValue||(result=!1),angular.isDefined(searchTerm)&&angular.isDefined(cellValue)){var formattedDate=cellValue.replace(new RegExp("/","ig"),"");formattedDate=formattedDate.split("+"),formattedDate=eval("new "+formattedDate[0]+(formattedDate.length>1?")":""));var month=formattedDate.getMonth()+1+"";1===month.length&&(month="0"+month),formattedDate=formattedDate.getDate()+"/"+month+"/"+formattedDate.getFullYear(),result=formattedDate.toLowerCase().trim().indexOf(escape(searchTerm).replace(/%5C/g,"").trim())>-1;var cellConditionResult=!0;try{cellConditionResult=eval(finalObject.filterObject.cellCondition)}catch(e){}return result&&cellConditionResult}}:finalObject.filterObject.hasOwnProperty("cellCondition")&&(finalObject.filter.condition=function(searchTerm,cellValue,row,col){var result=!1;result=cellValue&&cellValue.toLocaleLowerCase().indexOf(searchTerm)>-1?!0:!1;var cellConditionResult=!0;try{cellConditionResult=eval(finalObject.filterObject.cellCondition)}catch(e){}return result&&cellConditionResult}))):finalObject.enableFiltering=!1,finalObject.uiType=finalObject.type,delete finalObject.type,finalObject}function getSmartTableConfig(conf,scope,cellClassFunction,cellEditableConditionFunction){var finalObject=_.extend(new getDefaultGridConfigObject,conf);if(void 0!=finalObject.isVisible&&(finalObject.visible=formWidgetUtils.convertAndGetValue(finalObject.isVisible,scope,finalObject)),finalObject.enableCellEdit=!0,void 0!=finalObject.isReadOnly&&(finalObject.enableCellEdit=!formWidgetUtils.convertAndGetValue(finalObject.isReadOnly,scope,finalObject)),finalObject.isFixed&&("Left"==finalObject.isFixed&&(finalObject.pinnedLeft=!0),"Right"==finalObject.isFixed&&(finalObject.pinnedRight=!0),finalObject.maxWidth=260),finalObject.isGrouped&&(finalObject.grouping={groupPriority:0}),finalObject.aggregation&&(finalObject.treeAggregationType=2),finalObject.displayKey=finalObject.displayName,finalObject.isMandatory?finalObject.displayName=$filter("translate")(finalObject.displayName)+" *":finalObject.displayName=$filter("translate")(finalObject.displayName),finalObject.type)switch(finalObject.type){case"dropdown":finalObject.attributes.idKey||(finalObject.attributes.idKey="id");break;case"calculated":finalObject.cellTemplate=function(row,column){function BankerevenRound(e,t){var r=t||0,i=Math.pow(10,r),a=+(r?e*i:e),n=Math.floor(a),o=a-n,l=.5==o?n%2==0?n:n+1:Math.round(a);return r?l/i:l}if(column.colDef.field&&"IsCloseForReceiving"!=column.colDef.field&&"IsCloseForInvoicing"!=column.colDef.field){var inputValue=0;if(!column.colDef.field||"subtotal"!=column.colDef.field.toLowerCase()&&"total"!=column.colDef.field.toLowerCase())inputValue=eval(column.colDef.attributes.rule);else{var unitPriceRounding=0,taxesRounding=0,shippingChargesRounding=0,otherChargesRounding=0;unitPriceRounding=BankerevenRound(parseFloat(row.entity.unitPrice)*parseFloat(row.entity.quantity),parseInt(column.colDef.attributes.minmaxprecisionfilter.split(":")[1])),taxesRounding=row.entity.taxes>0?BankerevenRound(parseFloat(row.entity.taxes),parseInt(column.colDef.attributes.taxesandchargestotal)):0,shippingChargesRounding=row.entity.shippingCharges>0?BankerevenRound(parseFloat(row.entity.shippingCharges),parseInt(column.colDef.attributes.taxesandchargestotal)):0,otherChargesRounding=row.entity.otherCharges>0?BankerevenRound(parseFloat(row.entity.otherCharges),parseInt(column.colDef.attributes.taxesandchargestotal)):0,column.colDef.field&&"subtotal"==column.colDef.field.toLowerCase()?inputValue=unitPriceRounding:column.colDef.field&&"total"==column.colDef.field.toLowerCase()&&(inputValue=unitPriceRounding+taxesRounding+shippingChargesRounding+otherChargesRounding)}return $filter("minPrecisionHandler")(inputValue,column.colDef.attributes.minmaxprecisionfilter.split(":")[0],column.colDef.attributes.minmaxprecisionfilter.split(":")[1],!1)}return eval(column.colDef.attributes.rule)},finalObject.enableCellEdit=!1;break;case"popup":switch(finalObject.attributes.type){
case"splitsPopup":finalObject.cellTemplate=function(e,t){return(void 0!=e.entity.type||null!=e.entity.type)&&0==e.entity.splitType?1==e.entity.type.id?$filter("translate")("P2P_Common_Quantity"):$filter("translate")("P2P_Common_Amount"):$filter("translate")("P2P_Common_Percentage")};break;case"commentsAndAttachmentsPopup":finalObject.cellTemplate=function(e,t){return e.entity.notes&&e.entity.notes.length>0?$filter("translate")("P2P_Common_View"):$filter("translate")("P2P_Common_Add")};break;case"customAttributesPopup":finalObject.placeHolder=$filter("translate")("P2P_Common_View");break;case"manufacturerPopup":finalObject.cellTemplate=function(e,t){return(e.entity.manufacturer||e.entity.manufacturerPartNumber||e.entity.ManufacturerModel)&&(e.entity.manufacturerName=e.entity.manufacturer+":"+e.entity.manufacturerPartNumber+":"+e.entity.ManufacturerModel),e.entity.manufacturerName?e.entity.manufacturerName:$filter("translate")("P2P_Common_Add")};break;case"categoryPopup":finalObject.debounce=250;break;case"taxesPopup":finalObject.cellTemplate=function(e,t){return e.entity.isTaxExempt?$filter("translate")("P2P_Common_Exempt"):38==APPCONSTANTS.userPreferences.DocumentTypeId?"Taxable":e.entity.taxes}}}switch(finalObject.cellClass=cellClassFunction,finalObject.cellEditableCondition=cellEditableConditionFunction,finalObject.hasOwnProperty("filterObject")?(finalObject.enableFiltering=finalObject.filterObject.enableFiltering,finalObject.enableFiltering&&(finalObject.filter={placeholder:$filter("translate")("P2P_Common_Search")},finalObject.filterObject.hasOwnProperty("filterKeys")?finalObject.filter.condition=function(searchTerm,cellValue,row,col){var result=!1;("object"!=typeof finalObject.filterObject.filterKeys||"object"!=typeof cellValue||"object"==typeof finalObject.filterObject.filterKeys&&0==finalObject.filterObject.filterKeys.length)&&(result=!0);for(var key in cellValue)finalObject.filterObject.filterKeys.indexOf(key)>-1&&"string"==typeof cellValue[key]&&cellValue[key].toLowerCase().indexOf(searchTerm.toLowerCase())>-1&&(result=!0);var cellConditionResult=!0;if(angular.isDefined(finalObject.filterObject.cellCondition))try{cellConditionResult=eval(finalObject.filterObject.cellCondition)}catch(e){}return result&&cellConditionResult}:finalObject.filterObject.isDate?finalObject.filter.condition=function(searchTerm,cellValue,row,col){var result=!1;if((void 0==searchTerm||null==searchTerm||angular.isDefined(searchTerm)&&""==searchTerm.trim())&&(result=!0),!angular.isDefined(searchTerm)||void 0!=cellValue&&null!=cellValue||(result=!1),angular.isDefined(searchTerm)&&angular.isDefined(cellValue)){var formattedDate=cellValue.replace(new RegExp("/","ig"),"");formattedDate=formattedDate.split("+"),formattedDate=eval("new "+formattedDate[0]+(formattedDate.length>1?")":""));var month=formattedDate.getMonth()+1+"";1===month.length&&(month="0"+month),formattedDate=formattedDate.getDate()+"/"+month+"/"+formattedDate.getFullYear(),result=formattedDate.toLowerCase().trim().indexOf(escape(searchTerm).replace(/%5C/g,"").trim())>-1;var cellConditionResult=!0;try{cellConditionResult=eval(finalObject.filterObject.cellCondition)}catch(e){}return result&&cellConditionResult}}:finalObject.filterObject.hasOwnProperty("cellCondition")&&(finalObject.filter.condition=function(searchTerm,cellValue,row,col){var result=!1;result=cellValue&&cellValue.toLocaleLowerCase().indexOf(searchTerm)>-1?!0:!1;var cellConditionResult=!0;try{cellConditionResult=eval(finalObject.filterObject.cellCondition)}catch(e){}return result&&cellConditionResult})),"splitsPopup"==finalObject.attributes.type&&(finalObject.filter.condition=function(e,t,r){return(0==t.splitType?1==t.type.id?"Quantity":"Amount":"Percentage").toLowerCase().indexOf(e.toLowerCase())>-1})):finalObject.enableFiltering=!1,finalObject.field){case"total":finalObject.sortCondition=function(data,column,isAscending){return angular.isDefined(column.attributes.rule)?data.sort(function(a,b){return a=eval(column.attributes.rule.replace(/row.entity/g,"a")),b=eval(column.attributes.rule.replace(/row.entity/g,"b")),a>b?isAscending?-1:1:b>a?isAscending?1:-1:0}):data}}return finalObject.uiType=finalObject.type,delete finalObject.type,finalObject}this.getMassagedGirdConfig=function(e,t,r,i){var a=[];return _.each(e,function(e){a.push(getGridConfig(e,t,r,i))}),a},this.getMassagedSmartTableConfig=function(e,t,r,i){var a=[];return _.each(e,function(e){a.push(getSmartTableConfig(e,t,r,i))}),a},this.eavluateScopeBindedExpressions=function(e,t,r){return formWidgetUtils.convertAndGetValue(e,t,r)}}])}(),function(){"use strict";angular.module("SMART2").service("httpService",["$http","$q","APPCONSTANTS",function(e,t,r){delete e.defaults.headers.common["X-Requested-With"];var i=this,a=[];i.isNetworkOnline=!0,i.massageResultData=function(e){return e.success=!0,e.config.timeout&&angular.isDefined(e.config.timeout.status)?(e.status=e.config.timeout.status,e.statusText=e.config.timeout.statusText,e.success=!1):-1==[200,201,202,203].indexOf(e.status)&&(e.statusText="An error occured while fetching data.",e.success=!1),e},i.abortAll=function(e){angular.forEach(a,function(t){t.canceller.promise.status=e?0:499,t.canceller.promise.statusText=e?"The Internet connection appears to be offline.":"Request cancelled.",t.canceller.resolve()}),a=[]},i.abort=function(e){if(e){var t=void 0;t=_.find(a,function(t){return t.url==e.url&&angular.equals(t.requestArgs,e.params?e.params:e.data?e.data:{})}),t.canceller.promise.status=499,t.canceller.promise.statusText="Request cancelled.",t.canceller.resolve(),a=_.filter(a,function(t){return t.url!=e.url&&!angular.equals(t.requestArgs,e.params?e.params:e.data?e.data:{})})}},i.directhttp=function(n){var o,l=t.defer(),s=t.defer(),c=angular.isDefined(n.abortable)&&0==n.abortable?!1:!0,u=setTimeout(function(){s.promise.status=408,s.promise.statusText="Request timed out.",s.resolve()},angular.isDefined(n.timeout)?n.timeout:12e4);c&&a.push({url:n.url,requestArgs:n.params||n.data,canceller:s});var d={url:n.url,method:n.method?n.method.toUpperCase():"POST",cache:!1,timeout:s.promise,headers:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(r.userPreferences.UserBasicDetails)}};return!d.headers.RequestVerificationToken&&$("#hdnToken").val()&&(d.headers.RequestVerificationToken=$("#hdnToken").val()),angular.merge(d,n),o=e(d).then(function(e){e=i.massageResultData(e),e.success?l.resolve(e.data):l.reject(e)},function(e){e=i.massageResultData(e),l.reject(e)}),o["finally"](function(){clearTimeout(u),c&&(a=_.filter(a,function(e){return e.url!=n.url&&!angular.equals(e.requestArgs,n.params?n.params:n.data?n.data:{})}))}),l.promise}}])}(),function(){"use strict";angular.module("SMART2").service("menuListItemServ",[function(){return function(e){var t=e;null==t.parent().attr("role")&&t.parent().attr("role","listbox"),null==t.attr("isItemList")&&0!=t.length&&t.on("keydown",function(e){var t=$(this);40==e.keyCode?(e.preventDefault(),t.next().focus()):38==e.keyCode?(e.preventDefault(),t.prev().focus()):13==e.keyCode&&(e.preventDefault(),void 0!=t.find("[ng-click]")||void 0!=t.find("[href]")?t.find("[ng-click]").length>0?t.find("[ng-click]").trigger("click"):t.find("[href]").trigger("click"):void 0!=t.attr("ng-click")&&t.trigger("click"))}),t.attr("role","option").attr("isItemList","").attr("tabindex","0").children().attr("tabindex","-1")}}])}(),function(){"use strict";angular.module("SMART2").service("NoolsEngine",[function(){this.execute=function(e){var t=[],r=[],i=e.uiConfig,a=e.dataModel,n=e.type,o=e.rules,l=e.scope;"grid"==n?_.each(i[0].cloumnDefs,function(e){t.push({field:e.field,type:e.type})}):"header"==n&&_.each(i.sections,function(e){_.each(e.rows[0].properties,function(e){t.push({field:e.data,type:e.type,attributes:e.attributes})})});var s=nools.compile(o,{name:"totalErrors"}),c=s.getDefined("message");return a="grid"==n?a.orderData.items[0]:a,_.each(t,function(e){var t=[new c({ui:e,dataModel:a,scope:l})],i=s.getSession.apply(s,t).focus("empty");i.on("error",function(e){r.push(e.errors[0])}).on("fire",function(e){}),i.match(function(e){i.dispose(),nools.deleteFlow("totalErrors")})}),0==r.length?angular.isFunction(e.success)&&e.success():angular.isFunction(e.error)&&e.error({data:r}),a}}])}(),function(angular,window){"use strict";function persistenceServiceFunc(e,t,r,i,a,n,o){function l(e,t){y.redirectToPreviousNode(e,t)}function s(e){"object"==typeof h&&"undefined"==typeof h.length&&angular.extend(h,m.getUserData(m.storeLocation.DB,e))}function c(e,t){void 0==h&&(h={}),h[e]=t}function u(e,t,r,i){"undefined"!=typeof e.documentType&&(v=e.documentType,y.getModelData(v,t,r,i))}function d(e,t){y.saveRecentDocument(e,t)}function p(e){y.saveWorkspaceRecentDocument(e)}function f(e){"object"==typeof h&&"undefined"==typeof h.length&&m.saveUserData(m.storeLocation.DB,e,null,h)}var m=i,g=a,y=n,h={},v="",b=o,C=function(e,t){b.setDocumentFields(e,t)},D=function(e){return b.getDocumentFields(e)},O={userData:h,api:m,sectionPersistence:g,nPlusOne:y,getUserData:s,updateUserData:c,saveUserData:f,redirectToPreviousNode:l,getModelData:u,saveRecentDocument:d,saveWorkspaceRecentDocument:p,masterPersistenceService:b,setDocumentFields:C,getDocumentFields:D};return O}function persistenceApiServiceFunc(e,t,r,i,a,n,o){function l(e){return"undefined"!=typeof localStorage[e]&&""!=localStorage[e]?localStorage[e]:null}function s(e){return"undefined"!=typeof sessionStorage[e]&&""!=sessionStorage[e]?sessionStorage[e]:null}function c(e){return"undefined"!=typeof indexedDB[e]&&""!=indexedDB[e]?indexedDB[e]:null}function u(t){var r={contactCode:e.userPreferences.UserBasicDetails.ContactCode,partnerCode:e.userPreferences.UserBasicDetails.BuyerPartnerCode,documentType:t};$.ajax({url:e.userPreferences.URLs.AppURL+"/getSmartActions?oloc="+e.oloc.Persistence+"&c="+e.userPreferences.EncryptedBPC,method:"POST",async:!1,dataType:"json",timeout:3e3,data:JSON.stringify(r),contentType:"application/json",headers:{"Access-Control-Allow-Origin":"*"},success:function(e){if(e){if(e.length>0)for(;"string"==typeof e;)e=JSON.parse(e);if("undefined"!=typeof e[0]&&"undefined"!=typeof e[0].events){for(;"string"==typeof e[0].events;)e[0].events=JSON.parse(e[0].events);b=e[0].events}}},error:function(e){}})}function d(e,t){null!=e&&""!=e&&(localStorage[e]=t)}function p(e,t){null!=e&&""!=e&&(sessionStorage[e]=t)}function f(e,t){null!=e&&""!=e&&(indexedDB[e]=t)}function m(t,r,i){var n={method:"POST",params:{bpc:e.userPreferences.EncryptedBPC},url:e.userPreferences.URLs.AppURL+"/saveSmartActions?oloc="+e.oloc.Persistence+"&c="+e.userPreferences.EncryptedBPC,header:{"Content-Type":"application/json",UserExecutionContext:JSON.stringify(e.userPreferences.UserBasicDetails),Pragma:"no-cache","Access-Control-Allow-Origin":"*"}};"undefined"==typeof i&&(i=t);var o={contactCode:e.userPreferences.UserBasicDetails.ContactCode,partnerCode:e.userPreferences.UserBasicDetails.BuyerPartnerCode,documentType:i,events:JSON.stringify(r)};n.data=angular.toJson(o),a(n).then(function(e){})}function g(e,t,r){return 1==e?(u(t),b):2==e?l(r):3==e?s(r):4==e?c(r):void 0}function y(e,t,r,i,a){1==e?m(t,i,a):2==e?d(r,i):3==e?p(r,i):4==e&&f(r,i)}function h(t,r,i){var a={contactCode:e.userPreferences.UserBasicDetails.ContactCode,partnerCode:e.userPreferences.UserBasicDetails.BuyerPartnerCode,cultureCode:e.userPreferences.UserCountryCultureInfo};angular.extend(a,t),$.ajax({url:e.userPreferences.URLs.AppURL+"/getPersistanceSmartData?oloc="+e.oloc.Persistence,method:"POST",async:!0,dataType:"json",timeout:3e3,data:JSON.stringify(a),contentType:"application/json",headers:{"Access-Control-Allow-Origin":"*"},success:function(e){if(e){if(e.length>0)for(;"string"==typeof e;)e=JSON.parse(e);if(e.hasOwnProperty("data")){var t=e.data,r=Object.keys(t),a=0;for(a;a<r.length;a++)i.hasOwnProperty(r[a])&&i[r[a]].length>0?i[r[a]].splice(0,i[r[a]].length-1):i[r[a]]=[],angular.extend(i[r[a]],t[r[a]])}}},error:function(e){}})}function v(t,r,i){var a={contactCode:e.userPreferences.UserBasicDetails.ContactCode,partnerCode:e.userPreferences.UserBasicDetails.BuyerPartnerCode,cultureCode:e.userPreferences.UserCountryCultureInfo};angular.extend(a,t),$.ajax({url:e.userPreferences.URLs.AppURL+"/savePersistanceSmartData?oloc="+e.oloc.Persistence,method:"POST",async:!0,dataType:"json",data:JSON.stringify(a),contentType:"application/json",headers:{"Access-Control-Allow-Origin":"*"},success:function(e){if(e){if(e.length>0)for(;"string"==typeof e;)e=JSON.parse(e);if(e.hasOwnProperty("data")){var t=e.data,r=Object.keys(t),a=0;for(a;a<r.length;a++)i.hasOwnProperty(r[a])&&i[r[a]].length>0?i[r[a]].splice(0,i[r[a]].length-1):i[r[a]]=[],angular.extend(i[r[a]],t[r[a]])}}},error:function(e){}})}var b={},C={DB:1,LocalStorage:2,SessionStorage:3,IndexDB:4},D={storeLocation:C,getUserData:g,saveUserData:y,userData:b,getMasterUserDataFromDB:h,saveMasterUserDataToDB:v};return D}function sectionsPersistenceServiceFunc(e,t,r,i){function a(e){try{return"undefined"!=typeof e.sections?e.sections:[]}catch(t){}return[]}function n(e,t){"undefined"==typeof s[0]&&(s={}),_state=e,s[e]=t}function o(e,t){try{""!=_state?s[_state][e]=t:s[e]=t}catch(r){}}function l(e,t){if(e&&"undefined"!=typeof e.documentType){var r=a(t);if(r&&r.length>0){var i=100;angular.forEach(e.sections,function(e){if("undefined"!=typeof e.id){for(var t=0;t<r.length;t++)if(e.id==r[t]){e.sectionIndex=t;break}}else i++,e.sectionIndex=i}),e.sections=_.sortBy(e.sections,"sectionIndex")}}}var s={},c={getSectionsPersistence:l,setState:n,setUserData:o};return c}function nPlusOneServiceFunc(APPCONSTANTS,$window,$timeout,PLATFORMURLs,persistenceApiService,$state){function _redirectToPreviousNode(e,t){var r=!1;if(($state.current.url.indexOf("rfx")>-1||$state.current.url.indexOf("scorecard")>-1||$state.current.url.indexOf("form")>-1)&&(r=states.indexOf($state.current.url)>-1?!1:!0),"undefined"!=typeof t&&null!=t)return void(window.location.href=t);if(r)history.go(-1);else if(_historyIsEmpty())"undefined"!=typeof e&&1==e?window.location.href=APPCONSTANTS.appContextUrl:"undefined"!=typeof t?window.location.href=t:history.go(-1);else if("undefined"!=typeof sessionStorage.workspace2_Enabled)if(1==sessionStorage.workspace2_Enabled||"true"==sessionStorage.workspace2_Enabled){var i=persistenceApiService.getUserData(persistenceApiService.storeLocation.SessionStorage,"","recentDocuments");if("undefined"!=typeof i&&null!=i&&"undefined"!=i&&"string"==typeof i&&(i=JSON.parse(i),0==i.length&&(i=[])),i.length>1){if(i.length>2&&i[i.length-1].hasOwnProperty("docType")&&(1==i[i.length-1].docType||5==i[i.length-1].docType||6==i[i.length-1].docType)&&i[i.length-2].hasOwnProperty("docType")&&i[i.length-2].hasOwnProperty("docCode")&&-9==i[i.length-2].docType&&-1!=i[i.length-2].docCode.search("landingmax")&&-1!=i[i.length-2].docCode.search("template")&&i[i.length-3].hasOwnProperty("docType")&&21==i[i.length-3].docType){var a=i[i.length-3];return i.splice(i.length-2,2),sessionStorage.recentDocuments=JSON.stringify(i),void("undefined"!=typeof t?window.location.href=t:a.hasOwnProperty("urlFormat")&&""==a.urlFormat?history.go(-1):window.location.href=buildUrl(a))}var a=i[i.length-2];"/PPST/Project/Index"==window.location.pathname?history.go(-1):a.hasOwnProperty("urlFormat")&&""!=a.urlFormat&&a.urlFormat.indexOf("PPST/QuickCreate/QuickCreateProject")>-1?(a=i[i.length-3],i.splice(i.length-2,2),sessionStorage.recentDocuments=JSON.stringify(i),window.location.href=buildUrl(a)):(i.splice(i.length-1,1),sessionStorage.recentDocuments=JSON.stringify(i),"undefined"!=typeof t?window.location.href=t:a.hasOwnProperty("urlFormat")&&""==a.urlFormat?(i.splice(i.length-1,1),sessionStorage.recentDocuments=JSON.stringify(i),history.go(-1)):window.location.href=buildUrl(a))}}else history.go(-1)}function _historyIsEmpty(){if("undefined"!=typeof sessionStorage.recentDocuments&&""!=sessionStorage.recentDocuments&&null!=sessionStorage.recentDocuments){var e=JSON.parse(sessionStorage.recentDocuments);if(history.length>=1&&e.hasOwnProperty("length")&&1==e.length)return!0;if(history.length>1&&e.hasOwnProperty("length")&&e.length>1)return!1}else if(history.length>1)return!1;return!0}function buildUrl(e){var t="";return t=-9==e.docType?e.docCode:e.urlFormat,0==t.search("//")&&-1!=t.search("//")&&(t=t.replace("//","/")),t}function getDocDataOnChip(e){switch(e){case 1:return docDetails={docAttrs:[{key:"docName",value:"setup.EventName"},{key:"docCode",value:"setup.DocumentCode"}],docConditions:{initialCondition:""},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}",urlFormat:"/Sourcing/Rfx?oloc="+APPCONSTANTS.oloc.rfxOloc+"&dd={}"};case 9:return docDetails={docAttrs:[{key:"docName",value:"InvoiceData.name"},{key:"docNumber",value:"InvoiceData.number"},{key:"docCode",value:"InvoiceData.documentCode"}],docConditions:{initialCondition:"typeof modelData.InvoiceData.documentCode != 'undefined' && modelData.InvoiceData.documentCode > 0 && typeof modelData.InvoiceData.number != 'undefined' && modelData.InvoiceData.number != null"},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}&st=15",urlFormat:"/P2P/Invoice?dd={}&oloc="+APPCONSTANTS.oloc.invoiceOloc+"#/invoice"};case 8:return docDetails={docAttrs:[{key:"docName",value:"orderData.name"},{key:"docNumber",value:"orderData.number"},{key:"docCode",value:"orderData.documentCode"}],docConditions:{initialCondition:"typeof modelData.orderData.documentCode != 'undefined' && modelData.orderData.documentCode > 0 && typeof modelData.orderData.number != 'undefined' && modelData.orderData.number != null"},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}&st=15",urlFormat:"/P2P/Order?dd={}&oloc="+APPCONSTANTS.oloc.orderOloc+"#/po"};case 7:return docDetails={docAttrs:[{key:"docName",value:"ReqData.name"},{key:"docNumber",value:"ReqData.number"},{key:"docCode",value:"ReqData.documentCode"}],docConditions:{initialCondition:"typeof modelData.ReqData.documentCode!= 'undefined' && typeof modelData.ReqData.number!= 'undefined' && modelData.ReqData.number != '' "},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}&st=15",urlFormat:"/P2P/Index?dd={}&oloc="+APPCONSTANTS.oloc.reqOloc+"#/requisitions/{}"};case 14:return docDetails={docAttrs:[{key:"docName",value:"IRData.name"},{key:"docNumber",value:"IRData.number"},{key:"docCode",value:"IRData.documentCode"}],docConditions:{initialCondition:"typeof modelData.IRData.documentCode != 'undefined' && modelData.IRData.documentCode > 0"},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}&st=15",urlFormat:"/P2P/IR?dd={}&oloc="+APPCONSTANTS.oloc.irOloc+"#/ir"};case 11:return docDetails={docAttrs:[{key:"docName",value:"setup.formName"},{key:"docCode",value:"$('#hdnFormCode').val()"}],docConditions:{initialCondition:""},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}&st=15",urlFormat:"/PartnerManagement/Form/CreateForm?dd={}&oloc="+APPCONSTANTS.oloc.formOloc};case 12:return docDetails={docAttrs:[{key:"docName",value:"setup.name"},{key:"docCode",value:"$('#hdnAssessmentCode').val()"}],docConditions:{initialCondition:"typeof modelData.setup.name != 'undefined' && modelData.setup.name != '' "},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}&st=15",urlFormat:"/supplierManagement/Scorecard?dd={}&oloc="+APPCONSTANTS.oloc.scorcardOloc+"#/supplier/scorecard"};case 19:return docDetails={docAttrs:[{key:"docName",value:"partnerDetails.objPartnerDetails.LegalCompanyName"},{key:"docCode",value:"partnerDetails.objPartnerDetails.PartnerCode"}],docConditions:{initialCondition:""},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"spc={docCode}&bpc={bpc}",urlFormat:"/supplierManagement/Profile?dd={}&oloc="+APPCONSTANTS.oloc.partnerOloc+"#/supplier/profile"};case 5:return docDetails={docAttrs:[{key:"docName",value:"ContractInfo.ContractDetails.DocumentName "},{key:"docNumber",value:"ContractInfo.ContractDetails.DocumentNumber"},{key:"docCode",value:"ContractInfo.ContractDetails.DocumentCode "}],docConditions:{initialCondition:"typeof modelData.ContractInfo.ContractDetails.DocumentCode != 'undefined' &&  modelData.ContractInfo.ContractDetails.DocumentCode > 0 && typeof modelData.ContractInfo.ContractDetails.DocumentNumber != 'undefined' && modelData.ContractInfo.ContractDetails.DocumentNumber != null  && typeof modelData.ContractInfo.ContractDetails.DocumentName != 'undefined' && modelData.ContractInfo.ContractDetails.DocumentName != null"},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}&st=15",urlFormat:"/Contract/ContractInfo/Index?oloc="+APPCONSTANTS.oloc.contractOloc+"&dd={}&dt=5#/contract/new"};case 6:return docDetails={docAttrs:[{key:"docName",value:""},{key:"docNumber",value:""},{key:"docCode",value:""}],docConditions:{initialCondition:""},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode"};case 21:return docDetails={docAttrs:[{key:"docName",value:"Project.Title"},{key:"docNumber",value:"Project.DocumentNumber"},{key:"docCode",value:"Project.DocumentCode"}],docConditions:{initialCondition:""},bpc:"APPCONSTANTS.userPreferences.UserBasicDetails.BuyerPartnerCode",dd:"dc={docCode}&bpc={bpc}",urlFormat:"/?dd={}&oloc="+APPCONSTANTS.oloc.projectOloc+"#/ppst/edit?dd={}"}}}function getModelData(e,t,r,i){docType=e;var a={};a=getDocDataOnChip(e);var n={},o=[];"undefined"!=typeof a&&"undefined"!=typeof a.docAttrs?(a.docAttrs.forEach(function(e){n[e.key]="";e.value.split(".");o.push("modelData."+e.value)}),o.length>0&&(i(o),r())):r()}function saveRecentDocument(newVal,modelData){console.log(APPCONSTANTS.userPreferences);try{var enableSave=!0;if(docDetails.hasOwnProperty("bpc"))try{docDetails.bpc=eval(docDetails.bpc)}catch(e){enableSave=!1}if(enableSave){for(var currentDoc={},i=0;i<docDetails.docAttrs.length;i++)docDetails.docAttrs[i].value.indexOf("$")>-1?currentDoc[docDetails.docAttrs[i].key]=eval(docDetails.docAttrs[i].value):"undefined"!=typeof newVal[i]&&void 0!=newVal[i]?currentDoc[docDetails.docAttrs[i].key]=newVal[i]:enableSave=!1;enableSave&&(("0"==currentDoc.docCode.toString()||""==currentDoc.urlFormat)&&(newDocFlag=!0),docDetails.hasOwnProperty("urlFormat")&&(5==docType&&0!=currentDoc.docCode?(docDetails.urlFormat="/Contract/ContractInfo/Index?oloc="+APPCONSTANTS.oloc.contractOloc+"&dd={}&dt=5#/contract/{}",currentDoc.urlFormat=docDetails.urlFormat):currentDoc.urlFormat=docDetails.urlFormat),docDetails.hasOwnProperty("bpc")&&(currentDoc.bpc=docDetails.bpc),docDetails.hasOwnProperty("dd")&&(currentDoc.dd=docDetails.dd),currentDoc.docType=docType,currentDoc.selectedSectionId=selectedSectionId,saveRecentDoc(persistenceApiService.storeLocation.LocalStorage,currentDoc),saveRecentDoc(persistenceApiService.storeLocation.SessionStorage,currentDoc),saveRecentDoc(persistenceApiService.storeLocation.DB,currentDoc,"-9"))}}catch(err){console.log(err)}}function saveWorkspaceRecentDocument(e){console.log(APPCONSTANTS.userPreferences);try{var t=!0;if(t){var r={};r.docName=e.docName,r.docCode=e.docCode,r.urlFormat="/"+e.urlFormat.replace(APPCONSTANTS.userPreferences.URLs.AppURL,""),0==r.urlFormat.search("//")&&-1!=r.urlFormat.search("//")&&(r.urlFormat=r.urlFormat.replace("//","/")),r.docType=e.docType,saveRecentDoc(persistenceApiService.storeLocation.SessionStorage,r),saveRecentDoc(persistenceApiService.storeLocation.DB,r,"-9")}}catch(i){console.log(i)}}function saveRecentDoc(e,t,r){if(e!=persistenceApiService.storeLocation.DB){var i=10,a=persistenceApiService.getUserData(e,0,"recentDocuments");"undefined"!=typeof a&&null!=a&&"undefined"!=a?"string"==typeof a&&(a=JSON.parse(a),0==a.length&&(a=[])):a=[];a.length;if("undefined"!=typeof t.dd)if(0==t.docCode){t.dd=t.dd.replace("{docCode}",t.docCode),t.dd=t.dd.replace("{bpc}",t.bpc);var n=encode(t.dd)}else{var o=window.location.href;if(o=o.match(/(dd=)(\w+)/g),"string"!=typeof o)var n=o[0].replace("dd=","");else var n=o.replace("dd=","")}if("undefined"!=typeof t.urlFormat&&(0==newDocFlag?(t.urlFormat=t.urlFormat.replace("{}",n),(7==t.docType||21==t.docType)&&(t.urlFormat=t.urlFormat.replace("{}",n)),t.urlFormat=t.urlFormat.replace("==",2)):t.urlFormat=""),a.length>i&&a.shift(),e==persistenceApiService.storeLocation.SessionStorage){var l=!1;if(a.length>=1){var s=a.length-1;if(a[s].docType==t.docType&&(0==a[s].docCode||a[s].docCode==t.docCode)){var c=JSON.stringify(a[s])===JSON.stringify(t);l=!0,0==c&&angular.extend(a[s],t)}}0==l&&(a.push(t),a.length>i&&a.shift()),persistenceApiService.saveUserData(e,0,"recentDocuments",JSON.stringify(a))}else if(e==persistenceApiService.storeLocation.LocalStorage&&t.docCode>0){var l=!1;if(a.length>0)for(var u=a.length-1;u>=0;u--)if(a[u].docType==t.docType&&a[u].docCode==t.docCode){var c=JSON.stringify(a[u])===JSON.stringify(t);l=!0,0==c&&angular.extend(a[u],t)}0==l&&(a.push(t),a.length>i&&a.shift()),persistenceApiService.saveUserData(e,0,"recentDocuments",JSON.stringify(a))}}else if(e==persistenceApiService.storeLocation.DB){"undefined"!=typeof t.dd&&(t.dd=t.dd.replace("{docCode}",t.docCode),t.dd=t.dd.replace("{bpc}",t.bpc));var n=encode(t.dd);if("undefined"!=typeof t.urlFormat&&(t.urlFormat=t.urlFormat.replace("{}",n),(7==t.docType||21==t.docType)&&(t.urlFormat=t.urlFormat.replace("{}",n))),t.docCode>0&&-9!=t.docType){var d={};d.recentDocuments=[],d.recentDocuments.push(t),persistenceApiService.saveUserData(e,0,"recentDocuments",d,r)}}}function getbyte64(e,t){var r=ALPHA.indexOf(e.charAt(t));if(-1===r)throw"Cannot decode base64";return r}function decode(e){e=""+e;var t,r,i,a=e.length;if(0===a)return e;if(a%4!==0)throw"Cannot decode base64";t=0,e.charAt(a-1)===PADCHAR&&(t=1,e.charAt(a-2)===PADCHAR&&(t=2),a-=4);var n=[];for(r=0;a>r;r+=4)i=getbyte64(e,r)<<18|getbyte64(e,r+1)<<12|getbyte64(e,r+2)<<6|getbyte64(e,r+3),n.push(String.fromCharCode(i>>16,i>>8&255,255&i));switch(t){case 1:i=getbyte64(e,r)<<18|getbyte64(e,r+1)<<12|getbyte64(e,r+2)<<6,n.push(String.fromCharCode(i>>16,i>>8&255));break;case 2:i=getbyte64(e,r)<<18|getbyte64(e,r+1)<<12,n.push(String.fromCharCode(i>>16))}return n.join("")}function getbyte(e,t){var r=e.charCodeAt(t);if(r>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return r}function encode(e){if(1!==arguments.length)throw"SyntaxError: Not enough arguments";var t,r,i=[];e=""+e;var a=e.length-e.length%3;if(0===e.length)return e;for(t=0;a>t;t+=3)r=getbyte(e,t)<<16|getbyte(e,t+1)<<8|getbyte(e,t+2),i.push(ALPHA.charAt(r>>18)),i.push(ALPHA.charAt(r>>12&63)),i.push(ALPHA.charAt(r>>6&63)),i.push(ALPHA.charAt(63&r));switch(e.length-a){case 1:r=getbyte(e,t)<<16,i.push(ALPHA.charAt(r>>18)+ALPHA.charAt(r>>12&63)+PADCHAR+PADCHAR);break;case 2:r=getbyte(e,t)<<16|getbyte(e,t+1)<<8,i.push(ALPHA.charAt(r>>18)+ALPHA.charAt(r>>12&63)+ALPHA.charAt(r>>6&63)+PADCHAR)}var n=i.join(""),o=n.match(/\=/g);return"undefined"!=typeof o&&null!=o?(n=n.substring(0,n.length-o.length),n+o.length):n}var newDocFlag=!1,docDetailsTemplate={},docDetails={},dirtyCheck=[],docType=-10,selectedSectionId="",states=["/rfx/edit/:id","/supplier/scorecard","/supplier/form","/contract/:id","/supplier/profile"],saveSelectedSection=function(e){if(-10!=docType){var t=persistenceApiService.getUserData(persistenceApiService.storeLocation.SessionStorage,0,"recentDocuments");if("undefined"!=typeof t&&null!=t&&"string"==typeof t&&(t=JSON.parse(t),t.length>0)){var r=t.length,i=t[r-1];i.selectedSectionId=e,persistenceApiService.saveUserData(persistenceApiService.storeLocation.SessionStorage,0,"recentDocuments",JSON.stringify(t)),selectedSectionId=e}}},getSelectedSection=function(){if(-10==docType)return"";if(""!=selectedSectionId)return selectedSectionId;var e=persistenceApiService.getUserData(persistenceApiService.storeLocation.SessionStorage,0,"recentDocuments");if("undefined"!=typeof e&&null!=e&&"string"==typeof e&&(e=JSON.parse(e),e.length>0)){var t=e.length;return selectedSectionId=e[t-1].selectedSectionId}},PADCHAR="=",ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",service={redirectToPreviousNode:_redirectToPreviousNode,historyIsEmpty:_historyIsEmpty,getModelData:getModelData,saveRecentDocument:saveRecentDocument,docDetails:docDetails,saveSelectedSection:saveSelectedSection,getSelectedSection:getSelectedSection,saveWorkspaceRecentDocument:saveWorkspaceRecentDocument};return service}function masterPersistenceServiceFunc(APPCONSTANTS,$timeout,PLATFORMURLs,persistenceApiService,nPlusOneService){var _api=persistenceApiService,_nPlusOne=nPlusOneService,_userData={},_state="",_documentType=-10,masterData={},documentFields={},selectedValues={},setSelectedValue=function(e,t,r){var i=t;"string"==typeof t&&(i=JSON.parse(t));var a={filterKey:i.filterKey},n=r[a.filterKey];selectedValues[e]=n},setDocumentFields=function(e,t){(null==e||""==e)&&(e="rootFields"),documentFields.hasOwnProperty(e)||(documentFields[e]=[]),documentFields[e].push(t)},getDocumentFields=function(e){return _.isEmpty(documentFields)?null:("undefined"==typeof e&&(e="parentKey"),documentFields.hasOwnProperty(e)?documentFields[e]:null)},getFormattedData=function(data,format){if(!data||0==data.length)return[];var str=format;try{for(var parentSplit=str.split("{"),j=0;j<parentSplit.length;j++)for(var childSplit=parentSplit[j].split("}"),k=0;k<childSplit.length;k++)(childSplit[k].indexOf(".")>0||data.hasOwnProperty(childSplit[k]))&&(str=str.replace(new RegExp("{"+childSplit[k]+"}","ig"),eval("data."+childSplit[k])))}catch(e){}return str.trim()},saveMasterDataForRootField=function(e,t,r){if(!_.isEmpty(documentFields)){var i=!1;masterData.hasOwnProperty(e)&&-1!=masterData[e].indexOf(r)&&(i=!0);var a=t;"string"==typeof t&&(a=JSON.parse(t));var n={fieldId:e,events:{},childId:"undefined"!=typeof documentFields[e]?documentFields[e]:"Null",parentId:"undefined"!=typeof t.parentId&&""!=t.parentId?t.parentId:"Null",parentValue:"undefined"!=typeof t.parentId&&"undefined"!=typeof selectedValues[t.parentId]?selectedValues[t.parentId]:"Null"};if(i)r.hasOwnProperty("_id")&&delete r._id,n.events=r,n.fieldValue=r.filterKey;else{var o={filterKey:a.filterKey},l=r[o.filterKey];selectedValues[e]=l;var s=getFormattedData(r,a.displayKey);n.fieldValue=l,n.events={displayKey:s,searchKey:r[a.searchKey],filterKey:r[a.filterKey],value:s}}var c="rootFields";_api.saveMasterUserDataToDB(n,c,masterData)}},getMasterDataForRootField=function(){if(!_.isEmpty(documentFields)){var e={fieldId:documentFields.rootFields,parentId:"Null",parentValue:"Null"},t="rootFields";_api.getMasterUserDataFromDB(e,t,masterData),console.log(masterData)}},getAutoSuggestList=function(e,t){if("undefined"!=typeof e){var r={};if(!_.isEmpty(masterData)&&(r=masterData[e],"undefined"!=typeof r))return r}return[]},service={userData:_userData,api:_api,nPlusOne:_nPlusOne,selectedValues:selectedValues,getAutoSuggestList:getAutoSuggestList,documentFields:documentFields,setDocumentFields:setDocumentFields,getDocumentFields:getDocumentFields,getMasterDataForRootField:getMasterDataForRootField,saveMasterDataForRootField:saveMasterDataForRootField,setSelectedValue:setSelectedValue};return service}angular.module("SMART2").service("persistenceService",["APPCONSTANTS","$timeout","PLATFORMURLs","persistenceApiService","sectionsPersistenceService","nPlusOneService","masterPersistenceService",persistenceServiceFunc]).factory("persistenceApiService",["APPCONSTANTS","$timeout","PLATFORMURLs","httpService","$http","$window","$filter",persistenceApiServiceFunc]).service("sectionsPersistenceService",["APPCONSTANTS","$timeout","PLATFORMURLs","persistenceApiService",sectionsPersistenceServiceFunc]).service("nPlusOneService",["APPCONSTANTS","$window","$timeout","PLATFORMURLs","persistenceApiService","$state",nPlusOneServiceFunc]).service("masterPersistenceService",["APPCONSTANTS","$timeout","PLATFORMURLs","persistenceApiService","nPlusOneService",masterPersistenceServiceFunc]);
}(angular,window),function(){"use strict";function e(){var e=!1;return{getProperty:function(){return e},setProperty:function(t){e=t}}}angular.module("SMART2").service("requestClicked",e)}(),function(){"use strict";window.isObject=function(e){return angular.isObject(e)},window.isDate=function(e){return angular.isDate(e)},window.isNumber=function(e){return angular.isNumber(e)},window.isDefined=function(e){return angular.isDefined(e)},window.isUndefined=function(e){return angular.isUndefined(e)},window.isString=function(e){return angular.isString(e)},window.isUndefinedOrEmptyOrNull=function(m){if(isObject(m)&&m.hasOwnProperty("ui")){var result;try{result=eval("m.dataModel."+m.ui.field)}catch(e){}return""===result||void 0===result||null===result}return""===m||void 0===m||null===m},window.isEmptyOrNull=function(m){if(isObject(m)&&m.hasOwnProperty("ui")){var result;try{result=eval("m.dataModel."+m.ui.field)}catch(e){}return""===result||null===result}return""===m||null===m},window.isUndefinedOrNull=function(m){if(isObject(m)&&m.hasOwnProperty("ui")){var result;try{result=eval("m.dataModel."+m.ui.field)}catch(e){}return void 0===result||null===result}return void 0===m||null===m},angular.module("SMART2").service("RuleEngine",["$translate",function($translate){function appendErrorString(e){var t="";return e&&e.params&&_.isArray(e.params)&&(_.each(e.params,function(e,r){t+=e&&e.isToBeTranslated?$translate.instant(e.text):e.text}),e.error=t,delete e.params),e}function changeDateFormatForNools(colDefs,virtualDatamodel,type){if(""!=colDefs&&"cell"==type)_.each(colDefs.cloumnDefs,function(colDef){if("date"==colDef.attributes.type){var field=colDef.field,fieldVal=field.split(".");if(fieldVal.length>1){var fieldzeroval=eval("virtualDatamodel."+fieldVal[0]);if(void 0!==fieldzeroval&&null!==fieldzeroval){var dateVar=eval("virtualDatamodel."+fieldVal[1]);void 0!=dateVar&""!=dateVar?virtualDatamodel[field]=convertDate(dateVar):virtualDatamodel[field]=""}}else{var dateVar=eval("virtualDatamodel."+fieldVal[0]);void 0!=dateVar&""!=dateVar?virtualDatamodel[field]=convertDate(dateVar):virtualDatamodel[field]=""}}});else if(""!=colDefs&&"grid"==type){var field=colDefs.field,fieldVal=field.split(".");if(fieldVal.length>1){var fieldzeroval=eval("virtualDatamodel."+fieldVal[0]);if(void 0!==fieldzeroval&&null!==fieldzeroval){var dateVar=eval("virtualDatamodel."+fieldVal[1]);void 0!=dateVar&""!=dateVar?virtualDatamodel[field]=convertDate(dateVar):virtualDatamodel[field]=""}}else{var dateVar=eval("virtualDatamodel."+fieldVal[0]);void 0!=dateVar&""!=dateVar?virtualDatamodel[field]=convertDate(dateVar):virtualDatamodel[field]=""}}}function convertDate(e){if("undefined"!=typeof e&&null!=e&&isNaN(e)&&e.indexOf("/Date(")>-1){var t=e.replace("/Date(",""),r=t.replace(")/",""),i=new Date(parseInt(r));return new Date(i.getFullYear(),i.getMonth(),i.getDate()+1)}if("undefined"!=typeof e&&null!=e&&!isNaN(e)&&angular.isFunction(e.getFullYear)){var i=new Date(e);return new Date(i.getFullYear(),i.getMonth(),i.getDate()+1)}if("undefined"!=typeof e&&null!=e&&!isNaN(e)){var i=new Date(parseInt(e));return new Date(i.getFullYear(),i.getMonth(),i.getDate()+1)}}var service=this;this.utils={},this.setRules=function(e,t,r,i,a){this.dataConfig=e,this.dataModel=t,this.cumulativeRules=r,this.rules=i,this.type=angular.isDefined(a)?a:"header",this.isNoolsEnabled=!angular.isObject(i)},this.setDocumentRules=function(e){this.documentRules=e},this.setUtils=function(e){this.utils=e},this.executeNools=function(e,t){var r,i,a,n=[],o=this.dataConfig,l=this.dataModel,s=this.type,c=this.rules,u=this.isNoolsEnabled,d=[],p=[],f=[];if("grid"==s)_.each(l,function(e,t){var l=angular.copy(e);_.each(angular.isArray(o)?o[0].cloumnDefs:o.cloumnDefs,function(e,o){if(e.hasOwnProperty("rules")&&e.rules.length>0)if(angular.extend(e,{fieldName:e.field,errorFieldDisplayName:$translate.instant(e.displayName)}),"date"==e.attributes.type&&changeDateFormatForNools(e,l,"grid"),u){for(var s=[new Message({ui:angular.extend(e,{data:e.field}),dataModel:l,scope:""})],m=s[0].ui.rules,g=flow.getSession.apply(flow,s),y=0;y<m.length;y++)g.focus(""+m[y]);g.on("error",function(e){void 0!==e.errors[0].rowColIndex?"invalid"==e.errors[0].state?(d.push(e.errors[0].rowColIndex),f.push(e.errors[0]),g.dispose()):"disable"==e.errors[0].state&&p.push(e.errors[0].rowColIndex):"invalid"==e.errors[0].state&&(n.push(e.errors[0]),g.dispose())}),g.match()}else{var s={ui:angular.extend(e,{data:e.field,errorFieldDisplayName:$translate.instant(e.displayName)}),dataModel:l,index:{row:t,column:o},scope:""};r=c.get(s);for(var y=0;y<e.rules.length;y++)if(i=r[e.rules[y]],angular.isDefined(i)&&angular.isFunction(i.condition)&&i.condition()){a=appendErrorString(i.result()),angular.isDefined(a.rowColIndex)?"invalid"==a.state?(d.push(a.rowColIndex),f.push(a)):"disable"==a.state&&p.push(a.rowColIndex):"invalid"==a.state&&n.push(a);break}}})}),(d.length>0||p.length>0||f.length>0)&&(n.push(d),n.push(p),n.push(f));else if("cell"==s&&o.colDef.hasOwnProperty("rules")&&o.colDef.rules.length>0){o.colDef.fieldName=o.colDef.field;var m=angular.copy(l.entity);if("date"==o.colDef.attributes.type&&changeDateFormatForNools(t,m,"cell"),u){for(var g=[new Message({ui:o.colDef,dataModel:m,scope:""})],y=flow.getSession.apply(flow,g),h=o.colDef.rules,v=0;v<h.length;v++)y.focus(""+h[v]);y.on("error",function(e){n.push(e.errors[0]),y.dispose()}),y.match()}else{var g={ui:angular.extend(o.colDef,{errorFieldDisplayName:$translate.instant(o.colDef.displayKey)}),dataModel:m,scope:""};r=c.get(g);for(var v=0;v<o.colDef.rules.length;v++)if(i=r[o.colDef.rules[v]],angular.isDefined(i)&&angular.isFunction(i.condition)&&i.condition()){n.push(appendErrorString(i.result()));break}}}else"chargeGrid"==s&&(l=l.orderData.ItemChargesForHeader,_.each(l,function(e){var t=angular.copy(e),r=[];_.each(o[0].cloumnDefs,function(e){if(angular.extend(e,{fieldName:e.field}),e.hasOwnProperty("rules")){"date"==e.attributes.type&&changeDateFormatForNools(e,t);var i=[new Message({ui:angular.extend(e,{data:e.field}),dataModel:t,scope:""})];r.push(i)}}),_.each(r,function(e){for(var t=e[0].ui.rules,r=flow.getSession.apply(flow,e),i=0;i<t.length;i++)r.focus(""+t[i]);r.on("error",function(e){"invalid"==e.errors[0].state&&(n.push(e.errors[0]),r.dispose())}),r.match()})}));return angular.isFunction(e)?void e({success:0==n.length,failedRules:n}):{success:0==n.length,failedRules:n}},this.isValid=function(e,t){if("undefined"==typeof Header){var r=this.documentRules.get({ui:"",dataModel:this.dataModel,scope:"",utils:this.utils}),i=r[e];angular.isDefined(i)&&angular.isFunction(i.condition)&&i.condition()&&angular.isFunction(t)&&t({success:!1,errorData:appendErrorString(i.result())})}else{var a=[new Header({ui:"",dataModel:this.dataModel,scope:"",utils:this.utils})],n=headerFlow.getSession.apply(headerFlow,a).focus(e);n.on("error",function(e){angular.isFunction(t)&&t({success:!1,errorData:e.errors[0]}),n.dispose()}),n.match()}},this.execute=function(callback,currentScope){if(angular.isDefined(this.type)&&"header"!=this.type)return void this.executeNools(callback,currentScope);for(var isValid=!0,tmpPropertyValue,failedRules=[],rulesObj=this.rules,isNoolsEnabled=this.isNoolsEnabled,tmpRules,tmpRule,tmpRuleResult,i=0;i<this.dataConfig.length;i++)if(!this.dataConfig[i].isHidden)for(var j=0;j<this.dataConfig[i].rows.length;j++)for(var k=0;k<this.dataConfig[i].rows[j].properties.length;k++)if(!(this.dataConfig[i].rows[j].properties[k].isHidden||Object(this.dataConfig[i].rows[j].properties[k]).hasOwnProperty("attributes")&&this.dataConfig[i].rows[j].properties[k].attributes.readonly)){if(tmpPropertyValue=void 0,this.dataConfig[i].rows[j].properties[k].attributes&&this.dataConfig[i].rows[j].properties[k].attributes.hasOwnProperty("ngModelOptions")&&this.dataConfig[i].rows[j].properties[k].attributes.ngModelOptions.getterSetter)tmpPropertyValue=eval("currentScope."+this.dataConfig[i].rows[j].properties[k].data+"()");else try{if("object"==typeof eval("this.dataModel."+this.dataConfig[i].rows[j].properties[k].data)&&"subsection"!=this.dataConfig[i].rows[j].properties[k].type){if(void 0!=this.dataConfig[i].rows[j].properties[k].attributes)var datakey=void 0!=this.dataConfig[i].rows[j].properties[k].attributes.displayformat?this.dataConfig[i].rows[j].properties[k].attributes.displayformat:this.dataConfig[i].rows[j].properties[k].attributes.datakey;else if(void 0!=this.dataConfig[i].rows[j].properties[k].ui)var datakey=this.dataConfig[i].rows[j].properties[k].ui.displayformat?this.dataConfig[i].rows[j].properties[k].ui.displayformat:this.dataConfig[i].rows[j].properties[k].ui.datakey;datakey=datakey.split("-"),tmpPropertyValue="";for(var m=0;m<datakey.length;m++)datakey[m].indexOf("{")>-1&&(datakey[m]=datakey[m].replace("{","").replace("}","")),tmpPropertyValue+=eval("this.dataModel."+this.dataConfig[i].rows[j].properties[k].data+"."+datakey[m]).trim()}else tmpPropertyValue=eval("this.dataModel."+this.dataConfig[i].rows[j].properties[k].data)}catch(e){}var isValidated=!1;if(Object(this.dataConfig[i].rows[j].properties[k]).hasOwnProperty("attributes")&&(Object(this.dataConfig[i].rows[j].properties[k].attributes).hasOwnProperty("type")&&"number"==this.dataConfig[i].rows[j].properties[k].attributes.type?(isValidated=!0,(this.dataConfig[i].rows[j].properties[k].isMandatory&&(void 0==tmpPropertyValue||""===tmpPropertyValue||null==tmpPropertyValue||isNaN(tmpPropertyValue))||!this.dataConfig[i].rows[j].properties[k].isMandatory&&isNaN(tmpPropertyValue)&&void 0!=tmpPropertyValue)&&failedRules.push({type:"required",section:this.dataConfig[i],uiConfig:this.dataConfig[i].rows[j].properties[k],rule:"isNaN(this)",error:$translate.instant("PLATFORM_ThisFieldShouldBeNumber")})):Object(this.dataConfig[i].rows[j].properties[k].attributes).hasOwnProperty("type")&&"autocomplete"==this.dataConfig[i].rows[j].properties[k].attributes.type&&(isValidated=!0,!this.dataConfig[i].rows[j].properties[k].isMandatory||tmpPropertyValue+""!=""&&null!=tmpPropertyValue&&void 0!=tmpPropertyValue||failedRules.push({type:"required",section:this.dataConfig[i],uiConfig:this.dataConfig[i].rows[j].properties[k],rule:"this == ''",error:$translate.instant("PLATFORM_ThisFieldShouldNotBeBlank")}))),isValidated||"subsection"==this.dataConfig[i].rows[j].properties[k].type||"checkbox"==this.dataConfig[i].rows[j].properties[k].type||"switch"==this.dataConfig[i].rows[j].properties[k].type||!this.dataConfig[i].rows[j].properties[k].isMandatory||""!=tmpPropertyValue&&void 0!=tmpPropertyValue&&null!=tmpPropertyValue||failedRules.push({type:"required",section:this.dataConfig[i],uiConfig:this.dataConfig[i].rows[j].properties[k],rule:"this == ''",error:$translate.instant("PLATFORM_ThisFieldShouldNotBeBlank")}),Object(this.dataConfig[i].rows[j].properties[k]).hasOwnProperty("rules")&&this.dataConfig[i].rows[j].properties[k].rules)for(var l=0;l<this.dataConfig[i].rows[j].properties[k].rules.length;l++)if("string"!=typeof this.dataConfig[i].rows[j].properties[k].rules[l])eval(this.dataConfig[i].rows[j].properties[k].rules[l].rule.replace(/this/g,"tmpPropertyValue"))&&failedRules.push({type:"inline",section:this.dataConfig[i],uiConfig:this.dataConfig[i].rows[j].properties[k],rule:this.dataConfig[i].rows[j].properties[k].rules[l].rule,error:this.dataConfig[i].rows[j].properties[k].rules[l].error});else if(isNoolsEnabled){var messageModel=[new Header({ui:this.dataConfig[i].rows[j].properties[k],dataModel:this.dataModel,scope:currentScope,utils:this.utils})],session=headerFlow.getSession.apply(headerFlow,messageModel).focus(this.dataConfig[i].rows[j].properties[k].rules[l]),_section=this.dataConfig[i],_uiElement=_section.rows[j].properties[k];session.on("error",function(e){e.errors[0].uiConfig=_uiElement,e.errors[0].section=_section,failedRules.push(e.errors[0]),session.dispose()}),session.match()}else{var messageModel={ui:{section:this.dataConfig[i],property:this.dataConfig[i].rows[j].properties[k]},dataModel:this.dataModel,scope:currentScope,utils:this.utils};if(tmpRules=rulesObj.get(messageModel),tmpRule=tmpRules[this.dataConfig[i].rows[j].properties[k].rules[l]],angular.isDefined(tmpRule)&&angular.isFunction(tmpRule.condition)&&tmpRule.condition()){this.dataConfig[i].rows[j].properties[k].validate=!0,failedRules.push(appendErrorString(tmpRule.result()));break}}}if(angular.isDefined(this.cumulativeRules)&&angular.isArray(this.cumulativeRules)&&this.cumulativeRules.length>0){tmpRules=angular.isDefined(this.rules)&&angular.isFunction(this.rules.get)&&this.rules.get({ui:{},dataModel:this.dataModel,scope:currentScope,utils:this.utils});for(var i=0;i<this.cumulativeRules.length;i++)if("string"!=typeof this.cumulativeRules[i]&&eval(this.cumulativeRules[i].rule.replace(/this/g,"this.dataModel")))failedRules.push({type:"cumulative",rule:this.cumulativeRules[i].rule,error:this.cumulativeRules[i].error});else if(isNoolsEnabled){var messageModel=[new Header({ui:{},dataModel:this.dataModel,scope:currentScope,utils:this.utils})],session=headerFlow.getSession.apply(headerFlow,messageModel).focus(this.cumulativeRules[i]);session.on("error",function(e){failedRules.push(e.errors[0]),session.dispose()}),session.match()}else if(tmpRule=tmpRules[this.cumulativeRules[i]],angular.isDefined(tmpRule)&&angular.isFunction(tmpRule.condition)&&tmpRule.condition()){failedRules.push(appendErrorString(tmpRule.result()));break}}failedRules.length>0&&failedRules[0].section&&(failedRules[0].section.isContentLoaded=!0,failedRules[0].section.isActive=!0),angular.forEach(failedRules,function(e,t){e.uiConfig&&(e.uiConfig.validate=!0)}),failedRules.length>0&&(failedRules[0].hasOwnProperty("uiConfig")&&void 0!=failedRules[0].uiConfig||failedRules[0].hasOwnProperty("property")&&""!=failedRules[0].property&&void 0!=failedRules[0].property)&&("undefined"!=typeof failedRules[0].uiConfig?failedRules[0].uiConfig.focus=!0:failedRules[0].property.focus=!0),tmpRules=null,tmpRule=null,tmpRuleResult=null,angular.isFunction(callback)&&callback({success:0==failedRules.length,failedRules:failedRules})},this.executeOnStaticForm=function(callback){var isValid=!0,failedRules=[];for(var key in this.dataConfig)for(var i=0;i<this.dataConfig[key].rules.length;i++)eval(this.dataConfig[key].rules[i].rule.replace(/this/g,"this.dataModel."+key))&&(failedRules.push({type:"inline",rule:this.dataConfig[key].rules[i].rule,error:this.dataConfig[key].rules[i].error}),this.dataConfig[key].validate=!0,1==failedRules.length&&(this.dataConfig[key].focus=!0),isValid=!1);if(this.cumulativeRules)for(var i=0;i<this.cumulativeRules.length;i++)eval(this.cumulativeRules[i].rule.replace(/this/g,"this.dataModel"))&&(failedRules.push({type:"cumulative",rule:this.cumulativeRules[i].rule,error:this.cumulativeRules[i].error}),isValid=!1);angular.isFunction(callback)&&callback({success:isValid,data:failedRules})}}])}(),function(){"use strict";angular.module("SMART2").service("scrollPosition",["$filter","$state",function(e,t){var r,i=[];this.setEnableScroll=function(e){r=e},this.getEnableScroll=function(){return r},this.set=function(t,r){if(0===i.length)i.push({scroll:t,currentUrl:r});else{var a=e("filter")(i,{currentUrl:r},!0)[0],n=i.indexOf(a);a?(i.splice(n,1),i.push({scroll:t,currentUrl:r})):i.push({scroll:t,currentUrl:r})}},this.get=function(){return i},this.performScroll=function(e,t,r){angular.element("body,html").animate({scrollTop:e},3500,"linear")},this.scrollWitgetsection=function(e){var r,i=t;setTimeout(function(){if(i.previous.scrollTo&&i.previous.scrollTo.state===i.current.name){r=e.filter(function(e){return i.previous.scrollTo.sectionId===e.sectionId});var t=$("#"+r[0].sectionKey);if(t.length&&t.find(".collapsible-header").hasClass("active")){var a=t.offset().top-angular.element("#"+r[0].sectionKey.split("-section")[0]+"-sortable").offset().top;a+=62,angular.element("body,html").animate({scrollTop:a},"medium")}else t.find(".collapsible-header").trigger("click")}},100)}}])}(),function(){"use strict";angular.module("SMART2").service("ScrollTo",[function(){var e=0;this.setScrollingTopMargin=function(t){e=t},this.perform=function(t,r,i){try{angular.element(t.closest(".modal").length>0?t.closest(".modal"):"body,html").animate({scrollTop:t.offset().top-r.offset().top+e},400,function(){"undefined"!=typeof i&&i()})}catch(a){}}}])}();
//# sourceMappingURL=services.min.js.map
